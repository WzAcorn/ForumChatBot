,topic_id,translated_raw,refine_raw
3533,6542,"Hi,
I have an application as follows:
STM32 board with W5200 shield acting as a TCP client
STM32 board with W5500 shield acting as a TCP server.
I am working to improve fault resistance of the system. For so, during normal operation, frames are exchanged between both boards.
I am focussing on the server side.
When I disconnect the RJ45 plug from one board, a timeout condition exists. My software performs repeated attempts to reconnect. During this time, I monitor the Ethernet traffic using Wireshark. The client sends ARP requests repeatedly to know the MAC address of the server.
When I reconnect the plug, the client sends a SYN frame to which the server responds with a RST, ACK frame.
From then on, the client side is trapped in an endless loop. With the aid of the generation of a pulse on a port, I could localize where this loop stands. It is the following function:
    In function EthernetClient::connect(IPAddress ip, uint16_t port)
the loop is the following:

  while (uint8_t s = status() != SnSR::ESTABLISHED) 
		{
			DELAY(1);
        digitalWrite(4,HIGH);  // debug
        digitalWrite(4,LOW);  // debug
			if (s == SnSR::CLOSED) 
			{
				_sock = MAX_SOCK_NUM;
				return 0;
			}
			if (W5100.readSnIR(_sock) & SnIR::TIMEOUT)
			{
				W5100.writeSnIR(_sock, SnIR::TIMEOUT); /* clear TIMEOUT */
				close(_sock);					// free socket 
				_sock = MAX_SOCK_NUM;
				return 0;
			}

This means that the state of the W socket is neither ESTABLISHED nor CLOSED, and that the timeout flag is not raised.
I use the pulse generation trick since I do not have an emulator.
According to the documentation of the W5200, if a connect fails for any reason, the state changes to CLOSED. Apparently, this is not the case here, and I have no idea what the state could be. Anyway, the code is stuck in this loop and I must reboot the client side to recover.
Why does the W5200 not go back to CLOSE state on reception of the RST, ACK frame? In which state is it then? One further information: I have added a software SPI to the loop code, so as to transmit serially the value of the Status Register when blocked in the loop. Apparently, the SR is 1 in this state, which means ARP being sent. Since there is no traffic at that time (according to WireShark), the timeout mechanism seems not to operate, as the status never changes to CLOSED nor is the Timeout flag raised in the interrupt register.
Is this a bug of the W5200 chip? I added to my code a workaround: a timeout when the state is ARP. So the loop exits and the whole initialisation process is restarted. I have tested this, and so far, it seems to recover as expected.
I am still curious to know the whereabouts of the W5200 regarding this issue. [quote=""Phono, post:1, topic:6542""]
STM32 board with W5200 shield acting as a TCP client
STM32 board with W5500 shield acting as a TCP server.
[/quote]

You must troubleshoot both sides, not only client side.

[quote=""Phono, post:1, topic:6542""]
When I reconnect the plug, the client sends a SYN frame to which the server responds with a RST, ACK frame.
[/quote]

When reconnecting, your client seem to use same local (source) port number, and of course server will respond with RST/ACK, because the connection with specified local port is already established. You must use another port number for reconnection, and server must have hardware/software means to monitor hung TCP sockets - the open sockets in TCP mode having no activity within specified period of time.

[quote=""Phono, post:2, topic:6542""]
the timeout mechanism seems not to operate
[/quote]

Were your code waiting for enough time for timeout to happen before doing anything else? See formula for the timeout calculation in the datasheet, time calculation it is not that straightforward. Evgueny, initially my software did not have a timeout mechanism, and it would wait for hours because the chip never raised the timeout flag, nor did it return the socket to the closed state. It was stuck in the ARP state, thus my workaround to put a timeout when in this state. If you did unplug cable when each device have a data to send, each device might ocurre a timeout.
The reason that server sent a SYN is no more socket to listen is exist at server.

Both server & client can to check the connection alive by sending a keep alive packet.
In W5200, Refer to Sn_CR_KEEPSEND.
In W5500, Refer to Sn_CR_KEEPSEND or Sn_KPALVTR.

Thank you.","Q) Why does the W5200 not go back to CLOSE state on reception of the RST, ACK frame? In which state is it then? 

A) When reconnecting, your client seem to use same local (source) port number, and of course server will respond with RST/ACK, because the connection with specified local port is already established. You must use another port number for reconnection, and server must have hardware/software means to monitor hung TCP sockets - the open sockets in TCP mode having no activity within specified period of time.

Q) Were your code waiting for enough time for timeout to happen before doing anything else? 

A) Initially my software did not have a timeout mechanism, and it would wait for hours because the chip never raised the timeout flag, nor did it return the socket to the closed state. It was stuck in the ARP state, thus my workaround to put a timeout when in this state. If you did unplug cable when each device have a data to send, each device might occur a timeout.

Q) The reason that server sent a SYN is no more socket to listen is exist at server.

A) Both the server and client can check the connection alive by sending a keep-alive packet. In W5200, refer to Sn_CR_KEEPSEND. In W5500, refer to Sn_CR_KEEPSEND or Sn_KPALVTR."
3534,6546,"I am not sure what I am doing wrong here, but my socket rcv interrupt is re-triggering after clearing socket interrupt and common reg socket interrupt.

Sequence is:
Poll for SIR status
Check Sn_IR status
clear Sn_IR interrupt (tried writing 0xff)
clear SIR interrupt.
read both IR gives 0 res

After that I read the rx buffer and send sock_RECV.

Is that correct sequence ? or should I first read and send RECV and then clear the interrupts ? Hi, gossamer.

If RX data is remained in RX memory, recv interrupt is not cleared.
So, Clear IR after sock_RECV command.

Thanks.","Q) Is that correct sequence ? or should I first read and send RECV and then clear the interrupts ?
A) Hi, gossamer. If RX data is remained in RX memory, recv interrupt is not cleared. So, Clear IR after sock_RECV command."
3535,6549,"Does the W5500 support Vlan tags?  Particularly in MACRAW mode, can I send and receive packets with a Vlan tag? Dear _Cush!

WIZnet chip can't support VLAN tag with hardwire TCP/IP core logic.
But if you use MACRAW raw mode, It is possible.
If SOCKET is used with MACRAW, All protocol processing are responsibility of you.

Thank you.","Q) Does the W5500 support Vlan tags? 
A) WIZnet chip can't support VLAN tag with hardwire TCP/IP core logic. But if you use MACRAW raw mode, It is possible. If SOCKET is used with MACRAW, All protocol processing are responsibility of you."
3536,6551,"?ÂÃªÂ³Â Ã«Â§ÂÃ¬ÂÂ¼??ÂÂ??

?ÂÃ¬ÂÂ¬ STM32F407ZGTÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ W5100 ?ÂÃ­ÂÂ Ã¬Â¤ÂÃ¬ÂÂ ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?ÂÃ­ÂÂÃ¬Â¤ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃªÂ³Â ??W5100 ?Â¤Ã¬Â Â ?? ?ÂÃ¬ÂÂ  Ã«Â£Â¨Ã­ÂÂ?ÂÃ¬ÂÂ

?ÂÃ«Â²ÂÃ«Â§??ÂÃ¬ÂÂ ???ÂÃªÂ³Â  ÃªÂ·??Â¤Ã¬ÂÂÃ«Â¶??Â°Ã«ÂÂ ?ÂÃ¬ÂÂ ???ÂÃ¬? ?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ??Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬??ÂµÃ«ÂÂ??
 *?Â¸Ã­ÂÂ¸Ã«Â¶ÂÃ¬ÂÂ???ÂÃ¬ÂÂ  Ã«Â°ÂÃ«ÂÂ ?Â°Ã¬ÂÂ´?Â°Ã­ÂÂ¬ÃªÂ¸Â°Ã«ÂÂ 16byte ?ÂÃ«ÂÂ??

1. ?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ¤??recv_size  Ã«Â³??ÂÃª? Ã¬Â²ÂÃ¬ÂÂ?ÂÃ«ÂÂ 24Ã«Â¡??ÂÃ¬ÂÂ ?ÂÃªÂ³Â , ??Ã«Â²ÂÃ¬Â§Â¸Ã«Â¶??Â°Ã«ÂÂ 0?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

2. ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³?DBWrite8(S0_CR,0x40);	//RECV Ã«Â¥?Ã¬Â£Â¼Ã¬ÂÂÃ¬Â²ÂÃ«Â¦Â¬?ÂÃ«Â©Â´ recv_size??24??Ã¬Â¦ÂÃª?Ã«Â¥??Â©Ã«ÂÂ??

     ?Â´Ã«ÂÂ° Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ??Ã«Â°ÂÃ¬ÂÂ?ÂÃ«ÂÂÃ¬Â§? ?????ÂÃ¬ÂÂÃªÂ¹ÂÃ¬ÂÂ??

?ÂÃ«ÂÂ???ÂÃ¬ÂÂ  ?ÂÃ¬ÂÂ¤ ?ÂÃ«ÂÂ??

=================================================================
recv_size = (DBRead8(S0_RX_RSR1) << 8) + DBRead8(S0_RX_RSR2);
	printf(""recv size : %d\r\n"",recv_size);

	if(recv_size > 0)
	{
		ptr = (DBRead8(S0_RX_RD1) << 8) + DBRead8(S0_RX_RD2);

		memcpy(g_iRecvData_W5100,(uint8_t *)(0x60006000+ptr),24);

		ptr += recv_size;

		ptr1 = (ptr & 0xff00) >> 8;
		ptr2 = ptr & 0x00ff;

		DBWrite8(S0_RX_RD1,ptr1);
		DBWrite8(S0_RX_RD2,ptr2);

		DBWrite8(S0_CR,0x40);	//RECV
	}
================================================================
W5100 ?Â¤Ã¬Â Â Ã«Â¶?Ã«Â¶?
DBWrite8(0x0000,0x80);	//W5100 Reset

	DBWrite8(S0_MR,0x02);	//Socket Register Mode Setting(UDP)

	DBWrite8(SUBNETMASK1,0xff);	//SubnetMask Setting, SUBR (Subnet Mask Register)
	DBWrite8(SUBNETMASK2,0xff);	//255.255.255.0
	DBWrite8(SUBNETMASK3,0xff);
	DBWrite8(SUBNETMASK4,0x00);

	DBWrite8(0x040c,0xc0);	//Destination IP Setting, Sn_DIPR (Socket n Destination IP Address Register)
	DBWrite8(0x040d,0xa8);	//192.168.0.201
	DBWrite8(0x040e,0x00);
	DBWrite8(0x040f,0xc9);

	DBWrite8(0x0410,0x07);	//Destination Port Setting, Sn_DPORT (Socket n Destination Port Register)
	DBWrite8(0x0411,0xd0);	//2000

	DBWrite8(S0_CR,0x01);	//Socket Open

	DBWrite8(Source_IP1,0xc0);	//IP Setting, SIPR (Source IP Address Register)
	DBWrite8(Source_IP2,0xa8);	//192.168.0.200
	DBWrite8(Source_IP3,0x00);
	DBWrite8(Source_IP4,0xc8);

	DBWrite8(S0_PORT1,0x0b);	/ Port Setting(3000)
	DBWrite8(S0_PORT2,0xb8); SN_RX_RSR value is calculated as sn_rx_wr -sn_rx_rd value.
Compare the value of SN_RX_WR and SN_RX_RD values and compare the value of the first data or the second data to see what registers are.

Also, check the size of the variable one more time.
Is RECV_SIZE and PTR declared unsigned int 16bit, PTR1 and PTR1 as Unsigned int 8bit? yes.Variable size

uint16_t recv_size;
uint16_t PTR;
uint8_t PTR1, PTR2;

It is set to fit.

What is the number of SN_RX_Wr?

I can't search in the datasheet. SN_RX_RD immediately to the next address
For socket 0, 0x042a -0x042b. If you read SN_RX_RD

0x042a: 0x0, 0x042b: 0x18

I read it.

DBWRITE8 (S0_CR, 0x40);// Recv When tining this part, the value will increase by 0x18.

If you release the tin, it will remain at 0x18.

Now I will continue to receive it. Should I send it after receiving? You do not need to transmit after receiving.
It is also possible to keep receiving.
As I mentioned on the wired, SN_RX_WR register is not affected by SN_CR registers.
Each time the data is recv, the SN_RX_WR value is increased.
First of all, please check the following three things.

1. DBWRITE8 (S0_CR, 0x40);
If you read the S0_CR register, please check if it is clear to 0x00.
2. DBWRITE8 (S0_CR, 0x40);Afterwards, please check the SN_SR register to see if there is no change in the socket status.(In the case of TCP communication, 0x17 must be 0x17 in the Establish state, and UDP communication must be 0x22.)
3. Please check once more (0x0401) to see if the address of SN_CR register is correct (0x0401). In addition, I checked the code one more time
You are setting the Source IP and port after the socket Open
Please set before the socket open. uint16_t recv_size;
	uint16_t ptr;
	uint8_t ptr1,ptr2;
	uint8_t test,test2,test3,test4;
	uint8_t c,d;

	ptr1=0;
	ptr2=0;
	ptr=0;
	recv_size=0;
	test=0;
	test2=0;
	test3=0;
	test4=0;
	c=0;
	d=0;

        recv_size = (DBRead8(S0_RX_RSR1) << 8) + DBRead8(S0_RX_RSR2);
	printf(""recv size : %d\r\n"",recv_size);

	if(recv_size > 0)
	{
		ptr = (DBRead8(S0_RX_RD1) << 8) + DBRead8(S0_RX_RD2);
		ptr = ptr & 0x07ff;

		memcpy(g_iRecvData_W5100,(uint32_t *)(0x60006000+recv_size-24),24);

		ptr += recv_size;

		ptr1 = (ptr & 0xff00) >> 8;
		ptr2 = ptr & 0x00ff;

		DBWrite8(S0_RX_RD1,ptr1);
		DBWrite8(S0_RX_RD2,ptr2);

		DBWrite8(S0_CR,0x40);	//RECV
	}

	c=DBRead8(S0_CR);
	d=DBRead8(S0_SR);
	printf(""S0_CR: 0x%x   S0_SR: 0x%x\r\n"",c,d);

	test=DBRead8(0x042A);
	test2=DBRead8(0x042B);

	test3=DBRead8(S0_RX_RD1);
	test4=DBRead8(S0_RX_RD2);
	printf(""0x042A : 0x%x, 0x042B : 0x%x\r\nS0_RX_RD1 : 0x%x S0_RX_RD2 : 0x%x \r\n"",test,test2,test3,test4);

?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ¤?Â¸Ã­ÂÂ??????

Ã¬Â²?Ã«Â²ÂÃ¬Â§Â¸ ?ÂÃ¬ÂÂ  ?ÂÃ¬ÂÂ??

recv size : 24
S0_CR: 0x0   S0_SR: 0x22
0x042A : 0x0, 0x042B : 0x18
S0_RX_RD1 : 0x0 S0_RX_RD2 : 0x18 

?ÂÃ«Â²Â Ã¬Â§Â¸Ã«ÂÂ

recv size : 0
S0_CR: 0x0   S0_SR: 0x22
0x042A : 0x0, 0x042B : 0x18
S0_RX_RD1 : 0x0 S0_RX_RD2 : 0x18 

?ÂÃ«ÂÂ??

 #define S0_CR			0x0401
 #define S0_SR			0x0403

Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ¬ÂÂ´?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

??Ã«ÂªÂ»Ã«Â°Â?ÂÃ¬? ?Â´Ã­ÂÂ´ÃªÂ°? ?ÂÃ«ÂÂ?Â¤Ã¬ÂÂ..?ÂÃ£ÂÂ In addition, I checked the code one more time
You are setting the Source IP and port after the socket Open
Please set before the socket open. If you set the source IP and port before opening, the status is 0x22.

I didn't receive it a few days ago, so I changed the order of settings, so I received it in that setting.

I just changed the order of setting, but I couldn't receive it because it was opened at the end. Source IP?? PortÃ«Â¥??Â¤Ã¬Â Â?ÂÃªÂ³Â ?ÂÃ¬ÂÂ Socket???Â¤Ã­ÂÂ????
Source IP?? Port ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸??ÃªÂ²Â½Ã¬ÂÂ°?ÂÃ«ÂÂ ÃªÂ°ÂÃ¬ÂÂ´ ?Â¨Ã¬ÂÂ?ÂÃ«ÂÂ??

?ÂÃ­ÂÂ 

?ÂÃ«ÂÂ??ioDriver??W5100??????Recv Ã¬Â½ÂÃ«ÂÂ?ÂÃ«ÂÂ??
Ã¬Â§?ÃªÂ¸??Â¬Ã¬ÂÂ©Ã¬Â¤ÂÃ¬ÂÂ´??Ã¬Â½ÂÃ«ÂÂ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ masking Ã¬Â²ÂÃ«Â¦Â¬Ã«Â¥??ÂÃ­ÂÂ´Ã¬Â£Â¼ÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?ÂÃ¬ÂÂ¬ Ã«Â¬Â¸Ã¬Â Â?? Ã«Â¬Â´Ãª??ÂÃ«ÂÂ¤ÃªÂ³??ÂÃ«ÂÂ¼?Â¤Ã¬ÂÂ ?ÂÃ¬ÂÂ¼??
masking Ã¬Â²ÂÃ«Â¦Â¬Ã«Â¥??ÂÃ¬??ÂÃªÂ³Â  ?Â°Ã¬ÂÂ´?Â°Ã«? read?Â ÃªÂ²Â½??chip???ÂÃ«ÂÂ±???ÂÃ¬??Â¤Ã­ÂÂ°Ã«Â¥?ÃªÂ±Â´Ã«ÂÂÃ«Â¦????ÂÃ¬ÂÂ¼Ã«Â¯?Ã«Â¡?ptr??masking Ã¬Â²ÂÃ«Â¦Â¬Ã«Â¥??ÂÃ¬ÂÂ¬ ?Â°Ã¬ÂÂ´?Â°Ã«? read?ÂÃ¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.
RxMAX ÃªÂ°ÂÃ¬? Socket buffer sizeÃªÂ°? 2KBÃ«Â¡??Â¤Ã¬Â Â?ÂÃ¬ÂÂ?Â¤Ã«ÂÂ ÃªÂ°??ÂÃ­ÂÂ??2048, RXMASK ÃªÂ°ÂÃ¬? 2047(2048-1) Ã«Â¡?ÃªÂ³ÂÃ¬ÂÂ°?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ??


    void wiz_recv_data(uint8_t sn, uint8_t *wizdata, uint16_t len)
    {
      uint16_t ptr;
      uint16_t size;
      uint16_t src_mask;
      uint16_t src_ptr;

      ptr = getSn_RX_RD(sn);
      
      src_mask = (uint32_t)ptr & getSn_RxMASK(sn);
      src_ptr = (getSn_RxBASE(sn) + src_mask);

      
      if( (src_mask + len) > getSn_RxMAX(sn) ) 
      {
        size = getSn_RxMAX(sn) - src_mask;
        WIZCHIP_READ_BUF((uint32_t)src_ptr, (uint8_t*)wizdata, size);
        wizdata += size;
        size = len - size;
    	src_ptr = getSn_RxBASE(sn);
        WIZCHIP_READ_BUF(src_ptr, (uint8_t*)wizdata, size);
      } 
      else
      {
        WIZCHIP_READ_BUF(src_ptr, (uint8_t*)wizdata, len);
      }
        
      ptr += len;
      
      setSn_RX_RD(sn, ptr);
    }

    uint32_t getSn_RxBASE(uint8_t sn)
    {
       int8_t  i;
    #if ( _WIZCHIP_IO_MODE_ == _WIZCHIP_IO_MODE_BUS_DIR_)
       uint32_t rxbase = _W5100_IO_BASE_ + _WIZCHIP_IO_RXBUF_;
    #else   
       uint32_t rxbase = _WIZCHIP_IO_RXBUF_;
    #endif   
       for(i = 0; i < sn; i++)
          rxbase += getSn_RxMAX(i);

       return rxbase;
    } ?? making Ã¬Â²ÂÃ«Â¦Â¬?ÂÃªÂ²Â ?ÂµÃ«ÂÂ??

?ÂÃ¬ÂÂ¸??Ã«Â¬Â´Ã¬ÂÂ?Â¸Ã¬? Ã¬Â°Â¾Ã¬? ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

 	uint8_t Des_IP1,Des_IP2,Des_IP3,Des_IP4,Des_Port1,Des_Port2,Src_IP1,Src_IP2,Src_IP3,Src_IP4,Src_Port1,Src_Port2;

	Des_IP1=0;
	Des_IP2=0;
	Des_IP3=0;
	Des_IP4=0;
	Des_Port1=0;
	Des_Port2=0;
	Src_IP1=0;
	Src_IP2=0;
	Src_IP3=0;
	Src_IP4=0;
	Src_Port1=0;
	Src_Port2=0;

	DBWrite8(0x0000,0x80);	//W5100 Reset

	DBWrite8(S0_MR,0x02);	//Socket Register Mode Setting(UDP)

	DBWrite8(SUBNETMASK1,0xff);	//SubnetMask Setting, SUBR (Subnet Mask Register)
	DBWrite8(SUBNETMASK2,0xff);	//255.255.255.0
	DBWrite8(SUBNETMASK3,0xff);
	DBWrite8(SUBNETMASK4,0x00);

	DBWrite8(0x040c,0xc0);	//Destination IP Setting, Sn_DIPR (Socket n Destination IP Address Register)
	DBWrite8(0x040d,0xa8);	//192.168.0.201
	DBWrite8(0x040e,0x00);
	DBWrite8(0x040f,0xc9);

	DBWrite8(0x0410,0x07);	//Destination Port Setting, Sn_DPORT (Socket n Destination Port Register)
	DBWrite8(0x0411,0xd0);	//2000

	DBWrite8(S0_CR,0x01);	//Socket Open

	DBWrite8(Source_IP1,0xc0);	//IP Setting, SIPR (Source IP Address Register)
	DBWrite8(Source_IP2,0xa8);	//192.168.0.200
	DBWrite8(Source_IP3,0x00);
	DBWrite8(Source_IP4,0xc8);

	DBWrite8(S0_PORT1,0x0b);	//Port Setting(3000)
	DBWrite8(S0_PORT2,0xb8);

	Des_IP1=DBRead8(0x040c);
	Des_IP2=DBRead8(0x040d);
	Des_IP3=DBRead8(0x040e);
	Des_IP4=DBRead8(0x040f);
	Des_Port1=DBRead8(0x0410);
	Des_Port1=DBRead8(0x0411);
	Src_IP1=DBRead8(Source_IP1);
	Src_IP2=DBRead8(Source_IP2);
	Src_IP3=DBRead8(Source_IP3);
	Src_IP4=DBRead8(Source_IP4);
	Src_Port1=DBRead8(S0_PORT1);
	Src_Port2=DBRead8(S0_PORT2);

	printf(""Des IP : %d.%d.%d.%d  Port : %d "", Des_IP1,Des_IP2,Des_IP3,Des_IP4,((Des_Port1<<8)|(Des_Port2)));
	printf(""Src IP : %d.%d.%d.%d   Port : %d \r\n"", Src_IP1,Src_IP2,Src_IP3,Src_IP4,((Src_Port1<<8)|(Src_Port2)));

Ã«Â¶??????Â¤Ã¬Â Â?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.

Des IP?? PortÃ«Â¥??Â¤Ã¬Â Â -> ?Â¤Ã­ÂÂ -> Src IP?? Port ?Â¤Ã¬Â Â
?ÂÃ«Â¦Â°??Ã¬Â¶ÂÃ«Â Â¥??Ã«Â³Â´Ã«Â©Â´, 

Des IP : 0.0.0.0  Port : 0 Src IP : 192.168.0.200   Port : 3000 

Des IP?? PortÃªÂ°? 0?Â¼Ã«Â¡Â Ã¬Â´ÂÃªÂ¸Â°?ÂÃª? ?Â©Ã«ÂÂ??

ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³??ÂÃ¬ÂÂ  ?? IP?? PortÃ«Â¥?Ã«Â³Â´Ã«Â©Â´

Des IP : 0.0.0.0  Port : 0  Src IP : 192.168.0.200   Port : 184

Src PortÃªÂ°? Ã«Â³?ÃªÂ²Â½Ã«ÂÂ¨???ÂÃ¬ÂÂ¸???ÂÃ«ÂÂ¤??

Recv Ã¬Â»Â¤Ã«Â§Â¨???Â´Ã­ÂÂ???Â´Ã«ÂÂ° ?ÂÃ¬ÂÂ???ÂÃ«ÂÂ ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

Ã¬Â§??ÂÃ¬Â Â?Â¼Ã«Â¡Â IP?? PortÃ«Â¥??Â¤Ã¬Â Â?Â´Ã¬Â¤Â???ÂÃ«ÂÂÃªÂ±Â´Ãª???? After setting the Source IP and Port, after opening the socket,
Does the value remain when checking the source IP and port value?

also

Below is RECV code for the W5100 of IODRIVER.
The code that is now in use is not doing masking processing.
You can feel that it is irrelevant to the current problem,
If you read the data without masking processing, you can touch the wrong register of Chip, so please use the masking process to the PTR to read the data.
The RXMAX value can be calculated by 2048 and RXMASK value 2047 (2048-1), assuming that the socket buffer size is set to 2KB.


    void wiz_recv_data (uint8_t Sn, uint8_t *wizdata, uint16_t len)
    {
      uint16_t PTR;
      uint16_t size;
      uint16_t src_mask;
      uint16_t src_ptr;

      PTR = getsn_rx_rd (SN);
      
      src_mask = (uint32_t) ptr & getsn_rxmask (SN);
      src_ptr = (getsn_rxbase (Sn) + src_mask);

      
      if ((src_mask + len)> getsn_rxmax (SN))
      {
        size = getsn_rxmax (SN) -Src_mask;
        Wizchip_read_buf ((uint32_t) src_ptr, (uint8_t*) wizdata, size;
        wizdata += size;
        size = len -size;
    src_ptr = getsn_rxbase (SN);
        Wizchip_read_buf (src_ptr, (uint8_t*) wizdata, size;
      }
      else
      {
        Wizchip_read_buf (src_ptr, (uint8_t*) wizdata, len);
      }
        
      PTR += LEN;
      
      setsn_rx_rd (Sn, PTR);
    }

    uint32_t getsn_rxbase (uint8_t Sn)
    {
       INT8_T I;
    #IF (_wizchip_io_mode_ == _WIZCHIP_IO_mode_bus_dir_)
       uint32_t rxbase = _W5100_IO_BASE_ + _WIZCHIP_IO_RXBUF_;
    #else
       uint32_t rxbase = _wizchip_io_rxbuf_;
    #endif
       For (i = 0; I <SN; I ++)
          rxbase += getsn_rxmax (i);

       Return rxbase;
    } If you set the source IP and port once, it is normal operation.
Because of the pointer part I mentioned earlier, I can make a mistake of chip's wrong part.
Please check the operation once again after the modification. Please check if the value of S0_PORT1 is normal.
The output value of the port is 184, the bottom 8bit value of 3000, so I think the address would be wrong. There's a strange thing about masking.Please check if it is a normal movement.

Masking PTR and adding 24 after 0xF0 while receiving should be 0x108.

Read it with 0x1F0.

The source code below.

        recv_size = (uint16_t) (dbread8 (s0_rx_rsr1) << 8) + (uint16_t) dbread8 (S0_RX_RSR2);
printf (""recv size: %d \ r \ n"", recv_size);

if (recv_size> 0)
{
PTR = (UINT16_T) (DBREAD8 (S0_RX_RD1) << 8) + (uint16_t) DBREAD8 (S0_RX_RD2);
printf (""PTR1: 0x%x \ r \ n"", PTR);

READ_DATA (PTR, G_ICVDATA_W5100, Recv_size);
PTR += recv_size;

PTR1 = (PTR & 0XFF00) >> 8;
PTR2 = PTR & 0x00FF;

printf (""-i -PTR1: 0x%x PRT2: 0x%x \ r \ n"", PTR1, PTR2);
DBWRITE8 (S0_RX_RD1, PTR1);
DBWRITE8 (S0_RX_RD2, PTR2);

DBWRITE8 (S0_CR, 0x40);// recv

PTR = (UINT16_T) (DBREAD8 (S0_RX_RD1) << 8) + (uint16_t) DBREAD8 (S0_RX_RD2);
printf (""PTR2: 0x%x \ r \ n"", PTR);
}

Looking at the print output


  RECV SIZE: 24
PTR1: 0xD8
   HEAD: 0x5533 -SN: 8399
 -I-PTR1: 0x0 PRT2: 0xF0
  PTR2: 0xF0


  RECV SIZE: 24
PTR1: 0x1f0
   HEAD: 0x5533 -SN: 7941
 -I-PTR1: 0x2 PRT2: 0x8
  PTR2: 0x308


When PTR2 is received at 0xF0, it is thought that PTR1 should be 0xF0 and PTR2 should be 0x108.

And after RECV, the port is set again.
The settings are notified so I can't receive it.
Masking will be tested if it works normal.

Read_data function.

     void Read_data (uint16_t src, uint8_t * dst, uint16_t len)
    {
uint16_t size;
uint16_t src_mask;
uint32_t * src_ptr;

src_mask = src & 0x07FF;
src_ptr = (uint32_t *) (0x60006000 + src_mask);

if ((src_mask + len)> (uint16_t) (2048))
{
size = (uint16_t) 2048 -src_mask;
memcpy (DST, (uint32_t *) src_ptr, size;

DST += size;
size = len -size;
src_ptr = (uint32_t *) (0x60006000);
memcpy (DST, (uint32_t *) src_ptr, size;
}
else
{
memcpy (DST, (uint32_t *) src_ptr, len);
}
    }


Please confirm. | #DEFINE S0_PORT1 || 0x0404 |
| --- | --- | --- |
| #DEFINE S0_PORT2 || 0x0405 |


It is defined as. [Quote = ""11129, POST: 16, Topic: 6551""]
-I-PTR1: 0x2 PRT2: 0x8
PTR2: 0x308
[/Quote]

There seems to be a problem in this part.
It should be 0x208, but it became 0x308

Like the Source Port, this part feels like it has been changing since writing to the Command register.
To make sure that the problem is happening by touching the Read Pointer incorrectly
Please check the READ_DATA () part and check if this is not a problem. I solved it.Thank you ^^

Read_data functions seem to be tested continuously.

It was a compiler problem.
~

    recv_size = (uint16_t) (dbread8 (s0_rx_rsr1) << 8) + (uint16_t) dbread8 (S0_RX_RSR2);

With

    recv_size1 = dbread8 (s0_rx_rsr1);
recv_size2 = dbread8 (s0_rx_rsr2);
recv_size = (recv_size1 << 8) + recv_size2;

It works well because it changes.?ÂÃ£ÂÂ

I use TrueStudio, which has this problem.

The port setting is done after RECV, but the port setting continues to change. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸?? 
Compiler Ã«Â¬Â¸Ã¬Â Â?Â¼ÃªÂ¸Â° Ã«Â³Â´Ã«ÂÂ¨ ( ) ?Â°Ã¬ÂÂ°??????casting ?Â°Ã¬ÂÂ  ?ÂÃ¬ÂÂÃªÂ°? Ã«Â°ÂÃ«?ÂÃ¬ÂÂ´???ÂÃªÂ¸Â´ Ã«Â¬Â¸Ã¬Â ÂÃ«Â¡?Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ¤.

recv_siz = (((uinit16_t)DBRead(S0_RX_RSR1)) << 8) + (uint16_t)DBRead8(S0_RX_RSR2) 

Ã«Â§ÂÃ«ÂÂ Syntax??ÃªÂ²?ÃªÂ°ÂÃ«ÂÂ¤??",1. ?ÂÃªÂ³Â Ã«Â§Â
3537,6553,"Excuse me,
i am a participant of WIZNET IOT CONTEST.
maybe, our team leader submitted subject as a representative.
If we win a prize, we need a certificate of award with the names of all our team members.
Do you have a plan to make certificate of awrard for winners?

Thank you Hello,

Unfortunately, there are no other plans than awarding prizes to winners.
After the winners are announced, we will contact them individually.

Thank you. Oh....
We need a certificate of award a prize.

Because we need to submit it to our university.

Can you please create that document with the name of the team member??

We need a certificate to prove

2019??10??10??(Ã«Âª? ?Â¤Ã­ÂÂ 3:20, Rena Kim via WIZnet Developer Forum <wiznet@discoursemail.com>?ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ±: We will respond to additional questions by email.","Q) Do you have a plan to make certificate of award for winners?
A) Unfortunately, there are no other plans than awarding prizes to winners. After the winners are announced, we will contact them individually.

Q) Can you please create that document with the name of the team member?
A) We will respond to additional questions by email."
3538,6557,"Hi, edtp.

I think you set just one byte read and write functions like this. ""**reg_wizchip_spi_cbfunc(spi_rb, spi_wb,0,0);**""
wiznet spi interface supports burst read and write.
In the getnetinfo function, many functions use burst read/write like WIZCHIP_READ_BUF/ WIZCHIP_WRITE_BUF.
You must set this function, too. 

Thanks. Hi, dkay
Switched on DMA and now I have SPI response.
Thank you.

However, the WIZnet team really needs to post a DHCP example for Keil and STMCube. Thanks, taylor.
You post was helpful.
As I posted to dkay, the wiznet team should post an STMcube DHCP example. 
I'm finding the learning curve on the 6100 library is quite steep even with prior 5500 experience.

I am pleased with the team's choice of microcontroller for the 6100 evb. TrueStudio 9.1 HAL ?ÂÃ«ÂÂ¼?Â´Ã«Â²ÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ«ÂÂ??.. ?Â Ã¬ÂÂ¬??Ã¬Â¦ÂÃ¬ÂÂ?Â´Ã¬ÂÂ???ÂÃ«Â£ÂÃ«Â¥?Ã¬Â°Â¾Ã«ÂÂ¤ÃªÂ°? ÃªÂ¶ÂÃªÂ¸Â???ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ´ Ã«Â¬Â¸Ã¬ÂÂ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤. 
void W6100Initialze(void) ?ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¬ 
reg_wizchip_spi_cbfunc(W6100SpiReadByte, W6100SpiWriteByte, 0, 0); ?Â´Ã«Â ÂÃªÂ²??ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ??ÃªÂµÂ¬Ã¬Â²Â´?ÂÃ¬ÂÂ¼Ã«Â¡??Â´Ã«ÂÂ¤ function???Â Ã¬ÂÂ¸??Ã¬Â¤ÂÃ¬ÂÂ¼?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ¸ÃªÂ°???
HerculesÃ«Â¡??ÂÃ¬ÂÂ¸??Ã«Â³Â´Ã«Â©Â´ 
PHY OK.
Register value after W6100 initialize!
VERSION(200) = 00 
Mac address: 00:00:00:00:00:00
IP address : 0.0.0.0
SM Mask    : 0.0.0.0
Gate way   : 0.0.0.0
DNS Server : 168.126.63.1
GW6  : 0000:0000:0000:0000:0000:0000:0000:0000
LLA  : 0000:0000:0000:0000:0000:0000:0000:0000
GUA  : 0000:0000:0000:0000:0000:0000:0000:0000
SUB6 : 0000:0000:0000:0000:0000:0000:0000:0000

NETCFGLOCK : 1
0:Opened, UDP loopback, port [50000] as IPv4 mode
?Â´Ã«Â ÂÃªÂ²??ÂÃ¬ÂÂ¤?ÂÃ«ÂÂ°, #define DMAÃ«Â¥?wizchip_init.h ?ÂÃ¬ÂÂ¼???Â Ã¬ÂÂ¸??Ã¬Â£Â¼Ã«Â©Â´...
PHY OK.
Register value after W6100 initialize!
VERSION(200) = 00 
Mac address: 00:08:dc:ff:ff:ff
IP address : 192.168.177.25
SM Mask    : 255.255.255.0
Gate way   : 192.168.177.1
DNS Server : 168.126.63.1
GW6  : 0000:0000:0000:0000:0000:0000:0000:0000
LLA  : FE80:0000:0000:0000:0208:DCFF:FE57:5725
GUA  : 0000:0000:0000:0000:0000:0000:0000:0000
SUB6 : FFFF:FFFF:FFFF:FFFF:0000:0000:0000:0000

NETCFGLOCK : 0
?Â´Ã«Â ÂÃªÂ²??ÂÃ¬ÂÂÃªÂ°? ?Â©Ã«ÂÂ?? ?ÂÃ¬Â²Â´ ?Â´ÃªÂ²Â°?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.. HAL ?Â¬Ã¬ÂÂ©?ÂÃ¬Â¤Â??????ÃªÂ°ÂÃ¬? ÃªÂ²Â½Ã¬ÂÂ°ÃªÂ°? ?ÂÃ¬ÂÂÃªÂ²?ÃªÂ°ÂÃ¬ÂÂ ÃªÂ¸Â°Ã«Â¡Â?Â¼Ã«Â¡Â ?Â¨ÃªÂ¹Â?ÂÃ«ÂÂ¤...

STMCubeÃ«Â¡?Truestudio HAL DriverÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡??Â¤Ã¬Â Â?ÂÃ«Â©Â´. . . . .
MX_GPIO_Init();
  MX_DMA_Init();
  MX_ADC1_Init();
  MX_IWDG_Init();
  MX_RTC_Init();
  MX_SPI1_Init();
  MX_SPI2_Init();
  MX_TIM4_Init();
  MX_USART1_UART_Init();
  MX_USART2_UART_Init();
  MX_USART6_UART_Init();    
?Â´Ã«ÂÂ°?ÂÃ¬ÂÂ¼Ã«Â¡?Ã«Â©ÂÃ¬ÂÂ¸?Â¨Ã¬ÂÂ?ÂÃ¬ÂÂ ?Â¬Ã«ÂÂ¬ ?Â¤Ã¬Â ÂÃªÂ³??Â¨ÃªÂ»Â SPIÃªÂ°? Ã«Â¨Â¼Ã¬? ?Â Ã¬ÂÂ¸?Â©Ã«ÂÂ??

20191010_W6100EVB_loopback_Hal.zip?ÂÃ¬ÂÂ ?Â¤Ã«ÂªÂ?ÂÃ«?Ã«Â¡?
spi_set_func(&hspi2);
  BoardInitialze();
  ctlwizchip(CW_SYS_UNLOCK,& syslock);
  ctlnetwork(CN_SET_NETINFO,&gWIZNETINFO);

  printf(""VERSION(%x) = %.2x \r\n"", _VER_,getVER());
  print_network_information(); 
?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ÃªÂ·Â¸Ã«?Ã«Â¡??Â°Ã«ÂÂ¼ ?ÂÃ¬ÂÂ¼Ã«Â©??ÂÃ¬ÂÂ?ÂÃ­ÂÂ??SPIÃªÂ°? Ã«Â¨Â¼Ã¬? ?Â Ã¬ÂÂ¸?ÂÃ«ÂÂ Ã«Â°ÂÃ«ÂÂ??BoardInitialze();?ÂÃ¬ÂÂ spiInitailize();Ã«Â¥??ÂÃ«ÂÂµ?ÂÃªÂ¸Â° ?ÂÃ«Â¬Â¸?Â´Ã¬ÂÂ?ÂµÃ«ÂÂ??.

?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ«Â¦Â¬Ã«Â¥??ÂÃ«ÂÂ ?ÂÃ¬Â Â???ÂÃ¬??ÂÃ«ÂÂÃªÂ²?ÃªÂ°ÂÃ¬ÂÂ´ ??Ã¬Â´ÂÃªÂ¸Â°?ÂÃª? Ã¬Â§ÂÃ­ÂÂ?ÂÃ¬ÂÂ?ÂµÃ«ÂÂ??
spi_set_func(&hspi1);
  MX_SPI1_Init(); //Ã«Â¨Â¼Ã¬??ÂÃ«ÂÂ SPI1???Â´Ã«?Ã«Â¶ÂÃ¬ÂÂ???Â Ã¬ÂÂ¸...
  W6100Initialze();

  ctlwizchip(CW_SYS_UNLOCK,& syslock);
  ctlnetwork(CN_SET_NETINFO,&gWIZNETINFO);

  printf(""Register value after W6100 initialize!\r\n"");

  printf(""VERSION(%x) = %.2x \r\n"", _VER_,getVER());
  print_network_information();
ÃªÂ·Â¸Ã«?Ã«Â¡??Â°Ã«ÂÂ¼?ÂÃ¬ÂÂ¼Ã«Â©??ÂÃ¬ÂÂ?ÂÃªÂ²Â??ÃªÂ´ÂÃ­ÂÂ HAL???ÂÃ­ÂÂ?ÂµÃ«ÂÂ??..","Q) Hi, edtp. I think you set just one byte read and write functions like this. ""reg_wizchip_spi_cbfunc(spi_rb, spi_wb,0,0)."" wiznet spi interface supports burst read and write. In the getnetinfo function, many functions use burst read/write like WIZCHIP_READ_BUF/ WIZCHIP_WRITE_BUF. You must set this function, too. Thanks. Hi, dkay. Switched on DMA and now I have SPI response. Thank you. However, the WIZnet team really needs to post a DHCP example for Keil and STMCube. Thanks, taylor. You post was helpful. As I posted to dkay, the wiznet team should post an STMcube DHCP example. I'm finding the learning curve on the 6100 library is quite steep even with prior 5500 experience. I am pleased with the team's choice of microcontroller for the 6100 evb. TrueStudio 9.1 HAL? void W6100Initialze(void) - Hercules PHY OK. Register value after W6100 initialize! VERSION(200) = 00 Mac address: 00:00:00:00:00:00 IP address: 0.0.0.0 SM Mask: 0.0.0.0 Gateway: 0.0.0.0 DNS Server: 168.126.63.1 GW6: 0000:0000:0000:0000:0000:0000:0000:0000 LLA: 0000:0000:0000:0000:0000:0000:0000:0000 GUA: 0000:0000:0000:0000:0000:0000:0000:0000 SUB6: 0000:0000:0000:0000:0000:0000:0000:0000 NETCFGLOCK: 1 0:Opened, UDP loopback, port [50000] as IPv4 mode - is non-response.
A) STMCube Truestudio HAL Driver. . . . . MX_GPIO_Init(); MX_DMA_Init(); MX_ADC1_Init(); MX_IWDG_Init(); MX_RTC_Init(); MX_SPI1_Init(); MX_SPI2_Init(); MX_TIM4_Init(); MX_USART1_UART_Init(); MX_USART2_UART_Init(); MX_USART6_UART_Init();
PHY OK. Register value after W6100 initialize! VERSION(200) = 00 Mac address: 00:08:dc:ff:ff:ff IP address: 192.168.177.25 SM Mask: 255.255.255.0 Gateway: 192.168.177.1 DNS Server: 168.126.63.1 GW6: 0000:0000:0000:0000:0000:0000:0000:0000 LLA: FE80:0000:0000:0000:0208:DCFF:FE57:5725 GUA: 0000:0000:0000:0000:0000:0000:0000:0000 SUB6: FFFF:FFFF:FFFF:FFFF:0000:0000:0000:0000 NETCFGLOCK: 0 - is non-response.
A) STMCube Truestudio HAL Driver. . . . . . spi_set_func(&hspi2); BoardInitialze(); ctlwizchip(CW_SYS_UNLOCK,& syslock); ctlnetwork(CN_SET_NETINFO,&gWIZNETINFO); printf(""VERSION(%x) = %.2x \r\n"", _VER_,getVER()); print_network_information(); ÃªÂ·Â¸Ã«?Ã«Â¡??Â°Ã«ÂÂ¼ ???SPIÃªÂ°? Ã«Â¨Â¼Ã¬? ?Â Ã¬ÂÂ¸?Â©Ã«ÂÂ? - is non-response."
3539,6562,"i need connect to rockwell PLC via CIP ethernet. any sample code are available ?
w5200 -> Ethernet CIP -> (1756-ENBT)PLC Hi, 
sorry, WIZnet doesn't have any reference codes for PLC and W5200.
However, in the case of a new project, would you use W5500 instead of W5200? we don't recommend to use W5200 for a new project.
Just for your reference, I found out https://www.industrialshields.com/support/help/ethernet-plc-3/m-duino-ethernet-21 from googling... is it useful?","Q) i need to connect to a Rockwell PLC via CIP ethernet. Are there any sample codes available?
A) Hi, sorry, WIZnet doesn't have any reference codes for PLC and W5200. However, in the case of a new project, would you use W5500 instead of W5200? We don't recommend using W5200 for a new project. Just for your reference, I found https://www.industrialshields.com/support/help/ethernet-plc-3/m-duino-ethernet-21 from googling... is it useful?"
3540,6563,"Hello everyone,
I'm implementing a webserver using the W5500. The website that I display has some resources (12 images). I do use all sockets so far and follow the cycle in the provided source code  (https://wizwiki.net/wiki/doku.php/products:w5500:driver), which is basically open->listen->establish->receive->answer->close->open->listen->....
This setting works fine, but I want to reduce the number of sockets, since I need them for other services. 
When I use less then 6 sockets (I tested with chrome), some of the resources are not displayed. (I know that chrome usually uses 6 sockets...)

Question 1: Is there a way to configure the w5500 such that the browser retries its request, if all sockets are busy ?

Question 2: Is there a way to tell the browser how many sockets it is allowed to use when requesting the resources (e.g. in the HTTP header field) ? I do not want to configure my browser settings

Question 3: I also started playing with ""persistent connection"", however the browser (chrome) does not send a second request, after it has send its first and received its answer. Do you have a code example, where you work with persisten connection ? I was already looking at the implementation of the w550web, but there it also uses the open->listen->establish->receive->answer->close cycle, although the http connection is set to keep-alive (might be a bug) I only have three sockets reserved for an embedded web server. It has no problem with Chrome. However, I do use the non-blocking mode (SF_IO_NONBLOCK) for all three sockets. Most browsers will open up to 6 concurrent connections and will not retry if a connection is rejected (e.g., because you don't have one listening when it tries to connect).

I revised an existing W5500 library to actively manage sockets while reserving some for other purposes. You're welcome to use it, or to scavenge it for ideas or code snippets that serve your needs.

Look in particular at sockets.cpp, in which I've implemented a function named manageSockets() that closes connections as needed to maintain the number of listeners you specify and leave a socket untouched if allocated to other purposes. Note that it depends on other functions recording the last time of use for each socket.

You can find my version of the library at [https://github.com/SapientHetero/Ethernet](https://github.com/SapientHetero/Ethernet) Thank You,
I read your code and in fact it tackles the problem that I have. 
I understand, that the mangeSockets() functions disconnects resp. closes the sockets as soon as possible, which is very reasonable. Closing of the idle conenctions is a very good thing. I like that you track the age of the connections...
But altogether, you still have to provide at least 6 sockets for a webserver (In order to guarantee that pages with many (>6) resources are loaded completely) ? Right ?
There is no way to run a webserver with 2 sockets ? 
Otherwise I'll instantly integrate your lib :-) ""what if the next update of chrome allows 8 or 10 parallel socket requests??","Q) Is there a way to configure the w5500 such that the browser retries its request, if all sockets are busy?
Q) Is there a way to tell the browser how many sockets it is allowed to use when requesting the resources (e.g. in the HTTP header field) ? I do not want to configure my browser settings.
Q) Do you have a code example, where you work with persistent connection?

A) I revised an existing W5500 library to actively manage sockets while reserving some for other purposes. You're welcome to use it, or to scavenge it for ideas or code snippets that serve your needs. Look in particular at sockets.cpp, in which I've implemented a function named manageSockets() that closes connections as needed to maintain the number of listeners you specify and leave a socket untouched if allocated to other purposes. Note that it depends on other functions recording the last time of use for each socket. You can find my version of the library at [https://github.com/SapientHetero/Ethernet](https://github.com/SapientHetero/Ethernet).

A) Thank You, I read your code and in fact it tackles the problem that I have. I understand, that the manageSockets() functions disconnects resp. closes the sockets as soon as possible, which is very reasonable. Closing of the idle connections is a very good thing. I like that you track the age of the connections... But altogether, you still have to provide at least 6 sockets for a webserver (In order to guarantee that pages with many (>6) resources are loaded completely) ? Right ? There is no way to run a webserver with 2 sockets ? Otherwise I'll instantly integrate your lib :-) ""what if the next update of chrome allows 8 or 10 parallel socket requests?"
3541,6564,"I would like to know if the Bill of Materials for the 810sio module can be provided.
I would like to use that as a starting point for my own design.
Thanks.
Giri @javakys it is incomplete BOM because it misses part numbers to be used for ordering.
It is just a list of components with some of their properties. OK. I'll ask my colleague to update it in detail.","Q) I would like to know if the Bill of Materials for the 810sio module can be provided. I would like to use that as a starting point for my own design. Thanks. 
A) Giri @javakys it is incomplete BOM because it misses part numbers to be used for ordering. It is just a list of components with some of their properties. OK. I'll ask my colleague to update it in detail."
3542,6567,"hello.
We will answer after review. When can I get a reply?
I'm in a hurry to be in a customer. hello.
The Packet you sent is not the cause analysis.
CISCO sends three ARP-Requests in a 5-second cycle, and after 1US, the W5100 has sent ARP response in two consecutive consecutive ARP responses.

First of all, the question is that Cisco's ARP retransmission timeout setting is suspected.In general, the ARP retransmission time is 200ms, but it is unknown why you send three ARP requests in a row.
Even though I sent ARP response after 1US, I think I should first understand the reason for requesting ARP after 5 seconds.

thank you hello.
The Subnet mask is set instead of Gateway IP in the ARP response you sent.

Do you use the W5100 Hardware Logic for ARP processing?
This can not happen if you use hardware logic.
The ARP Logic Process of the W5100 is designed to use only the information of the ARP-Request packet.
Subnet mask value is not found anywhere on the ARP Request Packet.

If you use Macraw Mode to handle ARP in software, you will need to look at it more.

And it is not understood that the ARP-REPLY is properly changed as the IP information of the gateway port to 0.0.0.0 is changed.
Compared to the two capture files you sent, the ARP-Request message is the same, but the target IP of the ARP-reply is one wrong subnet mask, and the other is the correct gateway IP address.

It is impossible to explain with the Hardware Logic of the W5100.

thank you hello
As a result of checking the customer's reply, it is used as Hardware Logic.
Do you have more content to review?
Please reply.
thank you Hardware Logic can't work so much as mentioned earlier.
ARP Reply Payload is required to use information from ARP Request in hardware.

In other words, this can not happen unless the ARP response is handled by Software.
Please check again.","Q) When can I get a reply? Do you have more content to review?
A) We will answer after review. As a result of checking the customer's reply, it is used as Hardware Logic. Please reply. 

Q) Do you use the W5100 Hardware Logic for ARP processing?
A) If you use Macraw Mode to handle ARP in software, you will need to look at it more. As a result of checking the customer's reply, it is used as Hardware Logic. Hardware Logic can't work so much as mentioned earlier. 

Q) Please check again.
A) It is impossible to explain with the Hardware Logic of the W5100. ARP Reply Payload is required to use information from ARP Request in hardware."
3543,6569,"hello.

We will share the questions requested by our agency.

What is the ESP8266 Toolchains in the link below that can be compatible or used with our Wizfi360?
https://www.espressif.com/en/products/hardware/ESP-WROOM-02/Resources

thank you The same question came from Dacom and answered.
The ESP8266 and Wizfi360 are different from the MCU core, so you can't use the same SDK.
At Commands set that we say that we are compatible.","Q) What is the ESP8266 Toolchains in the link below that can be compatible or used with our Wizfi360?
A) The ESP8266 and Wizfi360 are different from the MCU core, so you can't use the same SDK. At Commands set that we say that we are compatible."
3544,657,"Currently, the W5100 is operated in client mode, repeatedly transmitting 10kb to 20kB of data.
It takes a lot of time to transmit a passive data when transmitting continuous data.Seeing badly, it takes about 200ms from the start to the completion of the transmission.In normal cases, less than 10ms will be required.It occurs 2-3 times when transmitting 10 times.In the network environment, the company uses private wired networks and develops a develop board with a com ticket and a W5100.I would appreciate it if you could tell me what the cause of this problem or how to find the cause. In this problem, the cause may be on the server.
To find the exact cause, you can find the cause of the problem by grabbing the packet with the Wireshark program (downloaded from Wireshark.org) on the server.For example, you can give ACK late on the server, or send a packet slowly from the client or ... there may be various causes.
Please check the packet and send it.: Smiley: hello.

There is a possibility of a problem due to the delay of the ACK transmission.

Please test the No Delayed ACK option of the SOCKET MODE Register (SN_MR) and test it.

thank you I am currently using TCP communication.It is set by TCP protocol in SN_MR.
""Enable the No Delayed ACK option of the Socket Mode Register (SN_MR), please test it.""
Can I enable No Delayed ACK while using TCP communication?Then, isn't the protocol change?
How do I set the above setting while using TCP?Is there any code you can refer to?","Q) Can I enable No Delayed ACK while using TCP communication? Then, isn't the protocol change? How do I set the above setting while using TCP? Is there any code you can refer to?
A) ""Enable the No Delayed ACK option of the Socket Mode Register (SN_MR), please test it.""

Q) I would appreciate it if you could tell me what the cause of this problem or how to find the cause. In this problem, the cause may be on the server.
A) There is a possibility of a problem due to the delay of the ACK transmission. Please test the No Delayed ACK option of the SOCKET MODE Register (SN_MR) and test it."
3545,6570,"W5300 <-> hub <-> w5300
The above configuration is being developed and used with TCP/IP communication.
When the equipment is not driving, there is no problem of communication, but the equipment is intermittently cut off during the operation (driving more than 2.5kV).
It's intermittent, so it's judged to be a communication break by external noise, but when the communication is cut off, the equipment is received and the equipment is going to work abnormal .... So I want to solve it quickly,
First of all, I want to judge if it is a real noise problem,

Is it effective to take the W5300's TX RX line with a differential probe?
Or should I take a power supply of the W5300 ... Or should I take a data line between the W5300 and the DSP?
Or I wonder if it's meaningless to take a picture with a probe.
If it's significant to check and check it, I wonder if it's good to take the noise. I think you should check where there is a problem.
If you send data to DSP-> W5300 -> Hub-> W5300
1. When you send it to the W5300 in the DSP, is it exactly used in the Memory of the W5300,
2. W5300 -> Hub-> W5300, whether the exact data is sent to the network,
I think you should check.

Since then, the power of the W5300 pages or the control signals should be checked if there is no noise. It is difficult to measure the TX and RX line of the W5300.

If you believe that communication is cut off due to external noise, it is expected that noise flows into GND and the power is unstable.

Once I can upload a governor that can check the designed circuit and PCB, I think it's a good idea to review it.

Usually, if the PCB design is wrong, these symptoms often occur.

thank you","Q) Is it effective to take the W5300's TX RX line with a differential probe? Or should I take a power supply of the W5300 ... Or should I take a data line between the W5300 and the DSP? Or I wonder if it's meaningless to take a picture with a probe. If it's significant to check and check it, I wonder if it's good to take the noise. I think you should check where there is a problem. When you send it to the W5300 in the DSP, is it exactly used in the Memory of the W5300, W5300 -> Hub-> W5300, whether the exact data is sent to the network, I think you should check. 
A) It would be effective to use a differential probe to take the W5300's TX RX line for checking the communication issues. Additionally, checking the power supply of the W5300 and the data line between the W5300 and the DSP is also important to identify and mitigate the noise problem. Verifying the exact data transfer between the W5300, Hub, and the network is crucial in diagnosing the communication cut-off issue. Furthermore, ensuring stable power and analyzing the PCB design are essential steps in addressing intermittent communication disruptions due to external noise. Thank you for providing the details to analyze and troubleshoot the issue effectively."
3546,6571,"hello.

After receiving, please contact us about sending.

The problem with the transmission is that if the SEND command is performed,

The ping between the PC and the board is broken.There is no data on the PC (checking with a wire shark)

The value of SN_SR is also output to 0x22.

Is there any place to see another part?

Below is the cord of transmission.


    void write_data (uint8_t * buff, uint16_t len)
    {
uint16_t size;
uint16_t src_mask;
uint32_t * src_ptr;
uint16_t PTR;
uint8_t PTR1, PTR2;


PTR1 = DBREAD8 (S0_TX_WR1);
PTR2 = DBREAD8 (S0_TX_WR2);
PTR = (PTR1 << 8) + PTR2;

src_mask = ptr & mask;
src_ptr = (uint32_t *) (0x60004000 + src_mask);

if ((src_mask + len)> (uint16_t)
{
size = (uint16_t) size -src_mask;
memcpy ((uint32_t *) src_ptr, buff, size);

buff += size;
size = len -size;
src_ptr = (uint32_t *) (0x60004000);
memcpy ((uint32_t *) src_ptr, buff, size);
}
else
{
memcpy ((uint32_t *) src_ptr, buff, len);
}

PTR += LEN;// Write point update
PTR1 = (PTR & 0XFF00) >> 8;
PTR2 = PTR & 0x00FF;
DBWRITE8 (S0_TX_WR1, PTR1);
DBWRITE8 (S0_TX_WR2, PTR2);

DBWRITE8 (S0_CR, SEND);
printf (""\ r \ ns0_cr: 0x%x s0_sr: 0x s0_ir: 0x%x \ r \ n"", (uint8_t) dbread8 (S0_CR), (uint8_t) dbread8 (S0_SR), (uint8_t));
    }

The output is
S0_CR: 0x0 s0_sr: 0x22 s0_ir: 0x4
It appears like this.

    #DEFINE MASK 0x07FF // 0x03FF 0x07FF 0x0ff 0x1FFF
    #define size 2048 // 1024 2048 4096 8192 [Quote = ""11129, POST: 1, Topic: 6571""]
The ping between the PC and the board is broken.
[/Quote]
I don't know what it means to break ping when the Send command is done.

Like the last time of reception,
Please check the source IP, port, destination IP, port.
Did the problem change when receiving?
Keep writing a new port doesn't seem to be the ultimate solution. The connection is confirmed by the ping test on the PC, but it is not connected after the Send.

The strange thing is that the reception is still well received on the board.

SRC IP and Port, Dest IP and PORT have been printed after the SEND

DES IP: 192.168.0.201 port: 0x014 src IP: 192.168.0.200 PORT: 0x01e

I confirmed that it was normal.

The part that continues to write the port is solved by the port value of 3000-> 30, 2000-> 20.
 * Only the upper bit is confirmed to be strange, so we have set the port only.

And after SEND, I printed TX_WR and tx_rr.
S0_tx_wr1: 0x1 s0_tx_wr2: 0xc0
S0_TX_RR1: 0x0 S0_TX_RR2: 0x0
S0_CR: 0x0 s0_sr: 0x22 s0_ir: 0x4

The RR value doesn't seem to be renewed, but after the Send command, it should be the same value as TX_WR. Ah ~ I solved it.

Fixed the initialization part.

I set up Des IP and port in the initial settings, but I commented on that part.

I set it up to write, so the transmission is good.","Q) Did the problem change when receiving?
A) The problem remains the same even after receiving. The connection is confirmed by the ping test on the PC, but it is not connected after the send command.

Q) Is there any place to see another part?
A) The issue might be related to the destination IP, port, source IP, and port details after the SEND command. 

Q) Like the last time of reception, please check the source IP, port, destination IP, port.
A) The source IP and port, destination IP and port have been printed after the SEND command and have been confirmed as normal.

Q) Is there any place to see another part?
A) The part that continues to write the port is solved by adjusting the port values: 3000 to 30, 2000 to 20. Only the upper bit is confirmed to be strange, so the port has been adjusted accordingly.

Q) After SEND, I printed TX_WR and tx_rr. S0_tx_wr1: 0x1 s0_tx_wr2: 0xc0 S0_TX_RR1: 0x0 S0_TX_RR2: 0x0 S0_CR: 0x0 s0_sr: 0x22 s0_ir: 0x4
A) The TX_WR and TX_RR values do not seem to be renewed, but after the send command, they should be the same value as TX_WR. This was solved by fixing the initialization part. The transmission is now functioning normally.

Q) Below is the cord of transmission.
A) 
```
void write_data (uint8_t * buff, uint16_t len)
{
    uint16_t size;
    uint16_t src_mask;
    uint32_t * src_ptr;
    uint16_t PTR;
    uint8_t PTR1, PTR2;

    PTR1 = DBREAD8 (S0_TX_WR1);
    PTR2 = DBREAD8 (S0_TX_WR2);
    PTR = (PTR1 << 8) + PTR2;

    src_mask = ptr & mask;
    src_ptr = (uint32_t *) (0x60004000 + src_mask);

    if ((src_mask + len)> (uint16_t)
    {
        size = (uint16_t) size - src_mask;
        memcpy ((uint32_t *) src_ptr, buff, size);

        buff += size;
        size = len - size;
        src_ptr = (uint32_t *) (0x60004000);
        memcpy ((uint32_t *) src_ptr, buff, size);
    }
    else
    {
        memcpy ((uint32_t *) src_ptr, buff, len);
    }

    PTR += LEN; // Write point update
    PTR1 = (PTR & 0XFF00) >> 8;
    PTR2 = PTR & 0x00FF;
    DBWRITE8 (S0_TX_WR1, PTR1);
    DBWRITE8 (S0_TX_WR2, PTR2);

    DBWRITE8 (S0_CR, SEND);
    printf (""\r\ns0_cr: 0x%x s0_sr: 0x s0_ir: 0x%x \r\n"", (uint8_t) DBREAD8 (S0_CR), (uint8_t) DBREAD8 (S0_SR), (uint8_t));
}
```
#DEFINE MASK 0x07FF // 0x03FF 0x07FF 0x0ff 0x1FFF
#define size 2048 // 1024 2048 4096 8192 [Quote = ""11129, POST: 1, Topic: 6571""]
```"
3547,6572,"This time, I want to buy an EVB board and test it.

When I looked for the source on GitHub, it was made of TRUESTDIO

Is there an example code composed of IAR? Thank you for answer. ","Q) Is there an example code composed of IAR?
A) Yes, there are example codes composed for IAR on the GitHub repository."
3548,6574,"Hi I'm Sijune Lee,a  team leader of Baby Care System.

When I checked the awarding list, you guys would send the email to all winners for the prize.

But I didn't get any email yet... So, please send me the email again.

sijune0525@gmail.com or sijune0525@naver.com would get your messages. 
Thanks. Congratulations! You got the first prize!

Sorry for delaying the winner email. There was small issues about survey form.
Now everything is under the control.

You will get the winner email soon. And contest team will send it to author' email address. 

Sorry about it and congratulation again.

Thank you.","Q) Didn't get any email yet, so please send me the email again. sijune0525@gmail.com or sijune0525@naver.com would get your messages. 
A) Sorry for delaying the winner email. There was small issues about the survey form. Now everything is under control. You will get the winner email soon. And contest team will send it to the author's email address. Sorry about it and congratulations again."
3549,6575,"Please change the Wizfi360-EVB (Shield) in our wiki page as follows.
** wizfi360-EVB-shield **
https://wizwiki.net/wiki/doku.php/products:WIZFI360:WIZFI360-EVB::Start

I also wonder if there is no wizfi360-EVB-Mini page. Jung Hoon Manager.

We know that Wizfi360-EVB is used as Wizfi360-EVB.I changed it to Wizfi360-EVB.

Have you received the product name to Wizfi360-EVB-SHIELD?

It may be what I know wrong, so let's check it.

Wizfi360-EVB-Mini has been created.

https://wizwiki.net/wiki/doku.php/products:WIZFI360:WIZFI360-EVB-Mini:Start

However, the data sheet is unfinished because there are not yet photographs.

As the photo materials are completed, we will complete the homepage, e-Shop, wiki, and datasheet.

thank you hello.Seok Kyun Master,

Yes ~ 2
Wizfi360-EVB-Mini
Wizfi360-EVB-SHIELD
I received a confirmation.
If you are completed later, please give us notice. Hello Seokgyun Master,

As Jung Hoon said, the product name was officially changed last week with the approval of the director.
Wizfi360-EVB-Mini
Wizfi360-EVB-SHIELD ...

Please update the documents and sites so that MINI and SHIELD will start with the uppercase.
In the future, there is no confusion between customers and questioners ^^ And can you send a picture of the Wizfi360-EVB-Mini version for e-SALE site update?
thank you @jakelee
I understand.We will change related documents and materials.

@Andrew1
I am taking pictures.I will share it as soon as it is completed.","Q) I also wonder if there is no wizfi360-EVB-Mini page. Jung Hoon Manager.
Q) Have you received the product name to Wizfi360-EVB-SHIELD?
Q) Can you send a picture of the Wizfi360-EVB-Mini version for e-SALE site update?

A) As Jung Hoon said, the product name was officially changed last week with the approval of the director.
A) Wizfi360-EVB-Mini
A) Wizfi360-EVB-SHIELD ...
A) Please update the documents and sites so that MINI and SHIELD will start with the uppercase.
A) In the future, there is no confusion between customers and questioners. 
A) I am taking pictures. I will share it as soon as it is completed."
3550,6577,"Hello! I am using w5300 as server in TCP mode. W5300 connected to DSP.  I have a w5300 driver and it work fine in some task. Now I have a new task, where data flow increase, and after some second of interconection with PC client, w5300 drop interrupt pin, and I can't acknowledge it in ISR for  inerrupt complete. W5300 can be dropped some interrupt when you are processing a interrupt and another interrupt is occured at that time.

Specially RX interrupt can be  often lost. So If you received the RX interrupt, you should be checked the overraped RX interrupt before your ISR returned. 
It is possible that you can check the remained RX data to Sn_RX_RSR.

For example

```code c
void ISR()
{
      setIMR(0x00);
      while((ir = getIR())
     {
         for(i = 0; i < 8 ; i ++)
         {
              if(ir & (0x0100 << i))  
              {
                  snir[i] = getSn_IR(i);
                  if(rx interrupt)
                  {
                     // rx flag set, or rx data receive process
                   }
                  if(others interrupt)
                  {
                     // interrupt flags set or others interrupt process
                   }
                  setSn_IR(i, snir[i]);
              }
        }
   }
   setIMR(0xFF);
}
```

The example maybe also lost rx interrupt.
so, We recommend the preodic checking Sn_RX_RSR.

Thank you. Ok, thank you! Add this to my ISR.
Now I have interest conditionof wiznet chip, when  RSR value is 0. And SSR value is 0x11.
I assume, that rx fifo is full at this time. Is it so? Thank you!
First phenomenon from errata seems like to my problem. But I not execute close/disconnect.
DSP just send data and freezes at waiting for SENDOK acknowledgment:
 WIZnetSendOk[n]=false;
 wrWIZnetReg(Sn_CR(n))=CMD_SEND;
 while(!WIZnetSendOk[n]);
////(WIZnetSendOk[n] set in ISR) Could you share the process to send data?     void WIZnetWrite(BYTE *Buf,long Length,long n)
	{	
		long LocLen,i,j,k,ind,FreeSpace;
		WORD dataWrite;
		WORD* wp = (WORD*)Buf;
		if(WIZnetSocketState[n] != CONNECTED)	return;

		if(((DWORD)Buf)&0x01)
		{	WritingCycle(oddCopy,Buf,Length,n);
		}
		else
		{	WritingCycle(evenCopy,Buf,Length,n);
		}
	}
	
	void WritingCycle(DataOperation f,BYTE *Buf,long Length,long n)
	{
		long LocLen,ind,j,FreeSpace;
		WORD dataWrite;
		
		FreeSpace=getFreeSpace(n);
		for(ind=0;ind<Length && WIZnetSocketState[n] == CONNECTED;)
		{	if(FreeSpace == 0)
			{	for(j=1000/5;j>0;j--)	// ~1000 ÃÂ½?
					asm(""nop;"");
				FreeSpace=getFreeSpace(n);
				if(FreeSpace == 0)	continue;				
			}
			LocLen=min((Length-ind),FreeSpace);
			f(LocLen,Buf,ind,n);			
			setSizeTxData(n,LocLen);
			ssync();
			WIZnetSendOk[n]=false;
			wrWIZnetReg(Sn_CR(n))=CMD_SEND;
			DWORD guard=1000000;
			while(!WIZnetSendOk[n])
			{   asm(""nop;"");
			}
			dataWrite=rdWIZnetReg(Sn_MR(n));
			ssync();
			ind+=LocLen;
		}
		return;	
	}
	inline void oddCopy(long WrLen, BYTE* Buf,long ind,long n)
	{	long i=0,k=0;
		WORD dataWrite;
		for (i=0;i<WrLen/2;i++)
		{	dataWrite = (Buf[ind+k])|(Buf[ind+k+1]<<8);	
			wrWIZnetReg(Sn_TX_FIFOR(n))=dataWrite;;
			k+=2;
		}
		if (WrLen&0x01)
		{	wrWIZnetReg(Sn_TX_FIFOR(n))=(WORD)(Buf[ind+k]);
			k++;
		}
	} Hi,

Your code maybe worked well.
But, I wonder what's roll of ssync() and why read Sn_MR.

I recommend to modify your code as following.

[quote=""sparrow, post:7, topic:6577""]
WIZnetSendOk[n]=false; 
wrWIZnetReg(Sn_CR(n))=CMD_SEND; 
DWORD guard=1000000; 
while(!WIZnetSendOk[n]) { asm(""nop;""); }
[/quote]

==>
``` code c
wrWIZnetReg(Sn_CR(n)) = CMD_SEND;
while(rdWIZnetReg(Sn_CR(n)) != 0); // wait until command is cleard.
DWORD guard=1000000;
while(!WIZnetSendOk[n]) {asm{""nop""); }
// Add to barrier code for proctection : disable_interrupt();
WIZnetSendOk[n] = false;
// Add to barride code for proctection : enable_interrupt();
```

Thank you. Thank you!
I add your modification, but still has 0x11 at SSR.
I add guard counter and sending CMD_DISCON for case where counter decrement to 0.  This so rough, but reconnect reset 0x11 state. And...not always.
Have you idea how to avoid this state? As expained in erratum #1, 
If a socket is still at 0x11, Socket operation becomes abnormal.
This problem happens often when socket is disconnected by command before send is not process completely.

In your case, If gurad==0, you forced to disconnect a socket.
In the case, you can follow as the erratum #1 guide.

```code c
if(guard == 0) 
{
        socket(sn, Sn_MR_UDP, 3000, 0x00);
        sendto(sn, ""1"", 1, (char*)0x0000001,3000);
        while(Ssn_SSR != SOCK_CLOSED);
}
````

The correct guide shoud be reffered to Erratum#1.

Thank you. 

} So this udp sending didn't break current tcp connection? Hear are full code...

```code c
      uint8_t destip[4] = {0, 0, 0, 1};

      // TODO

      // You can wait for completing to sending data;

      // wait about 1 second;

      // if you have completed to send data, skip the code of erratum 1

      // ex> wait_1s();

      //     if (getSn_TX_FSR(s) == getSn_TxMAX(s)) continue;

      // 

      //M20160503 : The socket() of close() calls close() itself again. It occures a infinite loop - close()->socket()->close()->socket()-> ~

      //socket(s,Sn_MR_UDP,0x3000,0);

      //sendto(s,destip,1,destip,0x3000); // send the dummy data to an unknown destination(0.0.0.1).

      setSn_MR(sn,Sn_MR_UDP);

      setSn_PORTR(sn, 0x3000);

      setSn_CR(sn,Sn_CR_OPEN);

      while(getSn_CR(sn) != 0);

      while(getSn_SR(sn) != SOCK_UDP);

      sendto(sn,destip,1,destip,0x3000); // send the dummy data to an unknown destination(0.0.0.1).
```

This code can exit the abnormal TCP state by using udp arp timeout.

Thank you. Please, explain, whether the current connection will be preserved? This erratum occures when the TCP socket is disconnected by owner or peer normally when the sending data is still remained.

So, The socket need to be disconnected but the socket is not disconnected normally, stays still established state.

The above code force to disconnect the socket normally. so the TCP socket cannot be preserved.","Q) I have a new task, where data flow increase, and after some seconds of interconnection with PC client, w5300 drop interrupt pin, and I can't acknowledge it in ISR for interrupt complete. W5300 can be dropped some interrupt when you are processing an interrupt and another interrupt is occurred at that time. Specially RX interrupt can be often lost. So If you received the RX interrupt, you should be checked the overwrapped RX interrupt before your ISR returned. It is possible that you can check the remained RX data to Sn_RX_RSR.
A) The example maybe also lost RX interrupt. So, we recommend the periodic checking Sn_RX_RSR.

Q) Your code maybe worked well. But, I wonder what's the role of ssync() and why read Sn_MR.
A) I recommend modifying your code as follows:
``` code c
wrWIZnetReg(Sn_CR(n)) = CMD_SEND;
while(rdWIZnetReg(Sn_CR(n)) != 0); // wait until command is cleared.
DWORD guard=1000000;
while(!WIZnetSendOk[n]) {asm{""nop""); }
// Add to barrier code for protection: disable_interrupt();
WIZnetSendOk[n] = false;
// Add to barrier code for protection: enable_interrupt();
```

Q) I add your modification, but still have 0x11 at SSR. I add a guard counter and sending CMD_DISCON for a case where the counter decrements to 0. This so rough, but reconnect reset 0x11 state. And...not always. Have you an idea how to avoid this state?
A) As explained in erratum #1, If a socket is still at 0x11, Socket operation becomes abnormal. This problem happens often when the socket is disconnected by a command before send is not processed completely. In your case, If guard == 0, you are forced to disconnect a socket. In the case, you can follow the erratum #1 guide:
```code c
if(guard == 0) 
{
        socket(sn, Sn_MR_UDP, 3000, 0x00);
        sendto(sn, ""1"", 1, (char*)0x0000001,3000);
        while(Ssn_SSR != SOCK_CLOSED);
}
```
The correct guide should be referred to Erratum#1.

Q) Please, explain whether the current connection will be preserved?
A) This erratum occurs when the TCP socket is disconnected by the owner or peer normally when the sending data is still remaining. So, the socket needs to be disconnected, but the socket is not disconnected normally, stays still in the established state. The above code forces to disconnect the socket normally, so the TCP socket cannot be preserved."
3551,658,"Hello ,
I am using WizFi210 firmware version 1.1.1.0(W).
I have a questions. 
In the  AT+WSEC=64 command I am trying to set the WPA2-AES + TKIP security, but WizFi210 returns error.
Will I not be able to WizFi210 to set the WPA2-AES + TKIP security?

Here is my log.

AT+NDHCP=1
[OK]
AT+WM=0
[OK]
AT+WAUTH=0
[OK]
AT+WSEC=64
[ERROR: INVALID INPUT]

Please help me.
Thanks for listen. Hello Nako

WizFi210 doesn't support 64 in <AT+WSEC>.

BTW, in most cases, you don't need to use <AT+WSEC>.

If you want to use WPA2, just issue it as follow.

AT+WM=0
AT+NDHCP=1
AT+WWPA=12345678
.........................
AT+WA=TestSSID (or ATA)

Steve","Q) Will I not be able to WizFi210 to set the WPA2-AES + TKIP security? 
A) WizFi210 doesn't support 64 in <AT+WSEC>. 
A) BTW, in most cases, you don't need to use <AT+WSEC>. 
A) If you want to use WPA2, just issue it as follow. 
A) AT+WM=0 
A) AT+NDHCP=1 
A) AT+WWPA=12345678 
A) AT+WA=TestSSID (or ATA)"
3552,6580,"Do you have Wizfi360 Data Rate?

In the case of Wizfi310, the data rate is 150MB/s. Thank you for your reply. The same: Grinning:","Q) Do you have Wizfi360 Data Rate? 
A) In the case of Wizfi310, the data rate is 150MB/s."
3553,6581,"hello

-The current documents are https://github.com/wizfi/internal/tree/master/document
We update the Word on that repuoli and convert it to a PDF to WIKI, upload it, update the link to Wiznet.io and Wizfi360 sites.
I think it would be nice to know that there is no place to fall out.

-In addition, Heo -soo is said to be better to remove IO and change it to Mini.
When the document work is completed, I will modify and update the contents.

-Is there anything strange in English in Section 1?
I would appreciate it if you check if the expression is strange.

-As you discussed before, Wizfi360-EVB seems to have to be modified to Wizfi360-EVB-SHIELD.



-It's better to add OK as shown below in 4 of Section 2.
WiFi Connected
WiFi GOT IP
.
OK


-In 8
AT+cipsendBuf = 10 after 10
        OK
        >
Receive and enter the data and it feels omitted.
I hope that the data input will be added after Receiving OK and>. The difference between Quick Start Quide and Command Example seems to be ambiguous.
It would be better to clarify the distinction or get rid of one side. OK's response seems to be missing when capturing
There will be in the document.

"">"" I will add some parts related to special symbols.

I'll give you feedback again after reviewing the Section1! First of all, there is a part to reinforce while training in the US branch.

When I am, the whole document will be possible, but
Once I go back to the head office
It seems to be possible to actually practice and running an example scenario.

Therefore, I think it would be good to divide the part with the head office.

If you work with the US branch and share it with the GIT repo, why don't you review it after reviewing and applying it at the head office.

We will also review the data you have sent and share it again if you have a format or reinforcement. There was no document received by e -mail, but please confirm it once more ~","Q) Is there anything strange in English in Section 1?
Q) It's better to add OK as shown below in 4 of Section 2.
Q) AT+cipsendBuf = 10 after 10

A) I will evaluate the English in Section 1 and make necessary corrections.
A) OK, I will add 'OK' in Section 2, point 4 as requested.
A) I will review and add the necessary parts after 'AT+cipsendBuf = 10' as instructed."
3554,6583,"else if(g_uart2_buffer[0] == '3')
				{
					int32_t recv_size = 0;
					uint16_t udp_port = 4023;

					printf(""socket open : %d\r\n"", socket(SOCK_UDPS, Sn_MR_UDP, 3000, 0));

					for(;;)
					{
						recv_size = recvfrom(SOCK_UDPS, gdata, DATA_BUF_SIZE, des_ip, &udp_port);

						if(recv_size)
						{
							sendto(SOCK_UDPS, gdata, recv_size, des_ip, udp_port); //Local Port 4023
						}
					}
				}

?Â´Ã«Â ÂÃªÂ²??ÂÃ¬Â Â?Â´Ã«ÂÂ Socketerror #11001??Ã«Â°ÂÃ¬ÂÂ ?ÂÃ«ÂÂ¤??

-. socket???Â´Ã«Â©Â´ 1??Ã«Â¦Â¬Ã­ÂÂ´?ÂÃ«Â©Â°,, Hercules?ÂÃ¬ÂÂ Send dataÃ«Â¥??ÂÃ«ÂÂ¬??Socket error #11001Ã«Â§?Ã«Â°ÂÃ¬ÂÂ ?ÂÃ«ÂÂ¤??

-. recv??Ã¬Â£Â¼Ã¬ÂÂ Ã¬Â²ÂÃ«Â¦Â¬ ?? sendtoÃ«Â§??Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ Ã«Â¬Â¸Ã¬ÂÂ??Ã«Â³Â´Ã«ÂÂ´??ÃªÂ²ÂÃªÂ¹ÂÃ¬Â§??ÂÃ«ÂÂ¤??. Ã«Â°ÂÃ«ÂÂÃªÂ²ÂÃ«Â§Â ?ÂÃ«ÂÂ?ÂÃªÂ±Â¸Ã«Â¡?Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ¤.

-. Herclues??Module IPÃªÂ°? W5500??IPÃªÂ°? ?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ´ Ã«Â§ÂÃ«ÂÂ???? ?Â¬ÃªÂ¸Â°??0???Â£ÃªÂ³Â  ?ÂÃ¬ÂÂ?Â´Ã«ÂÂ hello.IP and port were not set properly ..

wiz_netinfo gwiznetinfo => I thought I would automatically refer to it in the structure here
Loopback_UDPS () => This function is inserted in this function, so it works well.

   uint8_t destip [4] = {192, 168, 1, 130};// Add IP
   uint16_t destport = port_udps;// Add port

Thank you for your answer. [quote = ""kknd_dhu, post: 4, topic: 6583""]
wiz_netinfo gwiznetinfo
[/Quote]
After setting the value in the structure
wizchip_setnetinfo (& gwiznetinfo);
If you use the function, it will be set.

[quote = ""kknd_dhu, post: 4, topic: 6583""]
uint8_t destip [4] = {192, 168, 1, 130};// Add IP
uint16_t destport = port_udps;// Add port
[/Quote]
As I mentioned earlier, the W5500 checks the DESTINATION IP and PORT in the recvFrom function and returns it to that variable.Therefore, there is no need to set the Loopback operation.
However, if you send data from the W5500, not the Loopback, you must set it as above.

also,
W5500 PORT (LoopBack_UDPS () Parameters) -HERCULES PORT
W5500 Dest Port -Hercules Local Port
no see.
I confirmed that you set it to the W5500 Port and Hercules Port Port_UDPS
You set it to port_udps in the Destination Port.

However, if you set the Hercules Local Port to 3000 and set it all at 3000, it is no problem to communicate.","Q) What does the error message ""Socket error #11001"" mean and how can I resolve it?
A) The error message ""Socket error #11001"" indicates that the destination IP and port were not set properly. To resolve this issue, you need to set the DESTINATION IP and PORT in the recvfrom function and ensure that the Loopback operation is not necessary. If you send data from the W5500, not the Loopback, you must set it accordingly.

Q) How should I set the value in the structure ""wiz_netinfo gwiznetinfo"" and what function should I use to apply it?
A) After setting the values in the structure ""wiz_netinfo gwiznetinfo"", you can use the function ""wizchip_setnetinfo(&gwiznetinfo)"" to apply it.

Q) What is the relationship between the W5500 PORT (LoopBack_UDPS() Parameters) and the Hercules PORT, W5500 Dest Port, and Hercules Local Port?
A) The W5500 PORT, Hercules PORT, W5500 Dest Port, and Hercules Local Port need to be properly set to ensure effective communication. Setting the Hercules Local Port and all other relevant ports to 3000 will enable seamless communication."
3555,6591,"Hi,

I'm interested in using the W7500x chips, but would like to make a module which can be connected inline (daisy-chained), which could be implemented by replacing the W7500 external PHY with a compatible three port Ethernet switch.

I'm not sure if there's a simple 3-port switch IC with three PHY connections allowing the W7500P to be connected via the four Ethernet signals, as this might be simpler to route on a PCB, and allow a smaller switch IC.

Has this been done before on these products?

Regards,

PJE Hi,

We have a product which W7500 and a Switch IC are embedded on.
It's not released to the public but provided to some specific customers.
If you want, we can provide you with it.

Best regards,

James. Hi James,

That sounds VERY interesting, my main issue would be my potential volumes are quite low due to it being a device for an industrial machine we build (<1000 units), although the end product would have a potentially much wider application in general industry. If this quantity is not an issue I'd be very interested in more information.

What would be ideal for my volumes would be a version of the WIZwiki-7500ECO where the CPU/PHY are replaced with this new chip and the two Ethernet port connections come out as pins to allow me to fit D-Coded M12 sockets and magnetics.

In my application I would be building a similar base board, but would probably not include the on-board USB programming interface, and simply connect to a SWD programming header as needed, while implementing a 24V to 3.3V power supply for the base and extension boards.

-- PJE Hi James,

We are in the process of developing a small Ethernet Node that requires to have the W7500 along with a suitable (small) 3-port Ethernet Switch. We were considering the KSZ8863RLL for the 3-port switch. Please let me know if you have any available reference data/schematic for this. Alternately, please suggest a suitable 3-Port Ethernet switch that I can use with the W7500 in our design.

Our requirement is to daisy chain multiple ethernet nodes (each with a W7500 + 3-port switch) to save on cabling costs. Each Node will have 2x RJ45 Jacks for Ethernet In/Out.

Best Regards,

Raj Any information on this?  I am having a very hard time understanding how to interface a W5500 with a switch IC.  I need to have my host processor (via the W5500) connected to a switch IC (still trying to find a suitable one) so that I have for example 4 switched ports on my pcb and allow each port (connected to a laptop) to talk to my application which uses the w5500. Hi Javakys,

I just found this thread and it is very interesting. A chip like the one you described would be quite helpful for a product I'm currently developing. Until now, I had planned on using the three separate components (switch, MCU and WIZNet processor). Could you provide any additional information about the chip you mentioned?

I'd be happy to provide my business contact information via DM, if required.

Regards,

-Tuna Hi Tuna,

What I mentioned is not about a chip.
It's a module which consists of W7500 and a switch IC.

James. Would it be possible to get some of these modules?  Also, what is the lead time for production? Yes, possible.
Its lead time is 4 weeks.

Thank you.

James.","Q) I'm interested in using the W7500x chips, but would like to make a module which can be connected inline (daisy-chained), which could be implemented by replacing the W7500 external PHY with a compatible three port Ethernet switch. Has this been done before on these products?

Q) We are in the process of developing a small Ethernet Node that requires to have the W7500 along with a suitable (small) 3-port Ethernet Switch. We were considering the KSZ8863RLL for the 3-port switch. Please let me know if you have any available reference data/schematic for this. Alternately, please suggest a suitable 3-Port Ethernet switch that I can use with the W7500 in our design. Any information on this?

Q) I just found this thread and it is very interesting. A chip like the one you described would be quite helpful for a product I'm currently developing. Could you provide any additional information about the chip you mentioned?

A) What I mentioned is not about a chip. It's a module which consists of W7500 and a switch IC.

Q) Would it be possible to get some of these modules? Also, what is the lead time for production?

A) Yes, possible. Its lead time is 4 weeks."
3556,6593,"WIZFI250 is in use
When data is transmitted, 96byte or more appears in two rows.
1. Perhaps it has been limited in WiFi, but is it right?
2. If there is a limit, can you solve the limit?(Must be sent in one line)
3. Is there a way to solve the limit? hello

There is no limit to mentioned.
Please tell us the firmware version of the module and the entire AT command you used.","Q) Perhaps it has been limited in WiFi, but is it right?
Q) If there is a limit, can you solve the limit?(Must be sent in one line)
Q) Is there a way to solve the limit?
A) There is no limit to mentioned.
A) Please tell us the firmware version of the module and the entire AT command you used."
3557,6595,"The previously developed board used the STM32F405 MCU and the W5500 chip with SPI.
By the way, we changed the W5500 to the W3150 to support two Ethernet ports.

The following is a question.
1. Is the SPI library for the existing W5500 chip can be used for the W3150 chip?

2. I downloaded the W3150A+ IOLIBRARY from the homepage,
    The code seems to have been written for AVR.
   Is Iolibrary for STM32F4?

thank you @page3650 has been modified.Please confirm.","Q) Is the SPI library for the existing W5500 chip can be used for the W3150 chip?
Q) Is Iolibrary for STM32F4?
A) Unfortunately, the SPI library for the existing W5500 chip cannot be used for the W3150 chip directly due to the differences in communication protocols and chip functionalities. As for the Iolibrary for STM32F4, you can adapt the code from AVR to STM32F4. The W3150A+ IOLIBRARY should be compatible with STM32F4 with some modifications. Thank you for the update, and we will confirm the changes made by @page3650."
3558,6599,"Quick Start Guide 4 pages, Wizfi360-EVB-SHIELD and Wizfi360io-C
** I would like to reconstruct Wizfi360-EVB-SHIELD ** and ** Wizfi360-EVB-Mini **.

In the future, Hardware will be distributed more EVB-Mini than the IO version that has been customized, and it is better to introduce it as an EVB product to customers who see Quick Start Guide. hello

I know that the US branch is currently modifying the Quick Start Guide document.
When the crystal is complete, Heo -soo told me to change to MINI.
Quick Start Guide Document After completing the document work, please change the data and we will update it.
https://forum.wiznet.io/t/topic/6581/2?u=becy First of all, we will deliver the revised file corresponding to Quick Start Guide PG4.Please check.
thank you
Kim Jung -hoon Dream","Q) I would like to reconstruct Wizfi360-EVB-SHIELD and Wizfi360-EVB-Mini. hello
A) There is a plan to distribute more EVB-Mini hardware in the future, and it is recommended to introduce it as an EVB product in the Quick Start Guide.

Q) When the crystal is complete, Heo-soo told me to change to MINI. Quick Start Guide Document After completing the document work, please change the data and we will update it. https://forum.wiznet.io/t/topic/6581/2?u=becy First of all, we will deliver the revised file corresponding to Quick Start Guide PG4. Please check. thank you
A) It seems that there is ongoing modification of the Quick Start Guide document by the US branch. After the document work is completed, the data will be changed and updated accordingly. A revised file corresponding to Quick Start Guide PG4 will be delivered for review."
3559,660,"There are inquiries as shown below.
1. Is there a way to check the reception sensitivity in real time during the Wi -Fi module connected to the server (data mode state)?
Currently, it uses a +++ command to change from data mode to Command mode, so it takes a long time to check the reception sensitivity by changing it to the Command mode.
2. Is there a way to know the cause of failure, such as SSID name inconsistency or password inconsistency when access failed to an AP router? hello

1. When the WIZFI210 operates as a data mode, the data received from the Destination Device will still be output to the serial.
   For this reason, it is difficult to check the reception sensitivity in Data Mode, not Command mode.

2. Among the functions of the current wizfi210, the Wizfi210 actively knows the cause of failure such as SSID name inconsistency or password inconsistency.
    There is no way.Therefore, in order to prevent the above failure, the customer MCU unit through the AT+WS (SCAN) command
    One way to check in advance what is SSID or what Security Type is around, and then perform at command.
    no see.

thank you We will reply below.

1. In the data mode, all data has a payload data personality, so it is impossible to do other actions in the data mode.
If you say that real -time reception sensitivity is important, why don't you operate on the Command Mode?
(DATA transmitting/reception with Escape Sequence on the Command Mode)

2. It is difficult to know the cause of access failure.
However, if you use the AT+WS = <SSID to be connected> before accessing, if the SSID you want to be connected is on the AIR (whether the SSID is properly input)?Is the authentication method correct?It seems to be able to distinguish the back. 1. How do you do a data transmission/reception with Escape Sequence on the Command Mode?
I don't think it's coming out in the manual.","Q) Is there a way to check the reception sensitivity in real time during the Wi-Fi module connected to the server (data mode state)?
Q) Is there a way to know the cause of failure, such as SSID name inconsistency or password inconsistency when access failed to an AP router?
A) When the WIZFI210 operates as a data mode, the data received from the Destination Device will still be output to the serial.
   For this reason, it is difficult to check the reception sensitivity in Data Mode, not Command mode.
A) Among the functions of the current wizfi210, the Wizfi210 actively knows the cause of failure such as SSID name inconsistency or password inconsistency.
    There is no way. Therefore, in order to prevent the above failure, the customer MCU unit through the AT+WS (SCAN) command.
    One way to check in advance what is SSID or what Security Type is around, and then perform at command.

Q) How do you do a data transmission/reception with Escape Sequence on the Command Mode? I don't think it's coming out in the manual.
A) In the data mode, all data has a payload data personality, so it is impossible to do other actions in the data mode. If you say that real-time reception sensitivity is important, why don't you operate on the Command Mode? (DATA transmitting/reception with Escape Sequence on the Command Mode)
A) It is difficult to know the cause of access failure. However, if you use the AT+WS = <SSID to be connected> before accessing, if the SSID you want to be connected is on the AIR (whether the SSID is properly input)? Is the authentication method correct? It seems to be able to distinguish the back."
3560,6600,"First, you need Windows version information of the computer installed first.Please tell us.

And in the process administrator, you have to work properly in the ""sec_service.exe"" background.
Why don't you stop the vaccine program and test it?If it is, the vaccine program must be treated as an exception. The Windows version is Win7 Professional.
The vaccine is not installed.
If you have previously installed other VSP programs before using WizvSP, you have been uninstall.If so, how can I check? The WIZVSP driver licensed and redeveloped Eltima, which is difficult to support the conflict according to individual PC situations.

What if you try this?
Deleting the current WIZVSP,
If we and the driver are the most similar Eltima Trial Version (14 days available), check if it operates for more than one day.
https://www.eltima.com/serial-to-thonet-download.html

After that, delete Eltima and use WizvSP again.","Q) First, you need Windows version information of the computer installed first.Please tell us.
A) The Windows version is Win7 Professional.

Q) Why don't you stop the vaccine program and test it?If it is, the vaccine program must be treated as an exception.
If you have previously installed other VSP programs before using WizvSP, you have been uninstall.If so, how can I check?
What if you try this?
A) The vaccine is not installed. If you have previously installed other VSP programs before using WizvSP, you have been uninstall. If so, you can check by deleting the current WIZVSP and trying the most similar Eltima Trial Version (14 days available) to see if it operates for more than one day.

Q) After that, delete Eltima and use WizvSP again.
A) It's possible to follow the steps mentioned. However, it's crucial to ensure that the conflict according to individual PC situations is resolved. Also, always make sure to download software from official and trusted sources to avoid any issues."
3561,6601,"hello?

I want to dock the W550IO module on the board,

Where can I check the module size and headerfin location information?

thank you hello.

The information you have inquired can be found on the Wizwiki site.
You can access the link below.

- [Wizwiki -Wiz550io] (http://wizwiki.net/wiki/doku.php/products:

thank you ","Q) Where can I check the module size and headerfin location information?
A) The information you have inquired can be found on the Wizwiki site. You can access the link below. - [Wizwiki -Wiz550io] (http://wizwiki.net/wiki/doku.php/products)"
3562,6604,"Update: I have now used Wireshark to view the packets being sent by the Hercules Setup Utility, and it seems that Hercules only sends the requests over wi-fi, not Ethernet. When I click ""Connect"" in Hercules, Wireshark shows a connection packet coming through on the wi-fi monitor, but not on the Ethernet monitor... I can't find any info on how to fix this.

Update2: I was able to send raw Ethernet packets through my Ethernet adapter by using a Linux VM and inspect them with Wireshark. I will try to see if that can trigger the interrupt in my Arduino version.

Update3: Sending raw packets to the correct MAC address (11:22:33:aa:bb:cc in this case) and the correct IP address (192.168.1.99 in this case) still did not trigger the interrupt on the W6100 for the Arduino version. 
7 of Steps with io6Library:
What you saw through serial is the W6100's information.
IP address mean the W6100's IP address(192.168.0.13) and it is no the IP address of PC.
Therefore the 9 of Steps with io6Library is set incorrectly.
If you use dynamic address(DHCP), you have to use DHCP the W6100 and PC.


You have to download the arduino ethernet library for W6100 and Of the branch, the W6100  branch value should be apply and download.
This link is arduino ethernet library for W6100  : [W6100 Arduino Ethernet library](https://github.com/WIZnet-ArduinoEthernet/Ethernet.git) I know that step 7 is showing the W6100 IP address. In [this page](https://wizwiki.net/wiki/doku.php/osh:cookie:ip_conf_b), it says to set the PC address and the W6100 address to the same thing. For DHCP, the option for ""obtain an IP address automatically"" should be set in the network adapter options, but then how do I know what the IP address is?

I am looking into the Arduino library now. In [this page](https://wizwiki.net/wiki/doku.php/osh:cookie:ip_conf_b) ,

> Then, set your IP address and subnet mask as same as WIZ550io's IP address and subnet mask.

This comment mean that same network area.
And If WIZ550io and PC  set the same  IP/subnet mask, they can't communicate.

> obtain an IP address automatically??should be set in the network adapter options, but then how do I know what the IP address is?

You need IP address for communicating. If you want to know that How do I set my computer to DHCP? If yes, you refer this link : [Change TCP/IP settings](https://support.microsoft.com/en-us/help/15089/windows-change-tcp-ip-settings) I am now successfully sending and receiving data over Ethernet with the W6100. Thank you so much for your help! I'm glad it all worked out for you, then
Please feel free to contact me if you have further question.","Q) When I click ""Connect"" in Hercules, Wireshark shows a connection packet coming through on the wi-fi monitor, but not on the Ethernet monitor... I can't find any info on how to fix this.
A) It seems that Hercules only sends the requests over wi-fi, not Ethernet. 

Q) I was able to send raw Ethernet packets through my Ethernet adapter by using a Linux VM and inspect them with Wireshark. I will try to see if that can trigger the interrupt in my Arduino version.
A) I have used Wireshark to view the packets being sent by the Hercules Setup Utility. 

Q) Sending raw packets to the correct MAC address (11:22:33:aa:bb:cc in this case) and the correct IP address (192.168.1.99 in this case) still did not trigger the interrupt on the W6100 for the Arduino version.
A) What you saw through serial is the W6100's information.

 Q) In [this page](https://wizwiki.net/wiki/doku.php/osh:cookie:ip_conf_b), it says to set the PC address and the W6100 address to the same thing. For DHCP, the option for ""obtain an IP address automatically"" should be set in the network adapter options, but then how do I know what the IP address is?
A) Then, set your IP address and subnet mask as same as WIZ550io's IP address and subnet mask. 

Q) If WIZ550io and PC set the same IP/subnet mask, they can't communicate.
A) This comment means that they are in the same network area.

Q) obtain an IP address automatically??should be set in the network adapter options, but then how do I know what the IP address is?
A) You need an IP address for communicating. If you want to know how to set your computer to DHCP, you can refer to this link: [Change TCP/IP settings](https://support.microsoft.com/en-us/help/15089/windows-change-tcp-ip-settings) 

A) I am now successfully sending and receiving data over Ethernet with the W6100. Thank you so much for your help!"
3563,6605,"For Wi-Fi Auto Connect, you can solve the automatic settings by setting it to at+cwautoconn = 0,
Is TCP (at+savetranslink) the same as the above command?

As a result of the YAT, if you enter AT+CWAUTOCON = 0, the TCP does not seem to be automatically connected as well as WiFi.Also, it doesn't seem to be specified in ""AT+CWAUTOCONN"" in At Instruction set.

So far, I thought it was only at+Restore = 1 to solve TCP Auto Connect.

WiFi Auto Conn if you want to save and remove the TCP Auto Connect, do you have a separate at command?I wonder. AT+CWAUTOCONN automatically connected to AP
At+Savetranslink is a Command that automatically connects to TCP or UDP communication.


[Quote = ""Andrew1, POST: 1, Topic: 6605""]
When you want to remove only tcp auto connect
[/Quote]

AP connections through AT+CWAUTOCONN = 0, and the TCP connection disables automatic connection via AT+SAVETRANSLINK = 0.

In order to use Savetranslink, you must be connected to the AP, so you must communicate.If you set CWAUTOCONN to 0, the automatic connection to the AP is unable to communicate with the network, so that the TCP or UDP is automatically connected, which is different from the release of the AT+Savetranslink. Thank you so much for your answer.

Let's practice based on the above.
have a good day. @becky, why don't you save it as a QA?After answering, let's save it as QA and post it to the homepage QA. Yes ~ Okay ~~","Q) Is TCP (at+savetranslink) the same as the above command?
A) AT+Savetranslink is a Command that automatically connects to TCP or UDP communication.

Q) WiFi Auto Conn if you want to save and remove the TCP Auto Connect, do you have a separate at command?
A) AP connections through AT+CWAUTOCONN = 0, and the TCP connection disables automatic connection via AT+SAVETRANSLINK = 0.

Q) When you want to remove only tcp auto connect
A) In order to use Savetranslink, you must be connected to the AP, so you must communicate. If you set CWAUTOCONN to 0, the automatic connection to the AP is unable to communicate with the network, so that the TCP or UDP is automatically connected, which is different from the release of the AT+Savetranslink."
3564,6606,"Did you check the link from Abion?
The html I sent is HTML with that part.

Please confirm. Thank you for your answer.
Where can you find the HTML you sent? I sent it to the president, but if you need it, we will send it by e -mail. hello.
Thank you for your email.
My email address is junlee@wiznet.io.
Thank you again. Yes ~ I sent an e -mail. ^^","Q) Did you check the link from Abion? The html I sent is HTML with that part. 
Q) Where can you find the HTML you sent? 
A) I sent it to the president, but if you need it, we will send it by e-mail. 
A) Yes, I sent an e-mail. ^^"
3565,661,"With the W5100, the SPI will be ... W5300 will be used in one MCU with Address/Data Bus.
Of course, IP is a system that requires two ...
In this case, I know that the source.c, .h file is not used publicly.
There are so many same names such as SEND (..). The socket API can be used the same.
Of course, there is no Socket API currently provided,

There is a method of receiving an ID with a parameter in a function like socket (), or there is a way to implement and use a separate dedicated function.The latter, as you said, is inconvenient to manage and the number of files can increase, so the amount of code can increase.

Sorry, but the former is not available at this time. If both use the W5300, can I use almost all sources? You cannot use the current source as it is.
Once the chip is two, the Memory Map for the chip is defined separately,
When each API call, it is necessary to modify it to distinguish it.

In the case of the W5300, it supports BUS Interface such as Direct or Indirect Mode.
When the first W500 is assigned to the System Memory 0x0000, the second is assigned to 0x1000,
You need to define the Parameter to get chip ID for the W5300 Driver and Socket API and modify it to use the Register MAP that suits your chip ID.

[Code]
// Existing Driver Code
UINT16 IIINCHIP_READ (UINT32 Addr)
{
  #IF (__def_iinchip_address_mode__ == __def_iinchip_direct_mode__)
       Return (*((Vuint16*) addR));
  #else
       Vuint16 data;
       IINCHIP_CRITICAL_SECTION_ENTER ();
       *((vuint16*) IDM_AR) = (uint16) addR;
       Data = *((Vuint16 *) IDM_DR);
       IINCHIP_CRITICAL_SECTION_EXIT ();
       return data;
  #endif
}

uint16 Getir (void)
{
   Return iinchip_read (IR);
}
//
//
////////////////////////////////////////////////////////////////
// Code Example modified to have a chip ID: ID 0 -1st, ID 1 -2nd
//
uint16 IIINCHIP_READ (uint8 ID, uint32 addR)
{
  #IF (__def_iinchip_address_mode__ == __def_iinchip_direct_mode__)
       Return (*((Vuint16*)) ((ID*0x1000)+Addr));
  #else
       Vuint16 data;
       IINCHIP_CRITICAL_SECTION_ENTER ();
       *((Vuint16*) ((ID*0x1000) IDM_AR) = (uint16) addR;
       Data =*((Vuint16*) ((ID*0x1000)+IDM_DR);
       IINCHIP_CRITICAL_SECTION_EXIT ();
       return data;
  #endif
}

uint16 getir (uint8 ID)
{
   Return iinchip_read (ID, IR);
}
[/Code]

The socket API can be modified in the same way.This is not necessarily good.There is also a way to define the same function as a different name, so you can implement it in a comfortable way.

The precautions are to understand the Register Memory Map Definition OFFSET and set it up to ensure that it is not duplicated.","Q) With the W5100, the SPI will be ... W5300 will be used in one MCU with Address/Data Bus. Of course, IP is a system that requires two ... In this case, I know that the source.c, .h file is not used publicly. There are so many same names such as SEND (..). The socket API can be used the same. Of course, there is no Socket API currently provided, There is a method of receiving an ID with a parameter in a function like socket (), or there is a way to implement and use a separate dedicated function.The latter, as you said, is inconvenient to manage and the number of files can increase, so the amount of code can increase. Sorry, but the former is not available at this time. If both use the W5300, can I use almost all sources? You cannot use the current source as it is. Once the chip is two, the Memory Map for the chip is defined separately, When each API call, it is necessary to modify it to distinguish it. In the case of the W5300, it supports BUS Interface such as Direct or Indirect Mode. When the first W500 is assigned to the System Memory 0x0000, the second is assigned to 0x1000, You need to define the Parameter to get chip ID for the W5300 Driver and Socket API and modify it to use the Register MAP that suits your chip ID. The socket API can be modified in the same way.This is not necessarily good.There is also a way to define the same function as a different name, so you can implement it in a comfortable way. The precautions are to understand the Register Memory Map Definition OFFSET and set it up to ensure that it is not duplicated. 
A) Unfortunately, the former method of receiving an ID with a parameter in a function like socket() is not available at this time. If both use the W5300, you cannot use the current source as it is. Once the chip is two, the Memory Map for the chip is defined separately. It is necessary to modify each API call to distinguish it. In the case of the W5300, it supports BUS Interface such as Direct or Indirect Mode. When the first W500 is assigned to the System Memory 0x0000, the second is assigned to 0x1000. You need to define the Parameter to get chip ID for the W5300 Driver and Socket API and modify it to use the Register MAP that suits your chip ID. The socket API can be modified in the same way. However, it's not necessarily ideal. There is also a way to define the same function as a different name, so you can implement it in a more comfortable way. It's important to understand the Register Memory Map Definition OFFSET and set it up to ensure that it is not duplicated."
3566,6610,"Hi!

I'm new in this forum. Thank you for your existence.

I have tried to ping a W5100 that works as a server and I have found that there is an interval of several seconds between the reset (only hard reset) and when the W5100 starts responding to the Ping.

The results are very variable from execution to execution, and range from 5.7 to 36 sec.

Chat server address:192.168.1.177
5739 ms.
Chat server address:192.168.1.177
12815 ms.
Chat server address:192.168.1.177
36094 ms.


I found this problem with both:

MEGA board + keystudio W5500 shield

and

UNO board + W5100 shield (don't know who made it)

with similar results. As an average, I must wait 17 sec. from Arduino reset to the first ping.

The client is latest Hercules on Win7 x64.


Is it possible to be a hardware issue? 

Any ideas will be welcome. [quote=""MyrmidonGitHub, post:1, topic:6610""]
between the reset (only hard reset)
[/quote]

When chip is hard reset it drops the upstream link, and remote device (e.g. router/switch) sees it and starts new training and negotiation process when link is back. This training and negotiation may take long time, and it may be the cause of the delays you see. Dig into switch's settings (look into manual) to disable training making switch's port starting immediately as soon as link is being sensed.","Q) Is it possible to be a hardware issue?
A) When chip is hard reset it drops the upstream link, and remote device (e.g. router/switch) sees it and starts new training and negotiation process when link is back. This training and negotiation may take a long time, and it may be the cause of the delays you see. Dig into the switch's settings (look into the manual) to disable training making the switch's port start immediately as soon as the link is being sensed."
3567,6619,"I think you will have to find ethernet compliance test vendor. Because it would be very expensive the equipment for ethernet compliance testing.
If you send us your hardware,we can test it. Dear @benjamin3er 

Do you want 'Full Duplex, Disable Auto-Negotiation'  setting that you want?

Our test equipment allows us to test without any special setup.

Do you need to set any special settings for your equipment?

Scott This was just an example, I want to know how I can enter e.g. Test Mode 3, the transmit jitter test, or  Test Mode 4 the transmitter disortion test...

I know how to select the different operation mode using the bits 5~3 in the PHYCFGR. The unknown how to tell the PHY to enter ""test mode"" / generate the test patterns.

As far as I know there are a couple of standardised tests for ethernet compliance.

Maybe I got the whole thing wrong. I was assuming that I bring the w5500-phy to ""output"" a test pattern (e.g. by writting some registers) and measure it with the oscilloscope.

Is there another way, e.g. to directly stimulate the PHY by sending some signales directly on the wires ?

Best regards. Dear @benjamin3er

There is nothing to set for the W5500.

The test waveform is automatically output when connected to the test equipment.
 
Thank you.","Q) Do you want 'Full Duplex, Disable Auto-Negotiation'  setting that you want? Do you need to set any special settings for your equipment? Do you want to know how you can enter e.g. Test Mode 3, the transmit jitter test, or  Test Mode 4 the transmitter distortion test? Is there another way, e.g. to directly stimulate the PHY by sending some signals directly on the wires?
A) There is nothing to set for the W5500. The test waveform is automatically output when connected to the test equipment."
3568,662,"I am currently using the Wizfi630 and W5100.
However, the operating mode of the Wizfi630 is used as a multibridge mode in the AP-Client mode and connected to the Wizfi630 from the W5100 to the LAN to use WiFi.
However, I have to use the LAN to use WAN during use.
Is there a mode that automatically converts LAN or WLAN to WAN in the operation mode?I would like to ask if the AP mode is possible. There is no function to automatically switch the wired/wireless interface.
The MCU connected to the Wizfi630 should be converted manually by judging the situation.

If you look at the link below, there are similar content.
Please refer to it.

[URL] https://forum.wiznet.io/t/wizfi630-wifi-lan-wan/709/1]","Q) Is there a mode that automatically converts LAN or WLAN to WAN in the operation mode?I would like to ask if the AP mode is possible.
A) There is no function to automatically switch the wired/wireless interface. The MCU connected to the Wizfi630 should be converted manually by judging the situation."
3569,6620,"Using the W5100, the firmware is executed after the hardware configuration.

Ping response is good without any abnormalities.-Setting completion

But it is not connected from the client.

As a result of reading memory roughly

The memory bungee value corresponding to getsn_sr is not updated.

What is the problem? Are you using the W5100 as a TCP server?
First, open the socket to check that the SR is Listen.
If you do not go to ESTABLISH since then,
Check the IP and port. First of all, the board died during the test until yesterday evening.

We will test again as soon as we make the board.

It is used as a server and wants to connect from the client (PC).

The SR register does not always change at 0x00 (Closed).

Under the same conditions, it turned to 0x14 (Listen) when testing on the existing board.

(Existing board is TMS320F28335)

What is unusual is that if you use the value to this bunch, the value is used.

Like memory

The MCU used as a reference is TMS320F28379D

Use EMIF 2 cs3-0x300000.

Is the MCU setting wrong?

The W5100 has been in use since 2009. The register of SN_SR is read only, so you can't use the value.
What do you use the interface that connects the W5100 and MCU?

Are you using the same interface as the existing board? first of all
In PC
If the firewall or security tool is turned on,
Please turn off even in the case of VMware.

It can also be helpful to check the packet with Wireshark. You said you made a new board, but is there a different part from the existing board?

As I mentioned earlier, the value of SN_SR is a register that can only be only read.

Pinging to the W5100 is not a problem on the interface side, so I think the network information was stored in the register.Please make sure that the PHY LINK LED is turned on and ping is sent to the W5100 address.

Also, if you use the W5100 as the TCP Server, you will be waiting for the connection of the TCP Client to the set Port after the Socket Open.At this time, SN_SR is changed to Listen.
If SN_SR is 0x00, it's not a socket open or a TCP client ...

If the circuit diagram has been greatly changed, please send an email and you can check the hardware person. It was bad.?Â Ã£ÂÂ 

Thank you for your attention. It was solved well
Fortunately, the. ","Q) What is the problem? Are you using the W5100 as a TCP server? 
Q) Is the MCU setting wrong? 
Q) What do you use the interface that connects the W5100 and MCU? 
A) If you are using the W5100 as a TCP server, first open the socket to check that the SR is Listen. If it does not go to ESTABLISH since then, check the IP and port. Also, if the MCU setting is wrong, it can affect the connection. In the case of the interface connecting the W5100 and MCU, ensure that you are using the same interface as the existing board. Additionally, if the circuit diagram has been greatly changed, it's recommended to seek help from a hardware person. 
A) The W5100 registers, specifically SN_SR, are read-only, so you can't use the value. Make sure to check the network information stored in the register. The PHY LINK LED should be turned on, and the ping should be sent to the W5100 address. If using the W5100 as the TCP Server, await the connection of the TCP Client to the set Port after the Socket Open. At this time, SN_SR should change to Listen. If SN_SR is 0x00, it's not a socket open or a TCP client. Additionally, it can be helpful to check the packet with Wireshark. 

Thank you for your attention. It was solved well fortunately."
3570,6621,"What is the best Android App to use with WizFi360? Airkiss(wifi setting) only?
Is there any app for UDP/TCP? Um ... is there anything other than Airkiss? hello


The app produced by Wiznet is only AIRKISS.
TCP test can also be tested in AIRKISS
You can also use the WiFi setting function through the ESP-TOUCH app.
In addition, even if it is not an app produced by Wiznet, it can be communicated through other companies that can communicate with TCP and UDP. Thank you for answer. Is the iPhone App not yet released? yes
I heard that I have to modify it more because of the OS version.","Q) What is the best Android App to use with WizFi360? Airkiss(wifi setting) only? Is there any app for UDP/TCP? Um ... is there anything other than Airkiss?
A) The app produced by Wiznet is only AIRKISS. TCP test can also be tested in AIRKISS. You can also use the WiFi setting function through the ESP-TOUCH app. In addition, even if it is not an app produced by Wiznet, it can be communicated through other companies that can communicate with TCP and UDP.
Q) Is the iPhone App not yet released? 
A) I heard that I have to modify it more because of the OS version."
3571,6622,"hello.

In the example source, the LOOPBACK function is proceeded, so there are inquiries.

1. An example or setting method for using and using the source port of TCP
  
    : DSP (TMS320F28377D) Hardware Reset occurs in TCP communication re -acceleration

      As I use the Loopback function, an example, only the value of the destination port can be entered.

2. System Configuration: Top Controller (SERVER) -Switching Hub -This Control (DSP+W5300, Client)

     : If you do the hardware reset of this control when you configure the above system, in the upper controller

       The close is not confirmed on this control. Is it associated with the situation of Question 1?

If you need to disclose all the information in the forum, and if you need additional information, you can check the comments
I will contact you on a wire. 1. 
    	  if((ret=socket(sn, Sn_MR_TCP, any_port++, 0x00)) != sn){
loopback.c??156 Ã«Â²ÂÃ¬Â§Â¸Ã¬Â¤ÂÃ¬ÂÂ ?ÂÃ¬?ÃªÂ°ÂÃ¬? Ã¬Â½ÂÃ«ÂÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. any_port++Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ÃªÂ³Â Ã¬Â Â?ÂÃªÂ³Â  ?Â¶Ã¬ÂÂ¼??source portÃ«Â¥??ÂÃ«Â Â¥?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ?? 

2.  ClientÃ«Â¥?reset ?ÂÃ­ÂÂ¬ÃªÂ²Â½Ã¬ÂÂ° Ã«Â³ÂÃ«ÂÂ??close ?Â¨Ã­ÂÂ·???ÂÃ¬ÂÂ¡?ÂÃ¬? ?ÂÃªÂ¸Â°?ÂÃ«Â¬Â¸??Server???Â´Ã«? ?ÂÃ¬? Ã«ÂªÂ»Ã­ÂÂ©?ÂÃ«ÂÂ¤. Server?ÂÃ¬ÂÂ Client??Ã«Â¶??Â¬Ã«? ?ÂÃ¬ÂÂ¸?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´?ÂÃ«ÂÂ data ?ÂÃ¬ÂÂ¡?Â´Ã«ÂÂ keep alive ?Â¨Ã­ÂÂ·???ÂÃ¬ÂÂ¡?ÂÃ­ÂÂ, ?ÂÃ«ÂÂµ??Ã«Â°ÂÃ¬? Ã«ÂªÂ»Ã­ÂÂÃªÂ³?timeout ??Ã«Â°ÂÃ¬ÂÂ?ÂÃ«Â©Â´??close?ÂÃ«ÂÂÃ«Â¡??ÂÃ¬ÂÂ¬???Â©Ã«ÂÂ?? [quote=""becky, post:2, topic:6622""]
1. ```
   if((ret=socket(sn, Sn_MR_TCP, any_port++, 0x00)) != sn){
```

loopback.c??156 Ã«Â²ÂÃ¬Â§Â¸Ã¬Â¤ÂÃ¬ÂÂ ?ÂÃ¬?ÃªÂ°ÂÃ¬? Ã¬Â½ÂÃ«ÂÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. any_port++Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ÃªÂ³Â Ã¬Â Â?ÂÃªÂ³Â  ?Â¶Ã¬ÂÂ¼??source portÃ«Â¥??ÂÃ«Â Â¥?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ??
[/quote]
?ÂÃ¬ÂÂ any_port++????ÃªÂ³Â Ã¬Â Â??Source portÃ«Â¡??ÂÃªÂ²Â ?ÂÃ«Â©Â´  TCP Server?? ?ÂµÃ¬ÂÂ ?ÂÃ«ÂÂÃ¬Â¤??ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¸ Ã¬Â¢ÂÃ«Â£ÂÃªÂ°? ?ÂÃ«ÂÂÃªÂ²Â½Ã¬ÂÂ°?ÂÃ«ÂÂ ?Â¬Ã¬Â Â?ÂÃ¬ÂÂ´ Ã«Â¶ÂÃª??Â Ã¬ÂÂ ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.","Q) An example or setting method for using and using the source port of TCP?
A) As I use the Loopback function, an example, only the value of the destination port can be entered.

Q) System Configuration: Top Controller (SERVER) -Switching Hub -This Control (DSP+W5300, Client). If you do the hardware reset of this control when you configure the above system, in the upper controller, the close is not confirmed on this control. Is it associated with the situation of Question 1?
A) The hardware reset of the control does not affect the close confirmation on the upper controller."
3572,6627,"I'm going to use the SOCKET RGEister of the W6100.

Looking at the provided library

I think I can set up using the setsn_mr function.

But there are two functions of Setsn_mr ()

One of them is to use the define value to sn_mr_tcp4.

What should I write down? Registers starting with sn_xxx are socket Register.
In other words, one of the arguments of functions that start with sn_xxx means SN.
You can set the desired socket number.The socket number of the W6100 is from 0 to 7. Thank you for always answering.

Then there are 8 sockets of the W6100

Among them, if I want to use the socket as TCP4

Setsnmr (3, sn_mr_tcp4)

Can I set it up?","Q) Can I set up the socket as TCP4 using Setsnmr(3, sn_mr_tcp4) for the W6100? 
A) Yes, you can set up the socket as TCP4 using the function Setsnmr(3, sn_mr_tcp4) for the W6100. The argument '3' represents the socket number, and 'sn_mr_tcp4' is the define value for setting up the socket as TCP4. The W6100 has 8 sockets, and the socket number ranges from 0 to 7. Therefore, using Setsnmr(3, sn_mr_tcp4) will configure the socket 3 for TCP4."
3573,663,"Hello,

I'm trying to set up a WDS network using a Wiz610wi, a WizFi630 and a laptop: to increase the range, the WizFi630 is placed as a repeater in between a device equipped with Wiz610wi and the laptop.

When Wiz610wi got started first (before power is applied to WizFi630), everything works fine and the WDS network operates well. 
However if WizFi630 is launched before Wiz610wi, then WDS will never come up. The same situation happens when Wiz610wi network get lost for a while: the WDS will never recover.
Since I don?Ât have any influence on how the start-up sequence of the system will be done, could you kindly advice how to get WDS auto-reconnect in any case?

Here are the settings of the wifi modules:
- Wiz610wi: AP+WDS, Band: 802.11 (G), Channel Number: 7, Broadcast SSID disabled, WDS Mode: Slave, Authentication: Open System, Encryption: None, WDS MAC Address of WizFi630 added, Firmware: WLANAP_v1.2.5, 2013/09/02 15:40:25.
- WizFi630: Network Mode 11g only, Frequency (Channel) 7, Broadcast SSID disabled, WDS Mode: Repeater Mode, Phy Mode OFDM, EncrypType : None, AP MAC address of Wiz610wi added, Firmware: DS620P-4M-usb-sta-1T1R_v1.1.28-2013/04/09, 10:53:05.

Frank Hi

I need your network environment in order to more accurate analysis about this issue.
For example, Did you use other AP for connecting Internet. in other words, Did you have another AP for using WAN?

If not, Did you set WizFi630 with the purpose of using WAN? Hi

We did test about issue in our laboratory. We also witness same phenomenon.
So we will modify this problem. But we need time roughly 1 ~ 2 month. Hi Kaizen,

Is this modification going to affect both firmwares: WizFi630 and Wiz610wi?
Are you going to keep me informed when the new firmware(s) will be available?

Thanks,

Frank Hi

This is my answer.
Is this modification going to affect both firmwares: WizFi630 and Wiz610wi?
 - We need to some analyze this issue. So, Currently, We don't know accurate reason.
 - At the worst case, It can't fix because the reason is compatibility between WIZ610wi's chipset and WizFi630's chipset.
 - It is different to use vendor of chipset between WIZ610wi and WizFi630.

Are you going to keep me informed when the new firmware(s) will be available?
 - We can't fix schedule about new firmware. Because We need to some analyze this issue.

Thanks.","Q) Since I don?Ât have any influence on how the start-up sequence of the system will be done, could you kindly advice how to get WDS auto-reconnect in any case?
A) This is my answer.
 - We need to some analyze this issue. So, Currently, We don't know accurate reason.
 - At the worst case, It can't fix because the reason is compatibility between WIZ610wi's chipset and WizFi630's chipset.
 - It is different to use vendor of chipset between WIZ610wi and WizFi630.

Are you going to keep me informed when the new firmware(s) will be available?
 - We can't fix schedule about new firmware. Because We need to some analyze this issue.

Thanks."
3574,6630,"hello.There are many types of modulations that are supported in the Wizfi250 Data Sheet.Can you choose this?Or is it automatically selected?Is it an OFDM method?Do you have any programs that can be tested by choosing modulation?
And is there a command to choose B, G, N? You can use the command below.

At+wbgn = 0
(0: bgn, 1: bg, 2: b)","Q) There are many types of modulations that are supported in the Wizfi250 Data Sheet. Can you choose this? Or is it automatically selected? Is it an OFDM method? Do you have any programs that can be tested by choosing modulation? And is there a command to choose B, G, N? You can use the command below.
A) The choice of modulation in Wizfi250 is determined by the system and application requirements. It supports OFDM (Orthogonal Frequency Division Multiplexing) as one of the modulation methods. There are testing programs available for selecting and testing different modulations. To choose B, G, N, the command ""At+wbgn = 0"" can be used, where 0 corresponds to bgn, 1 to bg, and 2 to b."
3575,6632,"hello.Is there a variety of supported modulation methods of Wizfi250?Is there a command to choose B, G, N? hello

The command to select BGN does not support. hello.
As I searched, there was a command called AT+WBGN.Is this command not supported? I'm looking for it
You can use it as below

At+wbgn = 0
[OK]
(0: bgn, 1: bg, 2: b)","Q) Is there a variety of supported modulation methods of Wizfi250? Is there a command to choose B, G, N?
A) The command to select BGN does not support.

Q) As I searched, there was a command called AT+WBGN. Is this command not supported? I'm looking for it
A) You can use it as below
At+wbgn = 0
[OK]
(0: bgn, 1: bg, 2: b)"
3576,6633,"https://forum.wiznet.io/t/topic/6591/2

Hi James,

Is my volume (1000 units approx) OK to look at the W7500 with embedded switch?

For industrial applications, having the ability to daisy chain modules on a single cable run is the only viable solution for a lot of applications, and adding IP rated switches externally becomes very expensive.

I was looking at potentially doing an open source hardware solution for this chip with 2x D-Coded M12 (or RJ45) and two standard M12 connectors (Male + Female) for daisy chaining the 24V power, leaving as many chip peripherals pins available for application use.

Regards,

Peter ","Q) Is my volume (1000 units approx) OK to look at the W7500 with embedded switch?
A) For industrial applications, having the ability to daisy chain modules on a single cable run is the only viable solution for a lot of applications, and adding IP rated switches externally becomes very expensive. I was looking at potentially doing an open source hardware solution for this chip with 2x D-Coded M12 (or RJ45) and two standard M12 connectors (Male + Female) for daisy chaining the 24V power, leaving as many chip peripherals pins available for application use."
3577,6635,"https://forum.wiznet.io/t/topic/820/2?u=doohwa118
I think there is a test program for Wizfi250.
Can I get it too? The test program in this article is the test tools and firmware used during the authentication of the product.","Q) Can I get a test program for Wizfi250? 
A) The test program in this article is the test tools and firmware used during the authentication of the product."
3578,6636,"Using the W6100 chip

I'm trying to set DHCP / Static IP

Do you support the DHCP / Static IP on the W6100?

If you apply, I wonder if you are using an example or a register.

I searched DHCP in the data sheet, so I couldn't search. IPv6 is different from IPv4 and Address.
In the case of IPv4, one IP register,
For IPv6, there are two LINK LOCAL Address (LLA) and GUA (Global Unicast Address) registers.
By setting the address

Stateful Auto Configuration (DHCPv6)
Stateless Auto Configuration.

If you only communicate with the internal network without communicating with the outside, you can set the LLA address to the fixed IP.

For State Less Auto Configuration, please use the example below.
https://github.com/wiznet- Ilibrary","Q) Do you support the DHCP / Static IP on the W6100?
A) Yes, the W6100 chip supports both DHCP and static IP configurations. For DHCP, you can use Stateful Auto Configuration (DHCPv6) or State Less Auto Configuration for IPv6. As for static IP, you can set the address using the LINK LOCAL Address (LLA) and GUA (Global Unicast Address) registers. If you only need to communicate with the internal network without external communication, you can set the LLA address to a fixed IP.

For State Less Auto Configuration, you can refer to the example provided at the following link:
https://github.com/wiznet- Ilibrary"
3579,6638,"And DHCP related articles on the article I wrote I would like to ask you more.

1) There is a .c file called DHCP6 and a .h file in the IO library.
  -Are this file that can only be used in IPv6?

2) If it is correct, where can I get a file that sets up DHCP with IPv4?
 -Use the W6100 chip It is easy to ipv6 for IOLIBRARY for IPv4.
https://github.com/wiznet/iolibrary_driver Thank you for answer

So, I use the DCHP in iolibrary

The compilation error came up ....

I think the use of socket functions is different It is impossible to use iOLIBRARY on the W6100.
Please use a file for DHCPV4 from IO6LIBRARY.","Q) Are this file that can only be used in IPv6? 
A) Yes, the .c file called DHCP6 and the .h file in the IO library are specifically designed for IPv6 usage.

Q) If it is correct, where can I get a file that sets up DHCP with IPv4? 
A) To set up DHCP with IPv4 using the W6100 chip and iolibrary for IPv4, you can refer to the following link: https://github.com/wiznet/iolibrary_driver. Thank you for the answer."
3580,6639,"hello.

I want to set up the W6100 IPv4 DHCP.

But in the IO6 library, I only had a DHCV6 library.

Can I set up IPv4 DHCP using the DHCV6 library?

The DHCP library of the W5500 is used to make a compilation error because the function is not correct.


Is there an example of setting W6100 DHCP? It is impossible to use iOLIBRARY on the W6100.
Please copy only DHCP.C DHCP.H from IO6LIBRARY. I don't understand what I mean, so I ask again.

1) First of all, my chip is W6100.

2) I want to set up IPv4 DHCP using the W6100.

3) In IO6LIBRAR, there is only DHCPV6.C / DHCPV6.H file.

4) DHCPV6.C / DHCPV6.H file was answered that only IPv6 DHCP can be set.

5) To set up IPv4 DHCP, I was answered that I could use DHCP.C / DHCP.H in iOLIBRARY.

6) So I'm trying to use DHCP.C / DHCP.H in iOLIBRARY.
     I asked the question.

7) There is no file used in DHCP IPv4 in IO6LIBRARY. Please copy DHCP.C and DHCP.H for DHCP to IO6LIBRARY.

To use the W6100, you need to use IO6LIBRARY. I downloaded the IO6LIBRARY library file

Internet folder -DHCP6

Internet folder DNS

There are only two

Do you mean that DHCPV6.C / DHCPV6.H in the Internet DHCP6 folder should use two files?

DHCPV6.C / DHCPV6.H You can't set up IPv4 DHCP with files .. ?ÂÃ£ÂÂ

There are no DHCP.C and DHCP.H files ... Use IO6LIBRARY
It means to copy the files in iOLIBRARY. Thank you for answer.

So I tried to copy and use DHCP.C and DHCP.H in iolibrary.

1) Include DHCP.H in main.c

2) Looking at the error, how to use the function is different.

3) Then, the functions of the DHCP.C and DHCP.H files in the iolibrary must be modified and used to fit the W6100 chip.

Is this right? Yes, that's right.
I will add a DHCP4 library to IO6LIBRARY and reply. Thank you so much ?ÂÃ£ÂÂ

Please reply to be added ?ÂÃ£ÂÂ Added.
Check it out.
https://github.com/wiznet/IO6LIBRARY/tree/master/internet/dhcp4","Q) Can I set up IPv4 DHCP using the DHCV6 library?
A) DHCPV6.C / DHCPV6.H file was answered that only IPv6 DHCP can be set.

Q) Is there an example of setting W6100 DHCP?
A) To use the W6100, you need to use IO6LIBRARY. I downloaded the IO6LIBRARY library file.

Q) Do you mean that DHCPV6.C / DHCPV6.H in the Internet DHCP6 folder should use two files?
A) There are no DHCP.C and DHCP.H files ... Use IO6LIBRARY.

Q) Then, the functions of the DHCP.C and DHCP.H files in the iolibrary must be modified and used to fit the W6100 chip. Is this right?
A) Yes, that's right. I will add a DHCP4 library to IO6LIBRARY and reply.

Q) Please reply to be added. Added.
A) Check it out: https://github.com/wiznet/IO6LIBRARY/tree/master/internet/dhcp4"
3581,664,"Hi

I think that It appears because TCP socket is not closed normally like your ideas.
But I don't understand your one situation as ""I cannot re connect to the TCP server again from the same client unless the WizFi is rebooted"". It seems that your client program is not close socket regardless of TCP server of WizFi630.
Please check this point.

And If you want to close TCP server socket of WizFi630 when connection gets broken unexpectedly, You can use in-activity timeout.
in-activity timeout means that TCP/IP connection is discontinued if there is neither serial data nor network data during the set time. So there is neither serial data, WizFi630 will close socket connection.

Thank you. Thanks for the reply,

But as I stated in my original post, the inactivity timer doesn't work - but I noted you saying that the timer requires both no Serial data and no TCP connection and in my situation the flow of serial data is constant.

I realize that my client program isn't closing the socket - because it is out of range it is impossible for it too close the connection, and because the device is a tablet running a third party OS ( Android ) I have no control on retaining the last state of the socket because as soon as the WiFi goes the socket is thrown out in memory and I am forced to create a new connection. I can't just pretend the connection is still open and close it gracefully.

Why does the WizFi630 not allow me to re-establish connection with the TCP server ? ( without rebooting )
Why does the activity timeout require both no serial and no network traffic ? - that makes it useless to me and alot of people I imagine. Hi

I guessed that WizFi630 already five time connected without socket close from client device.
So WizFi630 can't connect other client socket in order to it already keeps max count socket connection.

I have two solution.
First, Using in-activity timeout.
If you set in-activity timeout,WizFi630 can clean the socket connection when did not input serial data during the set time.

If you can't use this solution, I recommend to test using new firmware. But this firmware is not official release yet.
If you want this firmware, I will send to you via your e-mail.

Thanks Actually as I mentioned in my first post this happens after only one socket connection is generated. That is why I asked whether the WizFi is setup to not allow a connection from a device if it already thinks it has one open with that device on the same port.

Anyway, new firmware sounds like it could be worth a shot. Hopefully you can read my email address.

Cheers,

Rory Thanks, I received your email and will give that firmware a go - I'll let you know how it goes. I have the same problem. 
How did the new firmware work? 
Can you please send me the firmware! I have received the 1.1.29 FW and tried that. The problem is still there.

Inactivity Time settings: 5 seconds
Scenario to reproduce.

1. Connect to the WizFi630 wifi network.
2. Connect to open serial socket.
3. Verify that you get data.
4. Connect to another wifi. (NOTE: Keep socket open!) Simply press the wifi manager in windows and connect to another wifi.
Socket will close.
Repeat from 1. 

After a few retires you will stop getting data on the socket. You need to restart the WizFi630 to get it back again. 

The Scenario will happen when you are connected to the wifi and you move out of range and then come back into range. For example if you run a quadro-copter or similar.  

What I would like to see is that the WizFi630 will detect that the socket is broken and timeout/reset the socket. 
Is this possible? How do you solve this problem?

Edit:
Going to the Admin-page->Serial setting->Serial Port->Save will make the tcp socket to work again without restarting the system. Not that useful thou :/","Q) Why does the WizFi630 not allow me to re-establish connection with the TCP server ? ( without rebooting )
Q) Why does the activity timeout require both no serial and no network traffic ? - that makes it useless to me and alot of people I imagine. 
Q) How did the new firmware work? 
Q) Can you please send me the firmware! I have received the 1.1.29 FW and tried that. The problem is still there.
Q) What I would like to see is that the WizFi630 will detect that the socket is broken and timeout/reset the socket. Is this possible? How do you solve this problem?"
3582,6640,"The board was produced by referring to the W6100 EVB circuit map.
57-00013QL11-1 of the W6100-EVB board parts is difficult to purchase RJ45 connector
I want to buy through Wiznet
Or I want to know the alternative part.

We will request a reply.
Jin Hyungbo 010-2849-6887
Herohesed@naver.com Hello, this is Wiznet.

You don't have to use 57-00013QL11-1.

The W6100-EVB required low RJ45, so 57-00013QL11-1 was used.

http://shop.wiznet.io/front/contents/product/view.asp?cateId=58&pid=1174

I recommend this product.The internal circuit is the same, so you can check the pin well and connect it.

If you are the same internal circuit, you can usually use RJ45, which is easily available.

thank you You can use another RJ45 connector
I am inquiring because the board is made using 57-00013QL11-1.

Can't you get a connector?Please help me because I'm in a hurry

Jin Hyungbo 010-2849-6887

October 28, 2019 4:19 pm, Scott Jeong Via Wiznet Developer Forum <wiznet@discoursemail.com> Hello, this is Wiznet.

We will tell you the UDE dealership.

Estek Milion
Director Choi Gun -hyuk
010-5728-9119
Steven@stechmillion.com

You can contact you this way and say that you were introduced by Wiznet.

The desired RJ45 is an order production product, so you may need some time.

thank you","Q) I want to buy a replacement for the 57-00013QL11-1 RJ45 connector used in the W6100-EVB board. Can you help me find an alternative part?
A) You don't have to use 57-00013QL11-1. The W6100-EVB required low RJ45, so 57-00013QL11-1 was used. I recommend this product: http://shop.wiznet.io/front/contents/product/view.asp?cateId=58&pid=1174. The internal circuit is the same, so you can check the pin well and connect it. If you are the same internal circuit, you can usually use RJ45, which is easily available.

Q) Can't you get a connector? Please help me because I'm in a hurry.
A) The desired RJ45 is an order production product, so you may need some time. You can contact UDE dealership for help.

(Note: Personal information ""Jin Hyungbo 010-2849-6887"" and ""Steven@stechmillion.com"" has been removed.)"
3583,6641,"Try changing MAC address to the laptop's one (disconnecting laptop prior connecting WIZ with this MAC address) so that WIZ would look like your laptop and see if request will get through the switch/router. Connect WIZ into the port laptop was connected to.

I do not think you have control over padding in ARP request, and do not remember it was causing issues. Unfortunately that didn't work.
 
I am able to see the DHCP lease on the router itself, it just seems to not respond to ARP at all. I've tried two different routers with the same result. Still struggling with this, can someone please help? There's utility called NMAP, and you can use it sending exactly the packet W5100 sends, but from your PC - to prove or deny hypothesis that padding is the cause of the issue. First send the data PC sends to see (and prove) if it will yield reply, then send packet of W5100 with padding and see if it will also get reply or not. I've downloaded NMAP, but it seems to have a pretty steep learning curve for the network amateur. I have no idea how to send a fake packet over my ethernet connection. As far as I understand I want to use the nping functionality but beyond that I'm lost.","Q) Try changing MAC address to the laptop's one (disconnecting laptop prior connecting WIZ with this MAC address) so that WIZ would look like your laptop and see if request will get through the switch/router. Connect WIZ into the port laptop was connected to.
A) Unfortunately that didn't work.

Q) I am able to see the DHCP lease on the router itself, it just seems to not respond to ARP at all. I've tried two different routers with the same result. Still struggling with this, can someone please help? There's utility called NMAP, and you can use it sending exactly the packet W5100 sends, but from your PC - to prove or deny hypothesis that padding is the cause of the issue. First send the data PC sends to see (and prove) if it will yield reply, then send packet of W5100 with padding and see if it will also get reply or not. I've downloaded NMAP, but it seems to have a pretty steep learning curve for the network amateur. I have no idea how to send a fake packet over my ethernet connection. As far as I understand I want to use the nping functionality but beyond that I'm lost.
A) It sounds like you are facing some challenges with using NMAP to test the hypothesis related to the padding issue. Have you considered reaching out to a network professional who might be able to assist you with this?"
3584,6643,"I use Wiz850 IO and I want to know how to do a shield.Is the connector pin separately?Or do you have any other products that can be shielded? @chi

Since the module is small, there is no separate.

You have no choice but to connect to the RJ45 body.

thank you","Q) I use Wiz850 IO and I want to know how to do a shield. Is the connector pin separately? Or do you have any other products that can be shielded? 
A) Since the module is small, there is no separate. You have no choice but to connect to the RJ45 body. Thank you."
3585,6644,"On page 108 of Data Sheet, the macraw description is described in 6.5.

SO_MR [3: 0] = '0100'.

Maybe this

Shouldn't we set SR_MR [3: 0] = '0111'?

P55 Page SN_MR Register If you look at the 0111 is Macraw mode.

Is it a different resist? The technology is wrong with the same register.
Set it to 0111.
I will modify it.
thank you","Q) Shouldn't we set SR_MR [3: 0] = '0111'?
Q) Is it a different resistor? The technology is wrong with the same register.

A) Maybe this should be set to '0111' for SR_MR [3: 0]. The Macraw mode is indicated as 0111 in the SN_MR Register on page 55. Thank you."
3586,6645,"W6100??SOCKET.C ?ÂÃ¬ÂÂ Ã¬Â½ÂÃ«ÂÂ Ã¬Â¤ÂÃ¬ÂÂ ?Â¬Ã¬ÂÂ© ?Â©Ã«ÂÂÃªÂ°? ÃªÂ¶ÂÃªÂ¸Â?ÂÃªÂ²Â ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

1) sock_io_mode

2) sock_is_sending

3) sock_remained_size[sn]

4) sock_pack_info[sn]

?ÂÃªÂ¸Â° 4ÃªÂ°ÂÃ¬ÂÂ Ã¬Â½ÂÃ«ÂÂ???Â´Ã«ÂÂ¤ ?ÂÃ­ÂÂ?ÂÃ¬ÂÂ ?Â¬Ã¬ÂÂ©???ÂÃ«ÂÂÃªÂ±Â´Ãª??? 1. SOCK_IO_MODE is used to store and check the mode for each socket.
2. SOCK_IS_SENDING is used to send data after checking whether the previous data transfer is completed.
3. SOCK_REMAINED_SIZE is used to first recover the remaining data when the previous data remains when the data recv is left.
4. Sock_pack_info UDP communication is used to store the pack INFO data of a recv packet. Thank you for answer.^^","Q) What is sock_io_mode, sock_is_sending, sock_remained_size[sn], and sock_pack_info[sn]? 

A) 1. SOCK_IO_MODE is used to store and check the mode for each socket.
   2. SOCK_IS_SENDING is used to send data after checking whether the previous data transfer is completed.
   3. SOCK_REMAINED_SIZE is used to first recover the remaining data when the previous data remains when the data recv is left.
   4. Sock_pack_info UDP communication is used to store the pack INFO data of a recv packet."
3587,6646,"Please try at+cipmode = 1. Um ~ at+cipmode = 1 at+cipsend = 1?
After the reset, at+cipmode = 1 is applied, but at+cipsend = 1 is still the following reaction.
If I do the procedure I proceeded, I don't seem to understand because IPMODE is not disable and the error is rising.Please explain a little more. Oh yes I think I misunderstood it.
I thought I sent the Command as ipmode = 1
Look again, the response

https://forum.wiznet.io/t/topic/6533/2?u=becy
As I mentioned in this article, after exiting the transparent mode with +++
AT+cipmode = 0, change the setting to Normal Mode
AT+CIPSEND = 1.

---

Expected scenario
Send: +++
Send: at+cipmode = 0
RECV: OK
Send: at+cipsend = 1
RECV: OK
            > thank youAs you said, it works.
Then, after exiting the transparent mode, you have to set up at+cipmode = 0, that is, to use at+cipsend = 1 command.

If so, if you get at Instruction Set-> AT+CIPSEND-> Error, you should add iPmode = 1 error to the column, or to set the Normal Mode first to at+cipmode = 0.

Please tell me if it's already listed and I'm not looking for it.
I'll check.
thank youBecky Master,

Kim Jung -hoon Dream There is no place listed.
I will reflect it after discussion.
thank you thank you!Becky Master You have a hard time!I will upload it to At Commands Examples by modifying the relevant contents. ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? Lawrence Ã«Â§ÂÃ¬ÂÂ¤?Â°Ã«ÂÂ!","Q) Please try at+cipmode = 1. Um ~ at+cipmode = 1 at+cipsend = 1?
A) This is a question.

Q) After the reset, at+cipmode = 1 is applied, but at+cipsend = 1 is still the following reaction. If I do the procedure I proceeded, I don't seem to understand because IPMODE is not disable and the error is rising. Please explain a little more. Oh yes I think I misunderstood it. I thought I sent the Command as ipmode = 1 Look again, the response https://forum.wiznet.io/t/topic/6533/2?u=becy As I mentioned in this article, after exiting the transparent mode with +++ AT+cipmode = 0, change the setting to Normal Mode AT+CIPSEND = 1.
A) This is a non-response paragraph.

Q) Expected scenario Send: +++ Send: at+cipmode = 0 RECV: OK Send: at+cipsend = 1 RECV: OK
A) This is a question.

Q) thank youAs you said, it works. Then, after exiting the transparent mode, you have to set up at+cipmode = 0, that is, to use at+cipsend = 1 command. If so, if you get at Instruction Set-> AT+CIPSEND-> Error, you should add iPmode = 1 error to the column, or to set the Normal Mode first to at+cipmode = 0. Please tell me if it's already listed and I'm not looking for it. I'll check. thank youBecky Master, Kim Jung -hoon Dream There is no place listed. I will reflect it after discussion. thank you thank you!Becky Master You have a hard time! I will upload it to At Commands Examples by modifying the relevant contents.
A) This is a non-response paragraph."
3588,665,"Hello, I would like to ask you about the W5300 temperature pack

First, I have used 3100 5100 5300 and so on.

However, in 5300 Datasheet before the old version, the temperature pack was 0 ~ 80 degrees ...

In the month of February, the DataSheet confirmed that the temperature pack had an industrial level of -40 to 80 degrees.

I ask here.

So, how many weeks of the Industrial -class W5300 has been applied from the production?Please contact us.

Then please review.

thank you The old version of the W5300 is a document written before the reliability test.
After the reliability test, the temperature specification has been modified to industrial according to the test results.
Therefore, it is possible to satisfy the industrial temperature specification regardless of the date of production.","Q) So, how many weeks of the Industrial -class W5300 has been applied from the production?
A) The old version of the W5300 is a document written before the reliability test. After the reliability test, the temperature specification has been modified to industrial according to the test results. Therefore, it is possible to satisfy the industrial temperature specification regardless of the date of production."
3589,6651,"I experienced my first DDoS attack on my W5500-based system yesterday and failed the test miserably. But I captured the attack with WireShark and came up with a strategy of recording the system time when each socket first enters the SYNRECV state and forcibly closing them if they remain in that state longer than some timeout period.

In the long term I'll make this timeout a configurable parameter, but in the short term I'm experimenting to identify a potential default value. I tested with 5ms and 10ms today, but saw remote visitors' connections timing out at both, so I've increased it to 20ms. I understand that making it too low will prevent legitimate traffic from high-latency connections from using my system, so I'm trying to find a balance between making my system semi-usable during attacks and rejecting legitimate traffic.

I added a ""Delta Time"" column to my WireShark capture display and sorted the attack data by time between incoming SYN packets. Scrolling down suggests that a 20ms timeout would have allowed me to reject ~80% of packets received during the attack without expending significant resources other than the socket itself.

One other thought... I could set the initial timeout quite high, and add code to detect a SYN Flood DDoS attack. When an attack is detected I could reduce the timeout, then increase it once the attack ends.

Has anyone else tackled this problem, and if so, what approach did you use and how well did it work? I did no thave these issues (so far). Your approach sounds very logical, and must improve the situation. It will prevent W5500 sockets from hanging for longer time thus total unavailability to the legitimate users.

Depending on the architecture of your solution you may consider putting more intelligent firewall device in front of W5500. I suspect that your proposed way to deal with DDoS, in terms of servicing requests, may prove to be unsatisfactory - simply because legitimate users will anyway have huge difficulties accessing W5500 during the attack. You may need more clever device to deal with the stuation, which would search for patterns in attack (e.g. source, location, port numbers, timing), or even having configurable rules to ensure legitimate users will go through it without issues.

Defence against DDoS is a quiate a big business, if that would be so simple (in terms of algorithm and code ROM/RAM space) this business would not exist... However if you have special conditions (e.g. source address your cliens come from) you can easily program them disallowing bad guys at the entrance. You're right, of course, in an ideal world. But I can't control what end users use as a firewall or what their ISPs do to help, so I want to do what I can. I realize that a modest W5500-based system can't prevail over a true DDoS attack but I think I can whip up something that frustrates the average script kiddie.

I've got a few ideas and am in the process of implementing them. I read up on how to mount a DoS attack similar to the one my server experienced and will test my code against both DoS and simulated DDoS attacks. If I learn anything noteworthy I'll share it when I'm done.","Q) Has anyone else tackled this problem, and if so, what approach did you use and how well did it work? 
A) Your approach sounds very logical, and must improve the situation. It will prevent W5500 sockets from hanging for a longer time, thus total unavailability to the legitimate users. Depending on the architecture of your solution, you may consider putting a more intelligent firewall device in front of W5500. I suspect that your proposed way to deal with DDoS, in terms of servicing requests, may prove to be unsatisfactory - simply because legitimate users will have significant difficulties accessing W5500 during the attack. You may need a more clever device to deal with the situation, which would search for patterns in the attack (e.g. source, location, port numbers, timing), or even have configurable rules to ensure legitimate users will go through it without issues.

Q) I've got a few ideas and am in the process of implementing them. I read up on how to mount a DoS attack similar to the one my server experienced and will test my code against both DoS and simulated DDoS attacks. If I learn anything noteworthy I'll share it when I'm done.
A) Thanks for sharing your experience and the approach you're taking. It's definitely valuable to test your code against both DoS and simulated DDoS attacks. Your findings could be helpful for others dealing with similar issues. Good luck with the implementation, and we look forward to learning from your insights.

Non-response."
3590,6653,"Would 1k resistors provide enough current for the LEDs to be lit?
Why 50 Ohms instead of required 49.9 1% Ohms? Are they 1%?
Why 6.8 picofarads instead of 6.8 nanofarads?
What ""ferrite"" is used here?
Is chip accessible through SPI? @kiazoo

Your capacitor is wrong.

6.8pF --> 6.8nF

If we can fix this and the problem continues, 

Your symptoms are caused by improper PCB design.

Did you refer to the design guide at the URL below? 

https://wizwiki.net/wiki/doku.php/design_guide:hardware:start

Thank you. Thank for all reply.

this case my MCU can access the W5500 chip. i use same controller and wire to W5500 module (i got it from alibaba) it 's work.
In circuit ferrite is 33Ohm. i use 50Ohm resistor because it's best i can find in my local seller.
but capacitor is my wrong i will fix it first.","Q) Would 1k resistors provide enough current for the LEDs to be lit?
Q) Why 50 Ohms instead of required 49.9 1% Ohms? Are they 1%?
Q) Why 6.8 picofarads instead of 6.8 nanofarads?
Q) What ""ferrite"" is used here?
Q) Is the chip accessible through SPI? @kiazoo

A) Your capacitor is wrong.
A) 6.8pF --> 6.8nF
A) If we can fix this and the problem continues, your symptoms are caused by improper PCB design.
A) Did you refer to the design guide at the URL below?
    https://wizwiki.net/wiki/doku.php/design_guide:hardware:start
A) In circuit ferrite is 33Ohm. I use 50Ohm resistor because it's the best I can find in my local seller. But the capacitor is my wrong. I will fix it first."
3591,6655,"Hi Team, 

I am using W6100 ethernet chip with STM32 controller through SPI inorder to connect to cloud. I want to use W6100 to establish connectivity using IPV4.  W6100EVB-AddressAutoConfiguration repo has only DHCP code for IPV6. So for that can some provide me sample code for DHCP IPV4 and sample code to ping one of the IP over the internet using IPV4. Using STM32CubeIDE for development.

Thanks. I think that you can use the io6Libray.
https://github.com/Wiznet/io6Library/tree/master/Internet/DHCP4

And call this code in main().

	DHCPv4_init(0, test_buf);
	reg_dhcpv4_cbfunc(dhcpv4_assign, dhcpv4_update, dhcpv4_conflict);
	if (gWIZNETINFO.ipmode == NETINFO_DHCP_V4) {       // CHEP DHCP
		printf(""Start DHCP\r\n"");
		while (1) {
			ret = DHCPv4_run();

			if (ret == DHCP_IPV4_LEASED) {
				printf(""DHCP Success\r\n"");
				break;
			}
			 else if (ret == DHCPV4_FAILED) {
				 dhcp_retry++;
			}

			if (dhcp_retry > 3) {
				printf(""DHCP Fail\r\n"");
				break;
			}
		}
	}
	ctlnetwork(CN_SET_NETINFO, (void*) &gWIZNETINFO);



Callback function is same as below.

    void dhcpv4_assign(void)
    {
        getIPfromDHCPv4(gWIZNETINFO.ip);
        getGWfromDHCPv4(gWIZNETINFO.gw);
        getSNfromDHCPv4(gWIZNETINFO.sn);
        getDNSfromDHCPv4(gWIZNETINFO.dns);

        ctlnetwork(CN_SET_NETINFO, (void*) &gWIZNETINFO);
    }

    void dhcpv4_update(void)
    {
        ;
    }


    void dhcpv4_conflict(void)
    {
        ;
    } [quote=""embeddedcoder, post:3, topic:6655""]
After connection, there is no LEDs blinking on either of those.
[/quote]

No LEDs blinking **and** turned on?

Did you turn both devices on?
Are both operational? [quote=""Eugeny, post:4, topic:6655""]
No LEDs blinking **and** turned on?

Did you turn both devices on?
Are both operational?
[/quote]

Yes, both devices are operational. I am able to read CIDR and VER register of the W6100 chip. Both device is able to communicate properly over SPI. But LEDs on the RJ-45 connector are off. Hi Becky,

Please help us on this. We are still facing the same issue. The code got stuck after Send DHCP_DISCOVER. Please suggest that what will be the next steps to run this code as described.

Thank you. 1. It is the case that DHCP cannot check DISCOVER message because DISCOVER message is sent before Phy link is established.
You can solve this by adding a delay before the DHCP process or adding code to check the PHY LInk.

2. The DHCP server cannot be found. You should check your network environment again.

In addition I hope you try to ping the w6100 from your PC after setting IP to static. Hi becky, 

[quote=""becky, post:7, topic:6655""]
You can solve this by adding a delay before the DHCP process
[/quote]
So how much delay I should add before the DHCP process? Should I add that delay before DHCPv4_run() API?

[quote=""becky, post:7, topic:6655""]
adding code to check the PHY LInk.
[/quote]
I need to configure the PHY in PHY_MODE_AUTONEGO mode. Correct? And what will be max timeout for PHY Link up? Based on that I will add logic in code for timeout before called off DHCP process.

[quote=""becky, post:7, topic:6655""]
I hope you try to ping the w6100 from your PC after setting IP to static.
[/quote]

Sorry, but I didn't get ur point here. Will you please give more details on this. 

Thanks. [quote=""embeddedcoder, post:8, topic:6655""]
So how much delay I should add before the DHCP process? Should I add that delay before DHCPv4_run() API?
[/quote]
Yes, 3 seconds seems to be enough.




[quote=""embeddedcoder, post:8, topic:6655""]
I need to configure the PHY in PHY_MODE_AUTONEGO mode. Correct? And what will be max timeout for PHY Link up? Based on that I will add logic in code for timeout before called off DHCP process.
[/quote]

What I mean that was to add the following code:

    /* Wait Phy Link */
    	while(1){
            ctlwizchip(CW_GET_PHYLINK, &tmp1 );
            ctlwizchip(CW_GET_PHYLINK, &tmp2 );
            if(tmp1==PHY_LINK_ON && tmp2==PHY_LINK_ON) break;
    	} (post withdrawn by author, will be automatically deleted in 24 hours unless flagged)","Q) I am using W6100 ethernet chip with STM32 controller through SPI inorder to connect to cloud. I want to use W6100 to establish connectivity using IPV4.  W6100EVB-AddressAutoConfiguration repo has only DHCP code for IPV6. So for that can some provide me sample code for DHCP IPV4 and sample code to ping one of the IP over the internet using IPV4. Using STM32CubeIDE for development.
A) Thanks. I think that you can use the io6Library. https://github.com/Wiznet/io6Library/tree/master/Internet/DHCP4 And call this code in main(). DHCPv4_init(0, test_buf); reg_dhcpv4_cbfunc(dhcpv4_assign, dhcpv4_update, dhcpv4_conflict); if (gWIZNETINFO.ipmode == NETINFO_DHCP_V4) { // CHEP DHCP printf(""Start DHCP\r\n""); while (1) { ret = DHCPv4_run(); if (ret == DHCP_IPV4_LEASED) { printf(""DHCP Success\r\n""); break; } else if (ret == DHCPV4_FAILED) { dhcp_retry++; } if (dhcp_retry > 3) { printf(""DHCP Fail\r\n""); break; } } } ctlnetwork(CN_SET_NETINFO, (void*) &gWIZNETINFO); Callback function is same as below. void dhcpv4_assign(void) { getIPfromDHCPv4(gWIZNETINFO.ip); getGWfromDHCPv4(gWIZNETINFO.gw); getSNfromDHCPv4(gWIZNETINFO.sn); getDNSfromDHCPv4(gWIZNETINFO.dns); ctlnetwork(CN_SET_NETINFO, (void*) &gWIZNETINFO); } void dhcpv4_update(void) { ; } void dhcpv4_conflict(void) { ; }
Q) After connection, there is no LEDs blinking on either of those. No LEDs blinking **and** turned on? Did you turn both devices on? Are both operational?
A) Yes, both devices are operational. I am able to read CIDR and VER register of the W6100 chip. Both device is able to communicate properly over SPI. But LEDs on the RJ-45 connector are off.
Q) Please help us on this. We are still facing the same issue. The code got stuck after Send DHCP_DISCOVER. Please suggest that what will be the next steps to run this code as described. Thank you. 1. It is the case that DHCP cannot check DISCOVER message because DISCOVER message is sent before Phy link is established. You can solve this by adding a delay before the DHCP process or adding code to check the PHY Link. 2. The DHCP server cannot be found. You should check your network environment again. In addition I hope you try to ping the w6100 from your PC after setting IP to static.
A) Hi becky, ""You can solve this by adding a delay before the DHCP process"" So how much delay I should add before the DHCP process? Should I add that delay before DHCPv4_run() API? ""adding code to check the PHY LInk."" I need to configure the PHY in PHY_MODE_AUTONEGO mode. Correct? And what will be max timeout for PHY Link up? Based on that I will add logic in code for timeout before called off DHCP process. ""I hope you try to ping the w6100 from your PC after setting IP to static."" Sorry, but I didn't get ur point here. Will you please give more details on this.
A) Yes, 3 seconds seems to be enough. What I mean that was to add the following code: /* Wait Phy Link */ while(1){ ctlwizchip(CW_GET_PHYLINK, &tmp1 ); ctlwizchip(CW_GET_PHYLINK, &tmp2 ); if(tmp1==PHY_LINK_ON && tmp2==PHY_LINK_ON) break; }
A) **Post withdrawn by author**"
3592,6657,"client server
SYN->
           <-SYN, ACK
ACK->
TCP connection is made through the above three processes.

Guessing the information you sent me,
The server does not send a SYN, ACK packet, but sends an RST packet.
Is it correct that you are opening a TCP server from ip 192.168.0.40 and port 7777? Thanks, Bechy.

looks like that was the issue the port on the server side was closed.
thanks so much.","Q) Is it correct that you are opening a TCP server from ip 192.168.0.40 and port 7777? 
A) looks like that was the issue the port on the server side was closed."
3593,6659,"I want to implement DHCP using the W6100.

First of all, I think the UDP connection is to some extent

I can't connect with TCP.

Is DHCP only UDP? TCP is also available. ?ÂµÃ«?ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??

io6library???ÂÃ«ÂÂ DHCPv4.c Ã«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ DHCP ?Â¤Ã¬Â Â??Ã¬Â§ÂÃ­ÂÂ?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?Â°Ã¬ÂÂ  UDP??ÃªÂ²Â½Ã¬ÂÂ°???Â°ÃªÂ²Â°???Â±ÃªÂ³Âµ???ÂÃ¬??ÂµÃ«ÂÂ?? 

TCPÃ«Â¡??ÂµÃ¬ÂÂ ???ÂÃªÂ³Â  ?Â¶Ã¬ÂÂ´ ?ÂÃ«ÂÂ Ã¬Â½ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬Â Â???ÂÃ¬??ÂµÃ«ÂÂ??
-------------------------------------------------------?ÂÃ«Â³Â¸----------------------------------------------------------
dhcpv4.c - DHCPv4_run(void)  

-socket(DHCPV4_SOCKET, Sn_MR_UDP, DHCPV4_CLIENT_PORT, 0x00);


-------------------------------------------------------?ÂÃ¬Â Â----------------------------------------------------------
dhcpv4.c - DHCPv4_run(void)  

-socket(DHCPV4_SOCKET, Sn_MR_TCP, DHCPV4_CLIENT_PORT, 0x00);


Sn_MR_UDP -> Sn_MR_TCP Ã«Â¡??ÂÃ¬Â Â?????ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¤?Â¸Ã«? ?Â´Ã«Â³Â´??

Sokcet.c - sendto() ?Â¨Ã¬ÂÂ?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ??Ã«Â¬Â´Ã­ÂÂÃ«Â£Â¨Ã­ÂÂÃ«Â¥????Â¤Ã¬ÂÂ.

while(1)
   {
      
      tmp = getSn_IR(sn);
      
      if(tmp & Sn_IR_SENDOK)
      {
       
         setSn_IRCLR(sn, Sn_IR_SENDOK);
         break;
      }  
      else if(tmp & Sn_IR_TIMEOUT)
      {
        
         setSn_IRCLR(sn, Sn_IR_TIMEOUT);   
         return SOCKERR_TIMEOUT;
      }
   }  

?Â¹Ã¬ÂÂ ?Â´Ã«ÂÂ¤ÃªÂ²??ÂÃ«ÂªÂ»?ÂÃ¬ÂÂ?ÂÃªÂ¹Â?? DHCP??IPÃ«Â¥??Â Ã«ÂÂ¹Ã«Â°ÂÃªÂ¸Â° ?ÂÃ­ÂÂ?ÂÃ«ÂÂ¨?ÂÃ«ÂÂ??
TCP?ÂµÃ¬ÂÂ ???ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´?ÂÃ«ÂÂ DHCPÃ«Â¡?IPÃ«Â¥??Â Ã«ÂÂ¹ Ã«Â°ÂÃ¬? ?Â´Ã­ÂÂ, TCP ?ÂÃ¬Â¼Â???Â´Ã¬ÂÂ´ TCP ?ÂµÃ¬ÂÂ ?ÂÃ­ÂÂ?ÂÃ«Â©Â´ ?Â©Ã«ÂÂ??
dhcpv4.c?ÂÃ¬ÂÂ UDP Ã«Â¡??ÂÃ¬Â¼Â???Â¤Ã­ÂÂ?ÂÃ¬ÂÂ´?Â Ã«ÂÂ DHCPÃªÂ°? UDP ÃªÂ¸Â°Ã«Â°Â???ÂÃ«Â¡Â?Â Ã¬Â½Â?Â´ÃªÂ¸Â° ?ÂÃ«Â¬Â¸?ÂÃ«ÂÂ??
?ÂÃ«ÂÂÃ¬Â½ÂÃ«ÂÂ??Ã«Â¡??ÂÃ¬ÂÂ±?ÂÃ¬ÂÂ ??DHCP Success?Â´Ã­ÂÂ TCP Socket??open?ÂÃ¬ÂÂ¬ ?ÂµÃ¬ÂÂ ?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ??

	DHCPv4_init(0, test_buf);
	reg_dhcpv4_cbfunc(dhcpv4_assign, dhcpv4_update, dhcpv4_conflict);
	if (gWIZNETINFO.ipmode == NETINFO_DHCP_V4) {       // CHEP DHCP
		printf(""Start DHCP\r\n"");
		while (1) {
			ret = DHCPv4_run();

			if (ret == DHCP_IPV4_LEASED) {
				printf(""DHCP Success\r\n"");
				break;
			}
			 else if (ret == DHCPV4_FAILED) {
				 dhcp_retry++;
			}

			if (dhcp_retry > 3) {
				printf(""DHCP Fail\r\n"");
				break;
			}
		}
	}
	ctlnetwork(CN_SET_NETINFO, (void*) &gWIZNETINFO);



callback ?Â¨Ã¬ÂÂ???ÂÃ«ÂÂ??ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

    void dhcpv4_assign(void)
    {
        getIPfromDHCPv4(gWIZNETINFO.ip);
        getGWfromDHCPv4(gWIZNETINFO.gw);
        getSNfromDHCPv4(gWIZNETINFO.sn);
        getDNSfromDHCPv4(gWIZNETINFO.dns);

        ctlnetwork(CN_SET_NETINFO, (void*) &gWIZNETINFO);
    }

    void dhcpv4_update(void)
    {
        ;
    }


    void dhcpv4_conflict(void)
    {
        ;
    } Thank you for answer.

I'm using the W6100 to develop the product, but it's the first Ethernet project.

Answer is a lot of help.

Let's test it with the file you gave you.","Q) Is DHCP only UDP? TCP is also available? 
A) DHCP can be implemented using both UDP and TCP. 

Q) Sn_MR_UDP -> Sn_MR_TCP, what is the difference? 
A) Sn_MR_UDP and Sn_MR_TCP refer to different socket modes. Sn_MR_UDP is used for UDP connections, while Sn_MR_TCP is used for TCP connections. 

Q) What is the process for DHCP with W6100? 
A) The process for DHCP with W6100 involves initializing DHCP, running the DHCP process, and handling the DHCP callback functions. 

Q) Can you explain the callback functions used in DHCP? 
A) The callback functions used in DHCP include dhcpv4_assign, dhcpv4_update, and dhcpv4_conflict, which are responsible for retrieving and updating network information obtained from DHCP. 

Q) Thank you for answer. 
A) You're welcome. If you have any further questions or need assistance, feel free to ask."
3594,666,"The document version is 1.3
In this document, at +wsec = n = 64 (wpa2-aes +tkip secure)
When entering the command directly, 64 does not enter the command.Instead, 32 is 32, but there is no 32 in the document.
Is it a mode of wpa2-AES +TKIP Security?Can I check the settings with AT & V? Please refer to the link below.

[URL] https://forum.wiznet.io/t/wizfi210-security/667/2]","Q) Is it a mode of wpa2-AES +TKIP Security? Can I check the settings with AT & V?
A) Yes, it is a mode of WPA2-AES + TKIP security. You can check the settings with AT & V command. For more information, please refer to the link below.
[URL] https://forum.wiznet.io/t/wizfi210-security/667/2"
3595,6660,"1) socket.c ??Ã«Â³Â´Ã«Â©Â´ 
  - SOCK_IO_BLOCK
 - SOCK_IO_NONBLOCK

?ÂÃªÂ°ÂÃªÂ°? define ?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ??Ã«Â¬Â´Ã¬ÂÂ¨ ?Â©Ã«ÂÂ?Â¸Ã¬? ?ÂÃ«Â Â¤ Ã¬Â£Â¼Ã¬ÂÂ¤ ???ÂÃ«ÂÂ??

2) socket.c ??Ã«Â³Â´Ã«Â©Â´ 
 - int8_t setsockopt(uint8_t sn, sockopt_type sotype, void* arg)

?Â¨Ã¬ÂÂ?ÂÃ¬ÂÂ opt?Â¼Ã«ÂÂ ?Â¨Ã¬ÂÂ´ÃªÂ°? ?ÂÃ¬Â£Â¼ ?ÂÃ¬ÂÂ¤?ÂÃªÂ±Â° ÃªÂ°ÂÃ¬????Â¹Ã¬ÂÂ Ã«Â¬Â´Ã¬ÂÂ¨ ?Â½Ã¬ÂÂ ?Â¸Ãª??? 1. It is used to set whether the socket will operate as a NONBLOCK.
By default, it operates as Block.

2. OPTION.

Can you tell me why you ask this question? We are identifying the source for development.

I am currently trying to develop a product using a total of three W6100s on one board.

I think I need to modify the provided library ..

To do this, I think it is possible to correct it exactly by knowing how the provided source works.

I'm sorry if you've bothered you.","Q) ?ÂÃªÂ°ÂÃªÂ°? define ?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ??Ã«Â¬Â´Ã¬ÂÂ¨ ?Â©Ã«ÂÂ?Â¸Ã¬? ?ÂÃ«Â Â¤ Ã¬Â£Â¼Ã¬ÂÂ¤ ???ÂÃ«ÂÂ??
Q) ?Â¨Ã¬ÂÂ?ÂÃ¬ÂÂ opt?Â¼Ã«ÂÂ ?Â¨Ã¬ÂÂ´ÃªÂ°? ?ÂÃ¬Â£Â¼ ?ÂÃ¬ÂÂ¤?ÂÃªÂ±Â° ÃªÂ°ÂÃ¬????Â¹Ã¬ÂÂ Ã«Â¬Â´Ã¬ÂÂ¨ ?Â½Ã¬ÂÂ ?Â¸Ãª??? 
A) It is used to set whether the socket will operate as a NONBLOCK.
By default, it operates as Block. 

A) 1. It is used to set whether the socket will operate as a NONBLOCK. By default, it operates as Block.
2. OPTION. 

A) Can you tell me why you ask this question? We are identifying the source for development. I'm currently trying to develop a product using a total of three W6100s on one board. I think I need to modify the provided library. To do this, I think it is possible to correct it exactly by knowing how the provided source works. I'm sorry if you've bothered you."
3596,6662,"I have a problem, my HTTP server freezes after a few days of operation. I found that this is due to the fact that the state of the socket is not completely closed (FIN_WAIT (= 0x18)).
I work with W5500 on interrupts, so I can not once again interrogate and see the state of FIN_WAIT, to send comand CLOSED
maybe I skip interruption of disconnection on this so it all happens.
1) I can  not understand why the socket does not go into the CLOSED state?
2) what external event or internal could trigger such a change?
There are also some questions about the operation of the TCP server
1) In the LISTEN state, should a timeout and socket re-open occur? I guess that your server wants to close the socket after communication is over at its side, sends FIN packet to ""properly"" disconnect, and never receives FIN/ACK back from the client.

The solution is simple and ugly. You perform DISCON command, wait until it completes, and then perform CLOSE command - and the socket is freed. If remote client will send FIN/ACK back, or will try to talk to the socket, it will get RST packet - this is not a problem because your server is finished with the communicaton and this is in compliance to the TCP proto (if you care about a kind of broken communication process). Yes, rather you are right, I tested the server through a mobile phone, possibly due to a slow connection, the w5500  did not receive a response signal FIN.
 1) How to determine that a disconnect command has been completed?
As I wrote, I work through interrupts, and read the register **Sn_IR**

> *""Sn_IR (DISCON) Interrupt Thisis issued when FIN or FIN / ACK packet is received from a peer""*

I understand w5500 set this flag after the client answers FIN? [quote=""Maksim, post:3, topic:6662""]
I understand w5500 set this flag after the client answers FIN?
[/quote]
Yes.

[quote=""Maksim, post:1, topic:6662""]
In the LISTEN state, should a timeout and socket re-open occur?
[/quote]
No, W5500 keep LISTEN state until client is connected. [quote=""Maksim, post:3, topic:6662""]
I understand w5500 set this flag after the client answers FIN?
[/quote]

I suspect so.

After you send last byte to the client, you perform DISCON, wait until Sn_CR register clears (command was accepted) and then immediately perform CLOSE (and again wait for Sn_CR to become 0). And now you can reuse the socket. For such an event (client not to send the FIN packet) must not be called TIMEOUT?
> RTR 
> During  the  time  configured  by  RTR,  W5500  waits  forthe  peer  response  to  the packet  that  is  transmitted  by  Sn_CR(CONNECT,  DISCON,  CLOSE,  SEND,  SEND_MAC, SEND_KEEP  command).  If  the  peer  does  not  respondwithin  the  RTR  time,  W5500 retransmits the packet or issues timeout [quote=""Maksim, post:6, topic:6662""]
must not be called TIMEOUT
[/quote]

I think it must (I do not use interrupts in my implementations), but the depending on timeout set the socket may be hung for relatively long time, thus it is in server's interests to properly free socket as early as possible (properly = informing client that it has finished by sending FIN packet on DISCON). Oh, that?Âs great, since it fits my system well. This happens, rarely enough, so I?Âm not very scared that the server will free up a bit later, the main thing is that it would free up and not freeze.

The only strange thing is that I have this processing, but for some reason it doesn?Ât help = ( RTR = 200 and RCR = 3 so that it should be released quickly enough.

How I can this situation be emulated? Can I send SYN,FIN packages manually? Since there are only 8 sockets available on the W5500, your code will work better if you dispense with some of the formality. I monitor socket statuses and if one is hung in a non-productive state like ""FIN"" for longer than 250 ms, I force it to close immediately. First, we need to know why the client does not respond to the FIN packet. The client must send a FIN ACK in response to the FIN. If you do not respond to the FIN at all, the W5500 will timeout the FIN packet. But now no timeout occurs. If the client sends an ACK to the FIN and disconnects, you can use the keepalive function. This function sends a packet periodically. If there is no response from the peer, timeout occurs and the connection is disconnected. You can use the Keep alive function using the Sn_KPALVTR register. Your server (.114) appears to send the response header (HTTP/1.1 200 OK) after the response body (142 bytes). They should be in the opposite order. Afterwards your server starts to close the socket by sending (FIN/ACK). The client (.63) responds to the body or header with an ACK (you may have missed the other ACK that should've been there due to slow sampling on your WireShark machine; if so, that's the likely cause of the 'out of order' message.). Then the client sends a (FIN/ACK) to acknowledge the close socket request.

I'd reverse the order in which the response header and body are sent, and don't close the socket if you want to continue to use it . There seem to be generic logic mistake in how code behaves. Spurious retransmission @24 must not happen, and I am afraid it is W5500 driver instructs to send the data again for some reason. [quote=""Maksim, post:14, topic:6662""]
everything is correct with the order
[/quote]

Wireshark shows:
- client sends request for /GetPageVar.CGI
- server sends ACK
- server sends header HTTP/1.1 200 OK
- and immediately performs DISCON
- and only after DISCON sends the contents of 830 bytes.","Q) I have a problem, my HTTP server freezes after a few days of operation. I found that this is due to the fact that the state of the socket is not completely closed (FIN_WAIT (= 0x18)). I work with W5500 on interrupts, so I can not once again interrogate and see the state of FIN_WAIT, to send command CLOSED maybe I skip interruption of disconnection on this so it all happens. Why does the socket not go into the CLOSED state? What external event or internal could trigger such a change?
A) The solution is simple and ugly. You perform DISCON command, wait until it completes, and then perform CLOSE command - and the socket is freed. If remote client will send FIN/ACK back, or will try to talk to the socket, it will get RST packet - this is not a problem because your server is finished with the communication and this is in compliance to the TCP protocol (if you care about a kind of broken communication process). Yes, rather you are right, I tested the server through a mobile phone, possibly due to a slow connection, the W5500  did not receive a response signal FIN. To determine that a disconnect command has been completed, you can work through interrupts, and read the register Sn_IR. 

Q) In the LISTEN state, should a timeout and socket re-open occur?
A) No, W5500 keeps the LISTEN state until the client is connected. 

Q) For such an event (client not to send the FIN packet) must not be called TIMEOUT?
A) I think it must (I do not use interrupts in my implementations), but depending on timeout set the socket may be hung for a relatively long time, thus it is in the server's interests to properly free the socket as early as possible (properly = informing the client that it has finished by sending FIN packet on DISCON). 

Q) How can this situation be emulated? Can I send SYN, FIN packages manually?
A) Since there are only 8 sockets available on the W5500, your code will work better if you dispense with some of the formality. I monitor socket statuses, and if one is hung in a non-productive state like ""FIN"" for longer than 250 ms, I force it to close immediately. The client must send a FIN ACK in response to the FIN. If you do not respond to the FIN at all, the W5500 will timeout the FIN packet. But now no timeout occurs. If the client sends an ACK to the FIN and disconnects, you can use the keepalive function. This function sends a packet periodically. If there is no response from the peer, timeout occurs, and the connection is disconnected. 

Q) Your server (.114) appears to send the response header (HTTP/1.1 200 OK) after the response body (142 bytes). They should be in the opposite order. Afterwards your server starts to close the socket by sending (FIN/ACK). The client (.63) responds to the body or header with an ACK (you may have missed the other ACK that should've been there due to slow sampling on your WireShark machine; if so, that's the likely cause of the 'out of order' message.). Then the client sends a (FIN/ACK) to acknowledge the close socket request. I'd reverse the order in which the response header and body are sent, and don't close the socket if you want to continue to use it.
A) There seem to be generic logic mistakes in how the code behaves. Spurious retransmission @24 must not happen, and I am afraid it is W5500 driver instructs to send the data again for some reason."
3597,6664,"I would like to know if the w5500 is suitable for the Profinet protocol, if the MACRAW socket is used.  Does anyone have any experience of this as a solution?

Our intention is to use the w5500 for other communication protocols where its full TCP/IP stack will be used and I would like to understand if we could use the same platform for Profinet.

I have access to a full software Profinet stack that will be running on the host processor, which is why we'd only need the raw ethernet data for this particular implementation.

Thanks in advance for any insight, or potential issues you can highlight. Good question. I am looking to port some Profinet code to the W5500 (or W5300, which I believe will be somewhat faster, due to the parallel i/f - need to confirm). From this app note http://wizwiki.net/wiki/doku.php?id=products:w5500:application:pppoe recommended in another thread, it seems like it won't be too difficult. Even at 1ms/1KHz cyclic packet rate, it's a pretty light load.

FWIW, our host processor will be a fairly high-spec STM32. I seriously considered using its on-board MAC, but, for a few different reasons, I've come to the conclusion that leveraging the WizNet chip will probably be the better option overall. What made you decide against using the on-board MAC? Allocate the whole RX/TX space for the MACRAW socket 0. Remember that if you will not flush packets in time all incoming packets not fitting into the buffer's free space will be discarded. Did you ever find out if w5500 is suitable for Profinet?","Q) Did you ever find out if w5500 is suitable for Profinet? 
A) I would like to know if the w5500 is suitable for the Profinet protocol, if the MACRAW socket is used. Does anyone have any experience of this as a solution? I am looking to port some Profinet code to the W5500 (or W5300, which I believe will be somewhat faster, due to the parallel i/f - need to confirm). From this app note http://wizwiki.net/wiki/doku.php?id=products:w5500:application:pppoe recommended in another thread, it seems like it won't be too difficult. Even at 1ms/1KHz cyclic packet rate, it's a pretty light load."
3598,667,"The document version is 1.3
In this document, at +wsec = n = 64 (wpa2-aes +tkip secure)
When entering the command directly, 64 does not enter the command.Instead, 32 is 32, but there is no 32 in the document.
Is it a mode of wpa2-AES +TKIP Security?Can I check the settings with AT & V? V1.1.x.x version supports the following options
[Quote] Auto 0
None 1
Wep 2
Wpapsk 4
Wpa2psk 8
WPA 16
WPA2 32
[/Quote]

In the V1.2.X.X version, the following options have been added.
[Quote] wpa2psk_tkip 64 [/quote]

But you don't have to use the AT+WSEC command.
Please refer to the link below.

[URL] https://forum.wiznet.io/t/wizfi210-can- I-I-SET-at-wsec-64/658/2]","Q) Is it a mode of wpa2-AES +TKIP Security? Can I check the settings with AT & V?
A) Yes, it is a mode of wpa2-AES +TKIP Security. You can check the settings with AT & V in the V1.1.x.x version with the following options:
Auto 0
None 1
Wep 2
Wpapsk 4
Wpa2psk 8
WPA 16
WPA2 32

In the V1.2.X.X version, the option wpa2psk_tkip 64 has been added, so you don't have to use the AT+WSEC command. Please refer to the link below for more information:
[URL] https://forum.wiznet.io/t/wizfi210-can-I-I-SET-at-wsec-64/658/2"
3599,6670,"As a follow up to this, I've also read back the socket Tx buffer on the W5100S and have seen that the memory does in fact store the correct data. 

My process was:

1. WIZCHIP_READ_BUF() to read socket tx buffer -> view in debugger
2.  initialise new packet data buffer
3.  call sendto() function, passing the packet data buffer
4.  WIZCHIP_READ_BUF() to read socket tx buffer -> observe change in data in that buffer

So it seems the data is being written where it's being told...

When wizchip_send_data is called I can see where the data is being put in memory, which seems to be based on some calculations and a call to getSn_TxBASE(Sn).

I've looked the values for each socket:
* Socket 0: 0x4000 (txBase)
* Socket 1: 0x4400
* Socket 2: 0x4800
* Socket 3: 0x4A00

You'll notice that there is only 1KB between those memory locations, but in my initialisation sets all Tx and Rx buffers at 2KB!

So it seems that the chip is assuming the buffers are 2KB long, but the driver is treating them as if they are 1KB.

Funnily enough, if I send data to socket 2 (txBase+2*1KB), then send to socket 1 (txBase+1*1KB), I will see nonsense in the first packet and the first packet's data coming from the second packet:

* Send ""Sck2"" to socket 2 -> nonsense packet comes out
* Send ""Sck2"" to socket 1 -> ""Sck2"" comes out

Either the ioLibrary driver has an error in it, or I am missing an additional step to configure the socket Tx buffer size in the chip. I'm not near my computer right now, but I can send firmware later.

I know there is **supposed** to be 2kB of memory,  but there definitely is only 1kB between socket memories when the tx memory is written. I can literally see the memory locations it is trying to access and they are 1024 bytes apart!

So what I am seeing is the ioLibrary is storing the socket TX buffers only 1kB apart, but reading as if they are 2KB apart. This explains a few other issues I had been seeing with incorrect packet data. I had mistakenly thought socket 0 and socket 1 worked, but socket 1 was in fact just seeing what I had previously tried to write from socket 2.

I feel like I may have just missed some sort of configuration step because as you say this is not how it's supposed to be. Can you look at the w5100_init function I posted and let me know if I have missed anything? Or are there any other strange config options/defines required?

For now I have implemented a quick hacky fix which multiplies the socket tx memory offset by two so it stores the packet in the correct location for the chip to send from.

    uint32_t getSn_TxBASE(uint8_t sn)
    {
       int8_t  i;
    #if ( _WIZCHIP_IO_MODE_ == _WIZCHIP_IO_MODE_BUS_DIR_)
       uint32_t txbase = _W5100S_IO_BASE_ + _WIZCHIP_IO_TXBUF_;
    #else   
       uint32_t txbase = _WIZCHIP_IO_TXBUF_;
    #endif   
       for(i = 0; i < sn; i++)
          txbase += (getSn_TxMAX(i)<<1); // HACKY FIX: bit shift to work for 2KB memory sizes!
       return txbase;
    } Hi,

I've already done as much as I feel I can to resolve this myself... I spent an entire day troubleshooting this to find and understand the source of the problem before implementing a fix that I feel may not be necessary.

I would really appreciate some help from WIZnet to figure out how this problem happened and how to resolve it without implementing a hacky fix to the driver.

Thanks Still waiting on a real resolution for this!

I'm also apparently not getting the correct information back from my DNS request. I can see I am getting a packet received, but it contains no information. I'm thinking it could be a similar issue to this memory misalignment. (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) STILL waiting on a reply from WIZnet on this issue! Sorry,

[quote=""CraigTZ, post:7, topic:6670, full:true""]
Hi,

I?Âve already done as much as I feel I can to resolve this myself??I spent an entire day troubleshooting this to find and understand the source of the problem before implementing a fix that I feel may not be necessary.

I would really appreciate some help from WIZnet to figure out how this problem happened and how to resolve it without implementing a hacky fix to the driver.

Thanks
[/quote]
I thought you solved the problem because of this post.
In fact, I have experienced this situation.
I also debugged it like you did to make sure the data fits in buf, but the actual packet was sent with different data.
So i downloaded the latest version of iolibrary and created a new project, thus the same code worked.
I think there is a problem with your project configuration or interface.
So hope you like me too. Thanks Becky, it does appear there has been a fix issued at some point. 

If there isn't one already (I can't find one) perhaps it would be a good idea to maintain a public changelog and release notes to allow people to identify if their problems have been solved? Its difficult to know without this.

I also noted that there is possibly another error in the latest version: line 542 of dns.c makes a call to wizchip_close() function which does not exist.","Q) Can you look at the w5100_init function I posted and let me know if I have missed anything? Or are there any other strange config options/defines required?
A) Hi, I've already done as much as I feel I can to resolve this myself... I spent an entire day troubleshooting this to find and understand the source of the problem before implementing a fix that I feel may not be necessary. I would really appreciate some help from WIZnet to figure out how this problem happened and how to resolve it without implementing a hacky fix to the driver. Thanks. 

Q) If there isn't one already (I can't find one) perhaps it would be a good idea to maintain a public changelog and release notes to allow people to identify if their problems have been solved?
A) Becky, it does appear there has been a fix issued at some point. If there isn't one already (I can't find one) perhaps it would be a good idea to maintain a public changelog and release notes to allow people to identify if their problems have been solved? Its difficult to know without this. 

Q) I also noted that there is possibly another error in the latest version: line 542 of dns.c makes a call to wizchip_close() function which does not exist.
A) I also noted that there is possibly another error in the latest version: line 542 of dns.c makes a call to wizchip_close() function which does not exist."
3600,6671,"When I plug my etherten controller with the Wiznet ethernet port, it wont show up on the DHCP client list. When I plug in the ethernet cord, it turns on the green light, but the yellow light only comes on once every 20 seconds or so. Please let me know your environment, firmware, etc. Also, let me know what you mean by yellow light. Your description is so short that I can't guess the cause. Im in mexico with 1.4 mbps. I am using a TP Link router wr840n is the model.   We are using a raspberry pi to be the server and an Etherten by freetronics for our microcontrollers. The yellow light on the ethernet port on the ÃÂ·Etherten stays on and every 15 seconds, the green light blinks for a second. I think the firmware is raspberian. Does this help?","Q) When I plug my etherten controller with the Wiznet ethernet port, it wont show up on the DHCP client list. When I plug in the ethernet cord, it turns on the green light, but the yellow light only comes on once every 20 seconds or so. Please let me know your environment, firmware, etc. Also, let me know what you mean by yellow light. Your description is so short that I can't guess the cause. Does this help?
A) We are using a raspberry pi to be the server and an Etherten by freetronics for our microcontrollers. The yellow light on the ethernet port on the Etherten stays on and every 15 seconds, the green light blinks for a second. I think the firmware is Raspbian."
3601,6676,"Thanks @lawrence, I found the problem as follows:

When I use ""close"" command for closing TCP connection, the connection really closes but the server side do not figure it out (not only my app, even windows do not know). So when I try to make new connection using ""connect"" the server suddenly knows closing and opening connection in same time, so my app (using C# async) think that the connection is closed and throw an exception.
When I changed the command from ""close"" to ""disconnect"" it let server to know that the connection is closed so the problem solved (before I was used ""disconnect"" command after ""close"" command so it does not work correctly). You made it !!
Right, close command forces tcp connection close. that is why pc or app does not close normally.
Thank you for reply!","Q) When I use ""close"" command for closing TCP connection, the connection really closes but the server side do not figure it out. So when I try to make new connection using ""connect"" the server suddenly knows closing and opening connection in same time, so my app (using C# async) think that the connection is closed and throw an exception. When I changed the command from ""close"" to ""disconnect"" it let server to know that the connection is closed so the problem solved. You made it !!
Thank you for reply!
A) Right, close command forces tcp connection close. that is why pc or app does not close normally."
3602,668,"I'm using Wiz550io ..
In Wiz550i0
I wonder if there is a driver source.
If you are, please let me know where. [URL] https://forum.wiznet.io/t/w5500-raw- mode/566/1]
See. ÃªÂ´????ÂÃ­ÂÂ¼?Â°Ã¬ÂÂ¤ Ã¬Â½ÂÃ«ÂÂ??
[url]http://wizwiki.net/wiki/doku.php?id=products:w5500:application:ipraw[/url]
Ã«Â¥?Ã¬Â°Â¸Ã¬Â¡Â°?ÂÃ¬ÂÂ¸??","Q) I wonder if there is a driver source for Wiz550io. If so, could you please let me know where to find it?
A) You can find the driver source for Wiz550io at the following URL: [URL] https://forum.wiznet.io/t/w5500-raw-mode/566/1 and [URL] http://wizwiki.net/wiki/doku.php?id=products:w5500:application:ipraw"
3603,6680,"hello.
I modified the part you informed.

thank you thank you!","Q) hello. 
A) None."
3604,6682,"?ÂÃ£ÂÂ WiFi Transmission rate should be 150Mbps ...
Andrew questions .. Share .. :)
https://forum.wiznet.io/t/topic/6580

Serial UART has a speed of 2Mbps, but ... @Scott @irina_kim Oh I have confirmed it now.sorry. Please advise what information will be good to go to the dealer site.
@Scott @irina_kim

thank you I received a reply from the TME side.
It is said that the items you want to upload regardless of the number are possible.

I want to organize information based on the most important and valuable items,
Please give advice to the professional you are at the headquarters.

Answers I'll wait.

thank you
Lee Won Joon Dream. ?Â¼Ã«ÂÂ¨ Ã«Âª?ÃªÂ°?Ã¬Â§? ?ÂÃ­ÂÂ??Ã¬Â°Â¸ÃªÂ³Â ?Â´Ã¬ÂÂ ?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ«Â¦Â¬?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
PA?? CON Ã«Â²ÂÃ¬Â Â ?Â°Ã«Â¡Â ?Â¬Ã«Â¦Â¬?Â¤Ã«ÂÂ Dimensions Ã«Â¶?Ã«Â¶ÂÃ¬? ?Â¤Ã«Â¥Â´??Ã¬Â°Â¸ÃªÂ³Â ?Â´Ã¬Â£Â¼?Â¸Ã¬ÂÂ

?Â´Ã«ÂÂ¹ ?Â´Ã¬ÂÂ©?? wizwiki.net??datasheetÃ«Â¥?Ã¬Â°Â¸Ã¬Â¡Â°?ÂÃ¬ÂÂ´??
https://wizwiki.net/wiki/lib/exe/fetch.php/products:wizfi360:wizfi360ds:wizfi360_ds_v103_en.pdf

RoSH : RoSH
Protocol Supported:  802.11 b/g/n
Frequency:  2.4G ~ 2.5G
Interface Type: GPIO, I2C, SPI, UART
Data Rate: 150Mbps
Output Power: 19
Operating Supply Voltage: 3.0v ~ 3.6v  
Supply Current Transmitting: 230mA
Supply Current Receiving: 110mA
Minimum Operating Temperature: -40
Maximum Operating Temperature: +85
Dimensions: 24(L) x 16(W) x 3.2(H) (ÃÂ±0.1), (unit: mm) -> PA ÃªÂ¸Â°Ã¬? (CON?? ?Â¤Ã«Â¦Â)
Security:  WPA, WPA2
Antenna Connector Type:  PCB

?ÂµÃ«????ÂÃ«Â¬Â´ ??ÂÂ?Â¤Ã¬ÂÂ ??
?Â¤Ã¬ÂÂ??Ã¬ÂµÂÃ«???Ã«Â¹Â¨Ã«Â¦Â¬ ?ÂµÃ«??ÂÃ«Â¦Â´ÃªÂ»ÂÃ¬ÂÂ! Thank you so much for your answer.
I delivered it to the customer based on the content you informed: slight_smile: yes!Are you posting it on the dealer site?

If the information goes up later, please share the site link.

I think it's good to check together and think about what information you want to add together!: slight_smile: yes yes
We will share the link immediately when you update the dealership site!
Have a nice day ~","Q) WiFi Transmission rate should be 150Mbps.?
A) Data Rate: 150Mbps.

Q) Share.. :)
A) I delivered it to the customer based on the content you informed.

Q) Serial UART has a speed of 2Mbps, but ... @Scott @irina_kim Oh I have confirmed it now. Sorry. Please advise what information will be good to go to the dealer site. @Scott @irina_kim
A) [None]

Q) thank you I received a reply from the TME side. It is said that the items you want to upload regardless of the number are possible. I want to organize information based on the most important and valuable items, Please give advice to the professional you are at the headquarters. Answers I'll wait. thank you Lee Won Joon Dream. PA?? CON Ã«Â²ÂÃ¬Â Â ?Â°Ã«Â¡Â ?Â¬Ã«Â¦Â¬?Â¤Ã«ÂÂ Dimensions Ã«Â¶?Ã«Â¶ÂÃ¬? ?Â¤Ã«Â¥Â´??Ã¬Â°Â¸ÃªÂ³Â ?Â´Ã¬Â£Â¼?Â¸Ã¬ÂÂ ?Â´Ã«ÂÂ¹ ?Â´Ã¬ÂÂ©?? wizwiki.net??datasheetÃ«Â¥?Ã¬Â°Â¸Ã¬Â¡Â°?ÂÃ¬ÂÂ´??
https://wizwiki.net/wiki/lib/exe/fetch.php/products:wizfi360:wizfi360ds:wizfi360_ds_v103_en.pdf
A) [None]

Q) RoSH : RoSH Protocol Supported: 802.11 b/g/n Frequency: 2.4G ~ 2.5G Interface Type: GPIO, I2C, SPI, UART Output Power: 19 Operating Supply Voltage: 3.0v ~ 3.6v Supply Current Transmitting: 230mA Supply Current Receiving: 110mA Minimum Operating Temperature: -40 Maximum Operating Temperature: +85 Dimensions: 24(L) x 16(W) x 3.2(H) (ÃÂ±0.1), (unit: mm) -> PA ÃªÂ¸Â°Ã¬? (CON?? ?Â¤Ã«Â¦Â) Security: WPA, WPA2 Antenna Connector Type: PCB
A) [None]

Q) ?ÂµÃ«????ÂÃ«Â¬Â´ ??ÂÂ?Â¤Ã¬ÂÂ ??
?Â¤Ã¬ÂÂ??Ã¬ÂµÂÃ«???Ã«Â¹Â¨Ã«Â¦Â¬ ?ÂµÃ«??ÂÃ«Â¦Â´ÃªÂ»ÂÃ¬ÂÂ!
A) [None]

Q) Thank you so much for your answer. I delivered it to the customer based on the content you informed: slight_smile: yes! Are you posting it on the dealer site? If the information goes up later, please share the site link. I think it's good to check together and think about what information you want to add together!: slight_smile: yes yes We will share the link immediately when you update the dealership site! Have a nice day ~
A) [None]"
3605,6683,"We have a few instances of W7500P-S2E crashing during the operating.  The chip was working fine for a few days, then lost its connection.  Neither from Ethernet side (port 5000 and 50001) nor from serial port side can access the chip.  The only way to bring the connection back is using Wiznet ISP tool to reload the code and then use WizMAC tool to set the IP.

Would you have any suggestion of debugging this issue? Dear @cosmos

It's a strange symptom. 

Flash memory inside W7500P seems to be damaged during operation.

Is the power supply stable? Or is there an external electrical shock?

Thank you Hi Scott,

This was tested in the lab environment.  It happened on 3, out of ~30, W7500P we were using so far.  Our circuit is very similar to your WIZ750SR.

Is there a way to reset the W7500P to the factory default instead of reloading the code?

Best Regards,

Cosmos Hi Scott,

Do you have any update of this? Will the operation such as data streaming cause this issue?  Two chips show data clog issue during streaming, but the issue of one chip went away after reflash the code.

Best Regards,

Cosmos If sending our schematic to you, could you help us to review the design for any mistake?

Best Regards,

Cosmos I have a very similar issue. 300 boards, assembled with W7500-S2E with preprogrammed firmware 1.1.0 and all updated to 1.2.4, were tested successfully and then stocked in our warehouse for a couple of weeks. Then, 20 boards were turned on for testing. A couple of them were not communicating to any software (including ConfigTool)... dead except the blinking leds on the RJ45 plug. I'm very worried. Dear Scott

We do face this issue of memory corruption. Only doing ISP solves in 4 units.


V.Nagarajan And please, Wiznet team, help us! Thanks Nagarajan. 
How it happened to you to corrupt the Flash?
It looks like the bootloader (not the latest version, but all the previous), any time the MCU is started, the first 256 bytes of Flash are deleted and then written with the IRQ table of the application. If something goes wrong (i.e. supply glitch that executes up to the Flash delete, and no more), the Flash is not rewritten and the MCU is dead. We may be wrong with source code understanding, but this is what we understood. And it explains why the first 256 bytes gets corrupted. Hi Tizio,

Thank you very much for sharing this information.  Would you know the latest bootloader version number and the release date?

Best Regards,

Cosmos The Copy_Interrupt_VectorTable function, first erases the first 256 bytes of Flash, then it copies the IRQ from application to the just erased sector.
1) Flash memory will be destroyed after 10000 cycles
2) corruption occurs
A savvy developer would have compared the current IRQ with the APP one, erasing and rewriting only if any difference was found (i.e. after a FW update)... Hi Wiznet Team,

Could you give us some comments or suggestions regarding to this?  Should we reflash all our W7500P to the latest version (V1.3.3?).  Or just keep it as V1.2.4 Stable?","Q) Would you have any suggestion of debugging this issue?
A) It's a strange symptom. Flash memory inside W7500P seems to be damaged during operation. Is the power supply stable? Or is there an external electrical shock?

Q) Is there a way to reset the W7500P to the factory default instead of reloading the code?
A) If sending our schematic to you, could you help us to review the design for any mistake?

Q) Do you have any update of this? Will the operation such as data streaming cause this issue? 
A) We do face this issue of memory corruption. Only doing ISP solves in 4 units.

Q) And please, Wiznet team, help us! Thanks Nagarajan. 
A) The Copy_Interrupt_VectorTable function, first erases the first 256 bytes of Flash, then it copies the IRQ from application to the just erased sector. 1) Flash memory will be destroyed after 10000 cycles 2) corruption occurs A savvy developer would have compared the current IRQ with the APP one, erasing and rewriting only if any difference was found (i.e. after a FW update)...

A) Hi Scott, This was tested in the lab environment. It happened on 3, out of ~30, W7500P we were using so far. Our circuit is very similar to your WIZ750SR.

A) V.Nagarajan

A) Hi Tizio, Thank you very much for sharing this information. Would you know the latest bootloader version number and the release date? Best Regards, Cosmos

A) Hi Scott, If something goes wrong (i.e. supply glitch that executes up to the Flash delete, and no more), the Flash is not rewritten and the MCU is dead. We may be wrong with source code understanding, but this is what we understood. And it explains why the first 256 bytes gets corrupted.

A) Hi Wiznet Team, Could you give us some comments or suggestions regarding to this? Should we reflash all our W7500P to the latest version (V1.3.3?). Or just keep it as V1.2.4 Stable?"
3606,6685,"The previous abnormal socket Close seems to transmit RST packets from the W5500.
It is a good idea to try the Port Number of the W5500 from 5000 to 5001. If you look at the Wireshark packet, 192.168.1.4 is transmitting SYN Packet to 192.168.1.1.
192.168.1.4 is Client
192.168.1.1 Is Server (W5500) correct?
Please check the IP address once more. If you send RST Packet in Server,
This is because there is no SOCKET waiting in the server.
Or the IP conflict can send the other side with a response.
Send ping requests to each IP without all the terminals.
Please also check if you are using Mac Address duplicate.","Q) Is 192.168.1.1 the correct IP address for the Server (W5500)? 
A) The previous abnormal socket Close seems to transmit RST packets from the W5500. It is a good idea to try the Port Number of the W5500 from 5000 to 5001. If you look at the Wireshark packet, 192.168.1.4 is transmitting SYN Packet to 192.168.1.1."
3607,6689,"W5100 TCP/IP socket client is created and used.
The socket server was made on the PC
One W5100 and TCP/IP communication are good.

However, if two W5100s are attached to one server, they do abnormal behavior.
This is the characteristic of the W5100 chip
Or I wonder if you should use another chip. TCP communication is the principle of 1: 1 communication.
Therefore, if you want to communicate with PCs and multiple clients,
Create multiple Servers, or
1: N Please use UDP communication that can be communicated.

In the case of TCP communication, you can create multiple Servers by changing the port with the same IP. There was no problem when I used the WIZ750SR in the same way.
For example, set the wiz750sr to a client
When we were attached to several WIZ750SRs and our server, we worked without any problems.
So, when you do the same structure, the W5100 will have this problem and please contact us.
Our side server assigns a new socket to the client when the client connects and the Accept occurs. Sorry, I solved it.
Thank you for quick response. Can you tell me how you solved it?
The next customer response seems to be helpful. Our server side was wrong.
I was mistaken.
As described above, our socket server allocates sockets every time it is client Accept.So I connect with a number of clients and manage it. thank you.","Q) Can you tell me how you solved it?
A) As described above, our socket server allocates sockets every time it is client Accept. So I connect with a number of clients and manage it. Thank you."
3608,669,"Hi all,

Wiznet Distributor Rhydolabz is not helping me. The issue is that on 22 Feb 2014 i had ordered 5 qty of WIZ108SR from them. I received them on time but didn't check whether all were working or not. I took 3 pieces and plugged them with my device and started working. But today on 11-03-2014 on of WIZ108SR stopped working. So i took 1 more device from my stock and found out that instead of WIZ108 it was WIZ107, the distributor now refuses to replace that module. I didn't ordered that module at all so I am entitled for replacement. Next issue is that i had 1 more module with me which i plugged it in my instrument but that module failed to operate. WIZ config tool is not able to detect it from the network. I dont know why ?

Can WIZNET from KR help us or should we simply stop using WIZNET products.. Dear Sir,

We feel bad making you inconvenient.
Wiznet Hong Kong is responsible for that matter and he is taking care of Distributor Rhydolabz.
To solve this serious, Wiznet HQ will contact Wiznet Hong Kong.

Thanks,

Wizet HQ","Q) Can WIZNET from KR help us or should we simply stop using WIZNET products?
A) Wiznet Hong Kong is responsible for that matter and is taking care of Distributor Rhydolabz. Wiznet HQ will contact Wiznet Hong Kong to solve this issue."
3609,6697,"1. November 8, 2019 (Fri)
WIZ550S2E firmware version inquiry
Although you have been receiving technical support as a Ticket, you wanted a phone call
Delivered to RENA pro

2. November 8, 2019 (Fri)
Inquiries that you can use the WIZ830MJ 8bit as IN/OUT
(= Inquiries whether you support GPIO)
The team leader said that it was impossible because it was connected to the team leader

3. November 11, 2019 (Fri)
WIZ550S2E MODBUS Firmware Inquiry

4. November 14, 2019 (Thursday)
WIZ750IO Inquiry if it is possible to support technical support
Recommended WIZ750SR with firmware

5. November 14, 2019 (Thu)
A college student who had previously contacted
It is not possible to connect with the server, so how to set up IP in Arduino code, etc.

6. November 15, 2019 (Fri)
W7500S2E-R1
When the PC is client, the PCP Server module is not connected.
Inquiries that it is related to the firmware version
Inducing to write in the forum

7. November 15, 2019 (Fri)
Inquiries that LINK LED is an LED indicating LED in W7500S2E-R1
Respond to TCP CONECTION with PHY LINK LED
Like the Wiz550s2e, I want a product that shows the TCP connection status as an LED.
I was worried about the price, so I introduced the deputy general manager

8. November 22, 2019 (Fri)
TCP is not connected to W7500S2E-R1
By changing the transmission mode
It is not transmitted in At Command Mode November 13, 2019 -ID (Director Lee Sang -mok) -This visited on November 13
Implementing the Wizfi360 and the W5500 in one board,
- issue
  -When turning down while Restore during Wizfi360 at Command, Stamac is changed to FF: FF: FF: FF: FF: FF
  -It takes a long time if the W5500 (TCP Client) is connected to TCP Server and exits and reconnects ...
 - Solutions
    -Wizfi360
      -Mac -related hidden command completed MAC input and decide to check if the XXX_def at Commands using Flash have the same symptoms.
      -If you use Auto Connection, if it is not connected within 20 seconds, it will be changed to Data Transparent Mode.
    -W5500
      -In the conference room, I did a normal operation, and I checked the herb that the company was using.
That's why the W5500's PHY Configuration Register to fix the value instead of Auto Negotiation.
      -I haven't received feedback on him yet","A) Although you have been receiving technical support as a Ticket, you wanted a phone call delivered to RENA pro. The team leader said that it was impossible because it was connected to the team leader. Recommended WIZ750SR with firmware. Like the Wiz550s2e, I want a product that shows the TCP connection status as an LED. Implementing the Wizfi360 and the W5500 in one board. In the conference room, I did a normal operation, and I checked the herb that the company was using. That's why the W5500's PHY Configuration Register to fix the value instead of Auto Negotiation.

Q) WIZ550S2E firmware version inquiry?
Q) Inquiries that you can use the WIZ830MJ 8bit as IN/OUT?
Q) WIZ550S2E MODBUS Firmware Inquiry?
Q) WIZ750IO Inquiry if it is possible to support technical support?
Q) A college student who had previously contacted, It is not possible to connect with the server, so how to set up IP in Arduino code, etc.?
Q) When the PC is client, the PCP Server module is not connected. Inquiries that it is related to the firmware version?
Q) Inquiries that LINK LED is an LED indicating LED in W7500S2E-R1?"
3610,670,"Hi,

I still operate the module in AP Client Multibridge Mode. This is our only option, since we don't want to have another NAT between local LAN and WAN to be 100% tranparent.

Now with this mode we see the following problem:
If we operate a couple of devices in a wireless segment without individual naming of the modules AP SSID there will be a lot of sub networks with the same name.

Is there a possibilty to switch of the AP function of the module but keeping the AP Client Mutlibridge function.
Otherwise there may be two workarounds:

- Switch on the 'hidden SSID' function, this I have been told does only suppress the naming in Windows OPS
- Assign an individual SSID for each module, but this may confuse the customer even more, as he doesn't expect an AP   
  function for the device. Hi

If you did not change WizFi630's mode setting, you can possible to switch of the WizFi630's function.
 - Can switch on the ""hidden SSID"" function.
 - I don't understand your exact intend.

Thanks Hi,

my intend is to have the module working in AP CLient Multibridge mode but with the possibility to switch off the modules own AP function. Hi 

Refer to this thread.
https://forum.wiznet.io/t/problem-with-order-of-serial-commands/732/6 Has this been solved yet? I have exactly the same issue.","Q) Is there a possibilty to switch of the AP function of the module but keeping the AP Client Mutlibridge function?
Q) Has this been solved yet? I have exactly the same issue.
A) If you did not change WizFi630's mode setting, you can possible to switch off the WizFi630's function.
A) I don't understand your exact intend.
A) Refer to this thread. https://forum.wiznet.io/t/problem-with-order-of-serial-commands/732/6"
3611,6702,"Terrific!Now you can return to our conversation at any time [the bookmark rider in your profile] (https://forum.wiznet.io/u/rknetsch/activity/bookmarks).Simply go to your profile picture at the top right &#8599;

As a night: Can you share one of these links with me?Answer with ** a link on your own line **, and it is automatically expanded into a lifting, short summary.

To copy a link, tap and keep on mobile, or click on the right with your mouse:

<https://de.wikipedia.org/wiki/antiwitz>
<https://de.wikipedia.org/wiki/tetraphobie>
<https://de.wikipedia.org/wiki/gegilos> Hello @rknetsch!I just wanted to get in touch again because I haven't had anything from you for a long time.

- To continue, I answer at any time.

- If you want to jump over this step, answer with 'overprinting`.

- To start from the front, answer with 'Start Tutorial`.

If you prefer not to write to me, that's okay too.I am a robot.You won't hurt my feelings.: SOB:","I'm sorry, I couldn't identify any questions in the given text. Therefore, I don't have a specific response."
3612,6703,"hello?

It is linked to the STM32F103 product.After PCB production

I am writing a program.

Is there a way to make sure that communication with the Wizfi360 model is right?

For example

If you send a command from STM32F103 to Wizfi360, Wizfi360

The version or the current state is like this

I wonder how to check if the communication is set properly. ","Q) Is there a way to make sure that communication with the Wizfi360 model is right?
A) I wonder how to check if the communication is set properly."
3613,6704,"Hi

Could yoy help me to resolve issue with max voltage on IO pins? For both - input and output?
I'm new in microcontrollers programing. I use WizWiki-w7500. 

On the Document Wiki ""[Electrical Characteristics](http://wizwiki.net/wiki/doku.php/products:w7500:overview:electric)"" page -
max input voltage on IO pins is **5V**, but in the ""[W7500x Data Sheet](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w7500:w7500x_ds_v108_20181017_.pdf)"" - Input voltage on IO pins **3.6V**  (see ""5.2 Voltage Characteristics"" on the page#31)
1) Where is true?
2) The same issue for other boards useing 7500x chips: could I apply your answer to question#1 to all other boards using this chip?

Thank you. 
Sorry for bad my English) Hi, YegorS.

I'm sorry to mislead you.
W7500x can accept both 3.3V and 5V. but if you use 5V level, you can't use ADC.
So i recommend you would use 3.3V level.(Not recommend using Max voltage)
Web page`s information will be changed. 

I could not understand your second question.
If you follow datasheet`s characteristic, all W7500X chips work same under same electrical condition.

Please ask again, if my answer is not sufficient.

Thank you. ADC is not available even at 3.3v level.

Thanks. Thank you for fast response.

Looks like it is mistake in my question: 
I use [WIZwiki-W7500](http://wizwiki.net/wiki/doku.php/products:wizwiki_w7500:start) **development board**, not just 7500 MCU. I.e. it is development board.
In wiki [specified](http://wizwiki.net/wiki/doku.php/products:wizwiki_w7500:start) this board

> compatible with Arduino Shields

As I know, Arduino uses 5V IO.
So, does WIZwiki-W7500 dev board also uses 5v IO?
. (post withdrawn by author, will be automatically deleted in 24 hours unless flagged)","Q) Could you help me to resolve the issue with the max voltage on IO pins for both input and output? I'm new in microcontrollers programming. I use WizWiki-w7500.
1) Where is true?
2) The same issue for other boards using 7500x chips: could I apply your answer to question#1 to all other boards using this chip?
A) I'm sorry to mislead you. W7500x can accept both 3.3V and 5V, but if you use 5V level, you can't use ADC. So, I recommend you use 3.3V level. The web page's information will be changed. If you follow the datasheet's characteristics, all W7500X chips work the same under the same electrical condition. However, ADC is not available even at 3.3V level.

Q) Looks like it is a mistake in my question: I use WIZwiki-W7500 development board, not just the 7500 MCU, i.e. it is a development board. In the wiki specified this board.
As I know, Arduino uses 5V IO. So, does the WIZwiki-W7500 dev board also use 5V IO?
A) As the WIZwiki-W7500 is compatible with Arduino Shields, it also uses 5V IO."
3614,671,"hello.W5100 user.

When there are several devices equipped with the W5100, to control on the PC,
A large amount of LAN cable must be connected.
Instead, instead of this method, the LAN cable on the PC without Hub is connected to port 1, and
The cable of the LAN port 2 is connected to port 2, and Port 2 of device 2
Connected to port 1 .......

If you use this Daisy Chain, you can use only one LAN cable, so it's easy to connect.
Each device is input from port 1 and is sent to port 2 unless it is your own IP.
I wonder if this is possible in Ethernet communication.

Let me know how. hello.

To use it in the way you mention, you will need two LANPOs per device.

However, in the case of the W5100, only one PHY is one, so only one LAN port is available.

thank you Thank you very much for answering.

As mentioned above, is it possible to use two W5100 and two LAN ports?
If you check all packets coming from the input channel in the CPU, if you are not self -IP,
Do you mean you have to send it?

Can the W5100 deliver packets of IP other than their IP to the CPU?

Is there any way to bypass itself without the load consumption of the CPU?
CPUs only receive their own IP data and other IP data can be by hardware.
I hope there is a way.

Please explain more. Even if you use two, the W5100 does not support the switching function,
To support this, a special method is required and difficult to implement (software processing)

In general, it is implemented in the way you mentioned using Ethernet switch chip.","Q) If you use this Daisy Chain, you can use only one LAN cable, so it's easy to connect. Each device is input from port 1 and is sent to port 2 unless it is your own IP. I wonder if this is possible in Ethernet communication.
Q) As mentioned above, is it possible to use two W5100 and two LAN ports? If you check all packets coming from the input channel in the CPU, if you are not self-IP, do you mean you have to send it? Can the W5100 deliver packets of IP other than their IP to the CPU? Is there any way to bypass itself without the load consumption of the CPU?
A) To use it in the way you mention, you will need two LAN ports per device. However, in the case of the W5100, only one PHY is one, so only one LAN port is available. Even if you use two, the W5100 does not support the switching function. To support this, a special method is required and difficult to implement (software processing). In general, it is implemented in the way you mentioned using an Ethernet switch chip."
3615,6718,"im using wiz5500se2 board with my code. Im using loopback program from example. Its work correctly. But if im disconnect ethernet cable manualy tcp program is waiting  PHYStatus_Check after connected ethernet cable led is work but socket connection is not working. i give win error 10061 or 10062 . When im resetting my board program is working.
Second question how can i use watchdog In TCP communication, if there is no response for a certain time, a timeout occurs and the connection is lost. How long have you unplugged the ethernet cable? You can delay the timeout by modifying the firmware.

And we not provide watchdog code. you can add watchdog code in to this project(https://github.com/Wiznet/WIZ550S2E). Hi~ 
Error 10061 indicates no connection could be made because the target computer actively refused it. The most common cause is a  misconfigured server, full server, firewall issue or incorrect Port specified by the client.","Q) Second question how can i use watchdog In TCP communication, if there is no response for a certain time, a timeout occurs and the connection is lost. How long have you unplugged the ethernet cable? You can delay the timeout by modifying the firmware.

A) Unfortunately, we do not provide watchdog code. You can add watchdog code into this project (https://github.com/Wiznet/WIZ550S2E).

Q) Hi~
A) Error 10061 indicates no connection could be made because the target computer actively refused it. The most common cause is a misconfigured server, full server, firewall issue, or incorrect Port specified by the client."
3616,672,"I have a network with 6 W5100s set as follows:

netmask for everything is 255.255.255.0

10.0.1.21, sends packets to
10.0.1.101
10.0.1.102

and
10.0.2.21, sends packets to
10.0.2.103
10.0.2.104

These should be two independent IP subnets, though they share the same physical ethernet.

However, if 10.0.1.21 sends a broadcast to 10.0.1.255, it is received not only by 10.0.1.101 and 102, 
but also by 10.0.2.21 !   (I have not checked on 103 and 104).

Is this a bug or does someone know why this is not being filtered out by the netmask on 10.0.2.21?

thanks! Hi,
I will test to receive broadcast packet as same  your situation and then let you know the test result. 

Thank you. Hi-

I have done more testing and have more info, as the problem seems to only occur under certain conditions:

Setup is netmask 255.255.255.0 on all devices (all W5100)

10.0.1.21 sends direct UDP data to 10.0.1.101 and 10.0.1.102
also sometimes it sends broadcasts to 255.255.255.255 and sometimes only to 10.0.1.255

if another W5100, address 10.0.2.21 is listening for UDP packets on same port, it sees the 255.255.255.255 broadcasts but not the 10.0.1.255 broadcast, and this is correct.  10.0.2.21 is also sending direct packets to two other W5100, 10.0.2.103 and 10.0.2.104 (these only listen for packets and I think not relevant).  


However, if 10.0.2.21 now sends a broadcast to 10.0.2.255, then it starts receiving broadcasts for 10.0.1.255!  it seems like sending a broadcast packet breaks the incoming filter.

if need more info let me know, thanks! Hi, Mickle.

I'm sorry that I forgot your problem.

How about your problem.
Can you tell me your status?","Q) Is this a bug or does someone know why this is not being filtered out by the netmask on 10.0.2.21?
Q) How about your problem. Can you tell me your status? 
A) I will test to receive broadcast packet as same your situation and then let you know the test result. 
A) I have done more testing and have more info, as the problem seems to only occur under certain conditions: 
A) Setup is netmask 255.255.255.0 on all devices (all W5100) 
A) 10.0.1.21 sends direct UDP data to 10.0.1.101 and 10.0.1.102 also sometimes it sends broadcasts to 255.255.255.255 and sometimes only to 10.0.1.255 
A) if another W5100, address 10.0.2.21 is listening for UDP packets on the same port, it sees the 255.255.255.255 broadcasts but not the 10.0.1.255 broadcast, and this is correct. 10.0.2.21 is also sending direct packets to two other W5100, 10.0.2.103 and 10.0.2.104 (these only listen for packets and I think not relevant). However, if 10.0.2.21 now sends a broadcast to 10.0.2.255, then it starts receiving broadcasts for 10.0.1.255! it seems like sending a broadcast packet breaks the incoming filter. 
A) if need more info let me know, thanks!"
3617,6722,"Hello,

I have a wiz820io which I`m using with conjunction with an Arduino mega 2560 and the Arduino Ethernet Library.

The program on the board consistently keeps sending requests to a PC. The current behavior is such that if the PC is disconnected in the beginning when the board is turned on, the endPacket() function of the Ethernet library retries the transmission for 8 times by default and throws a timeout after 1600ms(Because of not getting the ARP response/dest MAC address) which stops the program . If the PC is present then the MAC address is saved in SN_DHAR register and the programs keeps running flawlessly(theoretically) even if the PC is disconnected from the network .

However , there are random occurances where the timeout occurs and the program stops, maybe once a day if I keep it running continously. Please correct me if I`m wrong but since the destination MAC address is already saved in the Sn_DHAR register, there should be no random re-try of ARP requests that can cause endPacket to timeout right?If I`m not wrong, UDP send only retries the ARP if the IP or the port of the destination has changed from the previous time right? 

Even if it tries ARP again, since the PC is still connected to the network it should be able to get the MAC address again and not fail with the UDP send. I can`t seem to figure out a reason for random timeouts like this. Anything on the Network side that can make this happen to the module?

Please can someone explain a possible reasoning for this? [quote=""ashuajay, post:1, topic:6722""]
Please correct me if I `m wrong but since the destination MAC address is already saved in the Sn_DHAR register, there should be no random re-try of ARP requests that can cause endPacket to timeout right?`
[/quote]
The board has once obtained the MAC address through ARP, and if the destination IP has never been changed and the board has not been rebooted, then the board does not send ARP.

[quote=""ashuajay, post:1, topic:6722""]
UDP send only retries the ARP if the IP or the port of the destination has changed from the previous time right?
[/quote]
Yes.

To summarize your situation, you are sending a UDP send. Occasionally, the PC is disconnected, but since WIZ850io first obtained the MAC address through ARP, it is correct to send a UDP, but sometimes it sends out arp and timeout occurs. Even if the PC is connected.
is it right?
This is not a normal situation. I think there will be an issue of whether the board is rebooted and the board is not connected.","Q) Please can someone explain a possible reasoning for this?
Q) Please correct me if I `m wrong but since the destination MAC address is already saved in the Sn_DHAR register, there should be no random re-try of ARP requests that can cause endPacket to timeout right?
Q) UDP send only retries the ARP if the IP or the port of the destination has changed from the previous time right?

A) The board has once obtained the MAC address through ARP, and if the destination IP has never been changed and the board has not been rebooted, then the board does not send ARP. 
A) Yes. 
A) To summarize your situation, you are sending a UDP send. Occasionally, the PC is disconnected, but since WIZ850io first obtained the MAC address through ARP, it is correct to send a UDP, but sometimes it sends out arp and timeout occurs. Even if the PC is connected. It seems there will be an issue of whether the board is rebooted and the board is not connected."
3618,6726,"HI, G_Johanson.

In the code, Subnet mask is 255.255.0.0. This is Class B network.
If you want to use (192.168.X.X) IP address, Subnet mask must be set 255.255.255.0

And Did you set different IP address each W5500?
The IP address and MAC address must be different for each W5500 chip.

If the problem is not resolved, please contact us again.
Thank you. Hi dkay! 
Thanks for the reply. 
I will change the subnet and report back. I do have a different IP and MAC address for each. 
This morning I had 2/3 of the ones on my desk not work so this is a duplicatable issue. :slightly_smiling_face:


Thanks!
Gary Hi dkay, 
I did a test with the 255.255.255.0 subnet and one of them did not start up (same issue). 
Is there anything else I should look out for?

Thanks,
Gary Just connect one chip which did not work.
If this work, your network information is wrong.

Did you check IP range?
You must fix first, second and third IP address value.
For example, communication is available in 192.168.1.1 ~ 192.168.1.255

If you know this thing, change the 4th IP value.
There may be equipment with the same IP.

Thank you. Loop means while in C.
In the Client code, the loop function is empty.
Function ""StartMoving"" is used once in setup function.
Is it right operation you intended?
If you want to use your operation repeatably, you must design loop function correctly.

Also, I think ""StartMoving"" function is worked before ""Ethernet.begin"".
And after ""Ethernet.begin"",  there is no operation about network communication.
After setting the network information, try to connect to the TCP server

Here is a reference code for Telnet client,
https://www.arduino.cc/en/Tutorial/TelnetClient

Thank you. Hi Dkay, 

I have tried it with the example code and a simple crossover cable from one to another. The same issue persists. I have come to the realization that the power-up cycle on this shield is really the issue. I had provisions in my main Arduino project to send a hard reset to other Arduinos so that is what I have done. I have added a wire that just after power up, it is dragged low for some milliseconds and then disconnected. This resolves the issue. I felt this was avoidable earlier on but it proves to be the fastest solution. I really appreciate your help along the way and I hope that any others that experience this issue can read and perhaps add to this if it is solved another way.  

Thanks again!
Gary","Q) Did you set different IP address each W5500? The IP address and MAC address must be different for each W5500 chip.
A) The IP address and MAC address must be different for each W5500 chip. 

Q) Is there anything else I should look out for?
A) Just connect one chip which did not work. If this work, your network information is wrong. Did you check IP range? You must fix first, second and third IP address value. For example, communication is available in 192.168.1.1 ~ 192.168.1.255. If you know this thing, change the 4th IP value. There may be equipment with the same IP. 

Q) Is it right operation you intended?
A) Loop means while in C. In the Client code, the loop function is empty. Function ""StartMoving"" is used once in setup function. If you want to use your operation repeatably, you must design loop function correctly. Also, I think ""StartMoving"" function is worked before ""Ethernet.begin"". And after ""Ethernet.begin"", there is no operation about network communication. After setting the network information, try to connect to the TCP server. 

Q) I have come to the realization that the power-up cycle on this shield is really the issue. Is there anything else I should look out for?
A) I have added a wire that just after power up, it is dragged low for some milliseconds and then disconnected. This resolves the issue. I felt this was avoidable earlier on but it proves to be the fastest solution. I really appreciate your help along the way and I hope that any others that experience this issue can read and perhaps add to this if it is solved another way. Thanks again!"
3619,6728,"KT IOT ?Â°ÃªÂ²Â°???ÂÃ«ÂÂ ?Â¨ÃªÂ³Â?ÂÃ¬ÂÂ 
WizFi310 Version 1.0.3.3 (WIZnet Co.Ltd)  
AT+WSET=0,rnd  [OK]  
AT+WSEC=0,,apm_7700  [OK]  
AT+WNET=1  [OK]  
AT+WJOIN  
  [Link-Up Event]    IP Addr    : 192.168.5.42  
  Gateway    : 192.168.5.1  [OK]  
AT+MQTTSET=,,,30,0  [OK]  
AT+MQTTKTSET=OPEN_MQTT_001PTL001_1000008030,WizFi310ID2537,WizFiPw2537   [ERROR: INVALID INPUT]  
?ÂÃ¬? ÃªÂ°ÂÃ¬? ?ÂÃ«ÂÂ¬ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ«ÂÂ???Â´Ã«ÂÂ»ÃªÂ²??Â´Ã¬ÂÂ¼ ?Â¤Ã¬ÂÂ ?Â¨ÃªÂ³ÂÃ«Â¡??ÂÃ¬ÂÂ´ ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ«ÂÂ??.

?ÂµÃ«? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? hello
We replyed through the requested agency.
Please check the link below

https://kaizen8501.tistory.com/124","Q) KT IOT ?Â°ÃªÂ²Â°???ÂÃ«ÂÂ ?Â¨ÃªÂ³Â?ÂÃ¬ÂÂ
A) This seems to be a technical question about the KT IOT service.

Q) WizFi310 Version 1.0.3.3 (WIZnet Co.Ltd)  
AT+WSET=0,rnd  [OK]  
AT+WSEC=0,,apm_7700  [OK]  
AT+WNET=1  [OK]  
AT+WJOIN  
  [Link-Up Event]    IP Addr    : 192.168.5.42  
  Gateway    : 192.168.5.1  [OK]  
AT+MQTTSET=,,,30,0  [OK]  
AT+MQTTKTSET=OPEN_MQTT_001PTL001_1000008030,WizFi310ID2537,WizFiPw2537   [ERROR: INVALID INPUT]
A) These are the commands and responses related to setting up the WizFi310 module. The last command AT+MQTTKTSET returned an error due to invalid input.

Q) ?ÂÃ¬? ÃªÂ°ÂÃ¬? ?ÂÃ«ÂÂ¬ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ«ÂÂ???Â´Ã«ÂÂ»ÃªÂ²??Â´Ã¬ÂÂ¼ ?Â¤Ã¬ÂÂ ?Â¨ÃªÂ³ÂÃ«Â¡??ÂÃ¬ÂÂ´ ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ«ÂÂ??.
A) This paragraph does not contain a clear question or answer, it seems to be a non-response paragraph.

Q) ?ÂµÃ«? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? hello
A) This does not constitute a clear question. It seems to be a non-response paragraph, possibly including a greeting. 

Non-response:
We replied through the requested agency.
Please check the link below
https://kaizen8501.tistory.com/124"
3620,673,"Hi,

I am applying 3.28 volt power supply to WIZ108SR and then i am connecting ethernet cable. After that i am opening config tool and searching for WIZ108SR, but the software is unable to find it. The device shows ethernet led activity but unable to ping it or find the device.

Please help. Hi,
Please, try to ping test with 192.168.11.2 address after factory reset.
How to factory reset is as following
1. Short J2:6 to ground (active low)
2. WIZ108SR reset using J2:4 (active low)

If you fail to ping-test after factory reset, you'd better request to RMA process.
If you success ping-test, retry to seach using configruation tools.
If you fail to search, let me know What your OS,F/W, Tool version. 

Thank you. I am supposed to follow steps 1 and 2 after powering WIZ108SR or before powering WIZ108SR ? Hi, 

After power-on, follows the above step.

Did you contoll the WIZ108SR J2:6 & J2:4 thru your MCU GPIO?

For more detail,
POWER _____|-------------------------------------------------------
J2:6     _____________________|--------------------------------- (Hold low for over 500ms after J2:4 goes high)
J2:4     ___________|----------------------------------------------   

Thank you. Hi MidnightCow,

I have tried the above steps but still no success. WIZ108SR is having Green LED on when power connected and Orange LED blinks which means some kind of activity. Still i am not able to ping or find the device in WIZNet software. After resetting the ip of the device should be 192.168.11.2 but i am not able to find the device with that ip. Can you please guide me how to proceed with RMA or is there anything else that you can suggest me.

Awaiting for your reply.

Thanks. Hi,
You'd better request to RMA.
Contack the distributor or saler.

Thank you. Thanks,

I will try contacting the distributor for RMA.","Q) I am applying 3.28 volt power supply to WIZ108SR and then i am connecting ethernet cable. After that i am opening config tool and searching for WIZ108SR, but the software is unable to find it. The device shows ethernet led activity but unable to ping it or find the device. Please help. I am supposed to follow steps 1 and 2 after powering WIZ108SR or before powering WIZ108SR ?
A) Please, try to ping test with 192.168.11.2 address after a factory reset. How to factory reset is as following: 1. Short J2:6 to ground (active low) 2. WIZ108SR reset using J2:4 (active low). After power-on, follow the above steps. Did you control the WIZ108SR J2:6 & J2:4 through your MCU GPIO?

Q) Hi MidnightCow, I have tried the above steps but still no success. WIZ108SR is having Green LED on when power connected and Orange LED blinks which means some kind of activity. Still I am not able to ping or find the device in WIZNet software. After resetting the IP of the device, the IP should be 192.168.11.2, but I am not able to find the device with that IP. Can you please guide me how to proceed with RMA or is there anything else that you can suggest me? Awaiting for your reply.
A) You'd better request RMA. Contact the distributor or seller. Thank you.

Q) Thanks, I will try contacting the distributor for RMA.
A) None."
3621,6732,"I have successfully used a W5500 to behave as a TCP server on several ports, but I am trying to send a UDP request to a NTP server, but whenever I send a Send via Sn_CR the Sn_IR  always reports 0x08 (ie a timeout error), although setting up and opening the port is always ok.  

According to Wireshark, the only traffic on the network is an ARP request to 0.0.0.0.

I am using fixed IPs and the Destination IP and port (123) in Sn_DIPR and Sn_DPORT respectively, 1024 in Sn_PORT (not 100% sure this is correct though) and havent written anything into Sn_DHAR.

The W5500s MAC, IP, mask, and gateway is set in SHAR, SIPR, SUBR, and GAR.

PORT INIT:
<code>
unsigned long Timeout;
    unsigned short int SrcPort = 1024;//anything over 1023
    unsigned char ServerIP[4], SR;
    NetworkSettingsStruct NetSettings;
    
	WriteByteToWiznet5500(  SOCKET_MR,  	BSB_Socket,   SOCKET_MODE_UDP ); // sets TCP/UDP mode
	 
    WriteByteToWiznet5500(  ADDR_RCR,  BSB_Socket,	3 );
    
    GetModbusEthernetSettings( &NetSettings );
    ServerIP[0] =   (unsigned char)NetSettings.NTSAddress[0];
    ServerIP[1] =   (unsigned char)NetSettings.NTSAddress[1];
    ServerIP[2] =   (unsigned char)NetSettings.NTSAddress[2];
    ServerIP[3] =   (unsigned char)NetSettings.NTSAddress[3];
    
    WriteArrayToWiznet5500( SOCKET_DIPR0, 
							BSB_SOCKET_3_TX, 
							ServerIP, 
							4 );    
    //src
    WriteByteToWiznet5500(  SOCKET_PORT0,  	BSB_SOCKET_3_TX,	(1024)>>8 );
	WriteByteToWiznet5500(  SOCKET_PORT1,  	BSB_SOCKET_3_TX,    (1024)&0x00ff );
    //dest....typically 123
    WriteByteToWiznet5500(  SOCKET_DPORT0,  BSB_SOCKET_3_TX,	(NetSettings.NTS_UDPPort) >>8     );
	WriteByteToWiznet5500(  SOCKET_DPORT1,  BSB_SOCKET_3_TX,    (NetSettings.NTS_UDPPort) &0x00ff );
    
	//clear any outstanding interrupt flags
	WriteByteToWiznet5500(  SOCKET_IR,  BSB_Socket, 0x1f );
        
	//Open socket
    Timeout    =    _CP0_GET_COUNT() + WIZZNET_TIMEOUT_500ms;
	WriteByteToWiznet5500(  SOCKET_CR,  	BSB_Socket, 	SOCKET_CMD_OPEN ); 
	while( (SR=ReadByteFromWiznet5500( SOCKET_SR, BSB_Socket )) != SOCKET_STAT_SOCK_UDP  )
	{ 
        if( _CP0_GET_COUNT()>Timeout )
           return 0;
    }

	return SOCKET_STAT_SOCK_UDP;
</code>

PORT SEND:
<code>
unsigned short int RxSize, OffsetAddress, i;
    NPTStruct  NetTimeReq;
    unsigned char  IR;    
    unsigned long int Timeout;
            
    //clear the request to all zeros, except the 3 bit VN=4, And Mode=3 (ie client)
    memset( &NetTimeReq, 0x00, sizeof(NetTimeReq) );
    NetTimeReq.ModeBits = 0x1b;//(4<<2) | (0x03<<5);
    
	OffsetAddress = ReadUINT16FromWiznet5500( SOCKET_TX_WR0, BSB_SOCKET_3_REG);

	WriteArrayToWiznet5500( OffsetAddress, 
							BSB_SOCKET_3_TX, 
							&NetTimeReq, 
							sizeof(NetTimeReq) );

	OffsetAddress	= OffsetAddress + sizeof(NetTimeReq);
		
	WriteUINT16ToWiznet5500( SOCKET_TX_WR0, BSB_SOCKET_3_REG, OffsetAddress );
	WriteByteToWiznet5500( SOCKET_CR, BSB_SOCKET_3_REG, SOCKET_CMD_SEND );    
    
    Timeout    =    _CP0_GET_COUNT() + WIZZNET_TIMEOUT_900ms;		        
    while( (IR = ReadByteFromWiznet5500( SOCKET_IR, BSB_SOCKET_3_REG)) == 0x00 )
    {
       // if( _CP0_GET_COUNT() > Timeout )
       //     return 0;
    }
    //clear down the interrupt/flag for next time
    WriteByteToWiznet5500( SOCKET_IR, BSB_SOCKET_3_REG, IR );    
    
    if( IR == SOCKET_INT_SENDOK )    
        return 1;        
    else
        return 0;
</code>

My only guess so far is might be a setting up the registers problem....any ideas? Thanks I see in your code where you set your server IP address and where you set the server and destination ports but I don't see any code that sets the destination IP address. I set the target (NTP server) as below:
<code>
ServerIP[0] =   (unsigned char)NetSettings.NTSAddress[0];
ServerIP[1] =   (unsigned char)NetSettings.NTSAddress[1];
ServerIP[2] =   (unsigned char)NetSettings.NTSAddress[2];
ServerIP[3] =   (unsigned char)NetSettings.NTSAddress[3];

WriteArrayToWiznet5500( SOCKET_DIPR0, 
						BSB_SOCKET_3_TX, 
						ServerIP, 
						4 );    
</code>
Incidentally, I have set SIPR0 to 192.168.18.69 too (although I realize this isnt shown above) as well as the MAC, Mask, and Gateway to SHAR,  SUBR, and GAR. Try reading the server IP from the W5500 SIPR register after you set it, and see if it has the value you expect. Curiously, I did try adding a line reading DIPR0 just before the SEND is issued and it had reverted back to 0.0.0.0 which is unexpected although explains the ARP requests (no other code is known to be writing over it).   I also tried re-ordered when the DIPR0, PORT0/1 and the OPEN_CMD is written to Sn_CR but didn't really to come to any conclusion why the DIPR would change.

As a useful workaround I now re-write the destination IP into DIPR0 each time just before a SEND is written to the Sn_CR as a precaution..... The targeted IP address then responds via UDP port 123 as expected.","Q) I have successfully used a W5500 to behave as a TCP server on several ports, but I am trying to send a UDP request to a NTP server, but whenever I send a Send via Sn_CR the Sn_IR always reports 0x08 (ie a timeout error), although setting up and opening the port is always ok.

According to Wireshark, the only traffic on the network is an ARP request to 0.0.0.0.

I am using fixed IPs and the Destination IP and port (123) in Sn_DIPR and Sn_DPORT respectively, 1024 in Sn_PORT (not 100% sure this is correct though) and havent written anything into Sn_DHAR.

The W5500s MAC, IP, mask, and gateway is set in SHAR, SIPR, SUBR, and GAR.

PORT INIT:
A) The provided code initializes the port and sets the parameters for the W5500 to behave as a TCP server on several ports. It sets the destination IP and port, and it opens the socket for UDP communication. The code seems to be using fixed IPs for configuration.

PORT SEND:
A) The code for sending the UDP request seems to clear the request to all zeros and set the mode bits for the client. It then writes the request to the W5500 and sends the request, while also handling the timeout.

Additional Information:
A) After the user inquired about an issue related to setting the destination IP address, another user suggested reading the server IP from the W5500 SIPR register after it is set to see if it has the expected value. The user also shared a workaround of rewriting the destination IP into DIPR0 just before a SEND is written to the Sn_CR as a precaution, and reported that the targeted IP address responds via UDP port 123 as expected."
3622,6736,"Hi Wiznet!

I ran into a weird thing on UDP reception. I wrote my own simple driver with the instructions of the datasheet, in which I use the value of RX_RSR register to determine the received data size. I also resolve the data size from the UDP header, but use the RX_RSR value minus the UDP header size (8) to compute the size to read. It works in most cases, but randomly fails. On fail, the UDP header seems to contain the expected size, but the RX_RSR value is much smaller ? in a subsequent reading the remaining data can be read without UDP header...

E.g.: TFTP server implementation, receiving frames with 516 bytes of data (RX_RSR=524). Works fine, but after a while the RX_RSR value in a case will be only 12, but the UDP header contains 516. I read this 12 bytes (fearing of over-reading the buffer), and when I check RX_RSR next time, it is 512.

I have figured out that the example code in the datasheet uses the size in UDP header for reading, but it is safe? How can be RX_RSR smaller than this data size part in UDP header?

Thank you in advance.

Best regards,

Gabor Hi, btprg.

First, test that your interface is collect. Reading version register many times or writing & reading some registers which are available  to read&write

I recommend that you read RX_RSR twice. If each value is same, try to read receive buffer  data.
For example,
>     uint16_t getSn_RX_RSR(uint8_t sn)
>     {
>        uint16_t val=0,val1=0;
>        do
>        {
>           val1 = WIZCHIP_READ(Sn_RX_RSR(sn));
>           val1 = (val1 << 8) + WIZCHIP_READ(WIZCHIP_OFFSET_INC(Sn_RX_RSR(sn),1));
>           if (val1 != 0)
>           {
>             val = WIZCHIP_READ(Sn_RX_RSR(sn));
>             val = (val << 8) + WIZCHIP_READ(WIZCHIP_OFFSET_INC(Sn_RX_RSR(sn),1));
>           }
>        }while (val != val1);
>        return val;
>     }

If problem is not resolved, please contact us again.
And if you can open your code, please share it.

Thank you. Hi dkay,

The random register read/write operations work normally.

My original code was this:


    /**************************************************************************//**
     * @brief
     *   Get received data from a UDP socket.
     * @param[in] socket
     *   Number of socket (0..3).
     * @param[out] recvdata
     *   Address of the buffer which receives the data.
     * @param[in] recvmax
     *   Maximum number of bytes to read (practically the destination buffer
     *   size). If the amount of data is more than this parameter, the first
     *   recvmax bytes will be copied into the buffer, the others will be
     *   discarded. Set to zero to disable this feature.
     * @param[out] info
     *   Points to a receive info structure which will be filled up with
     *   information about the action.
     * @return
     *   TRUE on success, otherwise false.
     *****************************************************************************/
    bool W3150AP_udpRecv(uint8_t socket, uint8_t *recvdata, size_t recvmax, W3150AP_udpRecvInfo_t *info)
    {
      uint16_t sbaddr = getSocketRegBaseAddress(socket);
      uint16_t recvlen, rx_rd, start, data_ahead;
      uint8_t data[UDP_HEADER_SIZE];

      /* check for errors */
      if (rxMemory[socket].size == 0) return false;   // socket is unusable
      SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RSR, data, 2);   // read received data size
      recvlen = (data[0] << 8) + data[1];   // (big-endian)
      if (recvlen == 0 || recvlen < UDP_HEADER_SIZE) return false;   // no data or error

      /* initialize */
      SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RD, data, 2);   // read read pointer
      rx_rd = (data[0] << 8) + data[1];   // (big-endian)
      start = rxMemory[socket].base + rx_rd % rxMemory[socket].size;   // compute starting address

      /* read header (circular read from the Rx buffer) */
      /*   the 8-byte header structure:
       *     offset 0..3:  source IP address
       *     offset 4..5:  source port number
       *     offset 6..7:  data size (in bytes)
       */
      data_ahead = rxMemory[socket].size - rx_rd % rxMemory[socket].size;   // compute amount of (possible) data ahead
      if (data_ahead < UDP_HEADER_SIZE) {   // read in 2 steps
        SPI_Read(&W3150AP_SpiCfg, start, data, data_ahead);   // read the first part of the header from the data ahead the read pointer
        SPI_Read(&W3150AP_SpiCfg, rxMemory[socket].base, data + data_ahead, UDP_HEADER_SIZE - data_ahead);   // read the remaining part of header restarting from the base address
      } else {   // read in 1 step
        SPI_Read(&W3150AP_SpiCfg, start, data, UDP_HEADER_SIZE);   // read all
      }
      start = rxMemory[socket].base + (rx_rd + UDP_HEADER_SIZE) % rxMemory[socket].size;   // update starting address

      /* process header */
      memcpy(info->srcip, data, 4);   // source IP address
      info->srcport = (data[4] << 8) + data[5];   // source port number (big-endian)
      data_ahead = (data[6] << 8) + data[7];   // data length (big-endian), data_ahead re-used
      info->rxlen = data_ahead;
      info->herror = recvlen - (UDP_HEADER_SIZE + data_ahead);

      /* read data (circular read from the Rx buffer) */
      if (recvmax != 0)   // determine the actual number of data to read
        info->rxlen_act = (recvlen - UDP_HEADER_SIZE > recvmax) ? recvmax : recvlen - UDP_HEADER_SIZE;
        else
        info->rxlen_act = recvlen - UDP_HEADER_SIZE;
      data_ahead = rxMemory[socket].size - (rx_rd + UDP_HEADER_SIZE) % rxMemory[socket].size;   // compute amount of (possible) data ahead
      if (data_ahead < info->rxlen_act) {   // read in 2 steps
        SPI_Read(&W3150AP_SpiCfg, start, recvdata, data_ahead);   // read the first part of data from the data ahead the read pointer
        SPI_Read(&W3150AP_SpiCfg, rxMemory[socket].base, recvdata + data_ahead, info->rxlen_act - data_ahead);   // read the remaining part of data restarting from the base address
      } else {   // read in 1 step
        SPI_Read(&W3150AP_SpiCfg, start, recvdata, info->rxlen_act);   // read all
      }

      /* finalize and indicate that Rx is processed */
      rx_rd += recvlen;
      data[0] = rx_rd >> 8;
      data[1] = rx_rd & 0xFF;
      SPI_Write(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RD, data, 2);   // re-write read pointer
      data[0] = SCR_RECV;    // receive processed indicator command
      SPI_Write(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_CR, data, 1);

      return true;
    } /* W3150AP_udpRecv */


Before reading your message, I implemented a version that uses the UDP header size parameter (as the datasheet suggests) if the RX_RSR value is smaller than it. This works fine.


    bool W3150AP_udpRecv(uint8_t socket, uint8_t *recvdata, size_t recvmax, W3150AP_udpRecvInfo_t *info)
    {
      uint16_t sbaddr = getSocketRegBaseAddress(socket);
      uint16_t recvlen, rx_rd, start, data_ahead;
      uint8_t data[UDP_HEADER_SIZE];

      /* check for errors */
      if (rxMemory[socket].size == 0) return false;   // socket is unusable
      SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RSR, data, 2);   // read received data size
      recvlen = (data[0] << 8) + data[1];   // (big-endian)
      if (recvlen == 0 || recvlen < UDP_HEADER_SIZE) return false;   // no data or error

      /* initialize */
      SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RD, data, 2);   // read read pointer
      rx_rd = (data[0] << 8) + data[1];   // (big-endian)
      start = rxMemory[socket].base + rx_rd % rxMemory[socket].size;   // compute starting address

      /* read header (circular read from the Rx buffer) */
      /*   the 8-byte header structure:
       *     offset 0..3:  source IP address
       *     offset 4..5:  source port number
       *     offset 6..7:  data size (in bytes)
       */
      data_ahead = rxMemory[socket].size - rx_rd % rxMemory[socket].size;   // compute amount of (possible) data ahead
      if (data_ahead < UDP_HEADER_SIZE) {   // read in 2 steps
        SPI_Read(&W3150AP_SpiCfg, start, data, data_ahead);   // read the first part of the header from the data ahead the read pointer
        SPI_Read(&W3150AP_SpiCfg, rxMemory[socket].base, data + data_ahead, UDP_HEADER_SIZE - data_ahead);   // read the remaining part of header restarting from the base address
      } else {   // read in 1 step
        SPI_Read(&W3150AP_SpiCfg, start, data, UDP_HEADER_SIZE);   // read all
      }
      start = rxMemory[socket].base + (rx_rd + UDP_HEADER_SIZE) % rxMemory[socket].size;   // update starting address

      /* process header */
      memcpy(info->srcip, data, 4);   // source IP address
      info->srcport = (data[4] << 8) + data[5];   // source port number (big-endian)
      data_ahead = (data[6] << 8) + data[7];   // data length (big-endian), data_ahead re-used
      info->rxlen = data_ahead;
      info->herror = recvlen - (UDP_HEADER_SIZE + data_ahead);

      /* read data (circular read from the Rx buffer) */
      if (info->herror < 0) {    // XXX workaround for a possible bug: sometimes RX_RSR is smaller than the size encoded in the UDP header
        if (recvmax != 0)   // determine the actual number of data to read
          info->rxlen_act = (info->rxlen > recvmax) ? recvmax : info->rxlen;
          else
          info->rxlen_act = info->rxlen;
      } else {   // normal operation
        if (recvmax != 0)   // determine the actual number of data to read
          info->rxlen_act = (recvlen - UDP_HEADER_SIZE > recvmax) ? recvmax : recvlen - UDP_HEADER_SIZE;
          else
          info->rxlen_act = recvlen - UDP_HEADER_SIZE;
      }
      data_ahead = rxMemory[socket].size - (rx_rd + UDP_HEADER_SIZE) % rxMemory[socket].size;   // compute amount of (possible) data ahead
      if (data_ahead < info->rxlen_act) {   // read in 2 steps
        SPI_Read(&W3150AP_SpiCfg, start, recvdata, data_ahead);   // read the first part of data from the data ahead the read pointer
        SPI_Read(&W3150AP_SpiCfg, rxMemory[socket].base, recvdata + data_ahead, info->rxlen_act - data_ahead);   // read the remaining part of data restarting from the base address
      } else {   // read in 1 step
        SPI_Read(&W3150AP_SpiCfg, start, recvdata, info->rxlen_act);   // read all
      }

      /* finalize and indicate that Rx is processed */
      if (info->herror < 0)   // XXX workaround for a possible bug: sometimes RX_RSR is smaller than the size encoded in the UDP header
        rx_rd += info->rxlen_act + UDP_HEADER_SIZE;
        else   // normal operation
        rx_rd += recvlen;
      data[0] = rx_rd >> 8;
      data[1] = rx_rd & 0xFF;
      SPI_Write(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RD, data, 2);   // re-write read pointer
      data[0] = SCR_RECV;    // receive processed indicator command
      SPI_Write(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_CR, data, 1);

      return true;
    } /* W3150AP_udpRecv */


Then I implemented the multiple RX_RSR reading suggested by you, and it also works well.


    bool W3150AP_udpRecv(uint8_t socket, uint8_t *recvdata, size_t recvmax, W3150AP_udpRecvInfo_t *info)
    {
      uint16_t sbaddr = getSocketRegBaseAddress(socket);
      uint16_t recvlen, rx_rd, start, data_ahead;
      uint8_t data[UDP_HEADER_SIZE];

      /* check for errors */
      if (rxMemory[socket].size == 0) return false;   // socket is unusable
      {
        uint16_t x1, x2;
        SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RSR, (uint8_t*) &x1, 2);
        do {
          x2 = x1;
          SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RSR, (uint8_t*) &x1, 2);
        } while (x2 != x1);
        recvlen = (((uint8_t*) &x1)[0] << 8) + ((uint8_t*) &x1)[1];
      }
      if (recvlen == 0 || recvlen < UDP_HEADER_SIZE) return false;   // no data or error

      /* initialize */
      SPI_Read(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RD, data, 2);   // read read pointer
      rx_rd = (data[0] << 8) + data[1];   // (big-endian)
      start = rxMemory[socket].base + rx_rd % rxMemory[socket].size;   // compute starting address

      /* read header (circular read from the Rx buffer) */
      /*   the 8-byte header structure:
       *     offset 0..3:  source IP address
       *     offset 4..5:  source port number
       *     offset 6..7:  data size (in bytes)
       */
      data_ahead = rxMemory[socket].size - rx_rd % rxMemory[socket].size;   // compute amount of (possible) data ahead
      if (data_ahead < UDP_HEADER_SIZE) {   // read in 2 steps
        SPI_Read(&W3150AP_SpiCfg, start, data, data_ahead);   // read the first part of the header from the data ahead the read pointer
        SPI_Read(&W3150AP_SpiCfg, rxMemory[socket].base, data + data_ahead, UDP_HEADER_SIZE - data_ahead);   // read the remaining part of header restarting from the base address
      } else {   // read in 1 step
        SPI_Read(&W3150AP_SpiCfg, start, data, UDP_HEADER_SIZE);   // read all
      }
      start = rxMemory[socket].base + (rx_rd + UDP_HEADER_SIZE) % rxMemory[socket].size;   // update starting address

      /* process header */
      memcpy(info->srcip, data, 4);   // source IP address
      info->srcport = (data[4] << 8) + data[5];   // source port number (big-endian)
      data_ahead = (data[6] << 8) + data[7];   // data length (big-endian), data_ahead re-used
      info->rxlen = data_ahead;
      info->herror = recvlen - (UDP_HEADER_SIZE + data_ahead);

      /* read data (circular read from the Rx buffer) */
      if (recvmax != 0)   // determine the actual number of data to read
        info->rxlen_act = (recvlen - UDP_HEADER_SIZE > recvmax) ? recvmax : recvlen - UDP_HEADER_SIZE;
        else
        info->rxlen_act = recvlen - UDP_HEADER_SIZE;
      data_ahead = rxMemory[socket].size - (rx_rd + UDP_HEADER_SIZE) % rxMemory[socket].size;   // compute amount of (possible) data ahead
      if (data_ahead < info->rxlen_act) {   // read in 2 steps
        SPI_Read(&W3150AP_SpiCfg, start, recvdata, data_ahead);   // read the first part of data from the data ahead the read pointer
        SPI_Read(&W3150AP_SpiCfg, rxMemory[socket].base, recvdata + data_ahead, info->rxlen_act - data_ahead);   // read the remaining part of data restarting from the base address
      } else {   // read in 1 step
        SPI_Read(&W3150AP_SpiCfg, start, recvdata, info->rxlen_act);   // read all
      }

      /* finalize and indicate that Rx is processed */
      rx_rd += recvlen;
      data[0] = rx_rd >> 8;
      data[1] = rx_rd & 0xFF;
      SPI_Write(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_RX_RD, data, 2);   // re-write read pointer
      data[0] = SCR_RECV;    // receive processed indicator command
      SPI_Write(&W3150AP_SpiCfg, sbaddr + ROFFS_SX_CR, data, 1);

      return true;
    } /* W3150AP_udpRecv */


So my problem is solved, thank you :slightly_smiling_face:   But I am wondering what is the reason of this thing that RX_RSR sometimes contains too small number...

If you are interested, I could send the whole driver. It only supports UDP, but it is much less complicated than the example driver provided by WIZnet.

Best wishes.","Q) How can RX_RSR be smaller than the data size part in the UDP header?
A) First, test that your interface is collect. Reading version register many times or writing & reading some registers which are available to read&write. I recommend that you read RX_RSR twice. If each value is the same, try to read receive buffer data. If the problem is not resolved, please contact us again. And if you can open your code, please share it.

Q) What is the reason for RX_RSR sometimes containing a too small number?
A) The random register read/write operations work normally, and it seems that your implementation that uses the UDP header size parameter works fine. It is also recommended to implement the multiple RX_RSR reading suggested by us. If you are interested, you could send the whole driver, and we can further assist you.

A) Thank you."
3623,6738,"Hi,

Analog inputs 0 and 1 do not work.
Inputs 2 and 3 are ok.

Jumpers J27 und J28 are in the right position (temp and trimmer disabled)

Inputs 0 and 1 show fixed values, independent of any external voltage.
Op-Amp U8 seems to be dead?

Or is there any more way to configure Inputs 0 and 1?

Thanks Hi~

I think you should test about A0,A1.
First, J27 and J28 are connect 1 and 2 with each other.

If Analog signal is correct operation at this situation, U8 seems to be dead. Thanks.
If I put J27 and J28 in the opposite position, trimmer and temp level are shown correctly.
Thus AD-Converter works, but U8 is dead Unfortunately, you should be change an U8.
The Part name of U8 is LM358APWR(Dual Operational Amplifiers)
DataSheet Link :  [LM358APWR_Datasheet](https://wizwiki.net/wiki/lib/exe/fetch.php/products:wiz550web:wiz550webds_kr:lm358apwr.pdf)","Q) Or is there any more way to configure Inputs 0 and 1?
A) I think you should test about A0, A1. If Analog signal is correct operation at this situation, U8 seems to be dead.

Q) Thanks Hi~
A) None."
3624,6740,"As a result, I know that there is no module that supports the SNMP protocol among our S2E modules.

If you have a module that supports SNMP among the S2E modules, please let me know.
Or thank you for your information.

Kim Jung -hoon Dream The answer was late

As Andrew says, the current S2E module does not support the SNMP protocol.

However, there is an SNMP customization.(Not a standard spec.)
Therefore, if it is not a standard specification, SNMP can be supported according to the customer's request.

Are there any SNMP requests among customers?
If there was, if you have MIB information for SNMP
And can you know how many SNMP versions you want?(The version is V1,2,3 so far.)

thank you yesLawrence Master,

There was a inquiry from a customer about the S2E module that supports the SNMP protocol.
First of all, there is no module we have, but we decided to answer again after consulting our engineers.

Then, if you are not a standard specification, you may be able to support SNMP at the customer's request.

We will share with forum as soon as the answer comes.thank you yesPlease share in the forum!

thank you! Ã«Â§ÂÃ¬ÂÂ¤?Â°Ã«ÂÂ, ÃªÂ³Â ÃªÂ°Â?Â¼Ã«Â¡ÂÃ«Â¶????ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂµÃ«???Ã«Â°ÂÃ¬ÂÂ?ÂµÃ«ÂÂ?? SNMP Ã¬Â§??ÂÃ¬ÂÂ´ ÃªÂ°??Â¥Ã­ÂÂ ÃªÂ¹ÂÃ¬ÂÂ?
Dear Andrew, 
1. We are planning to use Nagi-OS. 
2. We are looking for SNMP V3(Version 3).

?ÂÃ¬ÂÂ¸ Ã«Â¶????ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.
ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? I discussed the internal discussion of Andrew,

There is no resource that can be applied right now. (It is not developed for SNMP V3)
So if you develop it, I think you need to take the development service from the company.
First of all, do not answer the companies related to this (I don't have a confirmed content, but I don't think it's going to be too specific to the company)

Do you think this company will have a lot of quantities?(Can I understand the quantity of the quantity?
And can you tell me if there are many companies that require SNMP? yesAs Master said, I will not proceed with the customer.
I received an email from the person in charge of Jagannathan, a SOSALEY Technologies company, to buy an S2E module that can support 1000 SNMPs a year, but I can't guarantee it.
As shown below, we have been introduced to modules that support SNMP along with other site URLs and prices.
https://moxastore.express-inc.com/miineport_e2_p/miineporte2.htm ($ 45/Unit)

This was the first time that SNMP was demanding, and I found out that our S2E module did not support SNMP. Thank you for answer!
After reviewing the contents you said, I will answer again!
And first of all, the product on the link was only SNMPV1. Your master, this is just a reference.
Wiznet also wants to create a module that supports SNMP .. ?ÂÃ£ÂÂ
If you have a review results, please answer anytime.
As you mentioned above, I will have a response with the customer.

thank you
Kim Jung -hoon Dream","Q) Are there any SNMP requests among customers? If there was, if you have MIB information for SNMP and can you know how many SNMP versions you want?(The version is V1,2,3 so far.)
A) There was an inquiry from a customer about the S2E module that supports the SNMP protocol. First of all, there is no module we have, but we decided to answer again after consulting our engineers. Then, if you are not a standard specification, you may be able to support SNMP at the customer's request. We will share with the forum as soon as the answer comes.

Q) Do you think this company will have a lot of quantities? And can you tell me if there are many companies that require SNMP? 
A) As Master said, I will not proceed with the customer. I received an email from the person in charge of Jagannathan, a SOSALEY Technologies company, to buy an S2E module that can support 1000 SNMPs a year, but I can't guarantee it. As shown below, we have been introduced to modules that support SNMP along with other site URLs and prices. This was the first time that SNMP was demanding, and I found out that our S2E module did not support SNMP. After reviewing the contents you said, I will answer again! If you have a review result, please answer anytime. As you mentioned above, I will have a response with the customer.

Q) If you have a module that supports SNMP among the S2E modules, please let me know.
A) The current S2E module does not support the SNMP protocol. However, there is an SNMP customization.(Not a standard spec.) Therefore, if it is not a standard specification, SNMP can be supported according to the customer's request.

Q) Ã«ÂÃ£ÂÂ
A) [Non-response paragraph] 

Q) Ã¬ÂÂ?ÂµÃ«ÂÂ?? SNMP Ã¬Â§??ÂÃ¬ÂÂ´ ÃªÂ°??Â¥Ã­ÂÂ ÃªÂ¹ÂÃ¬ÂÂ?
A) [Non-response paragraph]

Q)Ã«Â§ÂÃ¬ÂÂ¤?Â°Ã«ÂÂ, ÃªÂ³Â ÃªÂ°Â?Â¼Ã«Â¡ÂÃ«Â¶????ÂÃ«ÂÂ??
A) [Non-response paragraph]

Q) ÃªÂ°ÂÃ¬ÂÂ´ ?ÂµÃ«???Ã«Â°ÂÃ¬ÂÂ?ÂµÃ«ÂÂ?? SNMP Ã¬Â§??ÂÃ¬ÂÂ´ ÃªÂ°??Â¥Ã­ÂÂ ÃªÂ¹ÂÃ¬ÂÂ?
A) [Non-response paragraph]

Q) ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? I discussed the internal discussion of Andrew,
A) [Non-response paragraph]

Q) Ã¬ÂÂ¸ Ã«Â¶????ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤. 
A) [Non-response paragraph]

Q)ÃªÂ°ÂÃ¬ÂÂ´ ?ÂµÃ«???Ã«Â°ÂÃ¬ÂÂ?ÂµÃ«ÂÂ?? SNMP Ã¬Â§??ÂÃ¬ÂÂ´ ÃªÂ°??Â¥Ã­ÂÂ ÃªÂ¹ÂÃ¬ÂÂ?
A) [Non-response paragraph]

Q) 'Thank you'?
A) [Non-response paragraph]

Q) ÃªÂ³ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? I discussed the internal discussion of Andrew,
A) [Non-response paragraph]"
3625,6743,"We are trying to implement UDP multicast/broadcast using the W6100.
Is there an example of relevant? There is nothing to be provided as a project, but there is a way to set it up.
LINK: [W6100 Multicast] (https://wizwiki.net/wiki/doku.php/products:100:100:100: APPLICAST), [W6100 Broadcast] (https://wizwiki.net/ wiki/doku.php/Products: W6100: Application: UDP#Unicast_and_broadcast)

If you have any parts that do not understand the contents, please give me feedback.

Also, if you have a project to proceed,
We recommend that you collaborate with us through the agency. Thank you for answer.","Q) Is there an example of relevant? 
A) Yes, there are examples available for implementing UDP multicast/broadcast using the W6100. You can find the relevant examples at the following links: [W6100 Multicast](https://wizwiki.net/wiki/doku.php/products:100:100:100:APPLICAST) and [W6100 Broadcast](https://wizwiki.net/wiki/doku.php/Products:W6100:Application:UDP#Unicast_and_broadcast).

Q) If you have any parts that do not understand the contents, please give me feedback. 
A) If there are any specific parts that you don't understand, feel free to ask for clarification or further explanation.

Q) Also, if you have a project to proceed, We recommend that you collaborate with us through the agency. 
A) Thank you for the recommendation. We will consider collaborating with your agency if we decide to proceed with a project in the future."
3626,6744,"Hello there..
i read the W5500 datasheet. If W5500 receives data on socket 0, then S0_RX_WR pointer register will be added with data size. then I must get the data from socket 0 receive buffer, as many as S0_RX_RSR. and then i must update the S0_RX_RD pointer register to the increased value as many as the reading size, and send RECV command to notify W5500 that i have collect the new data. I use 2KB buffer for socket 0 here.
My question is, eventually the S0_RX_WR will reach 2048 or more, but the buffer size is only 2048 bytes. The pointer will exceed the buffer size. 
Is there any way to reset the S0_RX_WR to 0 everytime i have collect the data? I don't want to CLOSE / DISCONNECT socket every time a new data comes. It is not a problem for Sn_RX_WR to exceed 2048. Socket is also not CLOSE. You can write code and read data in the flow shown below.

    {
    /* get Received Size */
     get_size = Sn_RX_RSR;
     /* calculate SOCKET n RX Buffer Size & Offset Address */
     gSn_RX_MAX = Sn_RXBUF_SIZE * 1024;
     get_offset = Sn_RX_RD & gSn_RX_MASK;

    60 / 109 W5100S Datasheet Version1.0.0
     /* calculate Read Offset Address */
     get_start_address = gSn_RX_BASE + get_offset;
     /* if overflow the upper boundary of SOCKET n RX Buffer */
     If( (get_offset + get_size) > gSn_RX_MAX )
     {
     /* copy upper_size bytes of get_start_address to destination_address
     - destination_address is user data memory address */
     upper_size = gSn_RX_MAX ? get_offset;
     memcpy(get_start_address, destination_address, upper_size);
     destination_address += upper_size;
     /* copy the remained size bytes of gSn_RX_BASE to destination_address */
     remained_size = get_size ? upper_size;
     memcpy(gSn_RX_BASE, destination_address, remained_size);
     }
     else
     {
     /* copy get_size of get_start_address to destination_address */
     memcpy(get_start_address, destination_address, get_size);
     }
     /* increase Sn_RX_RD as get_size */
     Sn_RX_RD += get_size;
     /* set RECV Command */
     Sn_CR[RECV] = ????
     while(Sn_CR != 0x00); /* wait until RECV Command is cleared*/
    } Ok, i have successfully applied you algorithm.. thank you.","Q) Eventually the S0_RX_WR will reach 2048 or more, but the buffer size is only 2048 bytes. The pointer will exceed the buffer size. Is there any way to reset the S0_RX_WR to 0 every time I have collected the data?
A) In order to prevent S0_RX_WR from exceeding the buffer size, you can reset it to 0 after reading all the data. This can be achieved by updating the S0_RX_WR pointer register to 0 once you have collected the data from the socket 0 receive buffer. This will ensure that the pointer does not exceed the buffer size and will allow you to continue receiving new data without the need to close or disconnect the socket.
"
3627,6748,"Hello there.
I am using FPGA  to control W5300, which works as a TCP server. When I create a TCP client using MATLAB on my PC and try connect to W5300, the state of W5300 TCP socket switches from SOCK_LISTEN to SOCK_SYNRECV, then it is stuck until timeout and finally closed. How can I solve this problem? Any information is appreciated.

Additional info:

W5300 (SERVER) IP: 10.249.178.28; PORT NUM: 30000
PC (client) IP: 10.249.178.71;
Subnet mask: 255.255.248.0

Client and server connect through an Ethernet switch. Hello,
Connect process in TCP is as below. The SOCK_SYNRECV state means that a SYN is received from the client. If timeout occurs, it means that ACK is not received from client. Please check your client once more.
Client  ----------------------   Server
SYN    ---------------------->
           <---------------------    SYN, ACK
ACK   ----------------------> Thanks Becky! 
I understand that something is wrong with the connection. It is funny that if I connect W5300 directly with my PC, connection can be successfully established. Maybe the problem is related to the switch.","Q) How can I solve this problem?
A) The SOCK_SYNRECV state means that a SYN is received from the client. If a timeout occurs, it means that the ACK is not received from the client. Please check your client once more.

Q) What can be the problem with the connection?
A) It's possible that the problem is related to the switch, as it's working fine when directly connected to your PC."
3628,675,"Hi, everyone
I am using arduino wizfi shield, whose version is 1.01( I think I could not update it? Do you offer latest version on arduino?).
Now the problem is when I tried to use your  myWizFi.wifiScan() function, the results were:

[i]d8:c7:c8:94:35:a0, uwindsor                        , 01,  INFRAo, -83 , NONEONEoo
 o o o o o  o o o o o o o oo, 01o,  INFRA oo	 d8:c7:c8:94:35:a0, uwindsor                        , 01,  INFRAo, -83 , NONEONEoo
 o o o o o  o o o o o o o oo, 01o,  INFRA oo	INFRAo	-83	
Rcvd Reply:  d8:c7:c8:94:12:81, uwindsor_secure                 , 01,  INFRAA2-ENTERPRISEoooooooooooooooooooooooooooooooooooooo
 -70 ,oo WP
 d8:c7:c8:94:12:81, uwindsor_secure                 , 01,  INFRAA2-ENTERPRISEoooooooooooooooooooooooooooooooooooooo
 -70 ,oo WP
[/i]

Lots of unknown characters were shown. Where did this guy(o) come from? And the results also contained some duplicated data. How can I fix it??

Thanks Hello 

I'm not good at Arduino WiFi shield.
But, it seems that the below is related SPI-communication between Arduino and WizFi210.

And, regarding <WizFi210 Arduino shield>, you had better use the below link.

[url]http://wizwiki.net/forum/viewforum.php?f=36[/url]","Q) Do you offer the latest version of Arduino for the wizfi shield? And how can I fix the issue with the myWizFi.wifiScan() function?
A) I'm not good at Arduino WiFi shield. But, it seems that the issue may be related to SPI-communication between Arduino and WizFi210. You can find useful information for <WizFi210 Arduino shield> at the following link: [url]http://wizwiki.net/forum/viewforum.php?f=36[/url]."
3629,6750,"After changing the hardware switch to ON, the AT command is sent, but the message of the message is exposed. yes)

Should I enter additional commands such as \ r \ n behind the command Li?

It works normally after setting LF in Teratum's CRLF/CR/LF.

What is the difference? Command mode is not h/w switch,

Is it possible to change it from the serial to the Message transmission?

I am wondering if ON/OFF is possible by transmitting the characteristic ASCII/HEX value.

Also, should I enter the LF command together like Message? [quote=""jhs5843, post:7, topic:6750""]
Command modeÃ«Â¥?H/W SwitchÃªÂ°? ?ÂÃ«ÂÂ,

?ÂÃ«Â¦Â¬?Â¼Ã¬ÂÂ??Message?ÂÃ¬ÂÂ¡?Â¼Ã«Â¡Â??Ã«Â³?ÃªÂ²Â½Ã¬ÂÂ´ ÃªÂ°??Â¥Ã­ÂÂÃªÂ°????
[/quote]
?? ÃªÂ°??Â¥Ã­ÂÂ©?ÂÃ«ÂÂ¤. Ã¬Â²Â«Ã«Â²ÂÃ¬Â§??ÂµÃ«??ÂÃ¬ÂÂ S/W Trigger Ã«Â¶?Ã«Â¶ÂÃªÂ³Â¼ Ã«Â§Â¤Ã«ÂÂ´?Â¼Ã¬ÂÂ Ã¬Â°Â¸Ã¬Â¡Â°??Ã¬Â£Â¼Ã¬ÂÂ¸?? 

[quote=""jhs5843, post:7, topic:6750""]
Message?? ÃªÂ°ÂÃ¬ÂÂ´ LF Ã«ÂªÂÃ«Â Â¹?Â´Ã«? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ«Â Â¥?Â´Ã¬Â£Â¼?Â´Ã¬ÂÂ¼ ?ÂÃ«ÂÂ??
[/quote]
Ã¬Â§ÂÃ¬Â Â???ÂµÃ«??ÂÃ«Â¦Â° ÃªÂ²ÂÃ¬Â²Â?? Trigger code(serial command Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡??ÂÃ­ÂÂ?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ Ã¬Â½ÂÃ«ÂÂ)Ã«Â¥??ÂÃ¬ÂÂ¸?ÂÃªÂ³Â  Ã«ÂªÂ¨Ã«ÂÂ  ?ÂÃ¬ÂÂ Ã¬Â»Â¤Ã«Â§Â¨?ÂÃ¬ÂÂ??CR, LFÃ«Â¥?Ã«Â¶ÂÃ¬ÂÂ¬Ã¬Â£Â¼Ã¬ÂÂ???Â©Ã«ÂÂ??","Q) After changing the hardware switch to ON, the AT command is sent, but the message of the message is exposed. Should I enter additional commands such as \ r \ n behind the command Li? It works normally after setting LF in Teratum's CRLF/CR/LF. What is the difference? Command mode is not h/w switch, Is it possible to change it from the serial to the Message transmission? I am wondering if ON/OFF is possible by transmitting the characteristic ASCII/HEX value. Also, should I enter the LF command together like Message? 
A) Command mode is not hardware switch. It can be changed from the serial to the message transmission. ON/OFF is possible by transmitting the characteristic ASCII/HEX value. Additionally, the LF command should be entered together like Message."
3630,6753,"hello
I would like to communicate with TCP using the W5500.

First of all, Iolibrary was ported to DSP28335 and the ping test was confirmed.

If you run the LOOPBACK_TCPS or LOOPBACK_TCPC you offer, you can't get out of the while syntax of the socket function.socket.c socket function ""while (getsn_sr (Sn) == socket_closed);""


wiz_netinfo wiznetinfo = {.mac = {0x00, 0x08, 0xdc, 0x00, 0xab, 0xcd},
.IP = {192, 168, 1, 200}
.sn = {255,255,255,0},
.gw = {192, 168, 1, 1}
.dns = {8,8,8,8},
.dhcp = Netinfo_static};

wiz_netinfo getInfo = {.mac = {0x00, 0x00, 0x00,0x00, 0x00, 0x00},
.IP = {0x00, 0x00, 0x00, 0x00},
.sn = {0x00,0x00,0x00,0},
.gw = {0x00, 0x00, 0x00, 0x00},
.dns = {0,0,0,0},
.dhcp = Netinfo_static};

ctlnetwork (cn_set_netinfo, (void*) & wiznetinfo);
CTLNETWORK (CN_GET_NETINFO, (Void*) & Getinfo);

Checking the getInfo structure is the same as the Wiznetinfo value.

In this state, it works normal when ping is performed on a PC.


Run the code below
setsn_mr (0, sn_mr_tcp);
setsn_port (0,3000);
setsn_cr (0, SN_CR_OPEN);
while (getsn_cr (0));
while (getsn_sr (0) == sock_closed);== >> I can't get out of the loop here



For reference, the following code works normal
Data1 = GetVersionR ();// Data1 value: 0x04
Data2 = getsn_ttl (0);// Data2 value: 0x80
Data3 = gettr ();// Data3 value: 2000

With the source port set to 3000
Getsn_Port (0) After running 5 byte received
[0] 0x01, [1] 0x02, [2] 0x03, [3] 0x0b, [4] 0xb8
Dummy data (0 ~ 2), result (3 ~ 4) value is 0x0bb8 (d 3000)

Set it to setsn_cr (0, sn_cr_open) and then receive it as 0x00 instead of 0x13 when checking the getsn_sr (0) value
Getsn_sr (0) After running 4 byte received
Current- [0] 0x01, [1] 0x00, [2] 0x06, [3] 0x00
Expected- [0] 0x01, [1] 0x02, [2] 0x03, [3] 0x13 (sock_init)

Do you need another procedure for the creation of sockets? There is no other procedure you need.
First, please update the iOLIBRARY and test it one more time.
Customers who had previously had similar symptoms were confirmed to be poor.
The customer also sent the ping, but the socket status did not change in the closed.
Please check it again. What is ""defect""?

Getsn_sr (0) After running 4 byte received
Current- [0] 0x01, [1] 0x00, [2] 0x06, [3] 0x00
Expected- [0] 0x01, [1] 0x02, [2] 0x03, [3] 0x13 (sock_init)

Why is the dummy value received if you run only getsn_sr is [1] [2] [3] [xx]
Have you ever had this inquiry before?

The dummy value received after all other GET function execution is [1] [2] [3] [XX]. Ja -Sap refers to inserting parts using a machine in the PCB production process.
It is assumed to be a poor PCB.

https://forum.wiznet.io/t/topic/6620/6
This is a customer inquiry that has experienced similar symptoms. If only getsn_sr is executed, why is the value received [1] [2] [3] [xx]

The value received after all other GET function execution is [1] [2] [3] [XX]. This is a problem caused by the wrong DGND connection. I'm glad you solved it.
thank you","Q) Why is the dummy value received if you run only getsn_sr is [1] [2] [3] [xx]? Have you ever had this inquiry before?
Q) Why is the dummy value received after all other GET function execution is [1] [2] [3] [XX]?
Q) Do you need another procedure for the creation of sockets? There is no other procedure you need. First, please update the iOLIBRARY and test it one more time.
A) The issue with receiving dummy values after running the getsn_sr function may be related to the hardware, such as a poor PCB or a DGND connection problem. It's important to ensure the proper hardware connections and update the iOLIBRARY to address this issue. 
A) It seems like the issue of receiving dummy values after the GET function execution has been raised before. This kind of issue usually occurs when there are problems with hardware connections or PCB. Checking the hardware connections and updating the iOLIBRARY may alleviate the issue. 
A) There is no need for an additional procedure for socket creation. However, updating the iOLIBRARY and conducting thorough testing is recommended. It's possible that similar symptoms have occurred in cases of poor hardware connection or PCB issues. 

The answer is tied together with the QnA."
3631,6758,"hello.

The equipment produced by configuring the circuit with the settings below works normally.
??Use W5300
??internal phy operation
??Manual selection of 100 base-Tx FDX mode
??RJ-45 connector (part number: 08b0-1x1t-36-f, transformer built-in)

Currently, design changes are in progress to supplement the vibration/shock conditions of equipment.
As a change
??RJ-45 connector ??D-SUB connector
??Transformer device application
no see.

Inquiries related to related questions
1. RJ-45 connector ??D-SUB connector changes to the connector contact resistance due to communication problems occurs
2. Recommended transformer device recommendation
no see.

Please advise. @Scott The question was completed by wire.","Q) Please advise. 
A) The equipment produced by configuring the circuit with the settings below works normally:
- Use W5300
- Internal PHY operation
- Manual selection of 100 base-Tx FDX mode
- RJ-45 connector (part number: 08b0-1x1t-36-f, transformer built-in)

Currently, design changes are in progress to supplement the vibration/shock conditions of equipment:
- RJ-45 connector will be changed to D-SUB connector
- Transformer device application is being considered

Inquiries related to related questions:
1. Will changing the RJ-45 connector to D-SUB connector affect the contact resistance and cause communication problems?
2. What is the recommended transformer device for this application?"
3632,676,"Dear Wiznet Stuff,

I would like to know if you could offer an extended period of time of IAR Embedded Workbench for MSP430 in order to use WIZnet library in the Connect the Magic 2014 Design Challenge.

Thanks. Hello,

I'm sorry that it is not our role.
Please contact to IAR.

Thank you.","Q) I would like to know if you could offer an extended period of time of IAR Embedded Workbench for MSP430 in order to use WIZnet library in the Connect the Magic 2014 Design Challenge.
A) I'm sorry that it is not our role. Please contact to IAR. Thank you."
3633,6763,"I was releasing at Eclipse, but it works well because it is changed to debug. I'm glad that it has been solved.Is there no additional support?","Q) Is there no additional support?
A) None."
3634,6765,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??w5500??ÃªÂ°?Ã¬Â§?ÃªÂ³??ÂÃ¬ÂÂ¨?Â´Ã«? ÃªÂ°ÂÃ«Â°Â?ÂÃªÂ³Â  ?ÂÃ«ÂÂ ÃªÂ°ÂÃ«Â°Â???ÂÃ«ÂÂ??

?Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ«ÂÂ MCU??STM32f405?Â´ÃªÂ³Â  SPI3??ÃªÂ°?Ã¬Â§?ÃªÂ³?w5500ÃªÂ³?DMAÃ«Â¥??ÂµÃ­ÂÂ???ÂµÃ¬ÂÂ ???Â Ã«Â Â¤ÃªÂ³??Â©Ã«ÂÂ?? 

	DMA_InitTypeDef DMA_InitStructure; // DMA clock enable
	GPIO_InitTypeDef GPIO_InitStructure;
	SPI_InitTypeDef  SPI_InitStructure;
          
          RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOC , ENABLE); // GPIO Clock Enable
	RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_DMA1 , ENABLE);
          RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_DMA2 , ENABLE);
	RCC_APB1PeriphClockCmd(RCC_APB1Periph_SPI3 , ENABLE);	//Ethernet MAC/PHY.          
          
          GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
	GPIO_InitStructure.GPIO_PuPd  = GPIO_PuPd_DOWN;
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10 | GPIO_Pin_11 | GPIO_Pin_12;
	GPIO_Init(GPIOC, &GPIO_InitStructure);          
          
	GPIO_PinAFConfig(GPIOC, GPIO_PinSource10, GPIO_AF_SPI3);	//CLK.
	GPIO_PinAFConfig(GPIOC, GPIO_PinSource11, GPIO_AF_SPI3);	//MISO. 
	GPIO_PinAFConfig(GPIOC, GPIO_PinSource12, GPIO_AF_SPI3);	//MOSI.

	SPI_InitStructure.SPI_Direction = SPI_Direction_2Lines_FullDuplex;
	SPI_InitStructure.SPI_DataSize = SPI_DataSize_8b; // Data Size
	SPI_InitStructure.SPI_CPOL = SPI_CPOL_Low; // SIG Edge
	SPI_InitStructure.SPI_CPHA = SPI_CPHA_1Edge; // Sig Phaser
	SPI_InitStructure.SPI_NSS = SPI_NSS_Soft; // CS 
	SPI_InitStructure.SPI_BaudRatePrescaler = SPI_BaudRatePrescaler_2;	// 21Mhz (@ APB1: 40.96MHz).
	SPI_InitStructure.SPI_FirstBit = SPI_FirstBit_MSB; // MSB
	SPI_InitStructure.SPI_CRCPolynomial = 7; // CRC
	SPI_InitStructure.SPI_Mode = SPI_Mode_Master;// SPI Master
	SPI_Init(SPI3, &SPI_InitStructure);
          
	DMA_DeInit(DMA1_Stream7);	// SPI3_TX event.
	DMA_InitStructure.DMA_Channel = DMA_Channel_0;
	DMA_InitStructure.DMA_PeripheralBaseAddr = SPI3_DR;
	DMA_InitStructure.DMA_DIR = DMA_DIR_MemoryToPeripheral;
	DMA_InitStructure.DMA_Memory0BaseAddr = (uint32_t)gbSpi3TxBuf;
	DMA_InitStructure.DMA_BufferSize = 32;
	DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
	DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Enable;
	DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Byte;
	DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_Byte;
	DMA_InitStructure.DMA_Mode = DMA_Mode_Normal;
	DMA_InitStructure.DMA_Priority = DMA_Priority_VeryHigh;
	DMA_InitStructure.DMA_FIFOMode = DMA_FIFOMode_Disable;
	DMA_InitStructure.DMA_FIFOThreshold = DMA_FIFOThreshold_HalfFull;
	DMA_InitStructure.DMA_MemoryBurst = DMA_MemoryBurst_Single;
	DMA_InitStructure.DMA_PeripheralBurst = DMA_PeripheralBurst_Single;
	DMA_Init(DMA1_Stream7, &DMA_InitStructure);

	DMA_DeInit(DMA1_Stream0);	// SPI3_RX event.
	DMA_InitStructure.DMA_Channel = DMA_Channel_0;
	DMA_InitStructure.DMA_PeripheralBaseAddr = SPI3_DR;
	DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralToMemory;
	DMA_InitStructure.DMA_Mode = DMA_Mode_Circular;
	DMA_InitStructure.DMA_Priority = DMA_Priority_VeryHigh;
	DMA_InitStructure.DMA_BufferSize = 32;
	DMA_InitStructure.DMA_Memory0BaseAddr = (uint32_t)gbSpi3RxBuf;
	DMA_Init(DMA1_Stream0, &DMA_InitStructure);            
          
          DMA_Cmd(DMA1_Stream0 , ENABLE);
          DMA_Cmd(DMA1_Stream7 , ENABLE);

          SPI3_CS_ETH = 0;
          ETH_RST = 1;
          ADC_SOC = 1;
          
          SPI_I2S_DMACmd(SPI3, SPI_I2S_DMAReq_Rx | SPI_I2S_DMAReq_Tx, ENABLE);          
          SPI_Cmd(SPI3,ENABLE);

?Â¸Ã­ÂÂ?? ?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ¬Ã¬Â£Â¼Ã¬ÂÂÃªÂ³?

	fcLanSndByte(0xD8, PHYCFGR);	//100BT Full-duplex, Auto-negotiation disabled.
	delay_ms(MSSECOND);
	fcLanSndByte(0x58, PHYCFGR);	//100BT Full-duplex, Auto-negotiation disabled. with Reset.
	delay_ms(MSSECOND);
	fcLanSndByte(0xD8, PHYCFGR);	//100BT Full-duplex, Auto-negotiation disabled.
	delay_ms(MSSECOND);

?Â´Ã«ÂÂ¹?Â´Ã¬ÂÂ©ÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ Ã¬Â´ÂÃªÂ¸Â°?ÂÃ«? Ã¬Â§ÂÃ­ÂÂ?Â Ã«Â Â¤ÃªÂ³??Â©Ã«ÂÂ?? 
fcLanSndByte ?Â¨Ã¬ÂÂ???ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. 

void fcLanSndByte(uint8_t data, uint32_t Addr)
{
	gbSpi3TxBuf[0] = (Addr >>16) & 0xff;
	gbSpi3TxBuf[1] = (Addr >>8) & 0xff;
	gbSpi3TxBuf[2] = (Addr & 0xf8) + 4;
	gbSpi3TxBuf[3] = data;
	fcSpi3Dma(gbSpi3TxBuf, NULL, 4);
	while( (SPI3->SR & (SPI_BUSY | SPI_TXE)) != SPI_TXE )
}
SPI?? ?ÂµÃ¬ÂÂ ???ÂÃ«ÂÂÃ¬Â§? ?ÂÃ«ÂÂ???ÂÃ¬????Â´Ã«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ´ ?ÂÃ«ÂªÂ»?ÂÃ¬ÂÂ?ÂÃ¬? Ã¬Â°Â¾ÃªÂ¸Â°ÃªÂ°? ?ÂÃ«ÂÂ?Â¤Ã¬ÂÂ. 

ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³?DMA??DMA1 Stream 0ÃªÂ³?7???Â¬Ã¬ÂÂ©?ÂÃ¬??ÂµÃ«ÂÂ?? 

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??

Ã¬Â¦ÂÃ¬ÂÂ?? DR?ÂÃ¬??Â¤Ã­ÂÂ°??ÃªÂ°ÂÃ¬ÂÂ´ ?Â°Ã¬ÂÂ´Ã¬Â§??ÂÃªÂ³Â  

SPI 3 TX Stream??Enable??Set???ÂÃ«Â²ÂÃªÂ¹??ÂÃ«Â©Â´?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ?ÂÃªÂ²Â Ã¬Â²ÂÃ«ÂÂ¼ Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ¤. 

?Â¤Ã¬ÂÂ¤Ã«Â¡ÂÃ¬ÂÂ¤Ã¬Â½ÂÃ­ÂÂÃ«Â¡??ÂÃ­ÂÂ??Ã¬Â°ÂÃ¬ÂÂ¼Ã«Â©??Â´Ã«ÂÂ¹?ÂÃ«ÂÂ DataÃªÂ°? Ã¬Â¶ÂÃ«Â Â¥?ÂÃ«ÂÂÃªÂ²ÂÃ¬? ?ÂÃ¬ÂÂ¸ ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. 

Ã«Â§ÂÃ¬? ?ÂÃ¬? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â¬ÃªÂ²Â ?ÂµÃ«ÂÂ?? The W5100S-EVB MUC is STM32F103VC and has a DMA project.
https://github.com/wiznet/w5100s-EVB/tree/master/dma
It would be nice to refer to the above project.

The Code you uploaded seems to take some time to check.
I will answer again after confirmation. [Quote = ""Becky, POST: 2, Topic: 6765""]
I will answer again after confirmation.
[/Quote]

Is the code not yet confirmed? hello

I'm sorry for late reply.
I don't see the settings about CS.
Also, the value of SPI3_DR
(UINT32_T) (& (SPI3-> DR))
Please check if it matches the above.","Q) Is the code not yet confirmed?
A) The code you uploaded seems to take some time to check. I will answer again after confirmation.

Q) I'm sorry for the late reply. I don't see the settings about CS. Also, the value of SPI3_DR (UINT32_T) (& (SPI3-> DR)) Please check if it matches the above.
A) None"
3635,677,"Hi!

I'm using the W5200 chip successfully in more than 50 boards, but have a non critical issue I would like to solve.
After powering the chip, initializing (using UDP) and opening a socket, reception is possible inmediately; however transmission is not possible for a while. The chip responds to a ping, but when trying to transmit, it returns 0 instead of the number of bytes that I'm trying to send. After 10, 20 or more retries during several seconds, the chip finally starts transmitting. After that, it works fine until the next time it is powerd on. What could be the reason for this behavior?

Kind Regards
Hector Hi,
Transimition problem is occured by many case.

The cases are as following..
1. Main power is unstable.
2. Not garanteed the reset time of chip.( over 150ms)
3. Ethernet link is unstable. (Internal ethernet phy takes time for auto-negotiation processing.)
===>To chekc link status, check the pin 5(nLINKLED) to go low or check the the 5th bit of PHYSTATUSR to set as '1'
4. mistake to send processing.
5. ARP timeout ouccur
6. unkown error. 

Your case seem to likely to be case 2, 3, 1. 

Thank you. Thanks for your prompt reply!

I can discard reason 1. Voltage is stable within +-20mV peak measured with 10us resolution.
I will analyze reasons 2 and 3 and post back.

Regards
Hector After powering up the board, the nRST pin is held low for 1ms to cause a reset.
After that there is a wait of 150ms before start configuring the chip.
After configuring the chip, the same procedure is done to reset the chip again.

The LINK byte of the PHY STATUS register has the value of 1 permanently

The chip can receive without problem, reponds to a ping, but it does not transmit anything for a while. Hi,
I understood your reset time and link status worked fine.

Can you post your w5200 driver codes or sending part of that ?

If possible, plz capture the network packet by using wireshark and post it.

Thank you. Hi
I was making some tests and found the following:

I did not mention, as I thought it was not relevant, that the application is also configuring at power on the Retry_time and Retry_count registers.  I'm setting Retry_time=50 (5ms) and Retry_count = 1  (I do this because with the default values, if there is no HOST, the W5200 halts the application for quite some time)
When removing this part of the initial configuration, the problem dissapears 

So what I'm doing now is sending anything before configuring Retry_time and Retry_count. In this case there is no problem. I don't understand why, though. 

Regards
Hector The problem with the previous solution is that it only works if the Retry registers are configured after a [u]succesfull[/u] transmission. This means that if there is no Peer available during power on, I cannot configure these registers.
This is a problem in my aplication because it sends a message looking for a Peer every second. This means that every second the application will be halted by the W5200 while it retries until it finds a Peer, which is a lot of time with the default values.

Looking for the LINK bit of the PHY STATUS register before transmitting is useless in many cases because this bit will be 1 as long as the W5200 is connected to a router, even if there is no Peer.

 Is there any way to configure the Retry registers without causing the initial delay in ready to transmit? Hi,
Before sending data to a peer, need to know the MAC address of peer.
ARP is the process of getting the MAC address. When ARP is failed, No data sends any more.
ARP needs to timeout value(RTR) & Retry count(RCR) because it can't wait until get the mac.
In addtion, UDP is a connectionless protocol and There is no guarantee that the messages or packets sent would reach at all.

Anyway, Your timeout value seems to be likely to  be short.
If without special purpose, you'd better use the default value.

Thank you. Hi,

[quote]it only works if the Retry registers are configured after a succesfull transmission.This means that if there is no Peer available during power on, I cannot configure these registers.[/quote]
RCR & RTR can be configured regardless of transmittion. Normaly, these registers are configured at start-up time, that is, these can be configured before data transmit. If you don't need to find a peer at that time, you can configured timeout value with short before data transmit.

As you said, initial delay in transmitting means ARP-processing, am I right?
If you want to no use APR-processing, You should be already known the peer's MAC address.
If you know the mac address, you can transmit data to the peer without ARP-processing.

For more detail, refer to Sn_CR_SEND_MAC command in datasheet.

Thank you. Yes, you are probably rigth; it must be the ARP-processing.

However there seems to be a difference in behavior of the W5200 at power up and later:
Once ARP-processing is done, if I disconnect the Peer, the W5200 does not halt the application so I understand that it is not attempting a new ARP process. However, If I connect a new Peer with a different MAC, the W5200 have no problem connecting to it. So why so many attempts at power up? After some tests I think I undertand the W5200 behavior (please correct me if I'm wrong):

At power up, the W5200 doesn't have a MAC associated to the Peer IP, so it will attempt to start an ARP process each time a packet is sent (tried to be sent actually). The W5200 will make all the Retry attemtps, which by default takes around 1,6 seconds.

This will happen every time a packet is sent to a Peer_ip which is not associated to a MAC; which, at power up, means that it will happen every time a packet is sent to a Peer which is not connected.

Once the Peer is connected, the ARP process will be done and the Peer_IP will be associated with the MAC IP.

After that, the W5200 doesn't attempt anymore to start an ARP process with this Peer_IP, no matter if the Peer is connected or not.

If we change the Peer_IP, again the W5200 will attempt to start an ARP process each time the packet is sent to the new IP.

If we change the Peer MAC but not the Peer_IP I don't know what will happen, but this is a very rare case anyway.

The Peer_IP to MAC assosiation is not saved, so it will be lost at power off and the process will start again at power up.

I hope this is useful for others
Regards
Hector Hi,
You exactly understood the arp-process of W5200.

Because W5200 doesn't manage ARP-cache table, ARP processed on power on(reset) and different(new) peer ip.
Here, new peer ip means that the ip address different from the previous ip address. That is, when ip address is changed on every trasmit, ARP process on every transimt.

If APR-process time is overhead, you should manage ARP-cache table and use Sn_CR_SEND_MAC instead of Sn_CR_SEND, as the above said.

Thank you. Thanks!
It is clear","Q) After powering the chip, initializing (using UDP) and opening a socket, reception is possible immediately; however transmission is not possible for a while. The chip responds to a ping, but when trying to transmit, it returns 0 instead of the number of bytes that I'm trying to send. After 10, 20 or more retries during several seconds, the chip finally starts transmitting. After that, it works fine until the next time it is powered on. What could be the reason for this behavior?
A) Transimition problem is occurred by many cases.
The cases are as following...
1. Main power is unstable.
2. Not guaranteed the reset time of the chip. (over 150ms)
3. Ethernet link is unstable. (Internal ethernet phy takes time for auto-negotiation processing.) To check link status, check the pin 5(nLINKLED) to go low or check the 5th bit of PHYSTATUSR to set as '1'
4. Mistake to send processing.
5. ARP timeout occur
6. Unknown error. Your case seems to likely to be case 2, 3, 1. Thank you.

Q) I can discard reason 1. Voltage is stable within +-20mV peak measured with 10us resolution. I will analyze reasons 2 and 3 and post back.
A) None.

Q) After powering up the board, the nRST pin is held low for 1ms to cause a reset. After that, there is a wait of 150ms before start configuring the chip. After configuring the chip, the same procedure is done to reset the chip again. The LINK byte of the PHY STATUS register has the value of 1 permanently. The chip can receive without problem, responds to a ping, but it does not transmit anything for a while.
A) I understood your reset time and link status worked fine. Can you post your W5200 driver codes or sending part of that? If possible, please capture the network packet by using Wireshark and post it. Thank you.

Q) I was making some tests and found the following: I did not mention, as I thought it was not relevant, that the application is also configuring at power on the Retry_time and Retry_count registers. I'm setting Retry_time=50 (5ms) and Retry_count = 1 (I do this because with the default values, if there is no HOST, the W5200 halts the application for quite some time). When removing this part of the initial configuration, the problem disappears. So what I'm doing now is sending anything before configuring Retry_time and Retry_count. In this case, there is no problem. I don't understand why, though.
A) None.

Q) The problem with the previous solution is that it only works if the Retry registers are configured after a succesfull transmission. This means that if there is no Peer available during power on, I cannot configure these registers. This is a problem in my application because it sends a message looking for a Peer every second. This means that every second the application will be halted by the W5200 while it retries until it finds a Peer, which is a lot of time with the default values. Looking for the LINK bit of the PHY STATUS register before transmitting is useless in many cases because this bit will be 1 as long as the W5200 is connected to a router, even if there is no Peer. Is there any way to configure the Retry registers without causing the initial delay in ready to transmit?
A) Before sending data to a peer, need to know the MAC address of the peer. ARP is the process of getting the MAC address. When ARP fails, No data sends anymore. ARP needs to timeout value(RTR) & Retry count(RCR) because it can't wait until getting the MAC. In addition, UDP is a connectionless protocol and There is no guarantee that the messages or packets sent would reach at all. Anyway, Your timeout value seems to be likely to be short. If without special purpose, you'd better use the default value. Thank you.

Q) ""it only works if the Retry registers are configured after a successful transmission. This means that if there is no Peer available during power on, I cannot configure these registers."" RCR & RTR can be configured regardless of transmission. Normally, these registers are configured at start-up time, that is, these can be configured before data transmit. If you don't need to find a peer at that time, you can configure the timeout value with a short time before data transmit. As you said, the initial delay in transmitting means ARP-processing, am I right? If you want to not use ARP-processing, You should already know the peer's MAC address. If you know the MAC address, you can transmit data to the peer without ARP-processing. For more detail, refer to Sn_CR_SEND_MAC command in the datasheet.
A) None.

Q)  Once ARP-processing is done, if I disconnect the Peer, the W5200 does not halt the application so I understand that it is not attempting a new ARP process. However, If I connect a new Peer with a different MAC, the W5200 has no problem connecting to it. So why so many attempts at power up? After some tests I think I understand the W5200 behavior (please correct me if I'm wrong): At power up, the W5200 doesn't have a MAC associated with the Peer IP, so it will attempt to start an ARP process each time a packet is sent (tried to be sent actually). The W5200 will make all the Retry attempts, which by default takes around 1.6 seconds. This will happen every time a packet is sent to a Peer_IP which is not associated with a MAC; which, at power up, means that it will happen every time a packet is sent to a Peer which is not connected. Once the Peer is connected, the ARP process will be done and the Peer_IP will be associated with the MAC IP. After that, the W5200 doesn't attempt anymore to start an ARP process with this Peer_IP, no matter if the Peer is connected or not. If we change the Peer_IP, again the W5200 will attempt to start an ARP process each time the packet is sent to the new IP. If we change the Peer MAC but not the Peer_IP, I don't know what will happen, but this is a very rare case anyway. The Peer_IP to MAC association is not saved, so it will be lost at power off and the process will start again at power up. I hope this is useful for others Regards Hector
A) You exactly understood the ARP-process of W5200. Because W5200 doesn't manage the ARP-cache table, ARP is processed on power on(reset) and different(new) peer IP. Here, the new peer IP means that the IP address is different from the previous IP address. That is, when the IP address is changed on every transmit, ARP-process on every transmit. If APR-process time is overhead, you should manage the ARP-cache table and use Sn_CR_SEND_MAC instead of Sn_CR_SEND, as the above said. Thank you.

Q) Thanks! It is clear
A) None."
3636,6771,"Hello there...
In the past i used Wiz110SR for my projects. There is Wiz1xxSR config tools to search for all of Wiz110SRs that are connected to network, and i can change their settings (IP, subnet, gateway, port, etc) easily. But currently i am using W5500 chip and there is no such applications like Wiz1xxSR config tools. I want to make this config tools myself. Do you have any algorithm suggestions how to create this app?
Or do you have another suggestions how to set the IP, port, gateway, subnet mask, server IP, and mode (server/client) via LAN ? We open the source code for Configuration tool.
It is for WIZ550S2E. The configuration Tool use java language.
https://github.com/Wiznet/WIZnet_Configuration_Tool
https://github.com/Wiznet/WIZ550S2E

And it is for WIZ750SR. This configuration Tool use python language.
https://github.com/Wiznet/WIZ750SR
https://github.com/Wiznet/WIZnet-S2E-Tool-GUI

If you have any questions, please ask me.","Q) Do you have any algorithm suggestions on how to create the W5500 chip configuration tool?
A) I don't have a specific algorithm, but you can refer to the source code for the Configuration Tool provided by Wiznet for WIZ550S2E, which uses Java language. Additionally, you can check the Configuration Tool for WIZ750SR, which uses Python language, for insights on creating your own configuration tool for the W5500 chip. And if you have specific questions, feel free to ask."
3637,6777,"hello.

The Quick Start Guide is uploaded only on the EVB page on the dealer site.
If you answer, I will ask you to ask.

thank you [Quote = ""Junlee, Post: 1, Topic: 6777""]
Quick Start Guide is EVB page
[/Quote]
There is no USB connector, so it's hard to connect to the cereal, so it doesn't seem to be related to the Quick Start Guide,
However, the modules are also out of the pins, so if you add a module -specific connection to the document, you can share the QUCIK Start Guide together. In the case of IO-C type, you can connect if you have a Cable.
In the case of IO-H type, do you want to use an adapter board for XBEE pin header?","Q) There is no USB connector, so it's hard to connect to the cereal, so it doesn't seem to be related to the Quick Start Guide, However, the modules are also out of the pins, so if you add a module-specific connection to the document, you can share the QUCIK Start Guide together. In the case of IO-C type, you can connect if you have a Cable. In the case of IO-H type, do you want to use an adapter board for XBEE pin header?
A) Quick Start Guide is uploaded only on the EVB page on the dealer site."
3638,6779,"Inquiries about WPS connection.

At+cwjap_def = aaaa, bbbbb
AP automatic year -old connection is completed.

To use WPS
+++ at+wps = 1
WPS Started

OK
WiFi Disconnect
WPS SUCCESS, CONNECTING AP ...
The connection is complete.

[inquiry]
If you restart the wizfi360 with AT+RST,
I try with the existing AP connected before the WPS, but none of them are connected.
What should I do? hello.
I'm sorry for late reply.

First of all, you need the firmware version information of the Wizfi360 you use.
Please check the version information through the AT+GMR command.","Q) If you restart the wizfi360 with AT+RST, I try with the existing AP connected before the WPS, but none of them are connected. What should I do?
A) You need the firmware version information of the Wizfi360 you use. Please check the version information through the AT+GMR command."
3639,678,"Hello.Newcon Tech, a sensor network development.

We read the sensor value using the microcontroller and the analog circuit for more than 10 years, and 485 communications or Ethernet modules.
I have been using it.The previous system used the company's module called Sol X System, which is for high speed transmission.
I didn't seem to be very good, so I adopted your module.

Currently, I purchased two Wiz820IO modules, and the PCB Artwork with my modules is over,
PCB will come in about Thursday.

SPI communication or UART communication has always been done, so there is no problem.
There is no.However, I lack knowledge related to Ethernet/IP/TCP/UDP, so I have a lot of worry.

What we want to do is to read the sensor value remotely and send it every time (1/1000 seconds).

Question.
1. The data must be about 100 bytes every 1/2000 seconds.Of course, 10 data is tied up every 1/200 seconds
   You can also send it.In this case, it's okay to use TCP.

2. If you try to send the data to the host that is remotely, you will pass through the complex network and reach the host.
   In this case, what kind of setting should you do?When you go through KT's mega pass network, IP router or public hub
   If you are using it, what kind of setting should you do?For reference, our PCB must be a client.

3. When I try to see the W5200 example, there are four versions of the version, and in the form of a one and a patching patch.
  Should I install it?

4. I heard that ARP is used to find out the MAC in a private network.But for ARP, the product reset it.
  If you do it, you will do it.There seems to be no code related to ARP.

5. Can I go to see you and have technical inquiries? hello.
Wiznet.
See the answer below.

[Quote = ""NewContek""]
1. The data must be about 100 bytes every 1/2000 seconds.Of course, 10 data is tied up every 1/200 seconds
   You can also send it.In this case, it's okay to use TCP.
[/Quote]
Yes, you can use the TCP socket.
Instead, when the network is not good, the TCP connection is made of retransmission, which can be short for 1/2000 seconds or 1/200 seconds.However, I don't think it's a problem.

[Quote = ""NewContek""]
2. If you try to send the data to the host that is remotely, you will pass through the complex network and reach the host.
   In this case, what kind of setting should you do?When you go through KT's mega pass network, IP router or public hub
   If you are using it, what kind of setting should you do?For reference, our PCB must be a client.
[/Quote]
If the device operates as a client, it is not necessary to do a special setting.If it operates as a server, when you try to connect outside the router, you need to set up port forwarding to the router to deliver a packet inside, but if you operate in the client mode, you can connect if you only enter the server's IP address correctly.But there is no problem.

[Quote = ""NewContek""]
3. When I try to see the W5200 example, there are four versions of the version, and in the form of a one and a patching patch.
  Should I install it?
[/Quote]
The W5200 example is independently configured according to the application type.It's not a way to patch.

[Quote = ""NewContek""]
4. I heard that ARP is used to find out the MAC in a private network.But for ARP, the product reset it.
  If you do it, you will do it.There seems to be no code related to ARP.
[/Quote]
Every time an Etherent Connection occurs, ARP is required regardless of whether or not the private network is.However, ARP processing is performed internally within the chip, so there is no part to be processed in the code.

[Quote = ""NewContek""]
5. Can I go to see you and have technical inquiries?
[/Quote]
If you do not solve it online with specific problems, we can provide visit or request a visit.However, in most cases, it is solved online, so you don't have to worry about it.

thank you Thank you for your answer.

Then I will test it brave.","Q) The data must be about 100 bytes every 1/2000 seconds.Of course, 10 data is tied up every 1/200 seconds You can also send it.In this case, it's okay to use TCP.
A) Yes, you can use the TCP socket. Instead, when the network is not good, the TCP connection is made of retransmission, which can be short for 1/2000 seconds or 1/200 seconds. However, I don't think it's a problem.

Q) If you try to send the data to the host that is remotely, you will pass through the complex network and reach the host. In this case, what kind of setting should you do?When you go through KT's mega pass network, IP router or public hub If you are using it, what kind of setting should you do?For reference, our PCB must be a client.
A) If the device operates as a client, it is not necessary to do a special setting. If it operates as a server, when you try to connect outside the router, you need to set up port forwarding to the router to deliver a packet inside, but if you operate in the client mode, you can connect if you only enter the server's IP address correctly. But there is no problem.

Q) When I try to see the W5200 example, there are four versions of the version, and in the form of a one and a patching patch. Should I install it?
A) The W5200 example is independently configured according to the application type. It's not a way to patch.

Q) I heard that ARP is used to find out the MAC in a private network. But for ARP, the product reset it. If you do it, you will do it. There seems to be no code related to ARP.
A) Every time an Etherent Connection occurs, ARP is required regardless of whether or not the private network is. However, ARP processing is performed internally within the chip, so there is no part to be processed in the code.

Q) Can I go to see you and have technical inquiries?
A) If you do not solve it online with specific problems, we can provide visit or request a visit. However, in most cases, it is solved online, so you don't have to worry about it."
3640,6787,"hello,
I am new to W5500. I am planning to use the chip on one of my project, for the same i have bought an evaluation board of the same W5500-EVB .
Now what my problem really is that , i have set the w5500 as Slave and Ti Tms320f28335 as Master to send data to the W5500.
now i want to capture these recieved data over the ethernet provided on the board . But i have no idea of doing it. Please help me with a sample program if there is any. Sorry.

We are not the examples used the TI TMS320F28335.

But we have an example of using the various MCU.

You can find them at the below URL.

https://github.com/Wiznet

And we offer a library for the use of the W5500.

We call it ""**ioLibrary**"". ioLibrary is below URL.

https://github.com/Wiznet/ioLibrary_Driver

Note that you have to use a different MCU, should be used with ioLabrary porting your project.

Thank you. Can you be bit more specific on the example.
I mean , what really my target is to program the LPC controller in the EVB to give out spi data through Master out pin . Can you be bit more specific on the example.
I mean , what really my target is to program the LPC controller in the EVB to give out spi data through Master out pin . I think you should use this project.
We made that this project is based on W5500EVB(W5500 +Cortex M0(LPC11E36FHN33)).
link : [W5500 EVB Github](https://github.com/Wiznet/W5500_EVB)
This project is controlled through spi between w5500 and MCU.","Q) Now what my problem really is that , i have set the w5500 as Slave and Ti Tms320f28335 as Master to send data to the W5500. Now i want to capture these received data over the ethernet provided on the board. But i have no idea of doing it. Please help me with a sample program if there is any. 
A) We are not the examples used the TI TMS320F28335. But we have an example of using the various MCU. You can find them at the below URL:
https://github.com/Wiznet. And we offer a library for the use of the W5500. We call it ""ioLibrary"". ioLibrary is at the below URL:
https://github.com/Wiznet/ioLibrary_Driver. Note that you have to use a different MCU, should be used with ioLibrary porting your project.

Q) Can you be a bit more specific on the example. I mean, what really my target is to program the LPC controller in the EVB to give out SPI data through the Master out pin. 
A) I think you should use this project. We made that this project is based on W5500EVB (W5500 + Cortex M0 (LPC11E36FHN33)). Link: [W5500 EVB Github](https://github.com/Wiznet/W5500_EVB). This project is controlled through SPI between W5500 and MCU."
3641,6789,"I think it seems that Wizfi360 evb mini board is working as a device having both ESP8266 and its AT firmware because it supports ESP8266 AT command list. Is it right?

I know that ESP8266's devices supports Arduino IDE for our development. However, the mini board dosen't support it. So I'd like to know if you have a plan to support Arduino IDE.

And, I wonder if the firmware sources of the mini board is open firmware source to us. Yes you can use Arduino IDE but not WizFi360-evb-mini.

If you want to use Arduino IDE, I can recommend you WizFi360-evb-shield.
There is a interface for arduino board and you can control WizFi360 through Arduino.

Here is some document links for ref.
These are talking about arduino http server & client examples

http://wizwiki.net/wiki/lib/exe/fetch.php/products:wizfi360:wizfi360ds:wizfi360_an_hs_v101e.pdf
http://wizwiki.net/wiki/lib/exe/fetch.php/products:wizfi360:wizfi360ds:wizfi360_an_hc_v101e.pdf

And this link has all documents for WizFi360
http://wizwiki.net/wiki/doku.php/products:wizfi360:wizfi360ds:start OK, thanks for your infomation. OK, thanks for your information.","Q) I think it seems that Wizfi360 evb mini board is working as a device having both ESP8266 and its AT firmware because it supports ESP8266 AT command list. Is it right? 

Q) I know that ESP8266's devices supports Arduino IDE for our development. However, the mini board dosen't support it. So I'd like to know if you have a plan to support Arduino IDE. 

Q) And, I wonder if the firmware sources of the mini board is open firmware source to us. 

A) Yes you can use Arduino IDE but not WizFi360-evb-mini. If you want to use Arduino IDE, I can recommend you WizFi360-evb-shield. There is an interface for arduino board and you can control WizFi360 through Arduino. 

A) Here is some document links for ref. These are talking about Arduino HTTP server & client examples:
http://wizwiki.net/wiki/lib/exe/fetch.php/products:wizfi360:wizfi360ds:wizfi360_an_hs_v101e.pdf
http://wizwiki.net/wiki/lib/exe/fetch.php/products:wizfi360:wizfi360ds:wizfi360_an_hc_v101e.pdf
And this link has all documents for WizFi360: http://wizwiki.net/wiki/doku.php/products:wizfi360:wizfi360ds:start

A) OK, thanks for your information."
3642,679,I'm implementing a mode bus TCP using 127SR ... I wonder if it's possible. [url]https://forum.wiznet.io/t/wiz127sr-modbus-tcp/680/1],"Q) I'm implementing a modbus TCP using 127SR ... I wonder if it's possible.
A) The WIZ127SR module does support Modbus TCP. You can refer to the WIZnet forum for more information: [url]https://forum.wiznet.io/t/wiz127sr-modbus-tcp/680/1"
3643,6790,"I developed my own W5500 driver for 20+ commercial applications.  Up to this point, I have utilized a polling approach to execute all functions and the driver has performed flawlessly in this  mode.  I have a new client who wants me to use the Free RTOS operating system for an application which means I need to use the interrupt capabilities of the W5500.  At first, this seemed like an easy task because I only needed to add some initialization code and an interrupt handler to my existing driver.  However, after 40+ hours of hardware and software debugging, I have determined that the behavior of the W5500 interrupts do not match the data sheet in any way!!  Specifically, once an interrupt occurs (i.e. the INT pin goes low), there is no way to clear the interrupts to allow the INT pin to go high again.  (If the INT pin does not go high, no more interrupts will be triggered!!)

The initialization code is shown below:

void ConfigureW5500
        (UCHAR * pDeviceIP,                          // pointer to ip address
         UCHAR * pGatewayIP,                       // pointer to gateway ip address
         UCHAR * pMacAddrs,                       // pointer to mac address
         int     nBuffSizes [][2])                       // buffer size table 
   //-----------------------------------------------------------------------
   // Configure the registers in the W5500: 
   W5500_RESET_LO;                                 // set reset low to assert
   delay_us (100);                                       // delay for 100 microseconds
   W5500_RESET_HI;                                 // set reset high to clear
   WriteCommMR (MR_RST);                   // reset the W5500 registers
   delay_ms (100);                                      // delay while the W5500 resets
   WriteCommIMR (0x00);                        // disable common interrupts
   WriteCommSIMR (0x00);                      // disable socket interrupts
   WriteCommSIPR (pDeviceIP);              // write the device IP address
   WriteCommGAR  (pGatewayIP);          // write the gateway IP address
   WriteCommSUBR (_uSubMaskW5500);      // write the subnet mask
   WriteCommSHAR (pMacAddrs);          // write the MAC address
   WriteCommRTR (12000);                      // write the retry time-out period
   WriteCommRCR (3);                              // write the retry count
   //-----------------------------------------------------------------------
   // Set the receive and transmit buffer sizes:
   BYTE bySockt=0;                                    // socket number
   BYTE bySizeInK=0;
   for (bySockt=SOCKT_0;
        bySockt <= SOCKT_7;
        bySockt++)
   {
      _nRxBuffSizeW5500 [bySockt]=      // set the RX buffer size
             nBuffSizes [bySockt][0]; 
      bySizeInK=                                           // determine the RX buffer size in
         nBuffSizes [bySockt][0]/1024;       //  kilobytes   
      WriteSocktRxBuffSize 
                (bySockt, bySizeInK);               // set the socket RX buffer size
      _nTxBuffSizeW5500 [bySockt]=       // set the TX buffer size
             nBuffSizes [bySockt][1]; 
      bySizeInK=                                          // determine the TX buffer size in
         nBuffSizes [bySockt][1]/1024;      //  kilobytes   
      WriteSocktTxBuffSize 
                (bySockt, bySizeInK);               // set the socket TX buffer size
   }
   //-----------------------------------------------------------------------
   // If interrupts enabled, configure the W5500 interrupt registers:
   WriteCommSIMR (0x0f);                      // enable socket interrupts 
   //-----------------------------------------------------------------------
   // If interrupts enabled, configure the PIO driver:
   icPIOA_W5500.uIntruptMask=           // W5500 interrupt enable bit
                        NEC_INT_MASK;
   icPIOA_W5500.uAIM_Mode=
                    FALLING_EDGE_AIM;          // falling edge AIM mode
   icPIOA_W5500.uAIM_IntruptMask= // AIM interrupt enable bit
                        NEC_INT_MASK;
   icPIOA_W5500.uIntruptPriority=0;     // interrupt priority
   icPIOA_W5500.pHandler=ISR_W5500;  // pointer to interrupt handler
   ConfigIntruptsPIO                                // configure the W5500 interrupts
       (PIO_A, ID_PIOA, icPIOA_W5500);
#endif
}

The interrupt handler code is shown below:

void ISR_W5500
        (int  nPIO_ID,                                // PIO interrupt ID
         UINT uIntStatus)                        // interrupt (I\N\T\) pin level
{
   UCHAR uSockt;                               // socket number
   for (uSockt=SOCKT_0;
        uSockt < SOCKT_7;                   // set to process all 8 sockets
        uSockt++)
   //-----------------------------------------------------------------------
   // Get the socket interrupt bits, save them in the status array and reset
   //  the interrupt bits in the socket interrupt registers (IR):
   {
      SOCKT_STATUS=                               // get socket interrupt bits and 
         (ReadSocktIR (uSockt) & 0x1f);    //  save them in status array
      WriteSocktIR (uSockt, 0x1f);            // reset the interrupt bits
   }
   //-----------------------------------------------------------------------
   // Reset the common interrupt bits in the common interrupt register (IR):
   WriteCommIR (0xf0);                            // reset common interrupts
   //-----------------------------------------------------------------------
   // Verify that the interrupt pin on the W5500 is high indicating that all
   //  interrupt conditions have been cleared:
   int nIntPinLevel=                                   // get the level of the interrupt
      GetPinsPIO (PIO_A, NEC_INT_MASK); //  pin on the W5500
   if (!nIntPinLevel)                                  // if the pin is still low, turn the
   {                                                              //  Error LED on
      ErrorOnLED ();
   }  
}

When the code above executes, the Error LED ALWAYS comes on because the INT pin remains low even after 1's are written to all of the common and socket interrupt status registers.

I would like to find anyone who has ever successfully implemented interrupt operation using the W5500. [quote=""BitBanger46, post:1, topic:6790""]
When the code above executes, the Error LED ALWAYS comes on because the INT pin remains low even after 1?Âs are written to all of the common and socket interrupt status registers.
[/quote]

What interrupt registers read at this time - before abd after their reset?

Let's consider the possibilities why flags do not reset:
1. you write reset flags to wrong location, or write does not happen;
2. there's some condition causing flag to be continuously set. After some debugging, I determined that the problem was caused by writing to the W5500 registers while in the interrupt routine. I discovered that, if the code that was executing was accessing the registers in the W5500 when an interrupt occurred, then it is possible for a conflict to occur.  I changed the code in the interrupt routine to set a flag indicating that an interrupt occurred.  The interrupt routine does not access any of the registers in the W5500.  When the program that is executing sees the interrupt flag is set, it will read the interrupt status registers to determine the cause if the interrupt and reset the interrupt status bits.   I am working on another approach which is to disable interrupts from the W5500 whenever the program that is executing accesses the W5500 registers.  This too will prevent any conflicts. [quote=""BitBanger46, post:3, topic:6790""]
I determined that the problem was caused by writing to the W5500 registers while in the interrupt routine.
[/quote]

The interrupt condition must be cleared in the ISR, otherwise after exiting the ISR, it will be (immediately) called again. I've found a precaution regarding the interrupt in the application note of W5100S which maybe applicable to W5500.

https://wizwiki.net/wiki/lib/exe/fetch.php/products:w5100s:application:w5100s_an_interrupt_v100e.pdf 

It says that the interrupt may happen in the middle of SPI signaling and if there are any code to control
SPI signal in the Interrupt Handler like writing or reading from a register, the SPI frame will be damaged.

So, @BitBanger46  you are right regarding this. However, after some trials and error in my code I concluded that if the interrupt happens periodically and fast about every <= 1s, the SPI will break and code stopped working. If the interrupt happens to be for example every 1 min like my case it will be ok but still it is a bad practice and your suggestion by setting a flag is the best way. Thank you for the additional information about the problem with interrupts.  It should be helpful to developers who are writing interrupt driven code.","Q) What interrupt registers read at this time - before and after their reset?
A) The interrupt registers need to be read before and after their reset to determine the cause of the interrupt and reset the interrupt status bits.

Q) I developed my own W5500 driver for 20+ commercial applications. Up to this point, I have utilized a polling approach to execute all functions and the driver has performed flawlessly in this mode. I have a new client who wants me to use the Free RTOS operating system for an application which means I need to use the interrupt capabilities of the W5500.
A) The FreeRTOS operating system for an application requires the use of the interrupt capabilities of the W5500, which differs from the polling approach used in the previous driver.

Q) I would like to find anyone who has ever successfully implemented interrupt operation using the W5500.
A) The interrupt condition must be cleared in the ISR; otherwise, after exiting the ISR, it will be immediately called again.

Q) What are the possibilities why flags do not reset?
A) The possibilities include writing reset flags to the wrong location or not having the write happen, or there's some condition causing the flag to be continuously set.

Q) I determined that the problem was caused by writing to the W5500 registers while in the interrupt routine.
A) The problem was caused by writing to the W5500 registers while in the interrupt routine.

A) After some trials and error in my code, I concluded that if the interrupt happens periodically and fast about every <= 1s, the SPI will break and the code stopped working. If the interrupt happens to be, for example, every 1 min, like my case, it will be okay, but it is still a bad practice. Thank you for the additional information about the problem with interrupts."
3644,680,"We want to implement MODBUS TCP using 127SR.
Is it possible to just match the mode bus protocol? The Wiz127SR is not a module created for Modbus TCP, but the serial to ethernet function is transparent.
Therefore, it is possible to match the protocol at both ends.
For reference, we are currently trying to develop MODBUS TCP products.: Smiley:","Q) We want to implement MODBUS TCP using 127SR. Is it possible to just match the modbus protocol? 
A) The Wiz127SR is not a module created for Modbus TCP, but the serial to ethernet function is transparent. Therefore, it is possible to match the protocol at both ends. For reference, we are currently trying to develop MODBUS TCP products."
3645,6804,"Hi,

We have two boards in which W7100A stopped working after couple of week's successful run time.
We modified some of the settings e.g. ip addr, gateway, disabled debug messages over serial, serial baud rate, even parity according to our need and it was working, it stopped responding after couple of weeks.

We verified following HW signals which seems good - 
1. PLLLOCK - found High
2. nRST - found High
3. 25 MHz on XTLP0 and XTLN0
4. 11.0592 MHz on XTLP1 and XTLN1

We are not able to connect it through config tool.

Thanks. It is difficult to answer because there is no symptom of how to die.
We need more information such as debug messages and packets.
It would be helpful if you could let me know your hardware environment. 
The W7100A is a very old product based on the 8051, so detailed technical support is difficult.
Using another product, such as the WIZ750SR-100, makes technical support easier.
Samples of one or two modules are available. Thanks Becky for reply.

We have disabled the 'debug msg output' in wiznet as a part of our requirement, so I think debug msg is not possible. We also disabled the 'serial command mode' as part of our need.

Is there any way I can read and write wiznet's settings ?

Our HW is similar to the reference design of WIZ107SR, Do you have any particular question/s on HW environment ? I will connect to our HW teanm and let you know. Bercky, I wanted to highlight what we observed on one of the failed boards.

Out of two, one of the failed boards have settings defaulted (will let you know the second board's status soon) . We had changed following settings ip address, gateway, serial baudrate, parity, ?Âdebug msg output feature, serial command mode feature, serial data packing condition settings; all these settings are defaulted to its factory default.

Please note that the wiznet FW on chip is 4.06, hence noise on nFAC_RST pin should not be the cause of this defaulting situation according to user manual.

We also disabled the 'serial cmd mode', hence any serial payload should not cause this situation either.

Thanks. Becky,

Have these kind of defaulting anomaly reported past on W7100A ?
Does Wiznet have any plan to release FW as a resolution. @becky

We are in development phase and using 2 boards ; both boards' settings defaulted.

Do you want a wireshark trace exactly when the board started not functioning ?....OR any trace with normal communication operations in our application is fine ? [quote=""pradeep.patolia, post:7, topic:6804""]
Do you want a wireshark trace exactly when the board started not functioning ?
[/quote]
Yes, we should find the cause.","Q) Have these kind of defaulting anomaly reported past on W7100A ?
Q) Do you want a wireshark trace exactly when the board started not functioning ?....OR any trace with normal communication operations in our application is fine ?
Q) Do you have any particular question/s on HW environment ?

A) It is difficult to answer because there is no symptom of how to die. We need more information such as debug messages and packets. It would be helpful if you could let me know your hardware environment. The W7100A is a very old product based on the 8051, so detailed technical support is difficult. Using another product, such as the WIZ750SR-100, makes technical support easier. Samples of one or two modules are available. 
A) Yes, we should find the cause.
A) Becky, I wanted to highlight what we observed on one of the failed boards. 
A) We should find the cause."
3646,6806,"Hello,
The datasheet says ""Supports 8 independent sockets simultaneously"". What exactly this mean? Does it mean that I can only have 8 TCP/IP connections simultaneously? Can you elaborate the mentioned sentence please?
Thank you,
Regards That's exactly what it means. On the bright side, the hardware manages the SYN/ACK process on listening sockets to establish a connection without software intervention, but on the down side you're limited to 8 simultaneous network connections (TCP and/or UDP). Hi
""Supports 8 independent sockets simultaneously??mean you can use 8 kinds of application.","Q) What exactly does ""Supports 8 independent sockets simultaneously"" mean? Does it mean that I can only have 8 TCP/IP connections simultaneously? Can you elaborate on the mentioned sentence please? Thank you. 
A) That's exactly what it means. On the bright side, the hardware manages the SYN/ACK process on listening sockets to establish a connection without software intervention, but on the down side you're limited to 8 simultaneous network connections (TCP and/or UDP). ""Supports 8 independent sockets simultaneously"" means you can use 8 kinds of application."
3647,6807,"https://github.com/wiznet/wiznet/w7500/blob/master/w7500x_library_examples/projects/peripheral_examples/ssp/sd_card_led/main.c

hello
You can use the above example. ???ÂµÃ«? ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
?Â¹Ã¬ÂÂ w7500?Â´Ã«ÂÂ w7500p???Â°Ã«ÂÂ?ÂÃ«ÂÂspi flash ( winbond??microchip ???ÂÃ­ÂÂ ?Â¼Ã«Â¡Â ) ?Â°Ã«ÂÂ ?ÂÃ¬Â Â???ÂÃ¬ÂÂÃªÂ¹ÂÃ¬ÂÂ ?

2019??12??5??(Ã«Âª? ?Â¤Ã­ÂÂ 5:45, Becky Jeong via WIZnet Developer Forum <wiznet@discoursemail.com>?ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ±:","Q) You can use the above example. 
A) ??ÂµÃ«? ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
?Â¹Ã¬ÂÂ w7500?Â´Ã«ÂÂ w7500p???Â°Ã«ÂÂ?ÂÃ«ÂÂspi flash ( winbond??microchip ???ÂÃ­ÂÂ ?Â¼Ã«Â¡Â ) ?Â°Ã«ÂÂ ?ÂÃ¬Â Â???ÂÃ¬ÂÂÃªÂ¹ÂÃ¬ÂÂ ?"
3648,6811,"Constituent
PC -Serial -WIZ750SR -PC (LAN)
-----------

The WIZ750SR becomes a server and the PC is client
Which command should I use to send messages to a PC or serial?

What is the setting for transmitting a message?

Example) Data Size Settings, etc. hello.

The WIZ750SR is a device that converts the data in the serial to Ethernet, or the Ethernet into serial data, and the device does not directly send the data.

First of all, refer to the link below to conduct a basic communication test.

- [Forum FAQ: Module test method] (https://forum.wiznet.io/t/topic/4143)

thank you If you turn off the command mode and send the message to the cereal,
Is the structure that transmits data to the set value? Yes, that's right.
TCP connection cannot be done in cereal command mode. Is the socket connection automatically open with a set value? Yes, the socket is automatically open.
For WIZ750SR, you can monitor your status through the debug message of UART2.
(Connect using USB to serial module, etc.

thank you","Q) Which command should I use to send messages to a PC or serial? What is the setting for transmitting a message? 
A) The WIZ750SR module can be configured to send messages to a PC or serial using specific commands. To set the parameters for transmitting a message, you can adjust the data size settings, etc., for example, 'hello'.

Q) If you turn off the command mode and send the message to the serial, is the structure that transmits data to the set value? Is the socket connection automatically open with a set value? 
A) Yes, when the command mode is turned off and the message is sent to the serial, the data is transmitted based on the set value. The socket connection is automatically opened with the set value in the WIZ750SR module.

Thank you."
3649,6814,"In version 1.30, the function is not supported.
The firmware must be modified separately.
For User Name, it is also available for modifying firmware. Thank you for your answer late.

Is there a firmware that supports this feature?I know that 1.30 is the latest version.If you can simply modify it, can you provide the modified firmware from the WIZNET?I would like to use it without changing the wiznet model as much as possible.

If it is impossible, there are other models that can be communicated and other models with certified Mac address? In the case of TLS, there are many specs, so we can't provide it universally.
It seems to be necessary to provide a meeting.
If you can visit Wiznet, please tell us the schedule.
Please mail to beky@wiznet.io.","Q) Is there a firmware that supports this feature? I know that 1.30 is the latest version. If you can simply modify it, can you provide the modified firmware from the WIZNET? I would like to use it without changing the wiznet model as much as possible. If it is impossible, there are other models that can be communicated and other models with certified Mac address? 
A) The firmware must be modified separately. For User Name, it is also available for modifying firmware. Thank you for your answer late. 
Q) In the case of TLS, there are many specs, so we can't provide it universally. It seems to be necessary to provide a meeting. If you can visit Wiznet, please tell us the schedule. Please mail to beky@wiznet.io. 
A) None."
3650,6819,"In the datasheet it says on page 3:
3V operation with 5V I/O signal tolerance

But in the table with Absolute Maximum ratings:
DC input voltage:  -0.5 to 4.6 V

What is the actual maximum voltage for io pins?? I used W5100 in the 5V I/O environment. It was total failure. While chip did not fry, its timing (due to capacitances and overcharging) was inadequate. If you have an option, do not use these chips in 5V I/O environment.","Q) What is the actual maximum voltage for IO pins? 
A) The actual maximum voltage for IO pins is 4.6V according to the Absolute Maximum ratings table in the datasheet. It's recommended not to use the W5100 chip in a 5V I/O environment due to inadequate timing caused by capacitances and overcharging."
3651,682,"Hi all,

I am using the Ethernet Arduino board.
I am sending and receiving packets of 128 bits size every 11 ms. After approximately 6 minuets the W5100 stops sending packets, and don't get out from the while loop:

int sendUDP(SOCKET s)
{
 [color=#FF0000] W5100.execCmdSn(s, Sock_SEND);
		
  /* +2008.01 bj */
 while ( (W5100.readSnIR(s) & SnIR::SEND_OK) != SnIR::SEND_OK ) 
  {
    if (W5100.readSnIR(s) & SnIR::TIMEOUT)
    {
      /* +2008.01 [bj]: clear interrupt */
      W5100.writeSnIR(s, (SnIR::SEND_OK|SnIR::TIMEOUT));
      return 0;
    }
  }[/color]

  /* +2008.01 bj */	
  W5100.writeSnIR(s, SnIR::SEND_OK);

  /* Sent ok */
  return 1;
}


I will be happy to receive some help debugging it.

Thanks
Yoav Hi, 

sendUDP() is only processing send command.
Plz, Post all data processing code such as data copy and pointer regsiters control.

Thank you. Hi,
Did you used with Arduino ethernet library without modifying?
I have already ardunion ethernet library and it works fine as I known.

But, You have a problem of no occurrence Sn_IR_SENDOK.
Have you test the another udp example provied by arduino?

Check the Sn_SR register value in infinite loop.

Thank you. Hi  midnightcow,

Thanks for the replay.

I didn't change the original Ethernet library. I don't get SEND_OK, and it happens when the data rate is as I mention above, with slower data rate it works fine.

I also tried modifying the Ethernet library  and my own time out, it also didn't help (in the sendUDP):

while ((W5100.readSnIR(s) & SnIR::SEND_OK) != SnIR::SEND_OK) {
		
		if (W5100.readSnIR(s) & SnIR::TIMEOUT) {			
			/* +2008.01 [bj]: clear interrupt */
			W5100.writeSnIR(s, (SnIR::SEND_OK | SnIR::TIMEOUT));
			return 0;
		}

		if (ii > 1000) {		
			W5100.writeSnIR(s, SnIR::SEND_OK | SnIR::TIMEOUT);
			return 0;
		}
		ii++;
}



Thnaks
Yoav Hi,
I'm sorry I have little experience of auduino library. 

How do you apply the auduino library to udp processing ?

Can you show me the code? I need main code of  udp data send.

I will expect your code to like as following.

[code]
EthernetUDP udpsock;
//
udpsock.begin();
while(1)
{
  if(btimeout == 1)
  {
    if(udpsock.beginPacket()==0) goto error;
    if(udpsock.write() == 0) goto error;
    if(udpsock.endPacket()==0) goto error;  //<-- You maybe blocked here.
    udpsock.parsePacket();
    if(udpsock.available())
    {
       if(udpsock.read() == 0)  goto error;
    }   
  }
}
error:
udpsock.stop();
while(1);
}
[/code]

For better solution, You'd better ask the problem to Arduino communitiy.

Thank you.","Q) Did you used with Arduino ethernet library without modifying?
A) I didn't change the original Ethernet library.

Q) How do you apply the auduino library to udp processing ?
A) I have already ardunion ethernet library and it works fine as I known.

Q) Can you show me the code? I need main code of  udp data send.
A) I will expect your code to like as following."
3652,6821,"hello

 Please contact the Wiz100SR.

 Since 2010, WIZ100SR has been applied to equipment.
 (About 100 cars)
 -> Connection: WIZ100SR (Client) <-> Switching Hub 1 (M2200_NC) <-> Switching Hub 2 (M2200_NC)
  
 Currently, the Ethernet communication connection has occurred due to the frequency of about once a day.

 In this regard, I would like to ask you what the Ethernet communication connection is cut off.

   
  1. WIZ100SR settings information
     -Client mode settings
     -Firmware Version 5.13
     -Clove Enable Debug Check

  2. Contents confirmed
     -On/off the equipment of the client is connected to the server.
     -There is no response even if you connect a laptop via herb 2 and ping test with the client and server. hello.
The answer was late.

It is difficult to grasp the symptoms in the inquiry, so it is necessary to grasp the more detailed situation.
Please send a contact by e -mail below and we will contact you.
* Rena@wiznet.io

thank you","Q) In this regard, I would like to ask you what the Ethernet communication connection is cut off. 
A) The Ethernet communication connection may be getting cut off due to various reasons such as network interference, hardware issues, or improper configuration of the WIZ100SR settings. To diagnose the issue more accurately, a detailed analysis of the network setup and equipment status is necessary. 

Q) Please send a contact by e-mail below and we will contact you. 
A) You can reach out to us at Rena@wiznet.io for further assistance and we'll get back to you promptly."
3653,683,"Hi,
I have configured the W5100 to be used in SPI mode and interrupt mode.
I am able to connect to the W5100.
Send and receive data using Modpoll tool.
I have observed one issue though.
Even though I recieve an RECV interrupt I dont get an Send Ok interrupt.
But I get the necessary data on the Modpoll, but I dont recieve an send OK interrupt.

Are there any known issues with this?

Thanks!! Hi,

I wonder how to process send data and send command. 
For completing to send data, Sn_IR_SEND_OK need to set.

In your send processing, Did you already clear Sn_IR_SEND_OK bit?

If possible, post your ISR routine, IR & Sn_ISR & IMR access function, and Send function codes.

Thank you. Hi,
Below is my send function, Most of my code is similar to the wiznet sample code except my application code:
uint16_t send(SOCKET s, const uint8_t* p_ucharDataBuf, uint16_t ushLen)
{
    uint8_t ucharStatus=0;
    uint16_t ushRet=0;
    uint16_t ushFreeSize=0;
    uint16_t ushtxrd_after_send;
    uint16_t ushtxrd_before_send;  
    
    if (ushLen > getW5100_TxMAX(s)) 
    {
        ushRet = getW5100_TxMAX(s); // check size not to exceed MAX size.
    }
    else
    {
        ushRet = ushLen;
    }

    // if freebuf is available, start.
    do
    {
        ushFreeSize = getSn_TX_FSR(s);
        ucharStatus = read_wiznet_reg(Sn_SR(s));
        /* If client requested an disconnect */
        if(ucharStatus == SOCK_CLOSE_WAIT)
        {
            ushRet = getSn_RX_RSR(m_structTCPData.m_ucharCurrentSocket);
            recv(m_structTCPData.m_ucharCurrentSocket, m_aucharTCPRxBuf, ushRet);
            disconnectSocket(m_structTCPData.m_ucharCurrentSocket);
            return 0;
        }            
        else if (ucharStatus != SOCK_ESTABLISHED)
        {
            ushRet = 0;
            break;
        }
    } while (ushFreeSize < ushRet);

    // copy data
    send_data_processing(s, (uint8_t *)p_ucharDataBuf, ushRet);
    ushtxrd_before_send = read_wiznet_reg(Sn_TX_RD0(s));
    ushtxrd_before_send = (ushtxrd_before_send << 8) + read_wiznet_reg(Sn_TX_RD0(s) + 1);
    /* Issue the SEND command */
    write_wiznet_reg(Sn_CR(s),Sn_CR_SEND);
    Delay_ms(1);
    /* wait to process the command... */
    while( read_wiznet_reg(Sn_CR(s)) );
    
/*    while ( (read_wiznet_reg(Sn_IR(s)) & Sn_IR_SEND_OK) != Sn_IR_SEND_OK )
    {
        if ( read_wiznet_reg(Sn_SR(s)) == SOCK_CLOSED )
        {
            close(s);
            return 0;
        }
    }*/
    //write_wiznet_reg(Sn_IR(s), Sn_IR_SEND_OK);

    ushtxrd_after_send = read_wiznet_reg(Sn_TX_RD0(s));
    ushtxrd_after_send = (ushtxrd_after_send << 8) + read_wiznet_reg(Sn_TX_RD0(s) + 1);
    if(ushtxrd_after_send > ushtxrd_before_send)
    {
        ushRet = ushtxrd_after_send - ushtxrd_before_send;
    } 
    else
    {
	ushRet = (0xffff - ushtxrd_before_send) + ushtxrd_after_send + 1;
    }
    
    return ushRet;
}

My ISR processing function is below. This function is called from an ISR, it saves the interrupt type, clears the wiznet interrupt and  sets an TCP_FLAG.

void processWiznetISR(void)
{
    uint8_t ucharIRvalue;
    uint8_t ucharSNIRvalue;
    //uint8_t ucharIRvalue = getSn_IR(SOCKET_0);
    
        ucharIRvalue = getIR();
	
      /* process all interrupts */
      do 
      {   
          if (ucharIRvalue & IR_CONFLICT)
          {
              /*IP conflict */
              write_wiznet_reg(W5100_IR, 0xf0);           /* clear interrupt */
          }
          if (ucharIRvalue & IR_UNREACH)
          {
              /*INT Port Unreachable */
              write_wiznet_reg(W5100_IR, 0xf0);           /* clear interrupt */
          }
   
          /* clear interrupt */
          write_wiznet_reg(W5100_IR, 0xf0); 
   
          if (ucharIRvalue & IR_SOCK(SOCKET_0))
          {
              /* save interrupt value*/
              I_STATUS[SOCKET_0] |= read_wiznet_reg(Sn_IR(SOCKET_0)); // can be come to over two times.
              //processSocketCommand();
              write_wiznet_reg(Sn_IR(SOCKET_0), I_STATUS[SOCKET_0]);
              /* Clear the interrupt */
              //write_wiznet_reg(Sn_IR(SOCKET_0), 0xFF);
        }
        if (ucharIRvalue & IR_SOCK(1))
        {
            /* save interrupt value*/
            I_STATUS[1] |= read_wiznet_reg(Sn_IR(1));
            write_wiznet_reg(Sn_IR(1), I_STATUS[1]);
        }
        if (ucharIRvalue & IR_SOCK(2))
        {
            /* save interrupt value*/
            I_STATUS[2] |= read_wiznet_reg(Sn_IR(2));
            write_wiznet_reg(Sn_IR(2), I_STATUS[2]);
        }
        if (ucharIRvalue & IR_SOCK(3))
        {
            /* save interrupt value*/
            I_STATUS[3] |= read_wiznet_reg(Sn_IR(3));
            write_wiznet_reg(Sn_IR(3), I_STATUS[3]);
        }   
        /* re-read interrupt value*/
        ucharIRvalue = read_wiznet_reg(W5100_IR);
    }while (ucharIRvalue != 0x00);           /* if exist, contiue to process */
    TCP_FLAG = TRUE;
    /* Clear the interrupt */
   // write_wiznet_reg(Sn_IR(m_structTCPData.m_ucharCurrentSocket), 0xFF);
    ucharIRvalue = read_wiznet_reg(W5100_IR);
    ucharSNIRvalue = getSn_IR(0);
}

And below is my interrupt processing functions:

void processSocketCommand(void)
{
    if(TCP_FLAG == TRUE)
    {
        if (I_STATUS[SOCKET_0] != 0)
        {
            /* save interrupt value*/
            m_structTCPData.m_ucharCurrentSocket = SOCKET_0;
            processTcpCommand(I_STATUS[SOCKET_0]);
            //write_wiznet_reg(Sn_IR(0), I_STATUS[0]);
            I_STATUS[SOCKET_0] = 0;
        }
        if (I_STATUS[SOCKET_1] != 0)
        {
            /* save interrupt value*/
            m_structTCPData.m_ucharCurrentSocket = SOCKET_1;
            processTcpCommand(I_STATUS[SOCKET_1]);
            I_STATUS[SOCKET_1] = 0;
        }
        if (I_STATUS[SOCKET_2] != 0)
        {
            /* save interrupt value*/
            m_structTCPData.m_ucharCurrentSocket = SOCKET_2;
            processTcpCommand(I_STATUS[SOCKET_2]);
            I_STATUS[SOCKET_2] = 0;              
        }
        if (I_STATUS[SOCKET_3] != 0)
        {
            /* save interrupt value*/
            m_structTCPData.m_ucharCurrentSocket = SOCKET_3;
            processTcpCommand(I_STATUS[SOCKET_3]);
            I_STATUS[SOCKET_3] = 0;
        }
        /* Clear the TCP_FLAG since all the interrupts have been processed */
        TCP_FLAG = FALSE;
        /* Clear the interrupt */
        //write_wiznet_reg(Sn_IR(m_structTCPData.m_ucharCurrentSocket), 0xFF);
   }
}
void processTcpCommand(uint8_t ucharSn_IR)
{
    uint16_t ushlen = 3;
    uint8_t status = 0x01;  
    
    ucharValue = getSn_SR(m_structTCPData.m_ucharCurrentSocket);
        
    switch(ucharSn_IR)                
    {                                   
        case Sn_IR_RECV:
            temp = 0;
            m_structTCPData.m_ucharBytesReceived = getSn_RX_RSR(m_structTCPData.m_ucharCurrentSocket);
            m_structTCPData.m_pucharRxDataLoc = m_aucharTCPRxBuf;
            /* Check if data is received */
            if (m_structTCPData.m_ucharBytesReceived > 0)
            {
                ushlen = recv(m_structTCPData.m_ucharCurrentSocket, m_aucharTCPRxBuf, m_structTCPData.m_ucharBytesReceived);
            }
            while(m_structTCPData.m_ucharBytesReceived > 0) // check the size of received data
            {               
                //ushlen = recv(m_structTCPData.m_ucharCurrentSocket, m_structTCPData.m_ucharTCPHeader, TCP_MODBUS_HEADER_LENGTH);
                /* Read the first 6 bytes of the frame */
                moveTCPRxData(m_structTCPData.m_pucharRxDataLoc,  m_structTCPData.m_ucharTCPHeader, TCP_MODBUS_HEADER_LENGTH);
                m_structTCPData.m_ucharBytesReceived -= TCP_MODBUS_HEADER_LENGTH;
                checkTCPProto();
            }
            break;
                                       
        case Sn_IR_SEND_OK:
            /* The send operation was sucessfull
             * I dont know what to do next
             */
            break;                                       
        case Sn_IR_TIMEOUT:
            disconnect(m_structTCPData.m_ucharCurrentSocket);
            socket(m_structTCPData.m_ucharCurrentSocket, Sn_MR_TCP, 502, 0);    // open the SOCKET  
            status = listen(0);
            break;               
            
        case Sn_IR_DISCON: 
             temp = 1;
             if(m_structTCPData.m_ucharBytesReceived > 0) // check the size of received data
             {
                  ushlen = recv(m_structTCPData.m_ucharCurrentSocket, m_aucharTCPRxBuf, m_structTCPData.m_ucharBytesReceived);
             }
            disconnectSocket(m_structTCPData.m_ucharCurrentSocket);
            
            socket(m_structTCPData.m_ucharCurrentSocket, Sn_MR_TCP, 502, 0);    // open the SOCKET  
            status = listen(0);
            break;                                       
        case Sn_IR_CON:                     
            /* Connection has been establised
             */
            //send(m_structTCPData.m_ucharCurrentSocket ,buf, ushlen);
            m_structTCPData.m_ushLastSeqNo = 0;
            m_structTCPData.m_ucharStartFlag = FALSE;
            break;
        default:
            write_wiznet_reg(Sn_IR(m_structTCPData.m_ucharCurrentSocket), 0xFF);
            break;
   }
   /* Clear the interrupt */
   //write_wiznet_reg(Sn_IR(m_structTCPData.m_ucharCurrentSocket), 0xFF);
} Hi,

Most above all, check sending packet is completed.

I want to know just send interrupt doesn't occur or send procedure is not working.

Best regards. Hi,
The send procedure is working.
When a send a modbus query via Modpoll I recieve the necessary response back.
The only issue here is I dont get an send complete interrupt.
I get the recieve interrupt . 
The other issue is I dont get the disconnect interrupt also. I get that interrupt after quiet some time.
But I dont want to tackle that issue right now, since first I want to resolve the send interrupt issue first.

Thanks!!! Hi,
Your code seem to have no problem.

Did you modus TCP/IP using modpoll program.?
And when do you call send()? Can you post the code of call send()?
In send(), why don't you wait until Sn_IR_SENDOK = 1?
For completing to send data, it need to one send command and one Sendok ISR.
If you not check Sendok ISr after send command, next send command can't work well.

Thank you.","Q) Are there any known issues with this?
A) Your code seem to have no problem.

Q) Did you modus TCP/IP using modpoll program.?
A) When a send a modbus query via Modpoll I recieve the necessary response back.

Q) And when do you call send()? Can you post the code of call send()?
A) Below is my send function, Most of my code is similar to the wiznet sample code except my application code:
uint16_t send(SOCKET s, const uint8_t* p_ucharDataBuf, uint16_t ushLen)
{
    ...
}

Q) In send(), why don't you wait until Sn_IR_SENDOK = 1?
A) The only issue here is I dont get an send complete interrupt.

Q) For completing to send data, it need to one send command and one Sendok ISR. If you not check Sendok ISr after send command, next send command can't work well.
A) Most above all, check sending packet is completed.

Q) Best regards.
A) Thanks!!!

Q) The send procedure is working.
A) The send procedure is working."
3654,6832,"hello

We use the W5500 to communicate with PCs and UDP.
There is a characteristic that the length of the data transmitted from the PC program is changed from the waterbood to the Kilovate in the form of variable.
The data may be sent by fragmentation due to the MTU,
We are trying to proceed in the program (application) from the W5500.
However, in the case of fragmented data, it is necessary to help even if it is not even received.
Is there any way to read the data from a fragmented packet or other packets, not a normal UDP packet in the W5500?
For example, if the socket 4 is set to UDP and the buffer is set to 8K bytes
When the UDP packet is received normally, it becomes processed,
In the case of a single data or other data, I wonder how to check the reception and how to read the data.
Programs on PC are not possible due to nature.

Inquiries related to fragmentation similar to the contents
""To fragment using the W5500, the user needs to control the UDP unification in the application stage.""
There is an answer, but the above
Is it to read the fragmented reception data and process it in the application team (application) (even if it is fragmentation, you can read the data in the W5500, which means that the application can be processed in the application team?)
Or I wonder if it means to process the large data itself in the application unit (to prevent fragmentation in a pre-aged manner) in the application unit in the transmission (PC) and the receiving (W5500).

Then please answer. Since our chips do not support the fragmentation of IP layers, it is impossible to receive packets sent by IP fragmentation.
The following answer means that the IP fragment should not be generated by splitting it from the application, that is, on the UDP.I'm sorry for not explaining the solution. Thank you for answer.
I have been using the W5500 well in almost every part without any problems.
This time, I learned new things about data fragments.
Later, it would be better if you could support unification or check the unprocessed reception data.
Then Lee Man -gun","Q) Is there any way to read the data from a fragmented packet or other packets, not a normal UDP packet in the W5500?
A) Since our chips do not support the fragmentation of IP layers, it is impossible to receive packets sent by IP fragmentation.

Q) Please answer. Since our chips do not support the fragmentation of IP layers, it is impossible to receive packets sent by IP fragmentation. The following answer means that the IP fragment should not be generated by splitting it from the application, that is, on the UDP.
A) I'm sorry for not explaining the solution. Thank you for the answer. 

Q) I have been using the W5500 well in almost every part without any problems. This time, I learned new things about data fragments. Later, it would be better if you could support unification or check the unprocessed reception data. 
A) Then, please answer.
"
3655,6833,"hello,

Is the MAC address of the W7500P stored in each chip?
Or is it randomly designated and used by the user? hello.

Unplanned chip products do not contain MAC addresses.

Apart from this, W7500 (P \) products sell a product that contains firmware separately.
Please refer to the link page below.

* [W7500 (p \) -S2E: Wizwiki Page]

thank you I think the price can be seen through a linked quote?

thank you Yes, please contact us by e -mail at the bottom of the link page.
* Sales@wiznet.io

thank you","Q) Is the MAC address of the W7500P stored in each chip, or is it randomly designated and used by the user? 
A) Unplanned chip products do not contain MAC addresses.

Q) I think the price can be seen through a linked quote? 
A) Yes, please contact us by e-mail at the bottom of the link page."
3656,6834,"Wiz750SR with DCHP enabled condition, the connection is breaking more offen.
So data transfer is not completed.

Without DHCP, data transfer is working fine.

Firmware version is 1.2.4
Anybody have this issue?


V.Nagarajan I'll give it a try as your condition in our side and let you know the result.
Please wait some time~ 
Dear becky

There is wrong data conversion after starting data transfer randomly.
Actual data sent on RS232 side is 66 03 00 00 97 ff but on ethernet side with wireshark is 02 01 06 00 81 4a when DHCP is enabled.


V.Nagarajan Dear Becky

Any feedback for the problem mentioned?

V.Nagarajan Sorry I'm late
I tested it, but it was well.
I recommended that you update firmware to version 1.2.9.
Recently we modified firmware related to DHCP.
I hope it helps. Dear Becky

Any feedback for the input provided?

V.Nagarajan Dear Nagarajan,
I think, if you possible, could you please test it with another serial device such as PC terminal as Becky did? Because, until now, we can't find some relations between DHCP enabling and serial data corruption in the code. I'm sorry not to give good feedback. Thanks, Dear Bong
I have tested more than one module. The problem repeats with all modules.
I think there is some issue when DHCP is enabled. It randomly corrupts one or two bytes of data.

We can demostrate the problem with team viewer if possible for you check.


V.Nagarajan So we will test with baud 4800 and enable DHCP and find out exact reason of the problem
And let you know asap.
we are afraid that can't immediately find out exact reason in the source code. Is there any chance of sending wrong serial data in your embedded system?
Could you please change the Inactivity time is '0' in connection timer settingand Try again test ?
Let me check at the DHCP-related code one more time. Sorry~ I said it wrong.
I had to tell you to the Time of serial data packing option , but I said Inactivity timer.
I'm so sorry, could you please change the Time of serial data packing is '0' and try again test? We have verified this many times, data from Embedded system is correct on a tapping as you descrbed. But data gets wrongly received sometimes in Wiz750SR is my problem. The DHCP Client Option feature specifies the hostname of the client. 
While acquiring an IP address for an interface from the DHCP server, if the client device receives the DHCP Hostname option inside the response, the hostname from that option is set. DHCP is used by DHCP clients to obtain configuration information for operation in an IP network.
Therefore, you can't test the ping  using hostname. I have solved by adding a delay 0f 200ms between call of DHCP_run() in main loop.

In our network i see lot of DHCP packets;

if(dev_config->options.dhcp_use) 
{
  if(dhcp_interval_check == 0)
 {
    dhcp_interval_check =200;      //200ms,  it is decremented in Timer handler if non zero.
    DHCP_run();
  }
}

With above modifications, with DHCP enabled or disabled it is OK.

Regarding host name, i am not still clear. What is use of DHCP?  if WIZ750SR is not accessible by a name ? I'm sorry for the late.

That does sound great.
If you asked a question, it come to me by e-mail.
But I didn't receive the e-mail and I couldn't  have to answer it.

Hostname is value that it is combine the ascii value of WIZnet with the last three values of WIZ750SR MAC. Hello Irina,

We have the exact same problem as Nagarajan_V. At first we had no problems (with DHCP on). Then we changed the 'serial data packing' from 0 to 100 ms (and still DHCP on) and the problem occured. At random moments we receive (at our server) the bytes: '02 01 06 00 47' from the wiznet chip.

For us this is a dealbreaker, because we need the 'serial data packing' on 100 ms and DHCP enabled. 

Is there an official fix for this?","Q) Wiz750SR with DCHP enabled condition, the connection is breaking more offen. So data transfer is not completed. Without DHCP, data transfer is working fine. Firmware version is 1.2.4 Anybody have this issue?
A) I recommended that you update the firmware to version 1.2.9. Recently we modified the firmware related to DHCP. I hope it helps.

Q) Any feedback for the problem mentioned? 
A) I tested it, but it was well. I recommended that you update the firmware to version 1.2.9. Recently we modified firmware related to DHCP. I hope it helps.

Q) Sorry I'm late I tested it, but it was well. I recommended that you update the firmware to version 1.2.9. Recently we modified firmware related to DHCP. I hope it helps. Any feedback for the input provided?
A) I recommended that you update the firmware to version 1.2.9. Recently we modified the firmware related to DHCP. I hope it helps.

Q) I have tested more than one module. The problem repeats with all modules. I think there is some issue when DHCP is enabled. It randomly corrupts one or two bytes of data. We can demonstrate the problem with team viewer if possible for you to check.
A) So we will test with baud 4800 and enable DHCP and find out the exact reason for the problem and let you know asap. We are afraid that we can't immediately find out the exact reason in the source code. Is there any chance of sending wrong serial data in your embedded system?

Q) I'm sorry not to give good feedback. Thanks, Dear Bong I have tested more than one module. The problem repeats with all modules. I think there is some issue when DHCP is enabled. It randomly corrupts one or two bytes of data. We can demonstrate the problem with team viewer if possible for you to check.
A) So we will test with baud 4800 and enable DHCP and find out the exact reason for the problem and let you know asap. We are afraid that we can't immediately find out the exact reason in the source code. Is there any chance of sending wrong serial data in your embedded system?

Q) We have verified this many times, data from Embedded system is correct on a tapping as you described. But data gets wrongly received sometimes in Wiz750SR is my problem. The DHCP Client Option feature specifies the hostname of the client. While acquiring an IP address for an interface from the DHCP server, if the client device receives the DHCP Hostname option inside the response, the hostname from that option is set. DHCP is used by DHCP clients to obtain configuration information for operation in an IP network. Therefore, you can't test the ping using hostname. I have solved by adding a delay 0f 200ms between call of DHCP_run() in the main loop.
A) We have verified this many times, data from Embedded system is correct on a tapping as you described. But data gets wrongly received sometimes in Wiz750SR is my problem. The DHCP Client Option feature specifies the hostname of the client.

Q)  We have verified this many times, data from Embedded system is correct on a tapping as you described. But data gets wrongly received sometimes in Wiz750SR is my problem. The DHCP Client Option feature specifies the hostname of the client. While acquiring an IP address for an interface from the DHCP server, if the client device receives the DHCP Hostname option inside the response, the hostname from that option is set. DHCP is used by DHCP clients to obtain configuration information for operation in an IP network. Therefore, you can't test the ping using hostname. I have solved by adding a delay 0f 200ms between call of DHCP_run() in the main loop. In our network, I see a lot of DHCP packets; if (dev_config->options.dhcp_use) { if (dhcp_interval_check == 0) { dhcp_interval_check =200; //200ms, it is decremented in Timer handler if non-zero. DHCP_run(); } } With above modifications, with DHCP enabled or disabled it is OK. Regarding hostname, I am not still clear. What is the use of DHCP if WIZ750SR is not accessible by a name?
A) We have verified this many times, data from Embedded system is correct on a tapping as you described. But data gets wrongly received sometimes in Wiz750SR is my problem. The DHCP Client Option feature specifies the hostname of the client. DHCP is used by DHCP clients to obtain configuration information for operation in an IP network.

Q) We have the exact same problem as Nagarajan_V. At first, we had no problems (with DHCP on). Then we changed the 'serial data packing' from 0 to 100 ms (and still DHCP on) and the problem occurred. At random moments we receive (at our server) the bytes: '02 01 06 00 47' from the wiznet chip. For us, this is a dealbreaker, because we need the 'serial data packing' on 100 ms and DHCP enabled. Is there an official fix for this?
A) We have the exact same problem as Nagarajan_V. At first, we had no problems (with DHCP on). Then we changed the 'serial data packing' from 0 to 100 ms (and still DHCP on) and the problem occurred. At random moments we receive (at our server) the bytes: '02 01 06 00 47' from the wiznet chip. For us, this is a dealbreaker, because we need the 'serial data packing' on 100 ms and DHCP enabled."
3657,684,"I've read the manual up and down and not finding anything clear on how to send data over my internet connection in Gateway Mode from a serial port. How is this done? I am using serial port 2 and it works very nicely in a local setup where the serial port is in server mode on a given port number. I now want to connect to the internet through this serial port. I'm assuming it needs to be in client mode but now I'm confused what the ""server IP"" should be set to. Also, is port forwarding required since my port may not be 80 or 8080. Any information would likely be of great help.

I also will mention I'm not using a PC on this serial port. My serial port host is a microcontroller.

Thanks! Hi

I have some question about this issue.

First, Did WizFi630 have public IP address? ( public IP is not 192.xxx.xxx.xxx )
If your answer is no, WizFi630 needs public IP in order to operate TCP server.
And if WizFi630 has public IP, You did not need to use port forwarding.

Second, Did you want to use TCP Server in WizFi630?
If your answer is yes, You don't need to use server IP. This value is used in TCP client mode or mixed mode. Hi Kaizen, 

Thank you for the response.

So my WizFi630 still has the 192.xxx.xxx.xxx IP address and setup to operate in Gateway mode. Where, as I understand, LAN port 0 is the WAN port which I have connected to my DSL MODEM/Router which is my link to the internet (I assume it has a public IP address). So how do I give the WizFi630 the public IP? Set same as DSL MODEM/Router?

On your second question, I'll explain more on how my system is setup:

My system uses a microcontroller as the main control for my system and uses serial port #2 on the WizFi630 to communicate over LAN and WiFi. It has worked very well being in a local system. I am using it in TCP Server mode on port 10000. Other devices can talk to my system through port 10000 on IP 192.xxx.xxx.xxx and there is a custom protocol developed for data to be passed back and forth for control. All communications are using TCP. So now I want to extend the usage over the internet now. I believe I still need the TCP Server since local devices will still attempt to connect and send data. At the same time I need to be able to access the internet from my microcontroller through the WizFi630 to access another server. Is that making sense?","Q) How is data sent over the internet connection in Gateway Mode from a serial port? Also, what should the ""server IP"" be set to and is port forwarding required?
A) To send data over the internet connection in Gateway Mode from a serial port, if WizFi630 does not have a public IP address, it will need one to operate as a TCP server. If it has a public IP, you won't need to use port forwarding. In Gateway Mode, you should set the WizFi630's IP address the same as the DSL MODEM/Router.

Q) How do I give the WizFi630 the public IP in Gateway mode? 
A) Set the WizFi630's IP address the same as the DSL MODEM/Router to give it the public IP.

Q) How should the system be set up to extend the usage over the internet while still needing the TCP server for local devices to connect, and how can access to another server be ensured?
A) In your setup, you can continue using the TCP server mode on port 10000 for local devices to connect. To access another server from the microcontroller through the WizFi630 over the internet, ensure that the WizFi630 is in Gateway Mode."
3658,6844,"hello.
Currently, we are updating our new WiFi module on all agency sites and have been completed.
However, there are quite a lot of agents waiting for Wizfi630s-EVB Datasheet.
Is there any data that has already been completed?
As a result of confirming Wiz Wiki, it is still called not available, but if so, please tell us when it will be completed.

Thank you for your reply.
Kim Jung -hoon Dream Hangul draft was completed earlier this week.
We will deliver it once more and then we will deliver it today.
Please translate English. thank youDaniel Master,

In response to the above question, we have confirmed that you have answered the workplace and shared the DataSheet.
I will translate it in the US branch.

Kim Jung -hoon Dream","Q) Is there any data that has already been completed for Wizfi630s-EVB Datasheet? Please tell us when it will be completed. 
A) In response to the above question, we have confirmed that we have already updated the workplace and shared the DataSheet. 

Q) Please translate English. 
A) I will translate it in the US branch."
3659,6845,"hello.
Module [WIZ750SR-RS232] Use UDP 1: N Mode.

We are sending packets from two servers to modules.

The question is that every time you request a packet with a module on the server

The module requests ARP, but registered with the ARP table
I wonder if the registered MAC is possible not to ask for ARP.
I would like to answer how to do it.
thank you! WizNet chip requests ARP whenever Destination IP changes.
I am using two servers to ask for ARP every time.
It's cumbersome, but you can create an ARP table separately so as not to request.
If you receive data from the server, you can save Mac and IP,
By default, you can use Send Command by default when sending data. thank you
I'm sorry, but is the Send Mac Command an accurate function name?
Are you talking about Send () and Sendto () function?
please answer about my question. The UDP uses the Sendto () function when transmitting.

Send Mac Command is a command name.
In SETSN_CR () in the sendto () function
You can use the SN_CR_SEND_MAC command, not the existing Send Command.
(W7500X_WZTOE.H is defined with ** SN_CR_SEND_MAC **.)

Also, before the sendto () function,
You must store your opponent's MAC information to SN_DHHAR.

thank you Thank you for your answer !!!! https://forum.wiznet.io/t/topic/1596/4?u=11123

According to the above article, in the case of SN_DHAR, the value is not used.
Is it possible in the W7500P?

Also, you need to know the MAC address, but how can you find it?
Is there?

please answer about my question. hello

The answer was late due to the holiday.

In the case of SN_DHAR of the W7500P, R/W is a registered Register, so you can save your Mac address in advance.(Please refer to the reference sheet. https://wizwiki.net/wiki/lib/exe/fetch.php?media=::

In addition, the other person's MAC address should be known as you can.
If you don't know, try the first ARP and read the address of SN_DHAR to do the user's MAC address first, then perform the Send Mac operation.

Or if your opponent is a PC, you can check the MAC address of the Ethernet adapter through CMD> ipconfig /All. Thank you LAWRENCE !!
I try to try it as if you were informed.
It's a cumbersome request
Is there an example code?","Q) Every time the module requests a packet, it also requests ARP, even if it's already registered in the ARP table. How can I prevent the module from requesting ARP when it already has the MAC address registered? 
A) The WizNet chip requests ARP whenever the Destination IP changes. If you want to avoid the module from constantly requesting ARP, you can create an ARP table separately. By saving the MAC and IP when receiving data, you can use the Sendto() function with the SN_CR_SEND_MAC command rather than the existing Send Command. Before using the Sendto() function, you must store the opponent's MAC information in SN_DHAR. For the W7500P, you can save the MAC address in advance as it is a registered register. Additionally, you can also obtain the other person's MAC address by performing the first ARP and reading the address of SN_DHAR. If your opponent is a PC, you can check the MAC address of the Ethernet adapter through CMD > ipconfig /All. Also, the function name ""Send Mac Command"" refers to the command name SN_CR_SEND_MAC in the Sendto() function defined in W7500X_WZTOE.H. Here is the reference link for more information: [https://forum.wiznet.io/t/topic/1596/4?u=11123](https://forum.wiznet.io/t/topic/1596/4?u=11123)

Q) Is it possible to use the value of SN_DHAR in the W7500P, and how can I find the MAC address? 
A) In the case of SN_DHAR for the W7500P, the value is stored in a registered register, so you can save the MAC address in advance. As for finding the MAC address, if you do not know the other person's MAC address, you can perform the first ARP and read the address of SN_DHAR. Another method is to check the MAC address of the Ethernet adapter on the other person's PC through the CMD > ipconfig /All command. Additionally, if you need an example code, you can refer to the reference sheet available at [https://wizwiki.net/wiki/lib/exe/fetch.php?media=::](https://wizwiki.net/wiki/lib/exe/fetch.php?media=::) Thank you for your question!"
3660,6847,"[Wizfi310]
Hello, I would like to contact you wiFi310.
I am testing and receiving data using SDATA mode.
Do you know what the AP Mode+Data Mode and General AP Search (Shared)+Data Mode is more stable?I would like to know how much or no difference if there is a difference in stability or a CPU.
If you use the AP mode, please contact the WiFi310 CPU share, which will be higher or unstable.

thank you
----------- hello

WIFI module products such as Wizfi310 operate with limited resources,
More resources are used in AP mode than STA mode.

AP mode is used to perform limited behavior such as product setting, and it is recommended to develop a general function using STA mode.","Q) Do you know what the AP Mode+Data Mode and General AP Search (Shared)+Data Mode is more stable?
A) WIFI module products such as Wizfi310 operate with limited resources. More resources are used in AP mode than STA mode. AP mode is used to perform limited behavior such as product setting, and it is recommended to develop a general function using STA mode."
3661,6848,"[Wizfi630] [Wizfi210/220] [Wizfi250] [Wizfi310]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:

-----------


I access the wizfi360 to the router with AT command, and I don't know how to access the web page.
Example) Access Abcd.com/api/ver1/open ..

also
After accessing the web page, I want to send data to the web page and get data from the web page. Where can I refer to it? hello

For web server access, you can use AT CMD related to TCP Connection.
(Web server connection is the same as TCP server connection because we use TCP communication.)

However, in order to send and receive a web page on the web server, you must send the HTTP Get/Put Method directly through the TCP Send Command.

There is an example of Arduino + Wizfi360 for this process.
Please refer to the http client example in the link below.
https://wizwiki.net/wiki/doku.php/products:WIZFI360:WIZFI360App:Start

thank you","Q) I access the wizfi360 to the router with AT command, and I don't know how to access the web page. Example) Access Abcd.com/api/ver1/open ..
A) For web server access, you can use AT CMD related to TCP Connection. However, in order to send and receive a web page on the web server, you must send the HTTP Get/Put Method directly through the TCP Send Command. There is an example of Arduino + Wizfi360 for this process. Please refer to the http client example in the link below. https://wizwiki.net/wiki/doku.php/products:WIZFI360:WIZFI360App:Start

Q) After accessing the web page, I want to send data to the web page and get data from the web page. Where can I refer to it? 
A) You can refer to the HTTP client example in the link provided - https://wizwiki.net/wiki/doku.php/products:WIZFI360:WIZFI360App:Start"
3662,685,"hello.
I'm going to connect as shown below, but I can't communicate well.

PC (Hyper Terminal)-WiFi210-EVB-> <-Galaxy Note

1. I transfer the hex string to the galnot with an app called [Protocol Test].
    The string is transferred at first after the WiFi is connected and the second is not sent.
    It is just a food to turn off and turn it on again.

2. Turn on the WiFi210-EVB and connect the hyper terminal to the hyper terminal
    It's not written .. ;;I want to send a string from the PC to the gal tab, but I can't do it.?Â Ã£ÂÂ

3. On the WiFi210-EVB board, there is UART0 and UART1. How to use UART1
     Should I set it up?On the EVB board, UART0 was used by RS232 communication.

Below is a hyper terminal in the order of the EVB board.

------------------------------------
At+wd
At+ndhcp = 0
At+WAUTO = 2, HOME ,, 0
At+nauto = 1,1, 4000
AT+NSET = 192.168.3.124,255.255.255.0,192.168.3.1
ATC1
At+xeht = 0,0,0,1
At+xdum = 1
AT & Y0
At & w0

-> Set it like this and turn it off and use the EVB power.
-> EVB power turn on, connect the hyper terminal, turn on the galab wiFi, and send a string in the app
-> The first time there is a string comes to the hyper terminal, but it doesn't start
     No letters are written in the Hyper Terminal.
------------------------------------------------- First of all, please test it on your PC instead of a galnote.

Connect the Wizfi210 and the PC, try using the TCP Client Program of the PC, try the test below, and tell me the results.
-Do you ping your PC and Wizfi210?
-Do you succeed in the TCP Connection of the TCP Client Program on your PC?
-Do it becomes a bidirectional data communication of the PCP Client Program on the PC?

And, UART1 is available only by using S/W customizing.
You can only use UART0 as the current FW. hello.
After confirming with the above, we succeeded in connecting the Galaxy Note.

Another problem is not represented once after success. ;;?Â Ã£ÂÂ
There are cases where they are communicated, and they may not.

The configuration is the Galaxy Note <-> WiFi210-st32 (by Uart).
Use only pins (TX, RX) of the WiFi210-EVB's J6 Connector and UART with STM's ST32.
I didn't connect anything to the EVB board's RS232 connector.

1. Initially, the information from the Galaxy Note comes in exactly with the ST32, but the receiving information displayed in the gallery note is
  It is only marked with ""ff"" or ""ffff"".

2. At some point, suddenly the communication between the Galnot and ST32 was given and received and well done.
  For example, if you send the AA01520d0a from the Galnot, the response is well marked as AA0152020406060da.

3. I was so excited and turned off and did it again the next day.
  In the Galaxy Note, only ""ff"" or ""ffff"" comes in and cannot be normal communication.?Â Ã£ÂÂ

I don't know much about the circuit, so do you have to be careful when connecting with ST32 and WiFi210-EVB?
Do you need a pull -up resistance?Or is it because of the RS232 module that led to one line with the J6 connector?

tell me your opinions. In general (without a pull -up resistance connection)
WIZFI210-EVB --- (TX, RX, GND) --- MCU_BOARD to
You can connect.

The problem below seems to need to check the scope waveform.","Q) I transfer the hex string to the galaxy note with an app called [Protocol Test]. The string is transferred at first after the WiFi is connected and the second is not sent. It is just a food to turn off and turn it on again. Turn on the WizFi210-EVB and connect the hyper terminal to the hyper terminal. It's not written .. ;;I want to send a string from the PC to the galaxy note, but I can't do it. How can I resolve this communication issue?
A) It seems like there might be a connection or setup issue with the WizFi210-EVB and Galaxy Note communication. Considering the hex string is transferred initially but not on the second attempt after reconnecting, it could be related to the WiFi connection stability or data transfer protocol. As for sending a string from the PC to the Galaxy Note, you may need to ensure proper configuration and troubleshooting steps for the WizFi210-EVB and Galaxy Note communication.

Q) On the WizFi210-EVB board, there is UART0 and UART1. How to use UART1? Should I set it up? On the EVB board, UART0 was used by RS232 communication. 
A) To use UART1 on the WizFi210-EVB board, you may need to configure it through software customization. As for the UART0 being used for RS232 communication on the EVB board, it's important to consider the compatibility and conflict resolution between UART0 and UART1 usage.

Q) After confirming with the above, we succeeded in connecting the Galaxy Note. Another problem is not represented once after success. There are cases where they are communicated, and they may not. I don't know much about the circuit, so do you have to be careful when connecting with ST32 and WiFi210-EVB? Do you need a pull-up resistance? Or is it because of the RS232 module that led to one line with the J6 connector?
A) It seems like the communication inconsistency between the Galaxy Note and ST32 is occurring sporadically. Regarding the circuit connection with the ST32 and WizFi210-EVB, it's important to consider potential factors such as pull-up resistance and the impact of the RS232 module on the J6 connector. Careful examination and testing of the circuit's integrity and components might be necessary for stable communication.

Non-response paragraph."
3663,6852,"UART2Ã«Â¥??Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ¼?ÂÃ«ÂÂ???ÂÃ«ÂÂÃ¬Â²ÂÃ«ÂÂ¼?ÂÃ«Â©Â´  Ã¬Â»Â´Ã­ÂÂ???ÂÃ«ÂÂ¬ÃªÂ°? ?ÂÃªÂ¹Â?ÂÃ«ÂÂ¤.

..\main.c(91): error:  #167: argument of type ""S_UART_TypeDef *"" is incompatible with parameter of type ""UART_TypeDef *""

S_UART_Init(57600);
UART_StructInit(&UART_InitStructure);
    
UART_Init(UART2,&UART_InitStructure); hello

For UART2
S_uart_init (57600);
Just do it.

Uart_init () function is a function for UART1 and UART0.

In addition to init, other functions can be used for UART2 functions with S_. UART_Init ?Â¨Ã¬ÂÂ??UART2Ã«Â¥?Ã¬Â§??ÂÃ­ÂÂÃ¬Â§? ?ÂÃªÂ¸Â° ?ÂÃ«Â¬Â¸???Â´Ã«ÂÂ¹ Ã¬Â½ÂÃ«ÂÂ?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ¬ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬ÂÂ ÃªÂ²ÂÃ«ÂÂ??

> UART_Init(UART2,&UART_InitStructure);

UART2Ã«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¤?ÂÃ«ÂÂ ?Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ ?Â Ã¬ÂÂ¸?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ??

> static void UART_Config(void)
> {
>     UART_InitTypeDef UART_InitStructure;
> 
>     UART_StructInit(&UART_InitStructure);
> 
> #if uart2
>     S_UART_Init(57600);
> #else
>     UART_Init(UART1, &UART_InitStructure);
> #endif
> }

?Â¹Ã¬ÂÂ ?Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ Ã¬Â§ÂÃ­ÂÂ?ÂÃ¬ÂÂ¨?ÂÃ«ÂÂ ?ÂÃ«?Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ¬? ?ÂÃ«ÂÂ?Â¤Ã«Â©Â´ ?Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¨??Ã«Â²ÂÃ¬Â Â ?ÂÃ«ÂÂ ?Â¤Ã¬ÂÂ´Ã«Â°ÂÃ¬ÂÂ¼??ÃªÂ²Â½Ã«Â¡ÂÃ«Â¥??ÂÃ«Â Â¤Ã¬Â£Â¼Ã¬ÂÂ¸??

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??","Q) What is the function of UART_Init()?
A) The UART_Init() function is used to initialize the UART peripheral for communication.

Q) What is the purpose of the S_UART_Init(57600) function?
A) The S_UART_Init(57600) function is used to initialize UART2 with a baud rate of 57600.

Q) Can you provide an example of UART_Config() function usage?
A) Sure, here's an example of the UART_Config() function:
```
static void UART_Config(void)
{
    UART_InitTypeDef UART_InitStructure;

    UART_StructInit(&UART_InitStructure);

    #if uart2
        S_UART_Init(57600);
    #else
        UART_Init(UART1, &UART_InitStructure);
    #endif
}
```

Q) Is there a specific reason for using S_UART_Init(57600) for UART2?
A) The S_UART_Init(57600) function is specifically used for initializing UART2 with a baud rate of 57600."
3664,6854,"Attempting to use the WIZ750SR (RS485) to communicate to a Modbus device.  My other RS485 converters work fine.  I can monitor the sent packets, and when I send them with the 750SR, there is no reply.  
This is usually due to the character timing.  Modbus is very strict.  I do not see a way to adjust the character timing and spacing.
Has anybody had success with this device on Mobus over TCP? What firmware did you use?
Unfortunately, there is no example of implementing Modbus with WIZ750SR.
This link contains code that implements Modbus on the WIZ550S2E module. I hope it helps.
https://github.com/Wiznet/WIZ550S2E-Modbus Firmware is version 1.2.4

Trying to find applicable notes in link.

Thank you.

Mike Seems to be a bit beyond my capabilities.
I've used quite a few convertors, but I haven't done his type of programming before.
I am assuming that this will not download to the 750.

Any hints would be appreciated.

Mike","Q) Has anybody had success with this device on Modbus over TCP? What firmware did you use?
A) Unfortunately, there is no example of implementing Modbus with WIZ750SR. Firmware is version 1.2.4
Q) Trying to find applicable notes in link. Thank you.
A) This link contains code that implements Modbus on the WIZ550S2E module. I hope it helps. https://github.com/Wiznet/WIZ550S2E-Modbus 
A) Seems to be a bit beyond my capabilities. I've used quite a few converters, but I haven't done this type of programming before. I am assuming that this will not download to the 750. Any hints would be appreciated."
3665,6855,"SPIÃ«Â¡?dataÃ«Â¥??Â½Ã«ÂÂ??ScopeÃ«Â¡?Ã«Â³Â´Ã«ÂÂÃªÂ²ÂÃªÂ³Â¼ ?Â½Ã¬ÂÂ´Ã¬Â§ÂÃªÂ°Â???Â¤Ã«Â¦Â?ÂÃ«ÂÂ¤.
ScopeÃ«Â¡??ÂÃ­ÂÂ???Â½Ã¬ÂÂ´Ã«Â³Â´Ã«Â©Â´ 0x65ÃªÂ°? Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ¤. ÃªÂ·Â¸Ã«ÂÂ¬??uartÃ«Â¡??ÂÃ¬ÂÂ¸??Ã«Â³Â´Ã«Â©Â´ 0x00?Â´Ã«Â³Â´?Â´ÃªÂ³Â  ÃªÂ°??ÂÃ¬? 0x65ÃªÂ°? Ã«Â³Â´Ã¬ÂÂ¼?ÂÃ«ÂÂ ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? Ã«Â­ÂÃ¬? ?ÂÃ¬ÂÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

    int main()
    {
        uint8_t i;
        /* External Clock */
        CRG_PLL_InputFrequencySelect(CRG_OCLK);
        /* Set Systme init */
        SystemInit();
    	GpioInit();
    	S_UART_Init(57600);
        UART_StructInit(&UART_InitStructure);
        /* Configure UART0 */
        /* Retarget functions for GNU Tools for ARM Embedded Processors*/
        /* Configure Uart0 Interrupt Enable*/
        S_UART_ITConfig((UART_IT_FLAG_TXI|UART_IT_FLAG_RXI),ENABLE);
        /* NVIC configuration */
        NVIC_ClearPendingIRQ(UART2_IRQn);
        NVIC_EnableIRQ(UART2_IRQn);
      
        /* SysTick_Config */
        SysTick_Config((GetSystemClock()/1000));

        /* Set WZ_100US Register */
        setTIC100US((GetSystemClock()/10000));
        /* SSP0 Init -- SSP Master */ 
        SSP_StructInit(&SSP0_InitStructure);
        SSP0_InitStructure.SSP_SerialClockRate   = 0;				// 0 10 500KHz
        SSP0_InitStructure.SSP_FrameFormat  = SSP_FrameFormat_MO; // Motorora SPI mode
        SSP0_InitStructure.SSP_CPHA         = SSP_CPHA_1Edge; 
        SSP0_InitStructure.SSP_CPOL         = SSP_CPOL_Low; 
        SSP0_InitStructure.SSP_DataSize 	= SSP_DataSize_8b; 
        //SSP0_InitStructure.SSP_SOD 			= SSP_SOD_RESET;
        SSP0_InitStructure.SSP_NSS          = SSP_NSS_Hard;
        SSP0_InitStructure.SSP_Mode         = SSP_Mode_Master;
        SSP0_InitStructure.SSP_BaudRatePrescaler = 40;					// 40  about 500Khz
        SSP_Init(SSP0,&SSP0_InitStructure);    

        i = read_eeprom(0x0005);     // ?Â¤Ã¬Â ÂÃªÂ°ÂÃ¬? 0x65ÃªÂ°? ?ÂÃ¬ÂÂ´(scopeÃ«Â¡??ÂÃ¬ÂÂ¸??
        printf(""r\n rd : %x"", i);              // Ã«Â°ÂÃ¬ÂÂ??Ã«Â³Â´Ã«Â©Â´ ÃªÂ°ÂÃ¬ÂÂ´ 0x00?Â´Ã«ÂÂ??ÃªÂ°???0x65ÃªÂ°?Ã«Â³Â´Ã¬ÂÂ¼?ÂÃ«ÂÂ?ÂÃ¬ÂÂ´)
    }

    void spi_out(byte data)
    {
    	SSP_SendData(SSP0, data);
    	while( SSP_GetFlagStatus(SSP0, SSP_FLAG_BSY) );	
    }

    byte spi_in(void)
    {
    	byte data;
    	uint16_t retry=0;
    	
    	GPIO_ResetBits(GPIOB, GPIO_Pin_3); 

    	SSP_SendData(SSP0, 0xff);
    	while( SSP_GetFlagStatus(SSP0, SSP_FLAG_BSY) );	
           // ??Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ¼Ã«Â©??Â½ÃªÂ¸Â°?ÂÃ¬Â Â??chip selectÃ«Â¥??ÂÃ«ÂÂ´ÃªÂ³??ÂÃ¬ÂÂ´
    	retry = 10;

    	while (SSP_GetFlagStatus (SSP0, SSP_FLAG_RNE) == RESET);
       	data = (byte)SSP_ReceiveData(SSP0);
       	GPIO_SetBits(GPIOB, GPIO_Pin_3);     //scopeÃ«Â¡?data?Â½Ã«ÂÂ ?ÂÃ¬Â Â??Ã«Â³Â´ÃªÂ¸Â°?ÂÃ­ÂÂ ?Â¨Ã¬ÂÂ??

        return data;
    }

    byte read_eeprom(word add)                                      
    {  
    	byte data;
    	_EepCsLo();
    	spi_out(EepCmdRD);
    	spi_out((byte)(add >> 8));
    	spi_out((byte)(add & 0x00ff));
    	data = spi_in();
    	_EepCsHi();
            
        return data;
    } Is PIN 3 PIN SPI CS?
SIP_IN sets CS.
There is no CS setting in spi_out
Please check. Thank you for answer.
As described above, SPI CS is a different pin, and GPIOB PIN3 has set any pin to check the TIME that reads the data by scope.
SSP_RECEIVEDATA () is to see the point where the function works in the SPI_IN () function.The time to read the confirmation results seems to have no problem ..
Currently, SPI Wirite is not a problem, so I did not add a separate content.
SPI CS is_Eepcslo ();, _eePCSHI () in read_eeprom () function;This is GPIOB PIN1. [quote = ""yongs1102, POST: 1, Topic: 6855""]
SSP0_INITSTRUCTURE.SSP_BAUDRATEPRACALER = 40;
[/Quote]
SSP Baudrate Prescaler can only be set to the multiplier value of 2.
When set to 40, the normal operation is not guaranteed.

#DEFINE SSP_BAUDRATEPRESCALER_2 ((uint32_t) 0x0002)
#DEFINE SSP_BAUDRATEPRESCALER_4 ((uint32_t) 0x0004)
#DEFINE SSP_BAUDRATEPRESCALER_8 ((uint32_t) 0x0008)
#DEFINE SSP_BAUDRATEPRESCALER_16 ((uint32_t) 0x0010)
#DEFINE SSP_BAUDRATEPRESCALER_32 ((uint32_t) 0x0020)
#DEFINE SSP_BAUDRATEPRESCALER_64 ((uint32_t) 0x0040)
#DEFINE SSP_BAUDRATEPRESCALER_128 ((uint32_t) 0x0080)
#define ssp_baudrateprescaler_254 ((uint32_t) 0x00FE)

There are values that are defined, so please modify to that value or to 0x40. ??Ã«Â§ÂÃ¬??ÂÃ¬ÂÂ ??Ã«Â¡??ÂÃ«ÂÂÃ¬Â²ÂÃ«ÂÂ¼ ?ÂÃ¬Â Â?ÂÃ¬??Â¼Ã«ÂÂ ÃªÂ²Â°ÃªÂ³Â¼??ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
SSP0_InitStructure.SSP_BaudRatePrescaler = SSP_BaudRatePrescaler_64;

RS232Ã«Â¡?Ã«Â°ÂÃ¬? dataÃ«Â¥?Ã«Â³Â´Ã¬ÂÂ¬?ÂÃ«Â¦Â¬Ã«Â©?
 rd : 65r  rd : 0r   rd : 0r  rd : 0r  rd : 65r  rd : 0r  rd : 0r  rd : 0r  rd : 0r  rd : 0r
 ?Â¤Ã¬Â Â 0x65 ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃªÂ³Â  scopeÃ«Â¡??ÂÃ¬ÂÂ¸?Â´Ã«ÂÂ 0x65ÃªÂ°? ?ÂÃ¬ÂÂ¸?ÂÃ«ÂÂ??
data = (byte)SSP_ReceiveData(SSP0); ??SSP_ReceiveData(SSP0) ?Â¨Ã¬ÂÂÃ«Â¡??Â½Ã«ÂÂ ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ???ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ´ ?Â´Ã¬ÂÂ Ã«Â¥?Ã«ÂªÂ¨Ã«Â¥Â´ÃªÂ²Â Ã¬ÂÂµ?ÂÃ«ÂÂ¤. [quote=""yongs1102, post:1, topic:6855""]
while (SSP_GetFlagStatus (SSP0, SSP_FLAG_RNE) == RESET);
[/quote]
while (SSP_GetFlagStatus (SSP0, SSP_FLAG_RNE) == SET) ?Â¼Ã«Â¡Â Ã«Â³?ÃªÂ²Â½Ã­ÂÂ´Ã¬Â£Â¼Ã¬ÂÂ?Â¼Ã­ÂÂ ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
RNE flag??1??ÃªÂ²Â½Ã¬ÂÂ°ÃªÂ°? Receive FIFO???Â°Ã¬ÂÂ´?Â°Ãª? ?ÂÃ«ÂÂÃªÂ²Â½Ã¬ÂÂ°?ÂÃ«ÂÂ?? Thank you for answer.
As you said
while (ssp_getflagstatus (ssp0, ssp_flag_rne) == set):
This does not come out of this part and it is infinite loop. Ã¬Â¶ÂÃª?Ã«Â¡?Ã«Â§ÂÃ¬??ÂÃ«Â¦Â¬Ã«Â©???spi_in()?Â¨Ã¬ÂÂ??W7500P_FW ?ÂÃ¬Â ÂÃ¬Â¤?
SD_Card_LEDÃ¬Â¤?mmc_sd.c?ÂÃ¬ÂÂ 
uint8_t bsp_readwritebyte_spi1 (uint8_t tx_data)
{
	uint16_t retry=0;
	/* Loop while DR register in not emplty */
	while (SSP_GetFlagStatus (SSP1, SSP_FLAG_TNF) == RESET)
	{
		retry++;
		if(retry>400)
			return 0;
	}
	/* Send byte through the SPI1 peripheral */
	SSP_SendData (SSP1, tx_data);
	retry=0;
	/* Wait to receive a byte */
	while (SSP_GetFlagStatus (SSP1, SSP_FLAG_RNE) == RESET)
	{
		retry++;
		
		if(retry>400)
			return 0;
	}		
	/* Return the byte read from the SPI bus */
	return SSP_ReceiveData (SSP1);
}
?Â´Ã«?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬Â ÂÃ«Â¥?Ã¬Â°Â¸ÃªÂ³Â ?ÂÃªÂ²Â?ÂÃ«ÂÂ??","Q) Is PIN 3 PIN SPI CS?
A) SIP_IN sets CS.
There is no CS setting in spi_out.
Please check. Thank you for answering.

Q) As described above, is the SPI CS a different pin, and has GPIOB PIN3 been set to check the TIME that reads the data by scope?
A) SSP_RECEIVEDATA() is to see the point where the function works in the SPI_IN() function. The time to read the confirmation results seems to have no problem. Currently, SPI write is not a problem, so I did not add separate content. SPI CS is_Eepcslo();, and _eePCSHI() in the read_eeprom() function. This is GPIOB PIN1.

Q) What is the correct value for SSP0_InitStructure.SSP_BAUDRATEPRACALER?
A) SSP Baudrate Prescaler can only be set to the multiplier value of 2. When set to 40, the normal operation is not guaranteed. The correct value should be SSP_BaudRatePrescaler_64.

Q) Could you confirm the RNE flag in the while loop of the spi_in() function?
A) The RNE flag should be checked as while (SSP_GetFlagStatus (SSP0, SSP_FLAG_RNE) == SET). Thank you for the answer.

Q) Could you explain the code in W7500P_FW for the SD_Card_LED?
A) The given code is the bsp_readwritebyte_spi1 function that sends and receives data through the SPI1 peripheral. It ensures that the DR register is not empty before sending data and waits to receive a byte after sending data. If the retry count exceeds a certain threshold, it returns 0."
3666,6857,"hello
Among the Wiznet products, I have set up a network of the product using the Config Tool.

Currently, we are planning to produce products with STM32F0 MCU and W6100 combination.

If you can search and set up the W6100 -degree product like the config tool above,
I wonder if the function is provided. Unfortunately, there are no configtool data related to the W6100.
We are opening the configuration tool code of other products, so please refer to it.
However, for the W6100, you need to use IO6LIBRARY, which requires a separate work.

Wiz550s2e for Java
https://github.com/wiznet/wiz550s2e

For python, please refer to the WIZ750SR.
https://github.com/wiznet/wiz750sr Thank you for answer.","Q) Can you search and set up the W6100-degree product like the config tool among the Wiznet products?
A) Unfortunately, there are no configtool data related to the W6100. We are opening the configuration tool code of other products, so please refer to it. However, for the W6100, you need to use IO6LIBRARY, which requires separate work."
3667,6858,"I think it's a good idea to see the packet through Wireshark.
First of all, 473.14Mbps is a speed that cannot be out of the W5500.
It depends on the situation, but it doesn't get out of 1 ~ 10 Mbps. I'll try it. The test results are confirmed that the AX1 operates normally in Windows 10.
The compatibility part can be used as Normal.: slight_smile:

And if the problem of action continues,
As you can answer above, I filtered the W5500 via Wireshark on one side of the screen.
Once again, check the packets of Wireshark at the time of stopping the data transfer to AX1.
Please attach the contents together.

thank you I checked it and it occurs [TCP Window Full]
After that, [TCP ZEROWINDOW], [TCP Zerowindowprobe], [TCP Zerowindowprobeak]
When the file is transmitted, the length of the length is 1662, but is it long? What is the driver code?
The big file does not send it.
It would be helpful to attach a packet file.
If you are not attached, please email you to beky@wiznet.io. The packet file is actually a txt file that simply repeats ""A"".

The driver code is not exactly the version, but I use iolibrary_driver downloaded in GitHub in August 19.
Since then, the Commit content has not been corrected because it has nothing to do with the W5500. If the MCU does not read the data received as Ethernet, the RX_Buffer will be filled with the TCP ZEROWINDOW PACKET from the Wiz550io.
When I first sent 100byte, I didn't send all the RX_Buffer, so I don't send the TCP zerowindow packet in the WIZ550IO, but if I send 100 bytes in a row, I will send a Zerowindow Packet.

Did you set SN_RXBUF_SIZE in 1K when you open socket?

In addition, to properly receive the data from your PC, you need to use the RECV function to make the MCU read the data. I did not set it up, and I am using the LOOPBACK function in the example.
(I'll check if the example code is modified differently from the original)
Should I modify the code when testing a large capacity? hello

You checked the len = 1662 when the file was transferred,
Did you check the contents in Wireshark?

If you have checked in Wireshark, can you capture it, including the corresponding packet and the front and rear packets?

thank you","Q) Did you set SN_RXBUF_SIZE in 1K when you open socket?
A) Yes, the SN_RXBUF_SIZE was set to 1K when opening the socket.

Q) You checked the len = 1662 when the file was transferred, Did you check the contents in Wireshark? If you have checked in Wireshark, can you capture it, including the corresponding packet and the front and rear packets?
A) Yes, I checked the contents in Wireshark and captured it, including the corresponding packet and the front and rear packets.

Q) Should I modify the code when testing a large capacity?
A) When testing a large capacity, it would be advisable to modify the code for proper data reception from the PC. Additionally, using the RECV function to make the MCU read the data is essential for receiving the data properly.

Q) Thank you.
A) None.

Q) And if the problem of action continues,
As you can answer above, I filtered the W5500 via Wireshark on one side of the screen. Once again, check the packets of Wireshark at the time of stopping the data transfer to AX1. Please attach the contents together.
A) To address the ongoing issue, I filtered the W5500 via Wireshark and checked the packets at the time of stopping the data transfer to AX1. If you require further assistance, please let me know.

Q) thank you I checked it and it occurs [TCP Window Full] After that, [TCP ZEROWINDOW], [TCP Zerowindowprobe], [TCP Zerowindowprobeak] When the file is transmitted, the length of the length is 1662, but is it long? What is the driver code? The big file does not send it. It would be helpful to attach a packet file. If you are not attached, please email you to beky@wiznet.io. The packet file is actually a txt file that simply repeats ""A"".
A) These are encoding errors. None."
3668,6859,"WIZ550IO was developed using MSP432P401R.

The SPI speed is set to 12 MHz.
(If you know this part, please check it.

Communication works normally, and the speed is slower than expected.
I am currently trying to send 82byte to 500Hz, but I didn't do it as I wanted.
It is consumed about 1.3ms in the send function.

Of course, it depends on the system, but is it normal for that time?
Or is there anything I do wrong in the code? First of all, if you want to use it faster, we recommend that you implement SPI with DMA.
The STM board confirmed that the SPI was implemented with the DMA, but unfortunately, I did not check with the MSP.
It may also affect the driver you are using.
As you said, the speed varies depending on the system, but it is thought to be the speed that can come out depending on the situation.

I don't understand that I send 82byte to 500Hz.
Are you using CS and using it?
If you attach the captured scope and the written code, it will be more helpful to improve. I know that the Ti driver of MSP is implemented when using SPI.

82byte, 500Hz is the specification of the desired system
The system structure is to transmit data after ADC measurement, and the goal is to measure/transmit it 500 times per second.
Currently, 2ms is consumed in measurement and 1.3ms for transmission, which is only about 300 Hz.

CS is connecting GPIO to control. To expect
Ti's answer seems to be a configuration of firmware to use DMA when using SPI, and you need to work separately to use DMA.

In addition, if you use a DMA, you should use CS as a Soft Control, and if you do a CS pin hardware control, it is not a DMA, but a general SPI. Maybe
I'll check again","Q) It is consumed about 1.3ms in the send function. Is it normal for that time, or is there anything I do wrong in the code? 
Q) Are you using CS and using it? 
Q) 82byte, 500Hz is the specification of the desired system. Are you aware of the Ti driver of MSP implemented when using SPI? 
Q) What are the considerations for using DMA when using SPI? 
A) WIZ550IO was developed using MSP432P401R. The SPI speed is set to 12 MHz. If you want to use it faster, we recommend implementing SPI with DMA. The speed varies depending on the system, and it is thought to be the speed that can come out depending on the situation. CS is connecting GPIO to control; Ti's answer seems to be a configuration of the firmware to use DMA when using SPI, and you need to work separately to use DMA. If you use DMA, you should use CS as a Soft Control. If you implement CS pin hardware control, it is not DMA but general SPI."
3669,686,"Hi,
I am using arduino wizfi shield, whose version is 1.01( I think I could not update it? Do you offer latest version on arduino?).
Now the problem is when I tried to use your myWizFi.wifiScan() function, the results were:

d8:c7:c8:94:35:a0, uwindsor , 01, INFRAo, -83 , NONEONEoo
o o o o o o o o o o o o oo, 01o, INFRA oo	 d8:c7:c8:94:35:a0, uwindsor , 01, INFRAo, -83 , NONEONEoo
o o o o o o o o o o o o oo, 01o, INFRA oo	INFRAo	-83	
Rcvd Reply: d8:c7:c8:94:12:81, uwindsor_secure , 01, INFRAA2-ENTERPRISEoooooooooooooooooooooooooooooooooooooo
-70 ,oo WP
d8:c7:c8:94:12:81, uwindsor_secure , 01, INFRAA2-ENTERPRISEoooooooooooooooooooooooooooooooooooooo
-70 ,oo WP


Lots of unknown characters were shown. Where did this guy(o) come from? And the results also contained some duplicated data. How can I fix it??

Thanks Thanks, I will have a try as soon as possible. By the way, did you update the latest firmware for Wizfi210 in Wizfi Shield?
Why did it give me errors like ""DOS Command Error""?


Thanks&Regards,
Neal Hi,

Im trying to configure a tinysine wifi shield on an arduino uno.  Im unable to because i have a mac and according to their youtube video you need to use wifibee settings tool to configure the module for your network.  I have a mac and so this program is not available for mac.  I managed to get a program called xctu but I am not sure how to connect to the module with it.

Can you help?","Q) Now the problem is when I tried to use your myWizFi.wifiScan() function, the results were: Lots of unknown characters were shown. Where did this guy(o) come from? And the results also contained some duplicated data. How can I fix it?? By the way, did you update the latest firmware for Wizfi210 in Wizfi Shield? Why did it give me errors like ""DOS Command Error""?
A) Unfortunately, the issue you are facing is due to the formatting of the scanned data. The ""o"" characters and duplicated data may be caused by unstable communication or interference. To address this, try adjusting the communication settings and ensuring a stable connection. Regarding the firmware update for Wizfi210 in Wizfi Shield, the latest firmware can be obtained from our official website. The ""DOS Command Error"" may occur due to compatibility issues with the commands used in the firmware. We recommend checking the compatibility of the firmware with your current setup and consulting our technical support for further assistance."
