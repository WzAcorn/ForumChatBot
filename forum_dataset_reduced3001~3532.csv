,topic_id,translated_raw,refine_raw
3000,5083,"[quote=""discobot, post:2, topic:5083""]
https://en.wikipedia.org/wiki/Inherently_funny_word
[/quote]

https://en.wikipedia.org/wiki/Inherently_funny_word Hey @jonbas, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob:","Q) Hey @jonbas, just checking in because I haven’t heard from you in a while.
A) Sorry, this is a non-response paragraph."
3001,5088,"Our ethernet board is working properly, but only with a speed of 10Mbit. I run the following initialisation code:

        wiz_PhyConf cnf;

        // Ethernet controller
        CHIPUNLOCK();
        mr2 = (uint8_t)getMR2() | 0x80;     //MR2_CLKSEL;
        setMR2(mr2);
        CHIPLOCK();

        PHYUNLOCK();
        setPHYCR0(0x02);
        setPHYCR1(0x01);
        PHYLOCK();

        cnf.mode = PHY_MODE_MANUAL;
        cnf.speed = PHY_SPEED_100;
        cnf.duplex = PHY_DUPLEX_FULL;
        ctlwizchip(CW_SET_PHYCONF, (wiz_PhyConf*)&cnf);

But when I read PHYSR, it returns 0x13, indicating 10Mbit has been selected. This is also confirmed at the LEDs of the router. What am I missing not to have the controller running at 100 Mbit? Or could it also be a faulty hardware design?

Thanks in advance [quote=""Daan, post:1, topic:5088""]
setPHYCR0(0x02); setPHYCR1(0x01);
[/quote]

There seem to be a mistake for PHYCR0 in datasheet as it says

> Auto Negotiation
> If AUTO is set to ???? SPD and DPX are ignored.
> 1 : Disable Auto Negotiation
> 0 : Enable Auto Negotiation

and it is not clear if bit should be 0 or 1. I propose you to play with this bit, and not set PHYCR0's bit 1 to 1. Thank you Eugeny, that was the trick! PHYCR0 bit 1 should not be set. Now it's running at 100Mbit","Q) What am I missing not to have the controller running at 100 Mbit? Or could it also be a faulty hardware design?
A) There seem to be a mistake for PHYCR0 in datasheet as it says ""Auto Negotiation  If AUTO is set to ???? SPD and DPX are ignored. 1 : Disable Auto Negotiation  0 : Enable Auto Negotiation"" and it is not clear if bit should be 0 or 1. I propose you to play with this bit, and not set PHYCR0's bit 1 to 1. 

Q) Thanks in advance.
A) Thank you Eugeny, that was the trick! PHYCR0 bit 1 should not be set. Now it's running at 100Mbit"
3002,509,"Using wizfi210 in server mode and ad-hoc p2p connection to a PC.


When in command-mode (after issuing +++), i still recieve data from the client-browser. This interferes with the commands i send to the Wifi-module.

Can i disable the input from the connection/browser while in command-mode? I only want to listen on the http-port while in data-mode. The data i get from the browser(?) is following:

""gzip,deflate,sdch""
Accept-Language: en-US,en;q=0.8,sv;q=0.6 Hello Hobbex

There is no option to disable input from the connection.
So, you should parse <input from the connection> and <commands/return>.
 
But, you had better issue ""ATE0"" command.
Refer to the below.

[quote]ATE 
Format ATEn 
  n=0 (Input echo disable) ex) ATE0 
  n=1 (Input echo enable) ex) ATE1 
[/quote]","Q) Can i disable the input from the connection/browser while in command-mode? I only want to listen on the http-port while in data-mode.
A) There is no option to disable input from the connection. So, you should parse <input from the connection> and <commands/return>. But, you had better issue ""ATE0"" command."
3003,5090,"[quote=""roty, post:1, topic:5090""]
As soon as I setup the data path socket (SOCK_INIT with port 20, it was closed before) , I?Âm instantly getting state SOCK_CLOSE_WAIT , then SOCK_LAST_ACK and finally SOCK_CLOSED.
[/quote]

Before ESTABLISHED state, you must issue CONNECT command to the chip. I am sure you do it because CLOSE states you mention will not appear if you do not issue connect. It seems the issue is somewhere in the communication and one of the devices (WIZ or server) terminates the conneciton. The best way to see what is going on is to use Wireshark to capture packets and see what is being exchnaged within the respective TCP session. Install Wireshark on the server (if it is possible). I do not understand. What is ""on time""? If you talk about 15 seconds delay, then probably you are right, control connection may expire. But if you talk about milliseconds, then it should not be the cause.

So what server is saying in the packet before it closes the connection? Do not perform guesses, look into evidence given you already have them. Excuse me if I'm not as precise as I should be.

I do not talk about the Command Port 21 , I just talk about Data Port 20 connection.

Please refer to the first picture I sent. The Client (170) starts short Data transmission  (line 10) on port 20 (FTP-D...) to the Server (19) and immediately ( line 11) the Client sends [FIN][ACK] to the Server (19) also on port 20. Port 20 connection for STOR ends with line 14  on TCP level . This happens within around 20ms , if I'm not wrong. At least that's my interpretation.

I still ""assume"" the socket for port 20 will be closed anyhow in between or after  line 12 and 14.

Regards

Robert [quote=""roty, post:9, topic:5090""]
Excuse me if I?Âm not as precise as I should be.
[/quote]

My apologies, it is me who messed the things. I thought that module is client, but in your case it is server.

So: .19 is FTP server (WIZ) and .170 is FTP client. And server (19) connects to the client (170), and then client (170) sends 211 bytes of data and almost immediately finishes (packet #11).

Am I correct here? Or I have again messed something? [quote=""Eugeny, post:10, topic:5090""]
Am I correct here? Or I have again messed something?
[/quote]

That's absolutely correct.

I'm not an expert and it could be I burk up the wrong tree!

But don't waste your time with me.

Robert [quote=""roty, post:11, topic:5090""]
That?Âs absolutely correct.
[/quote]

But then it means that **client** closes the connection - without receiving anything material - within 26 microseconds! Maybe it has just sent all the data within these 211 bytes - what is the actual data size? [quote=""Eugeny, post:14, topic:5090""]
when you see connection not established any more, you must check for data once more to ensure there?Âs no more data in the buffer waiting to be flushed.
[/quote]

Thanks for explaining.

I absolutely understand what you are saying. BUT, I never see state ESTABLISHED. So there is no
implicite state ""Not Established anymore"".  Of cause, I could check if data are in input buffer as soon
as state SOCK_CLOSE_WAIT and STOR command is detected. Then I could read out and store data first before disconnect data socket. But I never saw such a request, even in the WIN5500 example.

I'll do that if it is a required procedure. [quote=""roty, post:15, topic:5090""]
I never see state ESTABLISHED
[/quote]

This MAY happen because your application is slow. Established state only lasts for a couple of microseconds, and as soon as W5500 receives FIN, its state goes to FIN_WAIT.

In other words, you should look for state ESTABLISHED (0x17) as well as other states following it (>0x17). State 0x17 means that connection is established and you flush data until state changes to >0x17, but if you see state >0x17, then you just check for data and terminate. In any case state >0x17 means there **WAS** a connection established for some time, and you have had active TCP session. Check datasheet, it contains codes beyond 0x17 (SOCK_ESTABLISHED).

So in conclusion I must say that everything seems to work properly in your setup, the only mistake you made is thinking that FIN_WAIT (0x18), SOCK_CLOSE_WAIT (0x1c) is something extraordinary (and most probably was doing wrong things seeing it).

By the way, as a workaround to the speed problem - it is possible that if your MCU is very slow and socket goes in closed state when you arrive to checking it - use socket interrupt state bits. The appropriate bits of Sn_IR will get set (e.g. RECV and DISCON), and seeing these bits set means you had respective activity on the socket. But you must not forget to clear these bits when finishing with the session (and not forget to enable their operation).

Let me know if there's still something unclear on how it works and what you should do. Great answer. 

I'll follow your advice and I'll modify my code as soon as possible according your
decription.

Thanks a lot. I really appreciate you share your knowledge with novice.

Best regards

Robert","Q) What is the issue with the data path socket setup and the subsequent state transition? 
A) Before the ESTABLISHED state, you must issue the CONNECT command to the chip. The issue is likely in the communication between one of the devices (WIZ or server), and the best way to analyze it is to use Wireshark to capture packets and understand the TCP session. 

Q) What does the client and server setup look like in the FTP connection scenario? 
A) .19 is the FTP server (WIZ) and .170 is the FTP client. The server (19) connects to the client (170), and then the client (170) sends 211 bytes of data and almost immediately finishes.

Q) When is it important to check for data in the input buffer in the context of socket states? 
A) When you see the connection is not established anymore, you must check for data once more to ensure there's no more data in the buffer waiting to be flushed. This is especially important in scenarios where the socket goes into the closed state due to slow application processing.

A) This may happen because your application is slow, and the established state only lasts for a couple of microseconds. As soon as W5500 receives FIN, its state goes to FIN_WAIT. 

Q) How should the code be modified to address the speed problem in the MCU? 
A) It is possible that, if your MCU is very slow and the socket goes into a closed state when you arrive to check it, you can use socket interrupt state bits to track the activity on the socket. The appropriate bits of Sn_IR will get set (e.g. RECV and DISCON), indicating respective activity on the socket. 

Great answer. I'll follow your advice and I'll modify my code as soon as possible according to your description."
3004,5099,"I am using the wizfi250 orange board
I want to create a web page or web server and hand over the data to the board.
Is it possible?

I want to update the weather information by region in OpenweatherMap
If you pass the local name on the web server and hand over the data of the local name, it is received from the board.
I want to show the weather in the area ..
It's frustrating because it was blocked from the web interworking ?Â Ã£ÂÂ  As you can see, the Wizfi250 should be implemented with TCP Server and TCP Client.
1. Connection with web server: Wizfi250 (TCP Server) -TCP Client
2. Connection with Weather Information Server: WIZFI250 (TCP Client)

For connection of 1, you need a separate work, such as port forwarding, but if you do not want this work,
The connection of 1 is also used to use MQTT.
** If both methods are not available, it is also possible to design Wizfi250 (TCP Client) -TCP Server.

The link below is an example of utilizing OpenAPI provided by Cocoaf (Orangeboard).
https://kocoafab.cc/make/view/709


In the source code, you can create two sockets by creating two WiFi classes as shown below.

WiFICLEENT1;
WiFICLEENT2;","Q) Is it possible to create a web server and hand over the data to the Wizfi250 orange board?
A) Yes, it is possible to create a web server and pass data to the Wizfi250 orange board. 

Q) I want to update the weather information by region from OpenweatherMap. Can I pass the local name on the web server and hand over the data of the local name to the board?
A) Yes, you can update the weather information by region from OpenweatherMap by passing the local name on the web server and handing over the data to the board. 

Q) How can I establish a connection with the web server and the Weather Information Server using Wizfi250?
A) For the connection with the web server (Wizfi250 TCP Server - TCP Client) and the Weather Information Server (Wizfi250 TCP Client), you can utilize port forwarding or MQTT. If both methods are not available, you can also design the connection as Wizfi250 TCP Client - TCP Server.

Q) Can you provide an example of utilizing OpenAPI provided by Cocoaf (Orangeboard)?
A) You can find an example of utilizing OpenAPI provided by Cocoaf (Orangeboard) at the following link: https://kocoafab.cc/make/view/709.

Q) How can I create two sockets by using two WiFi classes in the source code?
A) In the source code, you can create two sockets by creating two WiFi classes as shown below:
WiFiClient client1;
WiFiClient client2;"
3005,51,"[## Hardwired TCP/IP Chips ##](https://forum.wiznet.io/t/about-the-tcp-ip-chip-category/51/1)

iEthernet is the Ethernet controller chip that includes hardwired TCP/IP Core & MAC (&PHY).

 - [W3150A+](http://www.wiznet.io/product-item/w3150a+)
 - [W5100](http://www.wiznet.io/product-item/w5100)
 - [W5200](http://www.wiznet.io/product-item/w5200)
 - [W5300](http://www.wiznet.io/product-item/w5300)
 - [W5500](http://wizwiki.net/wiki/doku.php?id=products:w5500:start)

For more information, please refer to [TCP/IP Chip Product Comparison Table](http://www.wiznet.io/product/tcpip-chip/) Hi,
We are using the W5100 in a battery operated system, with Ethernet functionality not needed most of the time. Is there a ""software-way"" to put this chip in a low power mode? Can a hardware solution be to pull its RESET line low, when Ethernet is not in use? What will the chip current consumption be in a low power or RESET state? [quote=""Consul, post:4, topic:51""]
Can a hardware solution be to pull its RESET line low, when Ethernet is not in use?
[/quote]
This is good question. According to the datasheet PLL lock depends on the hardware reset signal, and we may suspect that internal chip's high speed (PHY) clock is down during the reset, therefore the consumption will be lower. But I suspect digital part will still be operational, consuming the power, maybe in some static state (will chip have problems being in static state for a long time?).

It was already discussed on the forums, and I recall at least one designer just powered off the chip when it is not needed. The procedure will be the same - you will need to fully reinitialize chip after reset or power off, therefore (3.3v) power off may be a better option. You must ensure the power on and power off slope not to be too fast. Hi,

Thank you for quick answer! The datasheet is rather unclear on power consumption, but according to other threads here it looks that about 150mA current consumption on 3.3V will be in the ballpark, that is with Magjack mounted. When I pull the RESET line low I measure a current reduction of about 10mA in the circuit, ie. not exactly a low power mode. And as you write, the datasheet say nothing about this beeing a safe way to prolonged power down of the device, so it may be a bit risky. Powering down 3.3V to the W5100 is a solution, but that I believe will require special buffers to MCU, if any of its interface outputs should go to 3.3V, even shortly. My conclusion so far is that no easy power down mode exisist for the W5100. [quote=""Consul, post:6, topic:51""]
I believe will require special buffers to MCU
[/quote]
If chip has input protection diodes then current limiting resistors may be enough. Is there a way to disable the PHY section in the 5100 series chips and get a MII/RGMII interface out?

The only chip product I see that doesn't have a Base-T phy in it is the obsolete/nologer-made  W3150A+ 



I need to connect to NOT a Ethernet cable/magnetics and buying a second external phy chip to get back to an MII interface seems very dumb.


I ordered on of the W5100s Eval boards as it seems exactly what I want (minus the Jack, Magnetics, and PHY) which I can do on my own board except how does one disable the phy chip. W5100 datasheet says once it uses MII at the PHY side, seems to be copy-paste issue. No, W5100 does not have MII i/f as is, it has RX/TX for magnetics. I never did it, but you may be able connecting two W5100 chips back-to-back without transformer, if it is ever feasible configuration.","Q) Is there a ""software-way"" to put the W5100 chip in a low power mode? Can a hardware solution be to pull its RESET line low, when Ethernet is not in use? What will the chip current consumption be in a low power or RESET state?
A) According to the datasheet, PLL lock depends on the hardware reset signal, and the internal chip's high speed clock may be down during the reset, resulting in lower consumption. However, the digital part may still be operational, consuming power, possibly in a static state. Powering off the chip is an option, but it will require a full reinitialization after reset or power off, making power off at 3.3V a better option. The power on and power off slope should not be too fast to ensure safety.

Q) The datasheet is rather unclear on power consumption, can you provide more information on this?
A) About 150mA current consumption on 3.3V will be in the ballpark, with the Magjack mounted. Pulling the RESET line low may result in a current reduction of about 10mA in the circuit, but not exactly a low power mode. As for prolonged power down, it may be risky as the datasheet does not mention it as a safe way. 

Q) Is there a way to disable the PHY section in the W5100 series chips and get a MII/RGMII interface out?
A) The W3150A+ is the only chip product that doesn't have a Base-T phy in it. Buying a second external phy chip just to get back to an MII interface seems impractical. The W5100 Eval board may seem suitable for the purpose, minus the Jack, Magnetics, and PHY. Disabling the phy chip in W5100 is not directly mentioned in the datasheet; however, it does not have MII i/f as is and has RX/TX for magnetics.

Thank you."
3006,5105,"[W3150A+] [W5100] [W5200] [W5300] [W5500] [W5100s]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------
Hello, I am using the W5100S chip.
Using the M3 MCU, I configured to pass the data received as a Serial to Ethernet, connected it to the PC and Ren, and tried a communication test.I checked, but in the Wireshark of the PC, there is a phenomenon that does not appear.I checked whether the Overflow occurred in Buffer, but it didn't happen at all.The incidence is not high, but if you proceed with a test that repeats communication without rest, it appears once every 10 minutes (no regularity).The Ethernet connection status connects the PC and the Internet hub and connects the W5100s to the hub. [quote = ""kyjoon, post: 1, topic: 5105""]
So take it as a serial
[/Quote]
Hello, the answer was late.
In the case of UDP, packet loss may occur.
If you are worried about the loss of packets, you can use TCP.

thank you","Q) I am using the W5100S chip and I configured to pass the data received as a Serial to Ethernet. However, in the Wireshark of the PC, there is a phenomenon that does not appear. I checked whether the Overflow occurred in Buffer, but it didn't happen at all. The Ethernet connection status connects the PC and the Internet hub and connects the W5100s to the hub.
A) In the case of UDP, packet loss may occur. If you are worried about the loss of packets, you can use TCP."
3007,5109,"https://forum.wiznet.io/t/topic/4975/1

It is solved Thanks for letting us know. We agree there is an issue and we're looking into it.","Q) Thanks for letting us know?
A) It is solved. We agree there is an issue and we're looking into it."
3008,511,"1. We have a 5300 + silabs product, and it does not have any DHCP support code. I can ping it with a direct cable connection from PC. I can ping it through my switch A. There can be multiple devices in the same switch A belonging to a network, say 192.168.1.x. My arp table if fine till this point. If I connect this switch to another switch B belonging to an existing large network with lot of devices, all hell breaks loose. 5300 replies for the first ping, and then it times out. Sometimes, it doesn't even reply for the first ping. If I see THE arp table, I can see that the MAC of 5300 is replaced with something else, and the gateway I entered in 5300  is also present with the same MAC, even though that gateway IP is not a valid IP or valid device! If I change the gateway in 5300 to 0.0.0.0, it doesn't help.  If I replace my 5300 device with another thirdparty device which uses realtek nw chip, with same IP and MAC, that device works fine, and pings well. If I replace 5300 device with a laptop, then the laptop replies for the ping correctly. If I remove the cable connection between this switch and the other network, then the problem disappears. That network has multiple network addresses, 192.168.1.x and 2.xs connected using 2 switches and nothing else, to my knowledge. No IP clash or MAC clash, since I can replace my device with another third party device with same MAC/IP as mentioned before, then it pings fine. If I do not use switch A, and just plug 5300 device into switch B network, the result is same. Some times, if 5300 initiates a connection to a specific PC in switch B,  then from that machine, 5300 can be pinged. Broadcasts from 5300 can also be received in all PCs connected in switch B. I have tried clearing arp table before pinging, specially when I see the arp table being filled with wrong MAC value  of 5300 ie: MAC that does not belong to 5300.
 In short, 5300 doesn't ping correctly in some network, with unknown /many devices !! . But my 5300 device works correctly with 3 or 4 devices in switch A, and can communicate with external word through a gateway also. What could be wrong?

2. Can 5300 negotiate speed with any 10/100/1000 switch / network device? I have tested it with 10/100 and it works fine. I have also posted this at [tomshardware.com/answers/id- ... issue.html](http://www.tomshardware.com/answers/id-2004391/strange-network-issue.html) since the answers from wiznet are generally late, if at all I get them. Got one reply from Tomshardware.com. He suggested that the issue could be arp poisoning. Is there any reason why a similar device (non wiznet serial-ethernet  device) with same MAC and IP doesn't get affected?  wiznet ping reply is hardware processed, and does this have something to do with the issues? Thanks, hjjeon0608 for the reply. Please go through the comments and advice.

1. Actually, I have mentioned that the devices from same network cannot ping wiznet. (ie: if wiznet address is 192.168.1.5 then 192.168.1.x devices are not able to ping. That was the quesiton!). I do not require DHCP at all. static ip address onlyis required. But, when wiznet device is connected to a specific network, ping works only once. When I posted this in Tom's hardware.com. I got the response that, this could be because of arp poisoning. Please check my link. Wiznet mac address is in such a network is somehow being changed.

2. I have tested wiznet using a couple of different makes of switches  of speed 10/100/1000, and it works fine. But I have found some laptops with 10/100/1000 not working. I needed to confirm that, wiznet can work in all 10/100/1000 environments. Speed would be 100 mbps, but what is important is to be able to connect and establish 100 mpps speed without errors. Hi,

To solve arp-poisioning problem, whenever it is reset or the cable is pluged after unpluged, Active send udp data to any peer. By sending udp data, its mac address can be registered into arp-manager agent as switch,gateway,and etc.

In second phase,
We can't guarantee of connection with all network device in the world. 
As you known, Test is limited.
If you tell me about information of devices have some problem, we will cope with the problem passionately.

Thank you. Thank you for the reply.

1. Currently, we are sending data to a specific peer, and from that peer, pinging seem to be working, but with issues. Will create a new subject on that, for clarity

2 I understand that you cannot guarantee connection with all the devices. But I can see that, it  would connect with normal 10/100/1000 ports, and that would be quite sufficient for all purposes. I was merely asking if there are any documented incompatibilities with auto-negotiation with 10/100/1000, and if there is anything specific that we should be aware of. 

Thanking you again. We feel supported and re-assured when questions are answered, or replied to. Hi, rm69.

I contemplated about No.1 problem.

I think arp table of router or switch is changed because there are same IP.
So first, W5300's MAC address is written at ARP table and then another device send ARP packet so MAC address could be changed. And it is looked like ARP poison.

The network are very large so it could be happened.

But I still wonder why ping still works with other device(e.g. laptop).

You may believe W5300 has problem, but the product is launched long time ago and it does not have such problem.
And packet sent by W5300 is standard so I recommend to use like dummy hub for capturing ping packet between A network and B network.

If you can, it help to solve the problem a lot.

Best regards.","Q) We have a 5300 + silabs product, and it does not have any DHCP support code. I can ping it with a direct cable connection from PC. I can ping it through my switch A. There can be multiple devices in the same switch A belonging to a network, say 192.168.1.x. My arp table if fine till this point. If I connect this switch to another switch B belonging to an existing large network with lot of devices, all hell breaks loose. 5300 replies for the first ping, and then it times out. Sometimes, it doesn't even reply for the first ping. If I see THE arp table, I can see that the MAC of 5300 is replaced with something else, and the gateway I entered in 5300 is also present with the same MAC, even though that gateway IP is not a valid IP or valid device! If I change the gateway in 5300 to 0.0.0.0, it doesn't help.  If I replace my 5300 device with another thirdparty device which uses realtek nw chip, with same IP and MAC, that device works fine, and pings well. If I replace 5300 device with a laptop, then the laptop replies for the ping correctly. If I remove the cable connection between this switch and the other network, then the problem disappears. That network has multiple network addresses, 192.168.1.x and 2.xs connected using 2 switches and nothing else, to my knowledge. No IP clash or MAC clash, since I can replace my device with another third party device with same MAC/IP as mentioned before, then it pings fine. If I do not use switch A, and just plug 5300 device into switch B network, the result is same. Some times, if 5300 initiates a connection to a specific PC in switch B,  then from that machine, 5300 can be pinged. Broadcasts from 5300 can also be received in all PCs connected in switch B. I have tried clearing arp table before pinging, specially when I see the arp table being filled with wrong MAC value  of 5300 ie: MAC that does not belong to 5300.
 In short, 5300 doesn't ping correctly in some network, with unknown /many devices !! . But my 5300 device works correctly with 3 or 4 devices in switch A, and can communicate with external word through a gateway also. What could be wrong? 
A) I think arp table of router or switch is changed because there are same IP. So first, W5300's MAC address is written at ARP table and then another device send ARP packet so MAC address could be changed. And it is looked like ARP poison. The network are very large so it could be happened. But I still wonder why ping still works with other device(e.g. laptop). You may believe W5300 has problem, but the product is launched long time ago and it does not have such problem. And packet sent by W5300 is standard so I recommend to use like dummy hub for capturing ping packet between A network and B network. 
Q) Can 5300 negotiate speed with any 10/100/1000 switch / network device? I have tested it with 10/100 and it works fine. I have also posted this at [tomshardware.com/answers/id- ... issue.html](http://www.tomshardware.com/answers/id-2004391/strange-network-issue.html) since the answers from wiznet are generally late, if at all I get them. Got one reply from Tomshardware.com. He suggested that the issue could be arp poisoning. Is there any reason why a similar device (non wiznet serial-ethernet  device) with same MAC and IP doesn't get affected?  wiznet ping reply is hardware processed, and does this have something to do with the issues? Thanks, hjjeon0608 for the reply. Please go through the comments and advice. 
A) To solve arp-poisioning problem, whenever it is reset or the cable is pluged after unpluged, Active send udp data to any peer. By sending udp data, its mac address can be registered into arp-manager agent as switch,gateway,and etc. We can't guarantee of connection with all network device in the world. As you known, Test is limited. If you tell me about information of devices have some problem, we will cope with the problem passionately.
Q) Actually, I have mentioned that the devices from same network cannot ping wiznet. (ie: if wiznet address is 192.168.1.5 then 192.168.1.x devices are not able to ping. That was the quesiton!). I do not require DHCP at all. static ip address onlyis required. But, when wiznet device is connected to a specific network, ping works only once. When I posted this in Tom's hardware.com. I got the response that, this could be because of arp poisoning. Please check my link. Wiznet mac address is in such a network is somehow being changed. 
A) I contemplated about No.1 problem. I think arp table of router or switch is changed because there are same IP. So first, W5300's MAC address is written at ARP table and then another device send ARP packet so MAC address could be changed. And it is looked like ARP poison. The network are very large so it could be happened. But I still wonder why ping still works with other device(e.g. laptop). You may believe W5300 has problem, but the product is launched long time ago and it does not have such problem. And packet sent by W5300 is standard so I recommend to use like dummy hub for capturing ping packet between A network and B network.
Q) I have tested wiznet using a couple of different makes of switches  of speed 10/100/1000, and it works fine. But I have found some laptops with 10/100/1000 not working. I needed to confirm that, wiznet can work in all 10/100/1000 environments. Speed would be 100 mbps, but what is important is to be able to connect and establish 100 mpps speed without errors. Hi, 
A) I understand that you cannot guarantee connection with all the devices. But I can see that, it  would connect with normal 10/100/1000 ports, and that would be quite sufficient for all purposes. I was merely asking if there are any documented incompatibilities with auto-negotiation with 10/100/1000, and if there is anything specific that we should be aware of. Thanking you again. We feel supported and re-assured when questions are answered, or replied to."
3009,5110,"https://forum.wiznet.io/t/topic/4893/1

not required Thanks for letting us know. We agree there is an issue and we're looking into it.","Q) Thanks for letting us know. 
A) We agree there is an issue and we're looking into it."
3010,512,"Hi!

I use my custom board with WizFi630. I can successfully use all ethernet and wireless interfaces (currently it looks like one small switch:)) in any operation mode. However, I can not communicate with WizFi630 by means of serial interfaces. I tried to use three apps for sending commands(<+++>, <WF>, <RI>, etc. in any combinations) through my COM-port to serial interface #1 (and also #2): Wizard Version 1.0, Device Terminal Ver. 1.0 and WIZSmartScript - no success. I see sent data on TX using oscilloscope, but no data on RX. I have connected only RxD, TxD and GND and haven't touched RTS_N, CTS_N, RIN, etc. GPIO19 is pulled up to logical ""1"" while ""Serial Command Mode - Disabled"".
Maybe I should use some addtitional pins? Will it work on such minimal RS232 configuration as I have?

Thanks! Hi Limit

1. Check GPIO
Serial Setting -> Serial Port #1 -> Data Packing Condition -> Command mode
Check Enable(Enable:HW GPIO Used) and change the switch of WizFi630-EVB.

2. Do <Factory default>.
Please try it again, after factory default.","Q) Maybe I should use some additional pins? Will it work on such minimal RS232 configuration as I have?
A) Serial Setting -> Serial Port #1 -> Data Packing Condition -> Command mode
Check Enable(Enable:HW GPIO Used) and change the switch of WizFi630-EVB.

Q) Thanks! Hi Limit
A) Do <Factory default>.
Please try it again, after factory default."
3011,5124,"Can I keep the socket connected from At Command Mode to Data Mode?

If you send at+mdata \ r \ n and go to Data Mode, the connection is cut off without closing the socket.

Can't you connect the socket in the data mode? Dear, TOPHS7

When switching at AT and DATA mode, the socket is initialized.The operation of the previous mode is not maintained.","Q) Can I keep the socket connected from At Command Mode to Data Mode?
A) Can't you connect the socket in the data mode?

Q) When switching at AT and DATA mode, the socket is initialized. The operation of the previous mode is not maintained.
A) If you send at+mdata \ r \ n and go to Data Mode, the connection is cut off without closing the socket."
3012,5127,"I have a WIZ750SR-105  module with F/W v1.2.4
When I set the module to TCP server mode, everything works OK.
But when I set it to TCP-CLient or Mixed mode, the module does not seem to be working.
I have been struggling with this for a week.
Any Idea? In TCP client mode and TCP mixed mode, the destination IP address and port number to be connected to WIZ750SR module must be set correctly.

The 'Remote host / port' settings of the Configuration tool is the destination IP address and port number for the TCP connection. Please check these settings.","Q) Any Idea?
A) In TCP client mode and TCP mixed mode, the destination IP address and port number to be connected to WIZ750SR module must be set correctly. The 'Remote host / port' settings of the Configuration tool is the destination IP address and port number for the TCP connection. Please check these settings."
3013,513,"Hi!

Is it possible to reset WizFi630 to factory defaults avoiding using of <WF> serial command and web interface? Maybe some kind of hardware reset using special pin?

Thanks! Hello limit

You can make <WizFi630-Factory-default> using 38 Pin.
If you press <Reset button in EVB, in other words, 38 Pin> for around 5 seconds, WizFi630 will become factory-default-state.
 
Regards","Q) Is it possible to reset WizFi630 to factory defaults avoiding using of <WF> serial command and web interface? Maybe some kind of hardware reset using special pin?
A) You can make <WizFi630-Factory-default> using 38 Pin. If you press <Reset button in EVB, in other words, 38 Pin> for around 5 seconds, WizFi630 will become factory-default-state."
3014,5130,"hello.We are currently trying to implement FTP using the W5300.Can I get an example code?please. hello

You can receive a library code that can be implemented with the W5300 in the link below.
https://github.com/wiznet/iolibrary_driver/tree/master/INTERNET","Q) Can I get an example code? 
A) You can receive a library code that can be implemented with the W5300 in the link below:
https://github.com/wiznet/iolibrary_driver/tree/master/INTERNET"
3015,5132,"Using Wiz811MJ and STM32F107 MCU, TCP Server is configured to set up PC and MODBUS TCU test
There is a problem during the way, and I upload a question.
The problem to be confirmed is that SN_SR works well in sock_established and suddenly
 Socket_established -> socket_close_wait-> socket_close-> sock_established
The connection will be cut once.
 I have no experience in TCP, so please let me know in detail.If you have the data you need to help, I'll upload it right away. hello

TCP_CLOSE_WAIT status is a state of receiving a Fin Packet from the opponent.
I think it is necessary to check what the PC is transmitted in the packet.
We recommend that you analyze packets with the Wireshark program.","Q) There is a problem during the way, and I upload a question. The problem to be confirmed is that SN_SR works well in sock_established and suddenly Socket_established -> socket_close_wait-> socket_close-> sock_established The connection will be cut once. I have no experience in TCP, so please let me know in detail. If you have the data you need to help, I'll upload it right away. 
A) The SN_SR transition you mentioned indicates the status of the Wiz811MJ module. The sudden transition from sock_established to socket_close_wait and then to socket_close indicates a problem in the TCP communication. This behavior could be caused by issues with the data transmission or socket handling. To diagnose the issue, analyzing the packets using a tool like Wireshark is recommended. This will help in understanding the data exchanges between the PC and the TCP server, aiding in identifying the root cause of the connection dropout."
3016,5134,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

W7500PÃªÂ°? ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ?ÂÃ«ÂÂÃ¬Â§? ?ÂÃ¬ÂÂ¸???ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´???ÂÃ¬Â ÂÃ«Â¥?Ã¬Â°Â¸ÃªÂ³Â ?ÂÃ¬ÂÂ¬ ?Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬? ?ÂÃ¬ÂÂ¤???ÂÃ¬ÂÂ¤Ã«Â¥??ÂÃ¬ÂÂ±?ÂÃ¬??ÂµÃ«ÂÂ?? ???ÂÃªÂ°Â?ÂÃ«ÂÂ ?ÂÃ«ÂÂÃ¬Â²ÂÃ«ÂÂ¼?ÂÃ«Â©Â´ ÃªÂ³Â Ã¬Â Â ipÃ«Â¥?Ã«Â°ÂÃ«ÂÂ ÃªÂ²ÂÃ¬ÂÂ´ÃªÂ³?Ã«Â¬Â¸Ã¬Â Â ?ÂÃ¬ÂÂ´ Ã«Â§ÂÃ­ÂÂ¬ÃªÂ°? Ã«Â¶ÂÃ¬ÂÂ´???ÂµÃ¬ÂÂ ????ÃªÂ²ÂÃ¬ÂÂ´?Â¼ÃªÂ³Â  ?ÂÃªÂ°Â?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?Â¼Ã¬ÂÂ°???Â¬Ã­ÂÂ¸???Â°ÃªÂ²Â°?ÂÃ¬ÂÂ¬ Ã«Â³Â´Ã«ÂÂ w7500p???ÂÃ¬ÂÂ¸???ÂÃ¬ÂÂ?ÂµÃ«ÂÂ?? ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡?Ã«Â§ÂÃ­ÂÂ¬ÃªÂ°? Ã«Â¶ÂÃ¬? ?ÂÃ«ÂÂÃªÂ²?ÃªÂ°ÂÃ¬ÂÂ???Â°Ã¬ÂÂ¤?Â¬Ã­ÂÂÃªÂ³?ÃªÂ°ÂÃ¬? ?Â¤Ã­ÂÂ¸?ÂÃ­ÂÂ¬ ????ÂÂ ÃªÂ°ÂÃªÂ²Â ?Â¤Ã¬Â Â????1:1Ã«Â¡??Â°ÃªÂ²Â°?ÂÃ¬?Ã¬Â§?Ã«Â§?Ã«Â§ÂÃ­ÂÂ¬ÃªÂ°? Ã«Â¶ÂÃ¬? ?ÂÃ«ÂÂ ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂ?ÂµÃ«ÂÂ??

?ÂÃ«Â¡Â??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ«ÂÂÃªÂ¹??ÂÃ¬ÂÂ¬ ?Â Ã«Â²Â ??Ã«Â³Â´Ã«ÂÂ?? ?Â¤Ã«Â¥Â¸ ?ÂÃ«Â¡ÂÃ«Â¥??Â¬Ã¬ÂÂ©??Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ°???ÂÃ¬ÂÂ¼ Ã¬Â¦ÂÃ¬ÂÂ??Ã«Â°ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

?Â¹Ã¬ÂÂ ?ÂÃªÂ°Â???ÂÃ¬ÂÂÃ«Â©??ÂÃ«Â²Â ÃªÂ²??Â Ã­ÂÂ´Ã¬Â£Â¼Ã¬ÂÂ???ÂÃ«ÂÂ??


    /*netset.h*/

    #ifndef NET_SETTING_H__
    #define NET_SETTING_H__


    #include ""W7500x_wztoe.h""
    #include ""W7500x_miim.h""

    #include ""loopback.h""
    #include ""dhcp.h""
    #include ""socket.h""

    #include ""flash.h""


    #define SOCK_TCPS	0
    #define SOCK_DHCP	2

    #define MY_MAX_DHCP_RETRY   3

    #define MAC_ADDR_SIZE 6
    #define IP_ADDR_SIZE 4


    typedef struct netconfig{
    	  uint8_t mac_addr[6]; 
        uint8_t src_addr[4];
        uint8_t gw_addr[4];
    		uint8_t sub_addr[4];
    }NetConfig;


    void netboot(void);
    void netset(void);
    void vDHCPTaskFunction(void* pvParameters);

    #endif


    /*netset.c*/
    #include ""netset.h""
    #include ""flash.h""


    #define debug_mode


    const uint8_t SIPR[4] = {192,168,42,9};
    const uint8_t  GAR[4] = {192,168,42,1};
    const uint8_t SUBR[4] = {255,255,255,0};


    uint8_t test_buf[2048];
    uint32_t my_dhcp_retry = 0;


    #ifdef debug_mode
    		const uint8_t SHAR[6] = {0x00, 0x08, 0xDC, 0x71, 0x72, 0x77};
    #endif



    void netboot(void){
    	
    		#ifdef debug_mode
    			DO_IAP(IAP_PROG, DAT0_START_ADDR, (uint8_t*)SHAR, MAC_ADDR_SIZE);
    			DO_IAP(IAP_PROG, DAT0_START_ADDR + MAC_ADDR_SIZE, (uint8_t*)SIPR, IP_ADDR_SIZE);
    			DO_IAP(IAP_PROG, DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE, (uint8_t*)GAR, IP_ADDR_SIZE);
    			DO_IAP(IAP_PROG, DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE + IP_ADDR_SIZE, (uint8_t*)SUBR, IP_ADDR_SIZE);
    		#endif

        PHY_Init();    
        while( link() == 0x0)
    			
    		netset();
    		
    //		if((Buffercmp((uint8_t*)SIPR,(((/*volatile */uint8_t *)(DAT0_START_ADDR) + MAC_ADDR_SIZE)),IP_ADDR_SIZE) == PASSED) &&
    //			 (Buffercmp((uint8_t*)GAR, (((/*volatile */uint8_t *)(DAT0_START_ADDR) + MAC_ADDR_SIZE + IP_ADDR_SIZE)),IP_ADDR_SIZE) == PASSED) &&
    //			 (Buffercmp((uint8_t*)SUBR,(((/*volatile */uint8_t *)(DAT0_START_ADDR) + MAC_ADDR_SIZE + IP_ADDR_SIZE + IP_ADDR_SIZE)),IP_ADDR_SIZE) == PASSED) )
    //		{
    			//run dhcp task->if 3 time loss, then default netset
    			
    //		}
    			
    }

    void netset(void){

    	NetConfig config;
    		
    	readflash((uint8_t*)config.mac_addr,(/*volatile */uint8_t *)(DAT0_START_ADDR), MAC_ADDR_SIZE);
    	readflash((uint8_t*)config.src_addr,(/*volatile */uint8_t *)(DAT0_START_ADDR + MAC_ADDR_SIZE), IP_ADDR_SIZE);
    	readflash((uint8_t*)config.gw_addr, (/*volatile */uint8_t *)(DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE), IP_ADDR_SIZE);
    	readflash((uint8_t*)config.sub_addr,(/*volatile */uint8_t *)(DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE + IP_ADDR_SIZE), IP_ADDR_SIZE);
    	
    	setSHAR(config.mac_addr);
    	setSIPR(config.src_addr);
    	setGAR(config.gw_addr);
    	setSUBR(config.sub_addr);
    	
    }

    void vDHCPTaskFunction(void* pvParameters){
    } hello

Does it mean that the link is tied to the lower door below?Is there a fire in the link LED?

[Quote = ""11116, POST: 1, Topic: 5134""]
while (link () == 0x0)
[/Quote] [Quote = ""Becky, POST: 2, Topic: 5134""]
Does it mean that the link is tied to the lower door below?Is there a fire in the link LED?
[/Quote]

hello.Thank you for answer.I haven't checked it because I have a debugging tool if I'm tied to the Japanese. The Link LED is light, but it is displayed so that it is not connected to the connected router without ping. hello

If the Link LED has been on fire, please check again if the network setting is right.
Whether data on the chip is read/write normally
You should debug whether the network settings are the same value. thank youIs there a separate way to make sure it's light on the Mbed board?
It's the same as I downloaded the Loopaback example you put on the GitHub on the MBED board for the test now.
In the example, I tried it in accordance with the network setting connected only to the source address and the gateway address. thank youThanks to this, I could find a problem.

DO_IAP The address of the data stored in Fresh is put in a pointer variable.


    #define debug
   
    TypeDef Struct NetConfig {
uint8_t mac_addr [6];
uint8_t src_addr [4];
uint8_t gw_addr [4];
uint8_t sub_addr [4];
    } Netconfig;

    Const NetConfig defaultData = {{0x00, 0x08, 0xdc, 0x01, 0x02, 0x03}, {192,168,42,123}, {192,168,42,1}, {255,255,255,0}}};

    NETSET (VOID) {

NetConfig* PConfig

#IFDEF Debug
Do_iap (IAP_PROG, DAT0_START_ADDR, (uint8_t*) (& defaultdata), 18);
#endif

pconfig = (netconfig*) (dat0_start_addr);
setshar (PConfig-> mac_addr);
setsipr (PConfig-> src_addr);
setgar (pconfig-> gw_addr);
setsubr (PConfig-> sub_addr);

    }

It's a simplified code, but if you do this, you can't set the IP.



    #define debug

    TypeDef Struct NetConfig {
uint8_t mac_addr [6];
    uint8_t src_addr [4];
    uint8_t gw_addr [4];
    uint8_t sub_addr [4];
    } Netconfig;

    Const NetConfig defaultData = {{0x00, 0x08, 0xdc, 0x01, 0x02, 0x03}, {192,168,42,123}, {192,168,42,1}, {255,255,255,0}}};

    NETSET (VOID) {

    NetConfig* PConfig

#IFDEF Debug
Do_iap (IAP_PROG, DAT0_START_ADDR, (uint8_t*) (& defaultdata), 18);
    #endif

    pconfig = (netconfig*) (& defaultdata);
    setshar (PConfig-> mac_addr);
    setsipr (PConfig-> src_addr);
    setgar (pconfig-> gw_addr);
    setsubr (PConfig-> sub_addr);

    }

In this way, it works normally.
I can save IP in my internal flash and I can get it when I boot, but I can't read it.
Can't you access the flash internal data as a pointer? Almost all of the Flash used in MCUs these days is NAND. NOR is expensive.

Most of the Cortex-M-based MCUs I have experienced can not access the NAND Flash as a pointer, but can be accessible by page using a controller called NVMCTRL.

Due to the nature of NAND, it is impossible to read and write in byte.Even if you try to use 1 bytes, you have to read it on page units, change 1 bytes data, and then rewrite the entire page.

If you don't provide a separate Flash area called Work Flash, you can use NVMCTRL to create a Pseudo EEPROM layer and use a part of Flash like eEPROM.

https://en.wikipedia.org/wiki/flash_memory#nor_flash
https://en.wikipedia.org/wiki/flash_memory#nand_flash

Please look at the NAND memory structure.You can understand why you are not directly accessible as a pointer. hello

First of all, you can access the flash internal data as a pointer.
However, as Leejin0 said above, it is impossible to read and write in bytes.
We recommend you to erase it before you write to the flash and use data on a section.
https://github.com/wiznet/w7500/tree/master/w7500x_library_examples/projects/peripheral_examples
Please refer to the flash example of the link above.

I'll review the code you uploaded. thank youThanks to this, I was able to solve the problem well.

I've written an example to partially change the sector of the flash below.


    Volatile testTatus transfersstatus = failed;
    
        Void Readfalsh (uint8_t* dst_addr, uint8_t* src_addr, uint32_t size) {
    uint32_t I;
    For (i = 0; I <size; I ++) {
    src_addr [i] = dst_addr [i];
    }
    
    }
    
    void writeflash (uint32_t dst_addr, uint8_t* src_addr, uint32_t size) {
    
    uint8_t buf [sect_size] = {0};
    uint32_t I;
    uint32_t tempaddr;
    UINT8_T TEMPSET;
    
    
    
    if (dst_addr <dat1_start_addr) {
    Tempaddr = dat0_start_addr;
    TEMPSET = IAP_ERAS_DAT0;
    } else {
    Tempaddr = dat1_start_addr;
    TEMPSET = IAP_ERAS_DAT1;
    }
    
    ReadFalsh ((uint8_t*) Tempaddr, (uint8_t*) BUF, sect_size;
    
    For (i = 0; I <size; I ++) {
    BUF [dst_addr -tempaddr + i] = src_addr [i];
    }
    
    Do_iap (tempset, 0,0,0);
    Do_iap (IAP_PROG, TEMPADDR, BUF, SECT_SIZE);
    
    }
    
    Void Eraseflash (uint32_t dst_addr, uint32_t size) {
    uint8_t src_addr [sect_size] = {0};
    Writeflash (dst_addr, src_addr, size);
    } [Quote = ""11116, POST: 9, Topic: 5134""]
I was able to solve the problem well.

I've written an example to partially change the sector of the flash below.
[/Quote]

I'm glad you solved it.
And thank you for good information.","Q) Does it mean that the link is tied to the lower door below? Is there a fire in the link LED?
A) While (link() == 0x0), it means that the link is tied to the lower door below. The Link LED cannot be confirmed unless you have checked that.

Q) Is there a separate way to make sure it's light on the Mbed board?
A) If the Link LED has been on fire, please check again if the network setting is right. Whether data on the chip is read/write normally, and you should debug whether the network settings are the same value.

Q) Can't you access the flash internal data as a pointer?
A) First of all, you can access the flash internal data as a pointer. However, it is impossible to read and write in bytes. We recommend you to erase it before you write to the flash and use data on a section.

Q) I was able to solve the problem well. I've written an example to partially change the sector of the flash below.
A) I'm glad you solved it. And thank you for good information. 

```c
/*netset.h*/

#ifndef NET_SETTING_H__
#define NET_SETTING_H__

#include ""W7500x_wztoe.h""
#include ""W7500x_miim.h""

#include ""loopback.h""
#include ""dhcp.h""
#include ""socket.h""

#include ""flash.h""

#define SOCK_TCPS	0
#define SOCK_DHCP	2

#define MY_MAX_DHCP_RETRY   3

#define MAC_ADDR_SIZE 6
#define IP_ADDR_SIZE 4

typedef struct netconfig{
      uint8_t mac_addr[6]; 
      uint8_t src_addr[4];
      uint8_t gw_addr[4];
      uint8_t sub_addr[4];
}NetConfig;

void netboot(void);
void netset(void);
void vDHCPTaskFunction(void* pvParameters);

#endif

/*netset.c*/
#include ""netset.h""
#include ""flash.h""

#define debug_mode

const uint8_t SIPR[4] = {192,168,42,9};
const uint8_t  GAR[4] = {192,168,42,1};
const uint8_t SUBR[4] = {255,255,255,0};

uint8_t test_buf[2048];
uint32_t my_dhcp_retry = 0;

#ifdef debug_mode
        const uint8_t SHAR[6] = {0x00, 0x08, 0xDC, 0x71, 0x72, 0x77};
#endif

void netboot(void){
    
        #ifdef debug_mode
            DO_IAP(IAP_PROG, DAT0_START_ADDR, (uint8_t*)SHAR, MAC_ADDR_SIZE);
            DO_IAP(IAP_PROG, DAT0_START_ADDR + MAC_ADDR_SIZE, (uint8_t*)SIPR, IP_ADDR_SIZE);
            DO_IAP(IAP_PROG, DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE, (uint8_t*)GAR, IP_ADDR_SIZE);
            DO_IAP(IAP_PROG, DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE + IP_ADDR_SIZE, (uint8_t*)SUBR, IP_ADDR_SIZE);
        #endif

    PHY_Init();    
    while( link() == 0x0)
            
    netset();
        
//      if((Buffercmp((uint8_t*)SIPR,(((/*volatile */uint8_t *)(DAT0_START_ADDR) + MAC_ADDR_SIZE)),IP_ADDR_SIZE) == PASSED) &&
//           (Buffercmp((uint8_t*)GAR, (((/*volatile */uint8_t *)(DAT0_START_ADDR) + MAC_ADDR_SIZE + IP_ADDR_SIZE)),IP_ADDR_SIZE) == PASSED) &&
//           (Buffercmp((uint8_t*)SUBR,(((/*volatile */uint8_t *)(DAT0_START_ADDR) + MAC_ADDR_SIZE + IP_ADDR_SIZE + IP_ADDR_SIZE)),IP_ADDR_SIZE) == PASSED) )
//      {
            //run dhcp task->if 3 time loss, then default netset
            
//      }
            
}

void netset(void){

    NetConfig config;
        
    readflash((uint8_t*)config.mac_addr,(/*volatile */uint8_t *)(DAT0_START_ADDR), MAC_ADDR_SIZE);
    readflash((uint8_t*)config.src_addr,(/*volatile */uint8_t *)(DAT0_START_ADDR + MAC_ADDR_SIZE), IP_ADDR_SIZE);
    readflash((uint8_t*)config.gw_addr, (/*volatile */uint8_t *)(DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE), IP_ADDR_SIZE);
    readflash((uint8_t*)config.sub_addr,(/*volatile */uint8_t *)(DAT0_START_ADDR + MAC_ADDR_SIZE + IP_ADDR_SIZE + IP_ADDR_SIZE), IP_ADDR_SIZE);
    
    setSHAR(config.mac_addr);
    setSIPR(config.src_addr);
    setGAR(config.gw_addr);
    setSUBR(config.sub_addr);
    
}

void vDHCPTaskFunction(void* pvParameters){
} 
```"
3017,514,"I just received a WIZ220OI, loaded configuration tool ver 1.1, and powered it up with 5V.  Red led on board is on, green led on ethernet jack is on, and orange led on ethernet jack blinks.  When I click on search using the tool. the MAC address displays, but all other fields are blank.  A window pops up saying ""invalid parameters"" and under that is another window saying search complete.  Am I missing a step or do I have a defective module or bad firmware load? Hi,

The problem maybe occured by different version between firmware and config tools. 

First, check the firmware version and update the latest version of firmware.

The versions are 
fw : 1.3
config tools : 1.1 Hi, 
I think you'd better return your module to distributor for RMA process.","Q) Am I missing a step or do I have a defective module or bad firmware load? 
A) The problem maybe occurred by different version between firmware and config tools. First, check the firmware version and update the latest version of firmware. The versions are fw: 1.3, config tools: 1.1. 

Q) Hi, what should I do? 
A) I think you'd better return your module to distributor for RMA process."
3018,5140,"Hi everybody.

I am using the W7500P-S2E on a self developed Board.
I got a problem with the RS232->Ethernet Signal.

Receiving from the Ethernet:
Received Data goes trough on the U_TXD0 (PA13/Pin43). It is functional and an other RS232 Device gets the Data. Works fine.

Sending back on the U_RXD0 (PA14/Pin44) is correctly but from there.... nothing on the Ethernet. Stays dead silent. -> The signal comes correctly on the W7500P Pin44.

Best Regards
Pio Additional:

It had Firmware Version 1.1.0.

I tried to update the version to 1.2.4 with the WIZnet tool 0.5.5 Beta
https://github.com/Wiznet/WIZ750SR/releases
Bin: WIZ750SRv124.bin (App only)

Cant find it anymore. Still have one backup platine with the old same behavior.

Best Regards
Pio Hi Pio,

For products prior to firmware version 1.1.2, the latest firmware can not be used immediately due to a change in the firmware update mechanism applied to version 1.2.0.
(Refer to https://wizwiki.net/wiki/doku.php?id=products:wiz750sr:download:start)

Please refer to the following link: WIZ750SR Recovery User Guide
https://wizwiki.net/wiki/doku.php?id=products:wiz750sr:developers:start#flash_programming_using_wizisp_tool Hi eric,

regardless of the version.
Is it necessary to update the firmware to get rid of the bug I posted?
Is there a known bug? Hi eric,

is there a way to send you the schematic on private?

Best Regards
Pio Hi Pio.
Yes. Please use the message of the forum to send the hardware design to me. Hi eric.

Sry I am not allowed to send you a private message here.
Maybe an email address?

Best Regards
Pio Hi Pio.

Ok. Please mail me directly. 
We will contact you after review.

eric@wiznet.io Hey eric.

Thanks for the help.
It was just the missing connection between Pin14 and Pin23.

In total it was my fault using the wrong version of the datasheet. I used v1.0 instead of v1.2.
Also thanks for the fast contact and support via email.

Best Regards
Pio","Q) Is it necessary to update the firmware to get rid of the bug I posted?
Q) Is there a known bug?
Q) Is there a way to send you the schematic on private?
Q) Thanks for the help. A) It was just the missing connection between Pin14 and Pin23. In total it was my fault using the wrong version of the datasheet. I used v1.0 instead of v1.2. Also thanks for the fast contact and support via email."
3019,515,"Hello!
I have wiz127sr. Trying to configure the device, I launched Configuration tool 1.0.0.0 after I pressed search button the mac adress of the device appeared. Then I found the newer firmware version and tried to load it. I was waiting for 5 mins but nothing happened. Afterward I restart the conf tool and the deveice, but I cant see it any more, even factory reset didnt help. Hi,

First, Please use with the latest version firmware(1.0) and configuration tools(1.0.0.1).

If you have done but it does not work, post again please. [quote]First, Please use with the latest version firmware(1.0) and configuration tools(1.0.0.1).[/quote] Done! Unfortunately without success.
During the firmware *loading the Config tool crashed (stoped working). Afterward I wasn't able to load any firmware version. So I did factory reset. Is it possible the device, to not be able to return initial firmware version? Another thing I should let you know is that, when I plug the RJ45 the green led is constantly on and the yellow one blink e.g. 1sec_on 0.2sec_off. The most of the time Y_led is on with short off pulses. May be that would help you to diagnose my issue.. Factory reset will reset all configuration values. Not firmware.
After reset the module, try to find module via configuration tool.
If you do not success to find, let me know your e-mail address.
I will send boot binary to your e-mail for recover wiz127sr. Thank you! My Email is: [prorandy88@gmail.com](mailto:prorandy88@gmail.com). A couple of questions occurred. How am I suppose to program the binary rs232/Ethernet ? Do I need special bootloader, or there is embedded one inside Conf. tool? Please give me some details or link to refer to! I am writing the guide document now.
But It takes some time.
I will send it until 12 Feb.","Q) A couple of questions occurred. How am I suppose to program the binary rs232/Ethernet ? Do I need special bootloader, or there is embedded one inside Conf. tool?
A) I am writing the guide document now. But It takes some time. I will send it until 12 Feb."
3020,5151,"    [W3150A+] [W5100] [W5200] [W5300] [W5500] [W5100S]
?Â¬Ã¬ÂÂ© Ã¬Â¤ÂÃ¬ÂÂ¸ ?ÂÃ­ÂÂ Ã«ÂªÂÃ¬ÂÂ ?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ«ÂªÂ©??Ã«ÂªÂÃªÂ¸Â°?ÂÃ¬ÂÂÃ«Â©?**??Ã«Â¹Â Ã«Â¥Â¸ ?ÂÃ«ÂÂµ**??Ã«Â°ÂÃ¬ÂÂ¼?????ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. 
Ã«Â³?Template????Â Â ??Ã«Â¬Â¸Ã¬ÂÂ ?Â´Ã¬ÂÂ©???Â¨ÃªÂ²Â¨ Ã¬Â£Â¼Ã¬ÂÂ¸??  :slight_smile:
----------
?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸?? 5200Ã«Â§??Â°Ã«ÂÂ¤ÃªÂ°? 5100?????ÂÃ¬Â»Â¤Ã«Â§Â¨Ã«ÂÂ ?ÂÃ¬ÂÂ ?Â¤ÃªÂ³Â  ?Â´Ã¬ÂÂ ?Â´Ã«Â²Â??Ã¬Â¹Â©Ã¬ÂÂ Ã«Â°ÂÃªÂ¿Â¨?ÂµÃ«ÂÂ?? 
?ÂÃ«Â¶Â??CPU ??Ã«Â°ÂÃªÂ¾Â¸Ã«Â©Â´Ã¬ÂÂ ?Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«ÂÂ¬Ã«Â¦Â¬ÃªÂ¹ÂÃ¬Â§? (STM LL driver )  Ã«Â³?ÃªÂ²Â½Ã­ÂÂÃªÂ²ÂÃ«ÂÂ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? Ã«Â§ÂÃ¬?ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. 
ÃªÂ·Â¸Ã¬Â Â??5200?ÂÃ¬ÂÂ???ÂÃªÂ³Âµ?ÂÃ«ÂÂ Ã«Â°Â©Ã«Â²Â?Â¼Ã«Â¡Â SPI Ã«Â°Â©Ã¬ÂÂ??WR, RD ÃªÂ°? Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ°, ?Â´Ã«Â²Â??5100?Â¼Ã«Â¡Â READ ?ÂÃ«ÂÂÃ«Â¶?Ã«Â¶ÂÃ¬ÂÂ?ÂÃ«ÂÂ Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ«ÂÂ?Â°Ã¬ÂÂ, 
?ÂÃªÂ³Âµ???Â¨Ã¬ÂÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬, WR???Â±ÃªÂ³Âµ?ÂÃ¬??ÂµÃ«ÂÂ?? ( ?Â´Ã«ÂÂ»ÃªÂ²??ÂÃ«ÂÂÃ«Â©? IP ?Â¤Ã¬Â Â??ping??ÃªÂ±Â¸Ã¬ÂÂ´Ã«Â³Â´Ã«Â©Â´ chip?????Â¥Ã¬ÂÂ´ ?ÂÃ¬ÂÂ?Â¼Ã«ÂÂ ?ÂÃ«ÂÂµ???ÂÃªÂ²Â Ã¬Â§???
ÃªÂ·Â¸Ã«ÂÂ°??inchip_readÃ«Â¥??Â´Ã«Â³Â´Ã«Â©??ÂÃ«Â°Â?Â´Ã­ÂÂ¸ ÃªÂ±Â¸Ã«ÂÂ¬ ???ÂÃ¬ÂÂ?ÂÃ¬ÂÂ´ ÃªÂ±Â¸Ã«Â Â¤???ÂÃ«ÂªÂ»?Â½Ã¬ÂÂ´?ÂµÃ«ÂÂ??  
in chip ?ÂÃ¬ÂÂ Ã«Â§ÂÃ¬?Ã«Â§?Ã«Â°ÂÃ¬ÂÂ´?Â¸Ãª? ?ÂÃ«ÂÂÃªÂ³??ÂÃ«?Ã«Â°ÂÃ¬ÂÂ´??Ã«Â³Â´Ã«ÂÂ´??Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ???Â½Ã¬ÂÂ¼Ã«Â©??ÂÃ«Â²Â?? 0, ?ÂÃ«Â²Â?? 2Ã«Â¡??Â½Ã¬ÂÂ´?Â¤ÃªÂ³Â ?? 
ÃªÂ·Â¸Ã«ÂÂ??inchip read ?ÂÃ¬ÂÂ ?Â¼Ã«????ÂÃ«Â²Â??Ã«Â³Â´Ã«ÂÂ´?? ?ÂÃ«Â²ÂÃ¬Â§??Â½Ã«ÂÂ Ã«Â°ÂÃ¬ÂÂ´?Â¸Ã«Â¡Â ?ÂÃ«?Ã«Â¡ÂÃ«ÂÂ ÃªÂ²Â°ÃªÂ³Â¼Ã«Â¥??Â½Ã¬ÂÂ´?Â¤ÃªÂ¸Â°???ÂÃ«ÂÂ??( Ã¬Â½ÂÃ«Â©Â?Â¸Ã­ÂÂ´?ÂÃ¬? Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?Â´Ã¬ÂÂ ) Ã«Â§ÂÃ¬ÂÂ ?ÂÃ­ÂÂÃ«Â§ÂÃªÂ³Â  ?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ¤?Â¸Ã«? ?Â´Ã«Â³Â´???ÂÃ«ÂÂ?Â¤Ã¬ÂÂ. ÃªÂ·Â¸Ã¬Â Â??5200?ÂÃ¬ÂÂ ?Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ¤Ã«Â¥??Â´Ã¬ÂÂ©?Â´Ã¬ÂÂ ?ÂÃ¬?  Ã«Â°ÂÃ«Â¡Â ?Â Ã¬Â¤Â?ÂÃ¬ÂÂÃªÂ±Â°Ã«ÂÂ ?? 0x63???Â¤Ã¬ÂÂ´?ÂµÃ«ÂÂ?? ?Â°Ã¬ÂÂ´?Â°Ã¬ÂÂ?Â¸Ã¬ÂÂ ?ÂÃ«ÂÂÃªÂ°ÂÃ¬ÂÂ´?ÂÃ«ÂÂ°??.
Ã«Â³ÂÃ¬Â§Â ?Â¤Ã­ÂÂ´Ã«Â´ÂÃ«ÂÂ ?Â´Ã­ÂÂ?ÂÃ¬ÂÂ´ ?Â´ÃªÂ²Â°?ÂÃ¬? ?ÂÃ«ÂÂ¤??. 

 ?Â¤Ã¬Â½Â?ÂÃ«? ?Â´Ã¬ÂÂ©?Â´Ã¬ÂÂ Ã¬Â°ÂÃ¬ÂÂ´Ã«Â³Â´Ã«ÂÂ, Ã«Â°ÂÃ¬ÂÂ´??Ã«Â°ÂÃ¬ÂÂ´??Ã«Â³Â´Ã«ÂÂ¼??MISO?Â Ã­ÂÂ¸ÃªÂ°? ÃªÂ°????Â¤Ã¬ÂÂÃ«Â°ÂÃ¬ÂÂ´??ÃªÂ¹ÂÃ¬? ?Â¨Ã¬ÂÂ´Ã¬Â§?Ã¬Â§? ?ÂÃªÂ³Â  ?Â Ã¬??ÂÃªÂ²Â???ÂÃ¬ÂÂ¸?????ÂÃ¬ÂÂ?ÂµÃ«ÂÂ??  ?ÂÃ«Â¨Â¸Ã¬Â§? ???Â´Ã«Â°Â?? Ã«ÂªÂ¨Ã«ÂÂ Ã¬Â²Â´Ã­ÂÂ¬?Â´Ã¬ÂÂ ?ÂÃ¬Â Â ???Â´Ã«Â°Â ?ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. ?Â¸ÃªÂµÂ­?Â¬Ã«ÂÂ¼?????Â´Ã«Â°Â??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ¬ÂÂ´ ?Â½Ã­ÂÂÃ¬Â§? ?ÂÃ¬ÂÂ?Â¤Ã«ÂÂ ÃªÂ¸??ÂÃ«Â³Â´ÃªÂ³?Ã«ÂªÂ¨Ã«ÂÂ ?ÂÃ¬ÂÂ¬Ã«Â´Â¤Ã¬ÂÂµ?ÂÃ«ÂÂ¤.. ?ÂÃ«ÂÂ?Â¤Ã¬ÂÂ
addr?Â¼Ã¬ÂÂ¸?????Â¤Ã¬ÂÂ´??ÃªÂ±Â¸Ã¬? ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ° ?Â¹Ã¬ÂÂ ?Â´Ã«ÂÂ° ?Â´Ã¬ÂÂ ?ÂÃ«Â¬Â¸?Â¼ÃªÂ¹Â?? Ã«Â¹ÂÃ¬ÂÂ·???ÂÃ¬ÂÂ??Ã«Â³Â´Ã¬ÂÂ  Ã«Â¶ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂÃ¬Â§??? 
?ÂÃ¬? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? 

    #define IINCHIP_SpiSendData     SPI2_SendByte

    uint8_t SPI2_SendByte(uint8_t byte)
    {
        TimeOutSPI2 = SPI_TIMEOUT_MAX;
        while( !LL_SPI_IsActiveFlag_TXE(SPI2) ){
            if (TimeOutSPI2-- == 0) return IOE_TIEMOUT;
        }    
        *((__IO uint8_t *)&SPI2->DR) = byte;
        //LL_SPI_TransmitData8(SPI2, byte);
        
        TimeOutSPI2 = SPI_TIMEOUT_MAX;
        while( !LL_SPI_IsActiveFlag_RXNE(SPI2) ){
            if (TimeOutSPI2-- == 0) return IOE_TIEMOUT;
        }
        return SPI2->DR;//LL_SPI_ReceiveData8(SPI2);
    }

    uint8 IINCHIP_WRITE(uint16 addr,uint8 data)
    {
        IINCHIP_ISR_DISABLE();                      // Interrupt Service Routine Disable

    	IINCHIP_CS_L;                            // CS=0, SPI start

    	IINCHIP_SpiSendData(0xF0);  
    	IINCHIP_SpiSendData((uint8)((addr & 0xFF00) >> 8));  // Address byte 1
    	IINCHIP_SpiSendData((uint8)(addr & 0x00FF));         // Address byte 2

    	IINCHIP_SpiSendData(data);                      // Data write (write 1byte data)
        
    	IINCHIP_CS_L;                               // CS=0, SPI start
    	IINCHIP_CS_H;                               
        
        IINCHIP_ISR_ENABLE();                           // Interrupt Service Routine Enable
            
    	return 1;
    }

    uint8 IINCHIP_READ(uint16 addr)
    {
    	uint8 data;
        
    	IINCHIP_ISR_DISABLE();                       // Interrupt Service Routine Disable
            
    	IINCHIP_CS_L;                               // CS=0, SPI start
        
        IINCHIP_SpiSendData(0x0F);  
    	
        IINCHIP_SpiSendData((addr & 0xFF00) >> 8);   // Address byte 1
    	IINCHIP_SpiSendData(addr & 0x00FF);          // Address byte 2
    	IINCHIP_SpiSendData(0x00);
        data = IINCHIP_SpiSendData(0x00);
        IINCHIP_CS_L;                            // CS=0, SPI start
        
        IINCHIP_CS_H;                               // CS=1,  SPI end
        
    	/*IINCHIP_CS_L;                               // CS=0, SPI start    
    	IINCHIP_ISR_DISABLE();                       // Interrupt Service Routine Disable
            IINCHIP_SpiSendData(0x0F);  
    	
            IINCHIP_SpiSendData((addr & 0xFF00) >> 8);   // Address byte 1
    	IINCHIP_SpiSendData(addr & 0x00FF);          // Address byte 2
    	IINCHIP_SpiSendData(0x00);
    	data = IINCHIP_SpiSendData(0x00);            // Data read (read 1byte data)
        
    	IINCHIP_CS_L;                               // CS=0, SPI start
            IINCHIP_CS_H;                               // CS=1,  SPI end
        */
        IINCHIP_ISR_ENABLE();                        // Interrupt Service Routine Enable
    	return data;
    } hello

Are you talking about this part twice?

[quote = ""sue_lee, post: 1, topic: 5151""]
IIINCHIP_SPISENDDATA (0x00);
 Data = IIINCHIP_SPISENDDATA (0x00);
[/Quote]

What is the value of 0x63?
You said that ping would be above, but I don't understand the part that you can't stand below.
Please explain more about the situation. [quote=""Sue_Lee, post:1, topic:5151""]
IINCHIP_SpiSendData(0x00);
[/quote]
IINCHIP_READ ?Â¨Ã¬ÂÂ?ÂÃ¬ÂÂ..

      IINCHIP_SpiSendData(0x0F);  
      IINCHIP_SpiSendData((addr & 0xFF00) >> 8);   // Address byte 1
      IINCHIP_SpiSendData(addr & 0x00FF);          // Address byte 2
	//IINCHIP_SpiSendData(0x00);
    data = IINCHIP_SpiSendData(0x00);

?Â°Ã¬ÂÂ´?Â°Ã«? ?ÂÃ«Â²Â Ã«Â³Â´Ã«ÂÂ´ÃªÂ³??Â½Ã¬ÂÂ¼?Â¨Ã«ÂÂ¤??
Ã«Â³?ÃªÂ²????ÂÃ¬ÂÂ¤???Â´Ã«Â³Â´?ÂÃªÂ¸Â¸ Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

thanks, 
irina","Q) Are you talking about this part twice?
What is the value of 0x63?
You said that ping would be above, but I don't understand the part that you can't stand below.
Please explain more about the situation. 
A) The value of 0x63 represents a specific memory address in the context of the SPI communication protocol. The mentioned code segment is correct and it reads data from the specified memory address using the SPI communication. The confusion about the ping and standing below parts may stem from a misunderstanding of the code context. If you need further clarification, please feel free to ask."
3021,5153,"I am using STM32F030  with W5100 with IAR compiler and LL driver.

SPI mode IINCHIP_WRITE does work well. 
After setting below, I can SEE  board IP on network.
    setSHAR(myMAC);     //Source hardware address Register        
    setSUBR(SUBNET);         
    setGAR(myGateWay);  //gateway address register
    setSIPR(myIP);      //source IP addresss Register


However, getSHAR, getGAR etc..  I cannot read exact data that I set. IINCHIP_READ function work every other time. 
So I read SPI  Inchip read twice in one function , that I can get proper answer. 

#define IINCHIP_SpiSendData     SPI2_SendByte
uint8_t SPI2_SendByte(uint8_t byte)
{
    TimeOutSPI2 = SPI_TIMEOUT_MAX;
    while( !LL_SPI_IsActiveFlag_TXE(SPI2) ){
        if (TimeOutSPI2-- == 0) return IOE_TIEMOUT;
    }    
    *((__IO uint8_t *)&SPI2->DR) = byte;
    //LL_SPI_TransmitData8(SPI2, byte);
    
    TimeOutSPI2 = SPI_TIMEOUT_MAX;
    while( !LL_SPI_IsActiveFlag_RXNE(SPI2) ){
        if (TimeOutSPI2-- == 0) return IOE_TIEMOUT;
    }

    return SPI2->DR;//LL_SPI_ReceiveData8(SPI2);
}

uint8 IINCHIP_WRITE(uint16 addr,uint8 data)
{
    IINCHIP_ISR_DISABLE();                      // Interrupt Service Routine Disable

	IINCHIP_CS_L;                            // CS=0, SPI start

	IINCHIP_SpiSendData(0xF0);  
	IINCHIP_SpiSendData((uint8)((addr & 0xFF00) >> 8));  // Address byte 1
	IINCHIP_SpiSendData((uint8)(addr & 0x00FF));         // Address byte 2

	IINCHIP_SpiSendData(data);                      // Data write (write 1byte data)
    
	IINCHIP_CS_L;                               // CS=0, SPI start
	IINCHIP_CS_H;                               
    
    IINCHIP_ISR_ENABLE();                           // Interrupt Service Routine Enable
        
	return 1;
}

uint8 IINCHIP_READ(uint16 addr)
{
	uint8 data;
    
	IINCHIP_ISR_DISABLE();                       // Interrupt Service Routine Disable
        
	IINCHIP_CS_L;                               // CS=0, SPI start
    
    IINCHIP_SpiSendData(0x0F);  
	
    IINCHIP_SpiSendData((addr & 0xFF00) >> 8);   // Address byte 1
	IINCHIP_SpiSendData(addr & 0x00FF);          // Address byte 2
	IINCHIP_SpiSendData(0x00);
    data = IINCHIP_SpiSendData(0x00);
    IINCHIP_CS_L;                            // CS=0, SPI start
    
    IINCHIP_CS_H;                               // CS=1,  SPI end
    
	/*IINCHIP_CS_L;                               // CS=0, SPI start    
	IINCHIP_ISR_DISABLE();                       // Interrupt Service Routine Disable
    IINCHIP_SpiSendData(0x0F);  
	
    IINCHIP_SpiSendData((addr & 0xFF00) >> 8);   // Address byte 1
	IINCHIP_SpiSendData(addr & 0x00FF);          // Address byte 2
	IINCHIP_SpiSendData(0x00);
	data = IINCHIP_SpiSendData(0x00);            // Data read (read 1byte data)
    
	IINCHIP_CS_L;                               // CS=0, SPI start
    IINCHIP_CS_H;                               // CS=1,  SPI end
    */
    IINCHIP_ISR_ENABLE();                        // Interrupt Service Routine Enable
	return data;
}

It seems work fine when I set and read setting(IP, mac etc..) info. 
But when board ping  to host,  It is not working . answer from ping status  (sn = getSn_SR(s)) is  0x63 .( value which is nowhere in dataseets )  I guess It is because I do not use Inchip read properly.  
I have check oscilloscope ,  MISO signal seems weirdly  moving because sometimes does stay H when 1byte SCK done.  except that, every timing  is  longer than datasheets says  even reset timing.  I do not use addr, data line, so it is opened. is that  could be a problem? 
Has anyone see similar problem? The problem is SPI communication. Pictures (timing) of all signals please for some read/write command. Thank you Eugeny for kind answer.. 
Problem solved.

I was not getting  LL_SPI_IsActiveFlag_RXNE while SPI send data..

I did not know  STM32F030   has option..  of Rx setting

 LL_SPI_SetRxFIFOThreshold(SPI2,LL_SPI_RX_FIFO_TH_QUARTER);

It took 2 weeks to know...   T_T

Thank you..","Q) Has anyone seen a similar problem? 
A) The problem is related to SPI communication. 

Q) Is that causing a problem? 
A) The issue might be due to improper usage of Inchip read function and unusual behavior of the MISO signal. 

Q) Can you provide pictures (timing) of all signals for some read/write commands? 
A) It seems like you need assistance in debugging the SPI communication. 

Q) What was the solution to the problem? 
A) The solution was setting the Rx FIFO threshold using LL_SPI_SetRxFIFOThreshold for STM32F030. 

Q) How long did it take for you to discover the solution? 
A) It took 2 weeks to discover the solution. 

A) Thank you."
3022,516,"We are using the Wizfi210 SPI module.
I'm trying to communicate with TCP through ATMEGA8 and SPI communication.
TCP Server-> TCP Client is well -communication, but it is not the opposite.
TCP Server is atmega8 + Wizfi210 and TCP Client is an Androit phone and notebook TCP Client program.

On the firmware, you can access the AP with atCommand and open the TCP server to enter the data mode.
According to the provided test code, Wizfi210_read_byte () when the GPIO19 pin is high;With a function
It is supposed to receive data, but even if you continue to send data from TCP Client, GPIO19 does not become high.

In addition, if you receive the data regardless of the GPIO19 pin, only 0xF5 data continues to output.
No matter what data from TCP Client, there is no change.

The provided test code is as follows:

============================================================
                     while (1)
                     {
                                int ch;
                                if (usart_getflagstatus (usart2, usart_flag_rxne)! = Reset)
                                 {
                                         ch = usart_ReceiveData (usart2);
                                          Sprintf (MSGBUF, ""%C"", CH);
                                          Wizfi210_write_buf (msgbuf);
                                }

                                if (gpio_readInputDatabit (gpiob, PB10) == 1)
                                {
                                          Key = wizfi210_read_byte ();
                                          if ((key! = spi_idle_char) & (key! = spi_invalid_char_zero) & & (key! = spi_invalid_char_all_one))
                                           {
                                                     Putchar2 (key);
                                          }
                                }
                     }

=========================================================

When using AtCommand, using both the wizfi210_write_buf () function and the wizfi210_read_byte () function
Since it was progressed without problems, the function itself seems to have no problem.
What should I check in the above situ?
I wonder if there is something to check in the firmware.
Please contact us as soon as possible.



For reference, the Atcommand used is as follows:
 I am using it after testing atCommand on Wizfi210-EVB
=======================================
At+wm = 0
At+wd
At+ndhcp = 1
At+wwpa = xxxxxxxxxxxx
At+WA = Genes007
At+nstat =?
At+NSTCP = 5000
ATA2
======================================= hello

It is believed that there is no problem with SPI communication regarding the following, but I can tell you two check points.

1. H/W confirms that there is a problem in the line where the GPIO19 of Wizfi210 and the GPIO of the MCU are connected.
2. S/W, check the GPIO_READPUTDATABIT () function
   For the provided SPI Master Example, the code is written based on STM32.Because gpio_ReadInputDatabit ()
     For functions, read the GPIO value as a method for STM32 MCU.
   But for the ATMEGA8 you are using now, I know that the GPIO control method is different from the STM32.Therefore
     Please check for. Thank you for your answer.

1. H/w is hard to check right now.The confirmation of this part is
   When you send and receive atCommand, let's see that the state of the pins of GPIO19 changes.
   When receiving the response of AtCommand, if the state of the pins in GPIO 10 is in high state, the hardware connection
   I will judge that there is nothing wrong.

2. I don't know exactly what the contents of the S/W STM32 -based GPIO_READPUTDATABIT () function
   I understand that GPIO19 is imported.Similarly in Atmega8, connected to GPIO19
   We have set the General I/O pin as input and are receiving whether the value of the pin is low or high.
     

In the Data Mode, in the sample code, the condition statement is (gpio_ReadInputDatabit (GPIOB, PB10) == 1)
Can I get TCP reception data when I read it?The current test situation is that there is no change in the state of GPIO19.
IF (gpio_readInputDatabit (gpiOb, PB10) == 1) is tested and tested.


There is no problem with G {IO19 pin connection as hardware, and IF (gpio_readinputdatabit (gpiob, pb10) == 1)
If you are testing TCP in data mode, what is the point to check more? hello

This is the answer to the following.

1. In the Data Mode, in the sample code, the condition statement is (GPIO_READINPUTDATABIT (GPIOB, PB10) == 1)
Can I get TCP reception data when I read it?
[color =#ff0000] -If you receive SPI data from the MCU without checking the status of the GPIO19 of Wizfi210, you can continue to receive 0xF5 (IDLE), not the desired data.
 The GPIO19 of the Wizfi210 is a sign that the Wizfi210 has data for the SPI master, and when the GPIO19 is high, you must receive the SPI data. [/Color]

2. Incidentally, the desired data may be received, but in principle, when there is data that the Wizfi210 sends, GPIO19 pins must be turned to high.That's why it's a good idea to solve the problem that the value of the pins of GPIO19 doesn't change. I have a question about the test.

AtCommand blows up to the ATA2 message and in the data mode state
TCP transmission (wizfi-> mobile) is good, but TCP receives (mobile-> wizfi)
It's a situation, but after the ATA2 command, I put ""+++""
TCP communication tests are not transmitted and TCP is not transmitted and TCP receives well.

In summary, in the data mode, the TCP server is opened and the TCP server is opened.
It is a situation where TCP is transmitted and TCP is not received
In the command mode, TCP is not transmitted and received.

When receiving TCP in command mode, GPIO19 Pins also turns normally in high state.

I confirmed that the TCP transmission and reception was once once, but depending on the mode, the transmission and reception are one side.
I don't understand.

I'll tell you about the situation, or the information I'm going to give more to solve the problem
Please answer what will happen. The answer was late.sorry.

Leave the at Command set used in the forum when you have a problem will help you analyze it.
At Command Set, please tell us both the CASE and the Command Mode used as the data mode.

thank you Data Mode Ã«Â¡??ÂÃ¬ÂÂ¤?????Â¬Ã¬ÂÂ©??ATCommand Set ?ÂÃ«ÂÂ?? 

AT+WD
AT+WM=0
AT+NDHCP=1
AT+WWPA=xxxxxxxxxxx
AT+WA=genes007
AT+NSTAT=? 
AT+NSTCP=5000 
ATA2

====================================================
Command Mode Ã«Â¡??ÂÃ¬ÂÂ¤?????Â¬Ã¬ÂÂ©??ATCommand Set ?ÂÃ«ÂÂ?? 


AT+WD
AT+WM=0
AT+NDHCP=1
AT+WWPA=xxxxxxxxxxx
AT+WA=genes007
AT+NSTAT=? 
AT+NSTCP=5000 
ATA2
+++

========================================================

Data Mode ?ÂÃ¬ÂÂ¤?Â¸Ã¬ÂÂ ?Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ Set ?ÂÃ¬ÂÂ +++ Ã«Â§??ÂÃ­ÂÂ´??Command Mode Ã«Â¡??ÂÃ¬ÂÂ¨ ?ÂÃ¬ÂÂ
?ÂÃ¬ÂÂ¤??Ã¬Â§ÂÃ­ÂÂ?ÂÃ¬??ÂµÃ«ÂÂ?? Please answer the inquiry as soon as possible. hello

When set to Data Mode, please use the command below.

At+wd
At+wm = 0
At+ndhcp = 1
At+wwpa = 12345678
At+Wauto = 0, Dir-636L
At+nauto = 1,1,, 5000
ATA

For reference, you can enter a +++ character to enter the Command Mode.

thank you","Q) What should I check in the above situ?
Q) In the Data Mode, in the sample code, can I get TCP reception data when I read it? 
Q) If I receive TCP data from the MCU without checking the status of the GPIO19 of Wizfi210, what happens?
Q) I have a question about the test. When receiving TCP in command mode, what happens to the GPIO19 pins?

A) - If you receive SPI data from the MCU without checking the status of the GPIO19 of Wizfi210, you can continue to receive 0xF5 (IDLE), not the desired data. The GPIO19 of the Wizfi210 is a sign that the Wizfi210 has data for the SPI master, and when the GPIO19 is high, you must receive the SPI data.
- The GPIO19 pins of Wizfi210 must be turned to high when there is data the Wizfi210 sends. It's important to solve the problem that the value of the GPIO19 pins doesn't change during TCP reception in the data mode. 

A) - AtCommand blows up to the ATA2 message and in the data mode state, TCP transmission (Wizfi-> mobile) is good, but the TCP reception (mobile-> Wizfi) is a situation. After the ATA2 command, putting ""+++"" does not allow TCP communication tests to be transmitted and received.

A) I'll tell you about the situation, or the information I'm going to give more to solve the problem. Please answer what will happen. 
- When set to Data Mode, please use the command below: ""At+wd, At+wm = 0, At+ndhcp = 1, At+wwpa = 12345678, At+Wauto = 0, Dir-636L, At+nauto = 1,1,, 5000, ATA."" For reference, you can enter a ""+++"" character to enter the Command Mode."
3023,5163,"I want to use the SPI feature of the W5100.
With the existing driver (W5100_DRIVER_V190) Iolibrary_driver-Master linked from the W5100s
https://github.com/wiznet/iolibrary_driver) What should I use?
Previously, I used an existing driver.
I also want to know how much the price difference is. hello
We recommend using iOLIBRARY_DRIVER.
Are you talking about the difference between the W5100 and the W5100s?
Below are the product ball pages.
http://shop.wiznet.co.kr/front/contents/product/view.asp?cateId=47&pid=1308
http://shop.wiznet.co.kr/front/contents/product/view.asp?cateId=47&pid=1005","Q) I want to use the SPI feature of the W5100. With the existing driver (W5100_DRIVER_V190) Iolibrary_driver-Master linked from the W5100s (https://github.com/wiznet/iolibrary_driver) What should I use? Previously, I used an existing driver. I also want to know how much the price difference is.
A) We recommend using the iOLIBRARY_DRIVER. Are you talking about the difference between the W5100 and the W5100s? Below are the product ball pages. http://shop.wiznet.co.kr/front/contents/product/view.asp?cateId=47&pid=1308 http://shop.wiznet.co.kr/front/contents/product/view.asp?cateId=47&pid=1005"
3024,5165,"WIZWIKI-W7500P (hereinafter referred to as W7500P)
Compiler: Mbed

I want to operate the IC by changing the IC (WM8731) settings to I2C.
It was tested using ""I2C.WRITE (** Slave Address **, ** Register **, ** Data **) in Mbed's library, but IC does not work.
(I2C pin SDA: D14, SCL: D15)

So, as the same settings to be put into the IC, the as a result of uploading to IC with Arduino, it works normal.
I searched for the I2C port (D14, D15), but there is an article that the operation is not done properly.

1. Is I2C working normally in the W7500P?
2. Can I use I2C using the library of Mbed?
3. If I2C does not work with Mbed, please contact the code and how to use it.
    ** SLAVE address ** I need a code that puts ** data ** in ** register **.
4. The most obvious thing is to provide an example of communicating with other ICs or uploading settings.

Please answer after review.
thank you Thank you for answer.

Isn't it possible to use I2C with the Mbed library that I can use the I2C for Mbed?
In the recommended site, we used mi2c.write and it is judged to be the same library as the I2C.WRITE.

Does it mean that SCLK is generated as a software that can be operated on software without supporting hardware?
If the SCLK is operated with software, how many KHz can the SCLK clock of W7500P can be generated? (SCLK maximum clock speed)
And I wonder if the software I2C alone can communicate with reliable data.
Do you have a history of this test?
It is necessary to answer the data communication using I2C.

In the end, it will be written in C code (GCC compilation), not Mbed.
Is there an I2C library for C code provided by Wiznet like Mbed?
If there is a library, can I also provide data communication examples using I2C?

And if you know how much restrictions on the length of the code, Mbed will tell you together.
If you do not have a library for C or have a limit to use, please contact us if you should use Mbed Compilation.

Please answer after review.
take care. hello

As you said, SCLK is generated by SW.
The GPIO is connected to the SCL pin and the SDA pin to generate high and low according to the specified I2C rules.
The maximum CLK that can be made by Toggle with GPIO is about 2MHz and not reliable testing.

Wizwiki-W7500P Examples must be implemented.
Please refer to the code for the WIZ750SR, a Serial to Ethernet board that contains the W7500P.
https://github.com/wiznet/wiz750sr/blob/master/projects/s2e_app/src/platformHandler Thank you for answer.

I would like to ask again about the parts you don't understand or know.

1. It seems to use I2C as a code of the attached site. Can you provide an I2C communication method or example using the above code?
I think it would have been distributed after I made a code on Wiznet and then I2C.
Then I would like to provide you if you have the educational code you have as a reference in the code or Wiznet.

In my case, I would like to put data into the register of I2C's slave address (0x1a).

2. I told you to talk about GPIO up to 2MHz, but can you also provide code for it?
I want to continue to generate 100kHz and 400kHz clocks.

3. During the answer
""Wizwiki-w7500p example should be implemented, and you should refer to the code for the Wiz750sR, a serial to ethernet board containing W7500P.""
I said, I don't know what example is to implement.
If you look at the code for the wiz750sr, you can use the code of 'I2C Start/Stop/i2ACK' as it is, but I don't know what you have to implement an example for Wizwiki-W7500p.

Please answer after review.
take care. hello

1. I2C example code is not disclosed.
If you tell me the e -mail, I will send an example using OLED written as I personally have the KEIL project.
If you write the data, you can write through the i2C_init () function within the W7500X_I2C.C code and write it through the i2C_WRITE () function.

2. In the case of GPIO, you can not give a certain clock.You need to keep the speed of TOGLE with the Delay function.

3. Because it is a project for the WIZ750SR board, the environment is different, so please refer to the I2C part.If you send the code by email, you can use it as it is. The email address was delivered to a personal message.
Please see and deliver the code to that e -mail.

take care. hello
Friday morning
I gave it an e -mail (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) hello

It's weird that you sent it again, but you didn't receive it.
I sent it again by e -mail. The next mail arrived well.
If you have any inquiries after use, I will leave again. hello,

I am also trying to use the SSD1306 OLED module as an I2C with the W7500P, but I know I2C is not good.

Can I get an example file? Please email by beky@wiznet.io I sent an e -mail. I sent an e -mail last week, but please confirm it. Wait and contact you again. Yes, I haven't received it yet.

Please recurrence.

December 4, 2018 (Tue) 9:03 AM, Becky Jeong <WizNet@discoursemail.com> hello

I checked that Google Mail seems to block the file as a security problem.
Please give me another mail address Then please go to ma810@naver.com.

December 4, 2018 (Tue) 9:03 AM, Becky Jeong <WizNet@discoursemail.com> I gave it an e -mail
Please confirm thank you.^^","Q) Is I2C working normally in the W7500P?
Q) Can I use I2C using the library of Mbed?
Q) If I2C does not work with Mbed, please contact the code and how to use it. ** SLAVE address ** I need a code that puts **data** in **register**.
Q) The most obvious thing is to provide an example of communicating with other ICs or uploading settings.
Q) Isn't it possible to use I2C with the Mbed library that I can use the I2C for Mbed?
Q) Does it mean that SCLK is generated as a software that can be operated on software without supporting hardware?
Q) If the SCLK is operated with software, how many KHz can the SCLK clock of W7500P can be generated? (SCLK maximum clock speed)
Q) And I wonder if the software I2C alone can communicate with reliable data. Do you have a history of this test?
Q) Is there an I2C library for C code provided by Wiznet like Mbed?
Q) If there is a library, can I also provide data communication examples using I2C?
Q) If you do not have a library for C or have a limit to use, please contact us if you should use Mbed Compilation.
Q) It seems to use I2C as a code of the attached site. Can you provide an I2C communication method or example using the above code?
Q) In my case, I would like to put data into the register of I2C's slave address (0x1a).
Q) I told you to talk about GPIO up to 2MHz, but can you also provide code for it?
Q) During the answer ""Wizwiki-w7500p example should be implemented, and you should refer to the code for the Wiz750sR, a serial to ethernet board containing W7500P."" I said, I don't know what example is to implement.
Q) Can I get an example file? Please email by beky@wiznet.io
A) As you said, SCLK is generated by SW. The GPIO is connected to the SCL pin and the SDA pin to generate high and low according to the specified I2C rules. The maximum CLK that can be made by Toggle with GPIO is about 2MHz and not reliable testing.
A) Wizwiki-W7500P Examples must be implemented. Please refer to the code for the WIZ750SR, a Serial to Ethernet board that contains the W7500P. (https://github.com/wiznet/wiz750sr/blob/master/projects/s2e_app/src/platformHandler)
A) 1. I2C example code is not disclosed. If you tell me the e-mail, I will send an example using OLED written as I personally have the KEIL project. If you write the data, you can write through the i2C_init () function within the W7500X_I2C.C code and write it through the i2C_WRITE () function.
A) 2. In the case of GPIO, you can not give a certain clock. You need to keep the speed of TOGLE with the Delay function.
A) 3. Because it is a project for the WIZ750SR board, the environment is different, so please refer to the I2C part. If you send the code by email, you can use it as it is. The email address was delivered to a personal message. Please see and deliver the code to that e-mail.
A) I checked that Google Mail seems to block the file as a security problem. Please give me another mail address. Then please go to ma810@naver.com."
3025,5166,"Hi, I am the first in W5100S.
I can not find any information of heat pad connection in QFN48 package.
The heat pad can be connected to GND? Hi infoic

Yes,  You can be connect pin 49 to GND.

Thank you.

Scott","Q) I can not find any information of heat pad connection in QFN48 package. The heat pad can be connected to GND? 
A) Yes, You can be connect pin 49 to GND."
3026,5173,"Hi

I have built a custom wiznet and MCU board for a Light controller application.   Everything is working great so far and the multicast function is doing what it should.   

Background info: I have a controller that is capable of receiving multiple universes  (sACN e1.31) and per  sACN rules it uses a unique Multicast address based on the universe.  The example would be universe 1 is 239.255.0.1 and universe 2 is 239.255.0.2 and so on.   The question  I have is would it be possible to initiate the wiznet to subscribe to multiple multicast group addresses?   

One workaround to at least receiving multiple multicast groups is to run in MACRAW mode and let the code filter out what traffic it wants to see based off of receive IP and packet contents.   But at some point traffic may get too intense and overload the MCU.  Therfore I entertain the thought of utilizing the multicast subscribe feature if at all possible.   Perhaps I could craft my own multicast join packet and not use the built in w5500 methods?   

Any direction or suggestion on options would be great.  

Thanks

crees Hi Crees, please below the code for the join. I have prefixed the socket API's with _ in order to be able to test the code on Raspberry Pi Raspbian SPI interface (not conflicting with the Linux socket API's). 

I have not tried to call it for several universes. But basically, this function just generates the join message. What if we call it for each universe to receive ? Does that simply work?

Arjan
[http://www.orangepi-dmx.org/allwinner-h3](http://www.orangepi-dmx.org/allwinner-h3)


    `#define IPSTR ""%d.%d.%d.%d""
    #define MACSTR ""%.2x:%.2x:%.2x:%.2x:%.2x:%.2x""

    int8_t w5x00_join_group(uint8_t sn, uint32_t ip, uint16_t port) {
    	DEBUG_ENTRY
    	DEBUG_PUTS(_WIZCHIP_ID_);

    	uint8_t multicast_ip[4];
    	uint8_t multicast_mac[6];

    	multicast_ip[0] = ip & 0xFF;
    	multicast_ip[1] = (ip >> 8) & 0xFF;
    	multicast_ip[2] = (ip >> 16) & 0xFF;
    	multicast_ip[3] = (ip >> 24) & 0xFF;

    	multicast_mac[0] = 0x01;
    	multicast_mac[1] = 0x00;
    	multicast_mac[2] = 0x5E;
    	multicast_mac[3] = multicast_ip[1] & 0x7F;
    	multicast_mac[4] = multicast_ip[2];
    	multicast_mac[5] = multicast_ip[3];

    #ifndef NDEBUG
    	printf(""Multicast-Group H/W address : "" MACSTR ""\n"", multicast_mac[0], multicast_mac[1],multicast_mac[2],multicast_mac[3],multicast_mac[4],multicast_mac[5]);
    	printf(""Multicast-Group IP address : "" IPSTR ""\n"", multicast_ip[0], multicast_ip[1],multicast_ip[2],multicast_ip[3]);
    	printf(""Multicast-GroupPort number : %d\n"", (int) port);
    #endif

    	/* set Multicast-Group information */
    	setSn_DHAR(sn, multicast_mac);	/* set Multicast-Group H/W address */
    	setSn_DIPR(sn, multicast_ip);	/* set Multicast-Group IP address */
    	setSn_DPORT(sn, port);			/* set Multicast-GroupPort number */

    	const uint8_t sd = _socket(sn, Sn_MR_UDP, port, SF_IO_NONBLOCK | Sn_MR_MULTI);

    	if (sd < 0) {
    		printf(""_socket(0, Sn_MR_UDP, %d, SF_IO_NONBLOCK | Sn_MR_MULTI)=%d\n"", (int)port, (int) sd);
    	}

    	return sd;

    	DEBUG_EXIT
    }` Forgot to mention, this is working with sACN E1.31. After the join, you can simply do a recvfrom. Note : the socket number 0 is hardcoded in the example below. 

    uint16_t NetworkW5x00::RecvFrom(uint8_t* packet, uint16_t size, uint32_t* from_ip, uint16_t* from_port) {
    	assert(packet != 0);
    	assert(from_ip != 0);
    	assert(from_port != 0);

    	uint8_t remoteAddress[4];

    	const int32_t rc = _recvfrom(0, (unsigned char *)packet, size, remoteAddress, from_port);

    	if (rc < 0) {
    #ifndef NDEBUG
    		printf(""Error recvfrom=%d\n"", (int) rc);
    #endif
    		return 0;
    	} else if (rc > 0) {
    #ifndef NDEBUG
    		DEBUG_PRINTF(""%d"", rc);
    #endif
    	}

    	*from_ip = remoteAddress[0] | (remoteAddress[1] << 8)  | (remoteAddress[2] << 16)  | (remoteAddress[3] << 24);

    	return (uint16_t) rc;
    } With reference to https://github.com/Wiznet/ioLibrary_Driver/blob/master/Ethernet/socket.c#L168
it is doing a close. So calling the join multiple times is not working. 

Also, I am eager to know how to initiate multiple join's for a single socket. I may be going about this thought the wrong way (bad hack)  Using MacRaw to receive all the multicast traffic so we don't have to bind IP to socket and then use a custom subscribe packet function to tell the upstream switch/router what multicast streams we are interested in? I found success receiving multiple multicast streams from different multicast groups in MACRAW mode.  However the issue is now that my buffer can only handle so many and I need to learn how to utilize IGMP to subscribe to multiple Groups.  I am still looking how to craft an IGMP subscribe function in MACRAW mode.  

Anyone have any advice on IGMP code usage in MACRAW mode?","Q) The question I have is would it be possible to initiate the wiznet to subscribe to multiple multicast group addresses?
A) Unfortunately, calling the join function multiple times for a single socket is not working as the socket close is being performed after the join, as seen in the ioLibrary_Driver. One possible workaround could be to use MacRaw mode to receive all the multicast traffic and then use a custom subscribe packet function to specify the multicast streams you are interested in.
Q) What if we call it for each universe to receive? Does that simply work?
A) As of now, calling the join function for each universe to receive is not working due to the socket close being executed after the join. Therefore, using MacRaw mode and filtering the traffic based on the receive IP and packet contents could be a viable option, although it may lead to overload on the MCU. Another consideration is to explore the possibility of crafting an IGMP subscribe function in MACRAW mode to handle multiple multicast streams."
3027,518,"What is the parameter that the factory sets to this module? 
Such as IP address and Subnet mask of the module? Hi,
WIZ220IO have factory reset as the below.

[code]
uint8 code default_setting[EE_TOTAL - EE_IP1] =
    {	
        192, 168, 11, 2,	         // IP address
        255, 255, 255,0,	// Subnet Mask
        192, 168, 11, 1,	        // Gateway address
        0x13, 0x88,		// local port 5000
        0x00, 0x50,		// http port 5000
       192, 168, 11, 231,	// server IP Address
        0x13, 0x88,		// server Port
        0, 				//operation mode
        0, 0, 				// delimeter time
        0, 				// static IP
        1, 				// debug
        HIGH(SW_VERSION), LOW(SW_VERSION),	// version
        0xfe, 8, 0, 1, 0,
        1,1,1,1,1,1,1,1, 	// digital Input
        0,0,0,0,0,0,0,0, 	// digital output
        0x0f, 0xff,		// analog input 0
        0x0f, 0xff,		// analog input 1
        0,0,		 		// analog output 0
        0,0,		 		// analog output 1
        0				// Keep connection
    };
[/code] [quote=""midnightcow""]Hi,
WIZ220IO have factory reset as the below.

[code]
uint8 code default_setting[EE_TOTAL - EE_IP1] =
    {	
        192, 168, 11, 2,	         // IP address
        255, 255, 255,0,	// Subnet Mask
        192, 168, 11, 1,	        // Gateway address
        0x13, 0x88,		// local port 5000
        0x00, 0x50,		// http port 5000
       192, 168, 11, 231,	// server IP Address
        0x13, 0x88,		// server Port
        0, 				//operation mode
        0, 0, 				// delimeter time
        0, 				// static IP
        1, 				// debug
        HIGH(SW_VERSION), LOW(SW_VERSION),	// version
        0xfe, 8, 0, 1, 0,
        1,1,1,1,1,1,1,1, 	// digital Input
        0,0,0,0,0,0,0,0, 	// digital output
        0x0f, 0xff,		// analog input 0
        0x0f, 0xff,		// analog input 1
        0,0,		 		// analog output 0
        0,0,		 		// analog output 1
        0				// Keep connection
    };
[/code][/quote]

thank you so much  :slight_smile:  :slight_smile:  :slight_smile:","Q) What is the parameter that the factory sets to this module? Such as IP address and Subnet mask of the module?
A) The factory reset for WIZ220IO is as follows:
- IP address: 192.168.11.2
- Subnet Mask: 255.255.255.0
- Gateway address: 192.168.11.1
- Local port: 0x1388
- HTTP port: 0x0050
- Server IP Address: 192.168.11.231
- Server Port: 0x1388
- Other settings for digital input, digital output, analog input, analog output, and more are also included in the factory reset."
3028,5184,"hi, dear developers!
i make some device with HTTP - server with W5500.
when i connect with telnet to my Server - that's all OK.
but when i connect from browser - i have some trouble.
my server send some data, and then close connection.
and in the next time browser open new connection, and don't send
any data... it's bad for me because i have only 7 sockets.

thats some trasing data:

>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00429 - this counter for bytes RX from browser
>     --- no Content Length
>     login.php
> 
>     login page
>     write...
>     write end.
>     HTTP/1.1 200 OK
>     Content-Type: text/html; charset=windows-1251
>     Connection: close
>     Server: aHata
> 
>     <http><body>?ÂÃ¢ÂÂ?ÂÃ¢ÂÂ?ÂÃ¢ÂÂ?ÂÃ¢ÂÂ?ÂÃ¢ÂÂ:<form action=""login.php"" method=""                                  post""><br>User <input type=""text"" name=""user"" value=""""><                                  Br>Password <input type=""text"" name=""pass"" value=""""><Br>                                  <input type=""submit"" value=""?ÂÃ¢ÂÂ?ÂÃ¢ÂÂ""/></form><a href=""login                                  .php"">test</a></body></html>
> 
> 
>     ---IP_SATE_CLOSE
>     00000
>     ---closing begin
>     ---socket closed
> 
>     socket state
>     00001
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000   - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ###HTTP_process
>     ---socket:
>     00000
>     ---Size
>     00000 - this counter for bytes RX from browser
>     ---IP_SATE_CLOSE
>     00000
>     ---closing begin
>     ---socket closed
> 
>     socket state
>     00001



how can i stop keep silent from browser? or it's problems with my code even if i do
> 		   disconnect(socketn); 
> 		   close(socketn);
it takes many time. browser does not want to shut off.
my browser Opera, or Chrome, or Vivaldi. all this browsers keep-alive connection. (i send header Connection: close). In the fire fox all OK. Those browsers you mentioned used to create spare connections to the web server, occupying the sockets for quite a time. Firefox has option to limit concurrent connections in its configuration tab.

You did not publish your code, but you must ensure that after server completes communicating from its side it performs DISCON and then (without waiting) performs CLOSE, and then OPEN, and LISTEN. Faster you do this process, less time you will have with socket being offline.

[quote=""alecksis, post:1, topic:5184""]
and in the next time browser open new connection, and don?Ât send
any data??
[/quote]

If you perform as I explained above, your clinet really connects (and you can confirm it wit Wireshark) but server does not send a data then the fault is in server's code. ok, it is my code
    /*
     * w5500my.c
     *
     * Created: 04.08.2018 14:04:51
     *  Author: belaz
     */ 

    #define DDR_MOSI 2
    #define DDR_SCK  1
    #define DDR_MISO 3
    #define DDR_SS 0
    #define WIZNET_resetpin 5
    #define WIZNET_select PORTB&=0b111111110
    #define WIZNET_cancel   PORTB|=0b000000001

    #define F_CPU 8000000 
    #include <avr/io.h>

    #include <avr/interrupt.h>
    //#include <avr/iom328p.h>
    #include <util/delay.h>
    #include ""w5500/w5500.h""
    #include  ""socket.h""
    #include ""httpServer/httpmy.c""

    #define IP_STATE_NO_SOCKET	0
    #define IP_STATE_SOCKET		1
    #define IP_STATE_LISTEN     2
    #define IP_STATE_CLOSE		3
    #define IP_STATE_ECHO		4
    #define IP_STATE_GOODBYE    5
    #define IP_STATE_DATA		IP_STATE_ECHO
    #define IP_STATE_WRITE_answer 7
    #define IP_STATE_READ_AND_WRITE 8
    #define WRITE_answer 1
    #define READ  0
    #define led_green         PORTC|=0b00100000

    volatile httpRequest myRequest;
    volatile uint8_t socket0st,socket1st,socket2st,socket3st,socket4st,socket5st,socket6st,socket7st,socketst[8]={0,0,0,0,0,0,0,0};
    volatile uint8_t socket_read_count;

    uint8_t write_buffer_len = 0;
    volatile char *READ_HTTP,WRITE_HTTP[1000],*TEMP_HTTP;
    volatile uint16_t httppagesize,READ_point=0,WRITE_point_end=0,WRITE_point_s=0;
    void reset_wiznet()
    {
    	DDRB|=(1<<WIZNET_resetpin); 
    	PORTB&=~(1<<WIZNET_resetpin);
    	_delay_ms(1);
    	PORTB|=(1<<WIZNET_resetpin);
    	_delay_ms(1);
    	return;
    }

    void SPI_MasterInit(void)
    {
    	/* Set MOSI and SCK output, all others input */
    	DDRB |= (1<<DDR_MOSI||1<<DDR_SCK||1<<DDR_SS); //x x x 0 miso mosi sck sc
    	PORTB|=1<<DDR_SS; // ss=1
    	/* Enable SPI, Master, set clock rate fck/16 */
    	SPCR = (1<<SPE)|(1<<MSTR)|(0<<CPOL)|(0<<CPHA); // SPIE=0 SPE=1 DORD=0 MSTR=1 CPOL=0 CPHA=0 SPR01=0 SPR00=0
    	
    	SPSR= 0b00000000;
    }



    //------------------------------------------------ SEARCH DOUBLE ENTER IN REQUEST
    int16_t search_denter(char *buff,uint16_t size) // \r=13 \n 0a 
    {
    	uint16_t i;
    	for(i=0;i<size;i++) { 
    		if (buff[i]==10) { 
    			if (buff[i+1]==13&&buff[i+2]==10) return i-1;
    			if (buff[i+1]==10) return i-1;
    			//if (buff[i]==10&&buff[i+2]==10) return i;
    			}
    		 } return -1; //0a
    }

    //------------------------------------------------ WRITE DATA TO ETHERNET w5500
    void WRITE_answer_to_eth(uint8_t sock, httpRequest *request)
    {
    		// WRITE_answer:
    		//if (httppagesize-WRITE_point_end>1000) {
    		//	size2=httppagesize-WRITE_point_end;
    		//	} else size2=1000;
    		WRITE_point_end += send(sock, WRITE_HTTP+WRITE_point_end, request->headerlength+request->contentlength);  // ÃÂ¾?ÃÂ¿?ÃÂ°ÃÂ²ÃÂ»?ÃÂµÃÂ¼ ÃÂ¾?ÃÂ²ÃÂµ?
    		UART_Send_Str(""\r\nwrite..."",100);
    		//UART_Send_Str(WRITE_HTTP,myRequest.contentlength);
    		if (WRITE_point_end == request->headerlength+request->contentlength )
    			{ READ_point=0; WRITE_point_end=0; UART_Send_Str(""\r\nwrite end."",100); return 1; }
    }


    //------------------------------------------------ READ & WRITE HTTP DATA
    uint8_t HTTP_process(uint8_t sockn){
    	int16_t enter,i; 
    uint16_t size,size2;	
    char *writeptr;
            //read
    		UART_Send_Str(""\r\n###HTTP_process\r\n---socket:"",100);
    		 // ?ÃÂ°ÃÂ·ÃÂ¼ÃÂµ? ÃÂ´ÃÂ°ÃÂ½ÃÂ½??
    		size = getSn_RX_RSR(sockn);
    		UART_Send_Int(sockn);
    		UART_Send_Str_Back(""---Size"",12);
    		UART_Send_Int(size);
    		if (size>0) {
    			socket_read_count=0;
    			if(size > 1000) size = 1000;
    			READ_point+=recv(sockn,READ_HTTP+READ_point,size); // ÃÂ¿ÃÂ¾ÃÂ»??ÃÂ°ÃÂµÃÂ¼ ÃÂ´ÃÂ°ÃÂ½ÃÂ½?ÃÂµ
    			
    			if (search_denter(READ_HTTP,READ_point)>=0)
    			    {
    				enter=search_denter(READ_HTTP,READ_point);
    				myRequest.contentlengthreq=getcontentlen(READ_HTTP,READ_point,&myRequest);
    				if (myRequest.contentlengthreq==0) {
    					// ÃÂ¾ÃÂ±?ÃÂ°ÃÂ±ÃÂ¾?ÃÂºÃÂ° ÃÂ·ÃÂ°ÃÂ¿?ÃÂ¾?ÃÂ°
    					
    					
    					HTTP_pars(READ_HTTP,enter,&myRequest,READ_HTTP+enter+4);
    					//UART_Send_Str_Back(READ_HTTP,READ_point);
    				    //led_green;
    					make_http_page(&myRequest,WRITE_HTTP);
    					WRITE_answer_to_eth(sockn,&myRequest);
    					//UART_Send_Str_Back(WRITE_HTTP,myRequest.contentlength+myRequest.headerlength);
    					
    					return IP_STATE_CLOSE;
    					} else {  
    					// ÃÂ¾ÃÂ±?ÃÂ°ÃÂ±ÃÂ¾?ÃÂºÃÂ° ÃÂ·ÃÂ°ÃÂ¿?ÃÂ¾?ÃÂ° ÃÂµ?ÃÂ»ÃÂ¸ ??ÃÂ¡ÃÂ¢ ÃÂ·ÃÂ°ÃÂ¿?ÃÂ¾? ?ÃÂ°???ÃÂ¸??ÃÂ²ÃÂ°ÃÂµÃÂ¼ , ÃÂºÃÂ¾ÃÂ³ÃÂ´ÃÂ° ÃÂºÃÂ¾ÃÂ½ÃÂµ? ÃÂ´ÃÂ°ÃÂ½ÃÂ½??
    					//READ_point+=recv(sockn,READ_HTTP+READ_point,(enter+4)+myRequest.contentlengthreq-(READ_point));  
    					//UART_Send_Str(""---read POST tree"",100);
    					make_http_page(&myRequest,WRITE_HTTP);
    					WRITE_answer_to_eth(sockn,&myRequest); 
    					return IP_STATE_CLOSE;
    					}
    				}
    			}
     socket_read_count++;
     if (socket_read_count>16) { socket_read_count=0; return IP_STATE_CLOSE; }
    return IP_STATE_READ_AND_WRITE;
    }


    //------------------------------------------------ MAANAGE SOCKETs STATUS
    void http_task(uint8_t socketn){
    	int8_t a;
    	switch(socketst[socketn]){
    		//------------------------------------------------
    		case IP_STATE_NO_SOCKET:
    		 if(socket(socketn, Sn_MR_TCP, 80, 0) == socketn)
    		 socketst[socketn] = IP_STATE_SOCKET;
    		   break;
    		//------------------------------------------------
    		case IP_STATE_SOCKET:
    		a=listen(socketn);
    		switch (a){
    			case SOCK_OK :
    			UART_Send_Str_Back(""\r\nsocket state"",100);
    			UART_Send_Int(a);
    			socketst[socketn] = IP_STATE_LISTEN;
    			break;
    			case SOCKERR_SOCKCLOSED :
    			socketst[socketn] = IP_STATE_CLOSE;
    		    }
    		break;
    		//------------------------------------------------
    		case IP_STATE_LISTEN :
    		switch(getSn_SR(socketn)){
    			case SOCK_LISTEN :
    			_delay_ms(10);
    			break;
    			case SOCK_ESTABLISHED:
    			socketst[socketn] = IP_STATE_READ_AND_WRITE;
    			break;
    			default:
    			socketst[socketn] = IP_STATE_CLOSE;
    		}
    		break;
    		//------------------------------------------------
    		case IP_STATE_READ_AND_WRITE:
    		if (getSn_SR(socketn) == SOCK_ESTABLISHED) {
    			_delay_ms(10);
    			socketst[socketn] = HTTP_process(socketn);
    			} else {
    			socketst[socketn] = IP_STATE_CLOSE;
    		    }
    		break;
    		//------------------------------------------------

    		//------------------------------------------------
    		case IP_STATE_CLOSE:
    			UART_Send_Str_Back(""---IP_SATE_CLOSE "",33);
    		   if (disconnect(socketn)==SOCK_BUSY) UART_Send_Str(""\r\nbusy"",100);
    		   close(socketn);
    		   UART_Send_Str_Back(""---socket closed"",100);
    		   socketst[socketn]=IP_STATE_NO_SOCKET; 
    		break;

    	}
    	return socketst[socketn];
    }


    int main(void)
    {
     char test3[]=""hello world!                           "";
    	wiz_NetInfo myCong={
    		.mac={12,13,56,57,58,59},
    		.ip={192,168,1,19},
    		.sn={255,255,255,0},
    		.gw={192,168,1,1},
    		.dhcp=NETINFO_STATIC, 
    		.dns={192,168,1,1}
    		};
    netmode_type mytype={0};
    READ_HTTP=WRITE_HTTP;
    wiz_NetTimeout mynettimeout={.retry_cnt=15,.time_100us=50};
    DDRA=0;
    DDRD=0b00000000;//
    DDRB=0b10100111; // 0 0 1 0 0miso 1mosi 1sck 1sc
    DDRC=0b10100000; //c7-en c5-data
    DDRE=0;
    DDRG=0;
    DDRF=0;
    rfinit();

    reset_wiznet();
    _delay_ms(10);
    SPI_MasterInit();
    	UART_Init();
    	UART_Send_Str(""\r\nHELLO"",10);


    	
    	
    reg_wizchip_cs_cbfunc(0,0);
    reg_wizchip_spi_cbfunc(0,0);
    reg_wizchip_spiburst_cbfunc(0,0);
    		ctlnetwork(CN_SET_NETINFO, &myCong);
    		ctlnetwork(CN_SET_NETMODE, &mytype );
    		ctlnetwork(CN_SET_TIMEOUT, &mynettimeout );
    		



    	while (1) {
    	    
    		do { http_task(0); }
    		while (socketst[0]==IP_STATE_READ_AND_WRITE);
    		do { http_task(1); }
    		while (socketst[1]==IP_STATE_READ_AND_WRITE);
    		do { http_task(2); }
    		while (socketst[2]==IP_STATE_READ_AND_WRITE);

    		};","Q) How can I stop the browser from staying silent and not sending any data?
A) If you perform as I explained above, your client really connects (and you can confirm it with Wireshark), but the server does not send any data, then the fault is in the server's code. You need to ensure that after the server completes communicating from its side, it performs DISCON and then (without waiting) performs CLOSE, and then OPEN, and LISTEN. Faster you do this process, less time you will have with the socket being offline.

Q) Is there a problem with my code, even if I perform ""disconnect(socketn); close(socketn);""?
A) If the server is not sending any data after the client connects, it is likely an issue with the server's code. If you are performing ""disconnect(socketn); close(socketn);"", and the browser does not shut off, you need to verify the server's code for any issues.

Q) What might be the reason for the browser staying silent and not sending any data, despite my code?
A) The behavior of the browser staying silent and not sending any data could be due to issues in the server's code. The server must ensure that after it completes communicating from its side, it performs DISCON and then (without waiting) performs CLOSE, and then OPEN, and LISTEN. Additionally, make sure to check for any errors or delays in the server's code."
3029,5186,"Hi

This problem is due to your network configuration.
10.54.53.240 is in a different network band from 10.15.1.80, and it is judged that the packet transmitted from 10.54.53.240 does not reach 10.15.1.80. It looks like really W5300 ignores the packets not responding to them, even to the retramsmitted one - thus it is not just a kind of ""packet loss"" - it is steady behavior in some W5300 state.

[quote=""sensiwood, post:1, topic:5186""]
We believe there are still free sockets on W5300
[/quote]

You must prove it - that when this happens, you have at least one socket in LISTEN state. If you have diagnostic terminal to W5300, then program its driver to print all common and socket registers into this diagnostic output (e.g. pressing a key on the diag terminal) so that you can see whole the configuration when issue happens.

[quote=""sensiwood, post:1, topic:5186""]
W5300 should send a RST instead of keeping silent
[/quote]

I suspect it is not correct assumption. In my web server application, when client's web browser issues more requests than sockets available, all new requests are ""hung"" - browser keeps waiting, until it timeouts. This means for me that chip (I use W5100) simply does not respond - otherwise if browser's stack would receive RST, it stopped waiting immediately.

[quote=""sensiwood, post:1, topic:5186""]
As I understand from the specification, the transition
[/quote]
Yes, it is controlled by the W5300 TCP/IP stack. Thus if something stops working, you first must look, carefully and thoroughly, into the *current effective* configuration of the chip at the time of the issue.

[quote=""sensiwood, post:1, topic:5186""]
Interestingly, W5300 is still working when this issue happens because another remote site 10.10.28.240 is talking to it.
[/quote]

It confirms that chip is still operational, and there's something else than faulty hardware.

[quote=""sensiwood, post:1, topic:5186""]
A software RST to MR1 of W5300 can restore the situation and it can accept new SYN and talk to both sites correctly.
[/quote]

Also logical as you reset whole configuration of the chip.

My conclusion - further troubleshooting is needed dumping all possible meaningful registers at the time after issue starts happening. I am sure we will find something interesting in the output. Hi Eugeny,

Sorry for the late reply.
I appreciate very much for your detailed comments.

And it is not possible at the moment to debug anything on the site so I was still trying to reproduce it on my own test bench. To dump all the registers is a good idea and I will try.

Hope I can come back with some useful information in following days.
Thanks again for your help! Hi Eugeny,

I did some tests on my test bench. The only way to reproduce the issue is, to set up two devices with the different IP addresses but the same MAC addresses.

Device 1 (TCP client), IP 192.168.30.10, MAC **00:01:19:01:01:01**

Device 2 (TCP client), IP 192.168.30.11, MAC **00:01:19:01:01:01**

Device 3 (TCP server), IP 192.168.30.17, MAC 00:01:19:64:01:02

All devices are connected to one switch to form a LAN.
Device 1 and 2 send the request to device 3 and device 3 responses.

I let the system run for some time (10 minutes) and I found device 3 does not send any response to SYN request any more. The only way to recover the communication is to reset the W5300. This is the similar phenomenon as our customer reports.

I reckon this is not desirable for LAN configuration because typically the MAC address over the LAN should be unique. But at the moment it is the only way to reproduce the issue stably.

And even if there are two MAC addresses on the LAN, this will confuse the switch only. For ARP table of the device, I think it should be OK if several target IP addresses use the same MAC address. Correct me if I am wrong.

When the issue happens, the register values I dumped from the firmware are:

MR: 0x01

IR: 0x00

IMR: 0x00

SHAR: 00:01:19:64:01:02

GAR: 0x0000

SUBR: 0x0fff

SIPR: 0xc0a81e11

RTR: 0xc350

RCR: 0x0008

TMSR: 0x0808080808080808

RMSR: 0x0808080808080808

MTYPER: 0x00ff

UIPR: 0x00000000

UPORTR: 0x0000

FMTUR: 0x0000

SOCK0

MR21

CR0

SR14

SOCK1

MR21

CR0

SR14

SOCK2

MR21

CR0

SR14

SOCK3

MR21

CR0

SR14

SOCK4

MR21

CR0

SR14

SOCK5

MR21

CR0

SR14

SOCK6

MR21

CR0

SR14

SOCK7

MR21

CR0

SR14

I cannot see obvious abnormal values from above. All sockets are in LISTENING status.

I also captured one situation that all sockets are in 0x17 status ESTABLISHED and the further SYN request will be responded with RST by w5300. It is reasonable.

And during the test, I ever read 0x1e and 0x11 status value of the socket randomly but they are not described in the manual. What do they mean?

Thanks! Dear support team of Wiznet,

I am still waiting for your response on my query.

Our customer keeps having similar phenomenon every 2 weeks or so.

Since the workaround provided by you does not work on my setup, I cannot positively reply anything to our customer yet.

The situation is getting more pressured when time elapsed without progress.

I hope you can understand it.

I think I have provided all the details I tested and all the dumped register values when the issue happened.

If you think that is not good enough for you to start working with, please let me know. I will provide more if possible.

Thanks! Dear sensiwood!
Im sorry my answer can't help you.

Assum W5300's regsiters are correct. If W5300 do not send to SYN/ACK, W5300 maybe do not receive the SYN packet from a peer.

As your first questioin, Your two device share the same MAC address.

Can you check correctly send the SYN packet to the W5300 by using dump-hub switch or port-mirroing function?

I wonder W5300 can receive the SYN packet from the your network.

Also, As I know, MAC address should be unique every device. why the same mac is shared?

Thank you. [quote=""sensiwood, post:10, topic:5186""]
In this test, I only used this special configuration to reproduce the problem faster.
[/quote]

In this setup, if routing device is intelligent, it will have to decide which route to send the packets. It may simply appear that SYN packets are sent to wrong wire.

[quote=""sensiwood, post:10, topic:5186""]
Wireshark using the port-mirroring switch
[/quote]

I would do it differently. I would put PC (Win or Linux) with two LAN cards in bridge mode between switch and W5300, and set up Wireshark on it. In this setup you will be able to see PC's both interfaces, and be sure that respecive packets are travelling in the wire up to the W5300's magjack. [quote=""Eugeny, post:11, topic:5186""]
I would do it differently. I would put PC (Win or Linux) with two LAN cards in bridge mode between switch and W5300, and set up Wireshark on it. In this setup you will be able to see PC?Âs both interfaces, and be sure that respecive packets are travelling in the wire up to the W5300?Âs magjack.
[/quote]

Thanks for sharing this good idea. I will try to figure out how to do it on my setup. [quote=""sensiwood, post:12, topic:5186""]
I don?Ât use router
[/quote]

That does not guarantee that this switching device performs no packet filtering.

[quote=""sensiwood, post:12, topic:5186""]
Let the system run about 10 minutes and then device 3 cannot respond to any SYN request from device 1 or device 2.
[/quote]

I suspect it is normal. After some time of operation intermediate network device decides on illegal devices and ""disconnects"" them.

[quote=""sensiwood, post:12, topic:5186""]
After I remove the duplicated MAC address device from the network and rebooted the switch, the device 3 cannot still reply to incoming SYN request. So I suppose W5300 run into an unexpected status.
[/quote]

Depending on the device, rebooting it may not clear cache. I think you must manually perform commands to reinitializate the tables / clear them.

Your diagram shows 3 W5300 devices, but you say that device 3 is affected. Clear everything, and swap switch ports of device 1 and device 2 - will another physical device become unresponsive? I didn't observe device 1 or 2 unresponsive because in this test,  device 1 and 2 keep initiating requests to device 3.
Device 3 replies the requests from device 1 and 2.

When issue happened, device 1 and 2 still sent SYN request to device 3. Dear Sensiwood!

As you mentioned, It is not a problem that two same MAC address is used in two device.
But, Eugeny & I think different.

To check the same mac issue, You can try to turn your switch off and on in the issed situatiion.
If you are still in the issued situation after your switch is reboot, the same mac issued is not problem any more.

Anyway, I wonder why not a socket is opened as UDP and stocked.

So I have checked your source code again, I hope to quest you have applied your code to as previous my code.

All SOCKET command such as OPEN, SEND, RECV and etc,  should be checked to be cleared as 0.

For example, 
setSn_CR(sn,Sn_CR_OPEN);
while(getSn_CR(sn) != 0);    //<- must

I want all your code to apply it.
Also, To avoid miss-understanding situation, I want you don't use the same mac address.

And I need a original capture fiel, not a figture.


Thank you. [quote=""sensiwood, post:17, topic:5186""]
However very unluckily, it is the only scenario I can reproduce the issue so far.
[/quote]

Symptoms may look like the same as at your customer site, but the cause might be different.

[quote=""sensiwood, post:17, topic:5186""]
The only way to restore the communication is, rebooting our device which will reboot W5300 from hardware level as well.
[/quote]

Try simply disconnecting and reconnecting network jack from W5300 for a minute - causing switch's port going down and then up. Dear sensiwood!

As you mentioned, You didn't use the same mac address in real world,  did use for just test.  
But your diagram is not. 

In your environment, It is possible that the communication doesn't work well.

The SYN/ACK packet to sent by the server may be send to another client. The packet may cause for W5300 to enter the errorous situation. Because the packet is a same the server ip address and server port in the client-side. If the packet have the sequence number & ack number to wait by client, the connection channel is abnormal and W5300 can't work well.

As well as, Because the server is already sent the SYN/ACK packet to a wrong client and is entered the wait state to receive the ACK packet from a client,  W5300 may be not response the SYN packet from a normal client.


Even if my answer can not to solve your problem, Don't use the same mac address.
The same mac address usage can not help to solve your problem.

Anyway, I wonder the test result that you modify your code in order to clear a command

Thank you. Dear Sensiwood!

How are you? I'm so sorry too late to check your issuse.

Your dumpped register values are all correct but I didn't know why not W5300 work well.

I wonder W5300 can reply to ping-request in this situation, and I wonder the modified code is tested.

Anyway, I checked your code again!

When  Sn_IR_SENDOK is checked within function w5300_send_data(), the loop count value seems be  too small. 
So, I will suggest to you two trials.

1. Remove loop count 

2. Check  Sn_IR_SENDOK after  Sn_CR_SEND is performed.

```
static int w5300_send_data(CPU_PORT port, int s, unsigned char *buf, unsigned int len)
{
       int i;
       if (ethernet[port].ether_protocol == TCP_PROTOCOL)
          w5300UpdateConnTimeout(port, s, CTO_RESET);
    
      bb_disable_int();

      SET_INDIRECT_REG(port, Sn_TX_FIFO(s));
      for (i = 0; i < len; i += 2)
      {
          writeByte(port, IDM_DR, buf[i]);
          writeByte(port, IDM_DR1, buf[i+1]);
      }

      // Notifying packet length, and transmitting packets by sending SEND command.
      w5300IndirectWriteWord(port, Sn_TX_WRSR(s), len >> 16);
      w5300IndirectWriteWord(port, Sn_TX_WRSR2(s), len);

      w5300IndirectWriteWord(port, Sn_CR(s), Sn_CR_SEND);
      while(w5300IndirectReadWord(port, Sn_CR(s)) != 0);    // Should wait until command clear 
      while((w5300IndirectReadWord(port, Sn_IR(s)) & Sn_IR_SEND_OK) == 0)
      {
              if(w5300_get_status(port, s) == SOCK_CLOSED)
             {
                closeSocket(port,s);
                 return FAIL;
              }
       }
       w5300IndirectWriteWord(port, Sn_IR(s), Sn_IR_SEND_OK);
      bb_enable_int();
      return OK;
}
```
Can you test two trials?
I will wait your good news.

Thank you. Hello midnightcow,

Happy new year to you!

I am just back to office from the holiday and will look into/try your suggestions in following days.
Thanks for your support! Hi team,

Sorry for coming back so late on this thread.

Actually I did some work as my background task in the past month. Now based on your suggestions, I think I have got a progress to bypass the issue. Two key changes I have made were:

1. Before closing the socket, always check if the send buffer has been emptied. Below are the functions I used.
static void closeSocket(CPU_PORT port, int s)
{
    T_SOCK *sock = GET_SOCK(port, s);
    int closing = waitForTxDone(port, s);

    if(closing == FAIL)
        applyErratum1(port, s);

    sock->timeWaitTimeout = 0;
    sock->sourcePort = 0;
    sock->remoteRtuAddress = 0;
}

static int waitForTxDone(CPU_PORT port, int s)
{
    T_SOCK *sock = GET_SOCK(port, s);
    USHORT loop;

    if(sock->txDone)
        return OK;

    loop = 1000; // approx 50 ms.
    while((w5300IndirectReadWord(port, Sn_IR(s)) & Sn_IR_SEND_OK) == 0)
    {
        if(--loop == 0)
            return FAIL;
    }

    w5300IndirectWriteWord(port, Sn_IR(s), Sn_IR_SEND_OK);
    return OK;
}

That means, every time when I close the socket, I will check if the last sending operation has been done.

2. If the sending activity is not finished within certain period of time (50ms), I will use following function to purge the output buffer and close the socket forcefully. 
void applyErratum1(CPU_PORT port, int s)
{
    BYTE dummyData[2] = { 0, 0 };
    union IPV4_ADDR ipAddr;

    ipAddr.addrVal = 1;
    w5300_open_socket_mode(port, s, MIN_PORT_NUM - 1, Sn_MR_UDP);
    w5300_set_dipaddr(port, s, ipAddr, TCP_KINGFISHER);

    w5300_write_tx_data(port, s, dummyData, 1);
    closeSocketWithoutWait(port, s);
}

After changing the socket type to UDP, I do not wait the socket status to be SOCK_UDP in a dead loop; instead I just wait a period of time and then directly start to send the rubbish bytes in output buffer to a void target IP address.

As tested on my own setup, the new firmware doe not have the permanent socket lock up issue any more. Sometimes, within certain period of time, one socket still cannot respond to SYN request as I observed. But the situation can be restored automatically. Anyway, the changes really made a difference. How to coordinate with customer to validate this on site is another story which might not be easy to deploy in near future.

I appreciate your help all through this ticket, and wish all the best to the team.

Thanks!","Q) Can you check correctly send the SYN packet to the W5300 by using dump-hub switch or port-mirroring function?
A) I would do it differently. I would put PC (Win or Linux) with two LAN cards in bridge mode between switch and W5300, and set up Wireshark on it. In this setup you will be able to see PC's both interfaces, and be sure that respective packets are traveling in the wire up to the W5300's magjack.

Q) I wonder W5300 can receive the SYN packet from your network.
A) As your first question, Your two devices share the same MAC address. 

Q) I did some work as my background task in the past month. Now based on your suggestions, I think I have got a progress to bypass the issue. 
A) Two key changes I have made were:
   1. Before closing the socket, always check if the send buffer has been emptied.
   2. If the sending activity is not finished within a certain period of time (50ms), I will use the following function to purge the output buffer and close the socket forcefully.

Q) How to coordinate with the customer to validate this on-site is another story which might not be easy to deploy in the near future.
A) I appreciate your help all through this ticket, and wish all the best to the team."
3030,5189,"hi, dear developers!
i can't understand how arranged memory in W5500.
there is code from official library **W5500.c**

       void wiz_send_data(uint8_t sn, uint8_t *wizdata, uint16_t len)
       {
       uint16_t ptr = 0;
       uint32_t addrsel = 0;

       if(len == 0)  return;
       ptr = getSn_TX_WR(sn);
       //M20140501 : implict type casting -> explict type casting
       //addrsel = (ptr << 8) + (WIZCHIP_TXBUF_BLOCK(sn) << 3);
       addrsel = ((uint32_t)ptr << 8) + (WIZCHIP_TXBUF_BLOCK(sn) << 3);
       //
       WIZCHIP_WRITE_BUF(addrsel,wizdata, len);
       
       ptr += len;
       setSn_TX_WR(sn,ptr);
       }
I calculate addrsel for all SOCKETs. It is

socket0 H00224:L00016
socket1 H00224 L00048
socket2 H00224 L00080
socket3 H00224 L00112
socket4 H00224 L00144
socket5 H00224 L00176
socket6 H00224 L00208
i don't understand, why behind sockets only (48-16=32) (80-48=32) (112-80=32) etc ?
and buffer for TX must be 2kB. can anybody explain, how memory map work in w5500. with picture please. i try to understand memory arrange with library code. but it so difficult , it's impossible ! Are you trying to increase buffer on TX / RX ?   If so look at this github link.  This shows how to use more sockets to increase RX TX Buffer.   

https://github.com/sstaub/Ethernet3

Pay Attention to Socket RAM Size. Please see the datasheet, the memory layout is explained in section 3 Register and Memory Organization

Arjan","Q) i don't understand, why behind sockets only (48-16=32) (80-48=32) (112-80=32) etc ? and buffer for TX must be 2kB. can anybody explain, how memory map work in w5500. with picture please. i try to understand memory arrange with library code. but it so difficult , it's impossible !
A) The memory layout for the W5500 chip allocates a certain size for each socket's TX and RX buffer. The calculated difference of 32 bytes between the sockets' buffer addresses signifies the size of the buffer allocated to each socket. As for the memory map, it may help to refer to the datasheet's section 3 ""Register and Memory Organization"" for a detailed explanation. Additionally, the provided GitHub link demonstrates how to use more sockets to increase the RX/TX buffer. 

Q) Are you trying to increase buffer on TX / RX ? If so look at this github link. This shows how to use more sockets to increase RX TX Buffer.
A) The provided GitHub link demonstrates how to use more sockets to increase the RX/TX buffer for the W5500 chip. This resource offers insights into expanding the buffer capacity.

Q) Pay Attention to Socket RAM Size. Please see the datasheet, the memory layout is explained in section 3 Register and Memory Organization
A) Pay attention to the socket RAM size and refer to the datasheet's section 3 ""Register and Memory Organization"" for a detailed explanation of the memory layout."
3031,519,"Hi,

I use the DHCP-Client-mode and want to read the assigned DNS-IP.
How to use Serial Command to read DNS-IP? Hello Hardix

Please try it again using <RI> or <RT>. Hi,

 The Command RI gives me the IP Addr and the Command RT gives me the WAN IP, SubMask and Gateway but no DNS-IP!? Hello Hardix

Please refer to the below logs.

[quote]<RV>
<S0_WIZnet_DIR636L_192.168.4.1>
<RT>
<S1_192.168.4.107_255.255.255.0_192.168.4.1>
[/quote]

Maybe <RV> is what you want.","Q) I use the DHCP-Client-mode and want to read the assigned DNS-IP. How to use Serial Command to read DNS-IP?
Q) Please try it again using <RI> or <RT>.
Q) Maybe <RV> is what you want. 
A) The Command RI gives me the IP Addr and the Command RT gives me the WAN IP, SubMask and Gateway but no DNS-IP!?"
3032,5194,"I need to call setSn_PORT() to set my source port. Otherwise I think W5500 will use the same destination port number as the source port. [quote=""acpie360, post:2, topic:5194""]
I need to call setSn_PORT() to set my source port.
[/quote]

Correct. By default it is 0. You set it to 80. Web server does not want to respond to port 80. Set the source port in range of 0xc000-0xfffe, and make the port number dynamic - so that for every new connection to this web server's port 80 you use previous port number + 1. Thanks for the comment. 

What is still a bit of puzzling is that I made this mistake a few months ago by passing in port number 80, instead of 0, when calling socket() API for a HTTP client socket. This bug wasn't discovered sooner because everything seemed to be working just fine in the office. However, when I took the device home and plugged it into my Google WiFi router, I couldn't connect, as if either the SYN never reached the server or the SYN ACK was lost.  Any theory why it was mistakenly working?","Q) What is still a bit of puzzling is that I made this mistake a few months ago by passing in port number 80, instead of 0, when calling socket() API for a HTTP client socket. This bug wasn't discovered sooner because everything seemed to be working just fine in the office. However, when I took the device home and plugged it into my Google WiFi router, I couldn't connect, as if either the SYN never reached the server or the SYN ACK was lost. Any theory why it was mistakenly working?
A) Any theory why it was mistakenly working?"
3033,5195,"hello.
We are developing the product using the WizNet W7500P.
It is currently in use in server mode.
I want to know how many clients can connect.
If possible, I would like to know where you can see the reference source.
And if only one W7500P is possible, several clients
If you have a chip that can be connected, please introduce it.

thank you The W7500P Datasheet confirmed that there were eight sockets.
When using the W7500P as a server mode, up to 8 client programs
Can you say it can be stuck?If you compile the WIZ750SR reference source,
The client confirmed that only one attached.Examples that can attach multiple
If you have source code, please. In the reference source, we have solved an additional socket.
thank you I'm glad you solved your question.

The W7500P has eight physical sockets, and each socket can be opened in IPRAW mode or macraw mode as needed.
You can use it in various ways depending on how you set up.

thank you","Q) I want to know how many clients can connect to the WizNet W7500P in server mode and where I can see the reference source. Also, if it's possible to connect several clients with one W7500P, please introduce a chip that can do that.
A) The W7500P Datasheet confirmed that there were eight sockets. When using the W7500P as a server mode, up to 8 client programs can be connected. If you compile the WIZ750SR reference source, it confirmed that only one can be attached. In the reference source, we have solved an additional socket. If you have source code, please. 

Q) Can you say how many clients can be connected when using W7500P in server mode?
A) The W7500P has eight physical sockets, and each socket can be opened in IPRAW mode or macraw mode as needed. You can use it in various ways depending on how you set up."
3034,520,"Hi!
Does wiznet produce any webserver module (with possibility to load into FLASH custom page) with built-in MAC address? Hi,

We don't have web server module having MAC address.

[url]http://www.wiznet.co.kr/sub_modules/en/product/Product_Detail.asp?cate1=5&cate2=42&cate3=0&pid=1196[/url]
I think you'd better using the WIZ550io(built-in MAC address) and implement the web server on your MCU.","Q) Does wiznet produce any webserver module (with possibility to load into FLASH custom page) with built-in MAC address?
A) We don't have web server module having MAC address."
3035,5202,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??
?ÂÃ¬ÂÂ¬ stm32h7 mcu Ã«Â³Â´Ã«ÂÂ??W5500 ?Â´Ã«ÂÂ?Â·Ã¬ÂÂ´?ÂÃ«? ?Â°ÃªÂ²Â°?ÂÃ¬ÂÂ¬  ?ÂµÃ¬ÂÂ ÃªÂ¸Â°Ã«ÂÂ¥ ?ÂÃ¬ÂÂ¤?Â¸Ã¬Â¤Â?ÂÃ«ÂÂ??
ÃªÂ¸Â°Ã¬Â¡Â´??5100S ?Â´Ã«ÂÂ???Â´Ã«ÂÂ Ã«ÂªÂ¨Ã«ÂÂ???Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ÃªÂ°ÂÃ«Â°Â?ÂÃ«ÂÂ¤ ?Â¬Ã«ÂÂ¬ÃªÂ°?Ã¬Â§? Ã«Â¬Â¸Ã¬Â ÂÃ«Â¡?
W5500 ?Â´Ã«ÂÂ?Â·Ã¬ÂÂ´??Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡?Ã«Â³?ÃªÂ²Â½Ã­ÂÂ???ÂµÃ«ÂÂ??

ÃªÂ¸Â°Ã¬Â¡Â´ W5100S Ã«ÂªÂ¨Ã«ÂÂ?ÂÃ¬ÂÂ SPI ?ÂµÃ¬ÂÂ ÃªÂ¸Â°Ã«ÂÂ¥??DMAÃ«Â¥??ÂÃ¬ÂÂ±?ÂÃ­ÂÂ´???Â°Ã¬ÂÂ´???Â¡Ã¬ÂÂ?Â Ã¬ÂÂ´ ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡?
?ÂÃ¬ÂÂ?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃ¬?ÃªÂ³?.
?ÂÃ¬ÂÂ¼ MCU Ã«Â³Â´Ã«ÂÂ??W5500 ?Â´Ã«ÂÂ?Â·Ã¬ÂÂ´?ÂÃ«Â§Â Ã«Â³?ÃªÂ²Â½Ã­ÂÂ???ÂµÃ«ÂÂ??
?ÂÃ¬Â¦Â??IO Library??gitHub?ÂÃ¬ÂÂ Ã¬ÂµÂÃªÂ·Â¼ Ã«Â²ÂÃ¬Â Â?Â¼Ã«Â¡Â ?Â¤Ã¬ÂÂ´Ã«Â°ÂÃ¬ÂÂ???ÂÃ¬ÂÂ©?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Ã¬Â¦ÂÃ¬ÂÂ?? ?ÂÃ¬ÂÂ Ã«Â§ÂÃ¬??ÂÃ«Â¦Â°??Ã«Â¡?SPIÃ«Â¥?DMAÃ«ÂªÂ¨Ã«ÂÂÃ«Â¡??Â¤Ã¬Â Â ??
TX ?Â°Ã¬ÂÂ´?Â°Ã«ÂÂ ?ÂÃ¬ÂÂ¡?ÂÃ¬?Ã«Â§?RX ?Â°Ã¬ÂÂ´?Â°Ãª? ??ÂÂ 0?Â¼Ã«Â¡Â ?Â½Ã­ÂÂ?ÂÃ«ÂÂ¤.
SPI ?Â¤Ã¬Â Â ??TXÃ«Â§?DMAÃ«Â¥??Â¤Ã¬Â Â?ÂÃªÂ³Â  RX??DMA ?Â¤Ã¬Â Â???ÂÃ¬? ?ÂÃ¬ÂÂ¼Ã«Â©??ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ?Â©Ã«ÂÂ??
SPI ?Â´Ã«ÂÂ­?? 25MhzÃ«Â¥??Â¬Ã¬ÂÂ©Ã¬Â¤ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.

?ÂÃ«ÂÂ??Ã¬Â½ÂÃ«ÂÂ?ÂÃ«ÂÂ??

/* Definition for SPIx Pins */
#define SPIx_NSS_PIN                     GPIO_PIN_12
#define SPIx_NSS_GPIO_PORT               GPIOB
#define SPIx_NSS_AF                      GPIO_AF5_SPI2
#define SPIx_SCK_PIN                     GPIO_PIN_13
#define SPIx_SCK_GPIO_PORT               GPIOB
#define SPIx_SCK_AF                      GPIO_AF5_SPI2
#define SPIx_MISO_PIN                    GPIO_PIN_14
#define SPIx_MISO_GPIO_PORT              GPIOB
#define SPIx_MISO_AF                     GPIO_AF5_SPI2
#define SPIx_MOSI_PIN                    GPIO_PIN_15
#define SPIx_MOSI_GPIO_PORT              GPIOB
#define SPIx_MOSI_AF                     GPIO_AF5_SPI2

/* Definition for SPIx's NVIC */
#define SPIx_IRQn                        SPI2_IRQn
#define SPIx_IRQHandler                  SPI2_IRQHandler

/* SPI2 DMA Setting */
#define DMAx_CLK_ENABLE()                __HAL_RCC_DMA1_CLK_ENABLE()
#define SPIx_TX_DMA_STREAM               DMA1_Stream3
#define SPIx_RX_DMA_STREAM               DMA1_Stream2
#define SPIx_TX_DMA_REQUEST              DMA_REQUEST_SPI2_TX
#define SPIx_RX_DMA_REQUEST              DMA_REQUEST_SPI2_RX
#define SPIx_DMA_TX_IRQn                 DMA1_Stream3_IRQn
#define SPIx_DMA_RX_IRQn                 DMA1_Stream2_IRQn
#define SPIx_DMA_TX_IRQHandler           DMA1_Stream3_IRQHandler
#define SPIx_DMA_RX_IRQHandler           DMA1_Stream2_IRQHandler

int InitSPI2(void)
{
  /*##-1- Configure the SPI peripheral #######################################*/
  /* Set the SPI parameters */

  g_hSpi2.Instance               = SPIx;
  //g_hSpi2.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_4; // 50Mhz
  g_hSpi2.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_8; // 25Mhz
  //g_hSpi2.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_16; // 12.5Mhz

  g_hSpi2.Init.Mode = SPI_MODE_MASTER;
  g_hSpi2.Init.Direction         = SPI_DIRECTION_2LINES;
  g_hSpi2.Init.CLKPhase          = SPI_PHASE_2EDGE; // SPI Mode3
  g_hSpi2.Init.CLKPolarity       = SPI_POLARITY_HIGH; // SPI Mode3
  g_hSpi2.Init.DataSize          = SPI_DATASIZE_8BIT;
  g_hSpi2.Init.FirstBit          = SPI_FIRSTBIT_MSB;
  g_hSpi2.Init.TIMode            = SPI_TIMODE_DISABLE;
  g_hSpi2.Init.CRCCalculation    = SPI_CRCCALCULATION_DISABLE;
  g_hSpi2.Init.CRCPolynomial     = 7;
  g_hSpi2.Init.CRCLength         = SPI_CRC_LENGTH_8BIT;
  g_hSpi2.Init.NSS               = SPI_NSS_SOFT;
  g_hSpi2.Init.NSSPolarity       = SPI_NSS_POLARITY_LOW;
  g_hSpi2.Init.NSSPMode          = SPI_NSS_PULSE_DISABLE;
/*
  g_hSpi2.Init.FifoThreshold = SPI_FIFO_THRESHOLD_01DATA;
  g_hSpi2.Init.TxCRCInitializationPattern = SPI_CRC_INITIALIZATION_ALL_ZERO_PATTERN;
  g_hSpi2.Init.RxCRCInitializationPattern = SPI_CRC_INITIALIZATION_ALL_ZERO_PATTERN;
  g_hSpi2.Init.MasterSSIdleness = SPI_MASTER_SS_IDLENESS_00CYCLE;
  g_hSpi2.Init.MasterInterDataIdleness = SPI_MASTER_INTERDATA_IDLENESS_00CYCLE;
  //g_hSpi2.Init.MasterReceiverAutoSusp = SPI_MASTER_RX_AUTOSUSP_DISABLE;
  g_hSpi2.Init.MasterReceiverAutoSusp = SPI_MASTER_RX_AUTOSUSP_ENABLE;
  g_hSpi2.Init.IOSwap = SPI_IO_SWAP_DISABLE;
*/
  g_hSpi2.Init.MasterKeepIOState = SPI_MASTER_KEEP_IO_STATE_ENABLE;  // Recommanded setting
                                                                                                                                          // to  avoid glitches
  
  if(HAL_SPI_Init((SPI_HandleTypeDef*)&g_hSpi2) != HAL_OK)
    return 0;
  
  return 1;
}

void HAL_SPI_MspInit(SPI_HandleTypeDef *hspi)
{
  GPIO_InitTypeDef  GPIO_InitStruct;

  if (hspi->Instance == SPIx)
  {
    /*##-1- Enable peripherals and GPIO Clocks #################################*/
    /* Enable GPIO TX/RX clock */
    SPIx_SCK_GPIO_CLK_ENABLE();
    SPIx_MISO_GPIO_CLK_ENABLE();
    SPIx_MOSI_GPIO_CLK_ENABLE();
    
#ifdef SPI2_DMA
    DMAx_CLK_ENABLE();
#endif
    
    /* Enable SPI clock */
    SPIx_CLK_ENABLE();

    /*##-2- Configure peripheral GPIO ##########################################*/
    GPIO_InitStruct.Mode      = GPIO_MODE_AF_PP;
    GPIO_InitStruct.Pull      = GPIO_PULLDOWN;
    GPIO_InitStruct.Speed     = GPIO_SPEED_FREQ_HIGH;

    /* SPI SCK GPIO pin configuration  */    
    GPIO_InitStruct.Pin       = SPIx_SCK_PIN;
    GPIO_InitStruct.Alternate = SPIx_SCK_AF;
    HAL_GPIO_Init(SPIx_SCK_GPIO_PORT, &GPIO_InitStruct);

    /* SPI MISO GPIO pin configuration  */
    GPIO_InitStruct.Pin = SPIx_MISO_PIN;
    GPIO_InitStruct.Alternate = SPIx_MISO_AF;
    HAL_GPIO_Init(SPIx_MISO_GPIO_PORT, &GPIO_InitStruct);

    /* SPI MOSI GPIO pin configuration  */
    GPIO_InitStruct.Pin = SPIx_MOSI_PIN;
    GPIO_InitStruct.Alternate = SPIx_MOSI_AF;
    HAL_GPIO_Init(SPIx_MOSI_GPIO_PORT, &GPIO_InitStruct);

    /* SPI NSS GPIO pin configuration  */
    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
    GPIO_InitStruct.Pull = GPIO_NOPULL;
    GPIO_InitStruct.Pin = SPIx_NSS_PIN;
    GPIO_InitStruct.Alternate = SPIx_NSS_AF;
    GPIO_InitStruct.Speed     = GPIO_SPEED_FREQ_LOW;
    HAL_GPIO_Init(SPIx_NSS_GPIO_PORT, &GPIO_InitStruct);
    
    HAL_GPIO_WritePin(SPIx_NSS_GPIO_PORT, SPIx_NSS_PIN, GPIO_PIN_RESET); // SPI NSS
    
#ifdef SPI2_DMA
    // Spi2 tx dma setting
    g_hDmaSpi2_tx.Instance = SPIx_TX_DMA_STREAM;
    g_hDmaSpi2_tx.Init.Request = SPIx_TX_DMA_REQUEST;
    g_hDmaSpi2_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;
    g_hDmaSpi2_tx.Init.FIFOMode = DMA_FIFOMODE_ENABLE;
    g_hDmaSpi2_tx.Init.FIFOThreshold = DMA_FIFO_THRESHOLD_FULL;
    g_hDmaSpi2_tx.Init.MemBurst = DMA_MBURST_SINGLE;
    g_hDmaSpi2_tx.Init.PeriphBurst = DMA_MBURST_SINGLE;
    g_hDmaSpi2_tx.Init.PeriphInc = DMA_PINC_DISABLE;
    g_hDmaSpi2_tx.Init.MemInc = DMA_MINC_ENABLE; 
    g_hDmaSpi2_tx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;
    g_hDmaSpi2_tx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;
    g_hDmaSpi2_tx.Init.Mode = DMA_NORMAL;
    //g_hDmaSpi2_tx.Init.Priority = DMA_PRIORITY_LOW;
    g_hDmaSpi2_tx.Init.Priority = DMA_PRIORITY_MEDIUM;
   
    if(HAL_DMA_Init(&g_hDmaSpi2_tx) != HAL_OK)
    {
      return;
    }

    __HAL_LINKDMA(hspi, hdmatx, g_hDmaSpi2_tx);
    
    // Spi2 rx dma setting
    g_hDmaSpi2_rx.Instance = SPIx_RX_DMA_STREAM;
    g_hDmaSpi2_rx.Init.Request = SPIx_RX_DMA_REQUEST;
    g_hDmaSpi2_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;
    g_hDmaSpi2_rx.Init.FIFOMode = DMA_FIFOMODE_ENABLE;
    g_hDmaSpi2_rx.Init.FIFOThreshold = DMA_FIFO_THRESHOLD_FULL;
    g_hDmaSpi2_rx.Init.MemBurst = DMA_MBURST_SINGLE;
    g_hDmaSpi2_rx.Init.PeriphBurst = DMA_MBURST_SINGLE;
    g_hDmaSpi2_rx.Init.PeriphInc = DMA_PINC_DISABLE;
    g_hDmaSpi2_rx.Init.MemInc = DMA_MINC_ENABLE;
    g_hDmaSpi2_rx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;
    g_hDmaSpi2_rx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;
    g_hDmaSpi2_rx.Init.Mode = DMA_NORMAL;
    g_hDmaSpi2_rx.Init.Priority = DMA_PRIORITY_HIGH;
    
    if(HAL_DMA_Init(&g_hDmaSpi2_rx) != HAL_OK)
    {
      return;
    }
    __HAL_LINKDMA(hspi, hdmarx, g_hDmaSpi2_rx);
#endif
   
    /*##-3- Configure the NVIC for SPI #########################################*/
    /* NVIC for SPI */
    HAL_NVIC_SetPriority(SPIx_IRQn, 1, 0);
    HAL_NVIC_EnableIRQ(SPIx_IRQn);
    
#ifdef SPI2_DMA
    HAL_NVIC_SetPriority(SPIx_DMA_TX_IRQn, 1, 0);
    HAL_NVIC_EnableIRQ(SPIx_DMA_TX_IRQn);
    
    //HAL_NVIC_SetPriority(SPIx_DMA_RX_IRQn, 1, 0);
    //HAL_NVIC_EnableIRQ(SPIx_DMA_RX_IRQn);
#endif
  }
}

?ÂÃ«ÂÂ??Wiznet Ã¬Â´ÂÃªÂ¸Â°??Ã«Â°??ÂµÃ¬ÂÂ  ?Â¨Ã¬ÂÂ?ÂÃ«ÂÂ??

int Init_W5500(void)
{
  wizchip_deselect();
  
  // register callback funtions
  {
    reg_wizchip_cs_cbfunc(wizchip_select, wizchip_deselect);
    
    reg_wizchip_spi_cbfunc(wizchip_read, wizchip_write);
    
    reg_wizchip_spiburst_cbfunc(wizchip_burst_read, wizchip_burst_write);
  }
  
  // wizchip initialize
  uint8_t tmp;
  intr_kind temp;
  //uint8_t memsize[2][8] = { {2,2,2,2,2,2,2,2}, {2,2,2,2,2,2,2,2} };
  uint8_t memsize[2][8] = { {8,8,0,0,0,0,0,0}, {8,8,0,0,0,0,0,0} };
  //uint8_t memsize[2][8] = { {16,0,0,0,0,0,0,0}, {8,0,0,0,0,0,0,0} };
  
  //wiz_PhyConf PhyConfigInfo;
  
  temp = IK_DEST_UNREACH;
  
  if(ctlwizchip(CW_INIT_WIZCHIP, (void*)memsize) == -1)
    return 0;
  
  if(ctlwizchip(CW_SET_INTRMASK, &temp) == -1)
  {
    //printf(""W5500 interrupt\r\n"");
    return 0;
  }
  
  do {
    if(ctlwizchip(CW_GET_PHYLINK, (void*)&tmp) == -1)
      return 0;
  }while(tmp == PHY_LINK_OFF);
  
  return 1;
}

static void wizchip_select(void)
{
  HAL_GPIO_WritePin(SPIx_NSS_GPIO_PORT, SPIx_NSS_PIN, GPIO_PIN_RESET);
}

static void wizchip_deselect(void)
{
  HAL_GPIO_WritePin(SPIx_NSS_GPIO_PORT, SPIx_NSS_PIN, GPIO_PIN_SET);
}

static uint8_t wizchip_rw(uint8_t byte)
{
  uint8_t iReadByte = 0x00;
  HAL_SPI_TransmitReceive(&g_hSpi2, &byte, &iReadByte, 1, 10);
  return iReadByte;
}

static uint8_t wizchip_read(void)
{
  return wizchip_rw(0xff);
}

static void wizchip_write(uint8_t wb)
{
  wizchip_rw(wb);
}

static void wizchip_burst_write(uint8_t *pData, uint16_t len)
{
#ifdef SPI2_DMA
  memcpy(g_aSpiSendBuf, pData, len);
  
  //SCB_CleanDCache_by_Addr((uint32_t*)g_aSpiSendBuf, len);
  
  g_aSpiDmaCplt[0] = 0;
  
  HAL_SPI_Transmit_DMA(&g_hSpi2, g_aSpiSendBuf, len);
  //HAL_SPI_TransmitReceive_DMA(&g_hSpi2, g_aSpiSendBuf, g_aSpiRecvBuf, len);

  while(1) // DMA TX ?ÂÃ«Â£Â ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ÃªÂ°? ?ÂÃ¬ÂÂ ?Â Ã«ÂÂÃªÂ¹ÂÃ¬? ??ÃªÂ¸?
  {
    if(g_aSpiDmaCplt[0] == 1)
      break;
  }
  
#else
  HAL_SPI_Transmit(&g_hSpi2, pData, len, 1000);
#endif
}

static void wizchip_burst_read(uint8_t *pData, uint16_t len)
{
#ifdef SPI2_DMA  
  g_aSpiDmaCplt[1] = 0;
  
  //SCB_CleanDCache_by_Addr((uint32_t*)g_aSpiRecvBuf, len);
  
  HAL_SPI_TransmitReceive_DMA(&g_hSpi2, g_aSpiSendBuf, g_aSpiRecvBuf, len);
  
  while(1) // DMA RX ?ÂÃ«Â£Â ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ÃªÂ°? ?ÂÃ¬ÂÂ ?Â Ã«ÂÂÃªÂ¹ÂÃ¬? ??ÃªÂ¸?
  {
    if(g_aSpiDmaCplt[1] == 1)
      break;
  }
  
//  SCB_InvalidateDCache_by_Addr((uint32_t*)g_aSpiRecvBuf, len);
  
  memcpy(pData, g_aSpiRecvBuf, len);
  
#else
  uint8_t aTmpBuf[8192];
  HAL_SPI_TransmitReceive(&g_hSpi2, aTmpBuf, pData, len, 1000);
#endif
} Hello,
I have same issue with STM32H723. I found some fixes for DMA memory address. 

DMA can't access everywhere on memory so I think we should re-locate dma variables on memory.","Q) I have same issue with STM32H723. I found some fixes for DMA memory address. DMA can't access everywhere on memory so I think we should re-locate dma variables on memory.
A) It seems like you are encountering issues related to DMA memory access with STM32H723. You are on the right track by considering re-locating DMA variables in memory to address this. Are you looking for suggestions on how to re-locate the DMA variables effectively on memory?"
3036,5206,"Hello,

I'm using the WIZ550SR Module to exchange data between a PC and multiple microcontrollers (each with it's own WIZ550SR in server mode).

The communication and everything else works fine, however I have an issue with the received data (from PC to microcontroller via the module), if the data is sent with small time gap between.

If the gap between the messages is >200ms everything is fine. The module sends the data every 200ms.
However the minimal gap between the data from PC to the module ist about 15-20ms. The data contains 3-5 Bytes.
The module is not sending the data right away. The data seems to be buffered and is sent out every 200ms.
Since the microcontroller has to react according to the data received (at a certain time), there is a chance that the microcontroller hasn't received the data but has to trigger some outputs according to the data.

Is there any setting I can change to prevent the module to buffer the data and transmit it imidiatly? Or at least reduce this buffer time? Dear, PKalen

Both serial to ethernet and ethernet to serial process data by polling. In other words, data is delivered immediately. The cause of delay can occur when searching for AT command trigger code or when packing data. Disable At Command. And please do not use packing condition. Dear, PKalen

As mentioned earlier, it polls the serial data and sends it to Ethernet. If the interval for sending serial data is short, serial data will continue to be generated while the module receives some serial data and sends it to Ethernet. This is the limit of the module. So we provide a function called serial data packing. If the serial you send has a certain rule, use that function. More information can be found at the link below.

https://wizwiki.net/wiki/doku.php?id=products:wiz550sr:wiz550sr_userguide_en

> Packing Conditions
> 
> Normally, data received from UART are sent to Ethernet immediately. But in many cases, users want to send data as a chunk of the whole frame without separated ones. This option is for packetizing data into one frame.
> Time (0 ~ 65535 ms, ???? Function Disable) : 
>     This field is for specifying time value (in ms) to judge whether one frame 
>     is received totally. If the time specified in this field is expired 
>     after receiving one byte, then WIZ550SR notice one data frame is finished, 
>     make an Ethernet packet with all data in its serial buffer and send it to 
>     the peer system via Ethernet. 
>     If WIZ550SR receives another byte from UART before the specified time is expired, 
>     it restart timer and add the received one to the end of serial data buffer.
> Size (0 ~ 255 byte, ???? Function Disable) : 
>     This field is for specifying size value to judge whether one frame is 
>     received totally. If the size specified in this field is received, then WIZ550SR 
>     notice one data frame is finished, make an Ethernet packet with specifying size's 
>     data in its serial buffer and send it to the peer system via Ethernet.       
> Char : 
>     This field is for specifying delimiter value to judge whether one frame is 
>     received totally. Char delimiters can be set up to 4 bytes in HEX and valid 
>     character count is decided according to the value in Length field. In case the 
>     value of Length field is '0', this option becomes inactivated. 
>     Appendix is another option for this. If user selects any value in Appendix field,
>     WIZ550SR make an ethernet packet with all received data by Char delimiter and 
>     next bytes in counts, which designated by Appendix field. 
>     When Appendix is set with any value, not '0', even though WIZ550SR received Char 
>     delimiters, it will wait until it receives next data.

Your attempt to set and test the size to 2 is correct. Currently, there seems to be no other way. Hello Ricky,

again, thank you for your time helping me out.

I tried a lot of different settings:
- limit the size to 2
- adding delimiters
- used a time limit
- combinations from above
with no changes...

The description of the packing conditions mentions UART to Ethernet all the time. But is this valid for the data the other direction (Ethernet to UART)?
Because I have this issue from Ethernet to UART, if I send data continiously from my PC (Client) to the Module (Server) every <200ms it does that buffering. Hello Ricky,


I got myself a WIZ850io, hooked it up to a STM32 NUCLEO board and 
built my own TCP(server) to UART application to test the issue.
I used the ioLibrary (w550.c/h, socket.c/h and wizchip_conf.c/h).

First I had the same behavior. Everything send to the w5500 with less than 200ms
wouldn't be send immidiatly.
I then searched anything indicating to that delay.
There is a define _RTR_ in the w5500 header. The description says:

""And so the default timeout period is 200ms(100us X 2000). During the time configured by @ref _RTR_, W5500 waits for the peer response
to the packet that is transmitted by \ref Sn_CR (CONNECT, DISCON, CLOSE, SEND, SEND_MAC, SEND_KEEP command).""

If a socket has been opend, this timeout period will be used all the time. Except if the socket 
is opened with ""SF_TCP_NODELAY"" as the socket flag parameter of the socket() function.

Checking the source code of the WIZ550SR the socked gets opend whith:
socket(sock, Sn_MR_TCP, net->local_port, SF_IO_NONBLOCK);
Therefor the timeout period is used.
Since I can measure the 200ms timeout I guess the WIZ550SR does not chnage the _RTR_ value?!

With my test setup, before opening the socket with SF_NON_BLOCKING flag I set the timeout to 1 (=100ÃÂ¼s).
The data will be sent out immidiatly (almost, 100ÃÂ¼s delay is still there).
Changing the open socked parameters to (..., ""SF_TCP_NODELAY"") without changeing the _RTR_ value, 
data will be send immidiatly. However the socket is no more non-blocking.

I'm not sure what will be the best setting for me (have to test this).
Since the socket open is hard-coded with SF_NON_BLOCKING, there is no option to change it to SF_TCP_NODELAY without changes to the firmware.
But is there a way to change the _RTR_ value without changeing the firmware of the WIZ550SR? Dear, PKalen

> is there a way to change the RTR value without changeing the firmware of the WIZ550SR?

no. There is not. The firmware needs to be changed.

As mentioned earlier, Both serial to ethernet and ethernet to serial process data by polling. data is delivered immediately. The speed of polling depends on processor capabilities.

I think the SF_TCP_NODELAY, RTR, RCR are not related to this problem. However, I will provide the changed firmware if necessary for your test. Hello Ricky,

if you could change the opening socket with SF_TCP_NODELAY so I can test it. This would be very helpful. Hello Ricky,

thank you for the firmware.
I don't know if I have the time to test it this week. However I will notify you with the results. Hello Ricky,

I flashed the module with your firmware.
After that the modul isn't doing anything. No green led blinking, nor any reply from both serial interfaces.
Can I simply programm your binary with the ST tool? I did this with several moduls and firmware 1.1.7 and didn't have any issue.","Q) Is there any setting I can change to prevent the module from buffering the data and transmit it immediately?
A) Both serial to ethernet and ethernet to serial process data by polling. In other words, data is delivered immediately. The cause of delay can occur when searching for AT command trigger code or when packing data. Disable At Command. And please do not use packing condition. 

Q) The description of the packing conditions mentions UART to Ethernet all the time. But is this valid for the data the other direction (Ethernet to UART)? Because I have this issue from Ethernet to UART, if I send data continuously from my PC (Client) to the Module (Server) every <200ms, it does that buffering.
A) As mentioned earlier, it polls the serial data and sends it to Ethernet. If the interval for sending serial data is short, serial data will continue to be generated while the module receives some serial data and sends it to Ethernet. This is the limit of the module. So we provide a function called serial data packing. If the serial you send has a certain rule, use that function. More information can be found at the link below.

Q) Hello Ricky, I got myself a WIZ850io, hooked it up to a STM32 NUCLEO board and built my own TCP(server) to UART application to test the issue. I used the ioLibrary (w550.c/h, socket.c/h and wizchip_conf.c/h). First I had the same behavior. Everything sent to the w5500 with less than 200ms wouldn't be sent immediately. I tested various settings, but there were no changes. Is there a way to change the _RTR_ value without changing the firmware of the WIZ550SR?
A) No. There is not. The firmware needs to be changed.

Q) Hello Ricky, if you could change the opening socket with SF_TCP_NODELAY so I can test it. This would be very helpful.
A) I think the SF_TCP_NODELAY, RTR, RCR are not related to this problem. However, I will provide the changed firmware if necessary for your test.

Q) Hello Ricky, I flashed the module with your firmware. After that the module isn't doing anything. No green led blinking, nor any reply from both serial interfaces. Can I simply program your binary with the ST tool?
A) Your attempt to set and test the size to 2 is correct. Currently, there seems to be no other way."
3037,5207,"Hi,

All sockets on my W5300 are initialized as non-alignment TCP mode.
I found one issue with my board  that, every 1000 packets (approximately), the leading two bytes I read from W5300 FIFO seem not the correct packet length. These two bytes should be a part of the normal packet, so I guess the expected packet length are missed or ignored somehow by W5300.
When this happens at the middle or close to the end of transaction, the application of the peer device has to re-send the whole data stream. 

I am still checking to see if this error is caused by my own source code. But I appreciate if anybody can tell me if similar phenomenon encountered before or it is a known issue. 

Thanks! Hello,

What does it mean that the packet length of two bytes is not correct
Does the difference between the packet you sent and the packet received on the W5300 differ by two bytes?
Or is the length of the packet read incorrectly?","Q) What does it mean that the packet length of two bytes is not correct? Does the difference between the packet you sent and the packet received on the W5300 differ by two bytes? Or is the length of the packet read incorrectly?
A) The issue of the leading two bytes not being the correct packet length suggests that the expected packet length is missed or ignored by the W5300. This can cause the application of the peer device to have to re-send the whole data stream when it occurs at the middle or close to the end of the transaction. It is being investigated to see if this error is caused by the source code, and any insight or prior encounters with a similar phenomenon would be appreciated."
3038,521,"Hello everybody,

I have a problem with mit w5100.
I want to send a byte array look like this [code]uint8_t data[8] = {0x62, 0xC8, 0x03, 0xC8, 0x00, 0x43, 0xC8, 0x00};[/code]
And now there is the problem, when I send this array the first 4 bytes were send, but after 0x00 all position wont be send.
Do I have to escape this 0x00?

Does anyone know how I can fix the problem?  :unamused: 

greetings Hi oadna, 

W5100 can send a zero (0x00).  :smiley: 

Please, check data length, data copy or updating Sn_TX_WR in your code.

Reference Code is [url]http://www.wiznet.co.kr/sub_modules/kr/product/product_detail.asp?Refid=677&page=1&cate1=5&cate2=7&cate3=26&pid=1019&cType=2[/url].

[code]
uint16 send(
  SOCKET s,     /**< the socket index */
  const uint8 * buf,  /**< a pointer to data */
  uint16 len    /**< the data size to be send */
  )
{
  uint8 status=0;
  uint16 ret=0;
  uint16 freesize=0;

   if (len > getIINCHIP_TxMAX(s)) ret = getIINCHIP_TxMAX(s); // check size not to exceed MAX size.
   else ret = len;

   // if freebuf is available, start.
  do
  {
    freesize = getSn_TX_FSR(s);
    status = IINCHIP_READ(Sn_SR(s));
    if ((status != SOCK_ESTABLISHED) && (status != SOCK_CLOSE_WAIT))
    {
      ret = 0;
      break;
    }
  } while (freesize < ret);

  // copy data
  send_data_processing(s, (uint8 *)buf, ret);
  IINCHIP_WRITE(Sn_CR(s),Sn_CR_SEND);

  /* +20071122[chungs]:wait to process the command... */
  while( IINCHIP_READ(Sn_CR(s)) )
    ;
  /* ------- */

#ifdef __DEF_IINCHIP_INT__
  while ( (getISR(s) & Sn_IR_SEND_OK) != Sn_IR_SEND_OK )
#else
  while ( (IINCHIP_READ(Sn_IR(s)) & Sn_IR_SEND_OK) != Sn_IR_SEND_OK )
#endif
  {
    /* m2008.01 [bj] : reduce code */
    if ( IINCHIP_READ(Sn_SR(s)) == SOCK_CLOSED )
    {
#ifdef __DEF_IINCHIP_DBG__
      printf(""SOCK_CLOSED.\r\n"");
#endif
      close(s);
      return 0;
    }
    }
#ifdef __DEF_IINCHIP_INT__
    putISR(s, getISR(s) & (~Sn_IR_SEND_OK));
#else
  IINCHIP_WRITE(Sn_IR(s), Sn_IR_SEND_OK);
#endif
    return ret;
}

void send_data_processing(SOCKET s, uint8 *data, uint16 len)
{
	uint16 ptr;

        /* read Sn_TX_WritePointer */
	ptr = IINCHIP_READ(Sn_TX_WR0(s));
	ptr = ((ptr & 0x00ff) << 8) + IINCHIP_READ(Sn_TX_WR0(s) + 1);

	write_data(s, data, (uint8 *)(ptr), len);
	ptr += len;
        /* update Sn_TX_WritePointer */
	IINCHIP_WRITE(Sn_TX_WR0(s),(uint8)((ptr & 0xff00) >> 8));
	IINCHIP_WRITE((Sn_TX_WR0(s) + 1),(uint8)(ptr & 0x00ff));
}

[/code] 
Thanks he, thanks for your reply.

I have tried it again and again, but it doesn`t work.
When i remove the 0x00 from the array, the whole array will be sent.
This is so crazy.

greets Hi oadna, 

We may find the error. :0
-----------------------------------------------------------------------------------------------
strlen
size_t strlen ( const char * str );
Get string length
Returns the length of the C string str.

The length of a C string is determined by the terminating [b]null-character[/b]
-----------------------------------------------------------------------------------------------
So, your code should be change, as below
- replace 'strlen' to 'sizeof'
- input data length directly

[code]
/* your code */
uint8_t data[8] = {0x62, 0xC8, 0x03, 0xC8, 0x00, 0x43, 0xC8, 0x00};
uint8_t end[2];
sprintf((char *) end, ""\n\r"");
if (send(sockreg,data,strlen((char *)data)) <= 0) break; //send data  <= here
printf((char *)data);
_delay_ms(100);
if (send(sockreg,end,strlen((char *)end)) <= 0) break; //send end   <= here
_delay_ms(1000);

/*fix code*/
//if (send(sockreg,data,  sizeof((char *)data)) <= 0) break; //send data
if (send(sockreg,data,  8)) <= 0) break; //send data
printf((char *)data);
_delay_ms(100);
//if (send(sockreg,end, sizeof((char *)end)) <= 0) break; //send end
if (send(sockreg,end, 2)) <= 0) break; //send end
_delay_ms(1000);

[/code]

Thanks
Thanks, hi suhwan,

You helped me so much, thank you a lot.
Now my thesis is save. :smiley:

greets","Q) Do I have to escape this 0x00?
A) W5100 can send a zero (0x00). Please, check data length, data copy or updating Sn_TX_WR in your code. 

Q) Does anyone know how I can fix the problem?
A) We may find the error. The length of a C string is determined by the terminating null-character. So, your code should be changed to replace 'strlen' with 'sizeof' and input data length directly. 

Q) Thanks he, thanks for your reply.
A) You helped me so much, thank you a lot. Now my thesis is saved."
3039,5212,"My first attempt at reading the RX buffer, on receipt of a UDP packet, showed that the second octed received was at the address of the first. I worked around this by taking 1 from the calulated address and was able to receive a UDP datagram payload as shown on page 69 of the manual.

Having added the offset correction, every other datagram was now incorrect, being out by one the other way around. I have managed to read expected data by adding the offset to every alternate datagram received.

The read code posted below:
    > //--------------------------------------------------------------------------------------------------------------------------
    > short WIZ_NewRX(int8 Skt){
    > // 02 NOV 2018 - Returns true when data waiting to be fetched
    >    int16 SktOS;		// Register offset for socket
    > 
    > // Begin Here
    >    SktOS = 0x0100 * Skt;			
    >    WIZa_ToGoRXQ = _WIZ_Get16(WIZ_REG_RX_SZ + SktOS);	// Anything in the buffer
    >    return (WIZa_ToGoRXQ > 0);				                               // Just the status
    > 
    > }// End NewRX
    > //--------------------------------------------------------------------------------------------------------------------------
    > void WIZ_GetRX(int8 Skt){
    > // 05 NOV 2018 - Testing theory of updateing the read pointer to change queue size, appears to work.
    >    int16 SktOS;			// Register offset for socket
    >    int16 RecOS;			// RX Buffer head offset
    >    int16 BufRX = 0x06000;	// Base address of RX Buffers, less 1 for a reason yet to be determined
    >    int16 AdrRX;			// Calculated read address, offset from start of buffer
    >    int8  Comd = 0x40;		//
    >    **static short Alt = TRUE;	// Testing theory that every alternate read is off by one**
    > 
    > // Begin Here
    >    SktOS =  (0x0100 * Skt);				//
    >    BufRX += (0x0800 * Skt);				// Address spave for buffer 
    >    WIZ_PIN_CS = 0;					// Chip Select   
    >    // - - - - - - - - - - - - - - - - - - - - -	- -	// Figure out address from offset
    >    RecOS = _WIZ_Get16(WIZ_REG_RX_RD + SktOS);		// Where to start reading from
    > // RecOS = 0;						// Testing **************************
    >    AdrRX = BufRX | RecOS;				// Offset from start of Socket buffer
    >    **if (Alt)AdrRX--; Alt = !Alt;**			// ******************************
    >    _WIZ_GoTo(AdrRX);			  	 // Set to address
    >    // - - - - - - - - - - - - - - - - - - - - - - - 	         // 
    >    while(WIZa_ToGoRXQ--){			// All the while there is data to process
    >       if(RecOS > 0x07FF){				// Time to circulate buffer
    >          RecOS = 0;				               	// Restart
    >          _WIZ_GoTo(BufRX);				//
    > 							                       //
    >       }//End If						      //
    >       NET_Accept(Skt, _WIZ_Get08());    //
    >       RecOS++;						 // Match pointer
    > 							                       //
    >    }//End While					      //
    >    // - - - - - - - - - - - - - - - - - - - - - - -	      //
    >    _WIZ_Put16(RecOS,WIZ_REG_RX_RD + SktOS); 		// Update the pointer 
    >    _WIZ_Put08(Comd, WIZ_REG_SX_CR + SktOS);		// 
    >     for(;;){						                                                // Till the above set command is cleared
    >        Comd = _WIZ_Get08(WIZ_REG_SX_CR + SktOS);	//
    >        if (!bit_test(Comd, 6)) break;			                       //
    > 							                                                       //
    >    }//End For						                                       //
    >    WIZ_PIN_CS = 1;			                                	       // Chip UnSelect
    > 
    > }//End GetRX

Has any one seen anything similar? The Datagram payload length is 17 octets. 
I will try sending different length datagrams to see if there is a boundry issue with the silicon. Hmmm. Stranger still.

If a UDP datagram with an even number of octets is received, then I'm always subtracting 1 from the real address to access the correct RX buffer data. With UDP datagrams with an odd number of Octest, the -1 offset is only applied alternately to read the correct data from the socket RX buffer.

Now looking to see if I can work the correct offset out from the RX Write pointer less the RX buffer size.
Will update again with anything new learned. [quote=""Hamish, post:2, topic:5212, full:true""]
Hmmm. Stranger still.

If a UDP datagram with an even number of octets is received, then I?Âm always subtracting 1 from the real address to access the correct RX buffer data. With UDP datagrams with an odd number of Octest, the -1 offset is only applied alternately to read the correct data from the socket RX buffer.

Now looking to see if I can work the correct offset out from the RX Write pointer less the RX buffer size.
Will update again with anything new learned.
[/quote]

There are not enough information about c function like _WIZ_GoTo(), NET_Accept, etc.
But, I guess this part occurs problem.
-----------------------------------------------------------------------------------------------
if(RecOS &gt; 0x07FF){ // Time to circulate buffer
 RecOS = 0; // Restart
 _WIZ_GoTo(BufRX); //
 //
 }//End If //
--------------------------------------------------------------------------------------------------
if you set the socket# rx memory size to 2KB, you should not read data over 2KB.
And RecOS has 16-bit data. It can not be limited to less than 0x800.
Therefore, you should not set the rx memory address to the base address (BufRX) even if RecOS is greater than 0x0800.

WIZnet supports a example code at the below site.
https://wizwiki.net/wiki/doku.php?id=products:w5100s:driver_temp

We can support you easier, when you use our example code(ioLibrary_Driver).
If the problem will not be solved, we need more information about your source code.

I hope your problem will be solved. If not, please leave reply.

thanks. [quote=""dkay, post:3, topic:5212""]
## There are not enough information about c function like _WIZ_GoTo(), NET_Accept, etc.
But, I guess this part occurs problem.
[/quote]
    void _WIZ_GoTo(int16 Addr){
    // 22 OCT 2018 - Common to Read and Write operations


    // Begin Here
    // WIZ_PIN_CS = 0;			// Chip Select
       TRISA = 0x00;			// Write Mode
       WIZ_PIN_A0 = 1;			// Address 0
       WIZ_PIN_A1 = 0;			// Address 1
       LATA = make8(Addr, 1);		// Address High Byte
       WIZ_PIN_WR = 0;			//
       delay_cycles(4);			// 4 * 6.25nS & 16MHz * 4 = 25ns
       WIZ_PIN_WR = 1;			//
       WIZ_PIN_A0 = 0;			// Address 0
       WIZ_PIN_A1 = 1;			// Address 1
       LATA = make8(Addr, 0);		// Address Low Byte
       WIZ_PIN_WR = 0;			//
       delay_cycles(4);			// 4 * 6.25nS & 16MHz * 4 = 25ns
       WIZ_PIN_WR = 1;			// End of second write
       WIZ_PIN_A0 = 1;			// Address := 3
    // WIZa_NewAddr = TRUE;			// Global State

    }//End
The NET_Accpet is the datagram processing function.
[quote=""dkay, post:3, topic:5212""]
## if(RecOS &gt; 0x07FF){ // Time to circulate buffer
RecOS = 0; // Restart
_WIZ_GoTo(BufRX); //
//
}//End If //

if you set the socket# rx memory size to 2KB, you should not read data over 2KB.
And RecOS has 16-bit data. It can not be limited to less than 0x800.
Therefore, you should not set the rx memory address to the base address (BufRX) even if RecOS is greater than 0x0800.
[/quote]
This I am aware of, however, I have not yet managed to receive much beyond 1K without hitting issues.
[quote=""dkay, post:3, topic:5212""]
WIZnet supports a example code at the below site.
https://wizwiki.net/wiki/doku.php?id=products:w5100s:driver_temp
[/quote]
I have looked at this Atmel code. My implimentation uses a Microchip PIC18...

Since my last post, I have identified more strange things, when updating socket RX_RD pointer, reading back the value does not allways return the value written, and in some cases when it was previously something like 32, it may then read zero.
In relation to this, reading the socket buffer size may then also still be at the value is was prior to the read causing a continual read loop. Sending another datagarm to the WIZchip will then clear / change this value,
so I am not inclined to believe that there is an issue with reading the register.

For any one interested, I have also determined that reading one more octet from a socket RX buffer than reported by the socket RX_SZ register will override any value written to the RX buffer Read pointer and then report an RX_SZ buffer read size of 2047 bytes/octets. That is not explained in the manual... Hi all.

I have discovered something that may be useful to others, related to my last post.
If, when reading in a datagram from the RX buffer, data should then be written to the TX buffer in response,
be aware that moving the last read/write address pointer before completeing the RX cycle and calling RECV
may break setting the RX_RD socket pointer write. This in turn has the effect of not resetting the socket RX Size register, giving the impression that a new datagram has been received.

My advice, therefor, is to to ensure mutual exclusion of receive and send routines.

This point about reading the entire content of the RX buffer and then setting the RX_RD offset pointer
without interleave could be explained in the user manual or errata, if there be such a thing...","Q) Has anyone seen anything similar? The Datagram payload length is 17 octets. I will try sending different length datagrams to see if there is a boundary issue with the silicon. Hmmm. Stranger still.
A) There are not enough information about c function like _WIZ_GoTo(), NET_Accept, etc.
But, I guess this part occurs a problem.

Q) Now looking to see if I can work the correct offset out from the RX Write pointer less the RX buffer size. Will update again with anything new learned.
A) There are not enough information about c function like _WIZ_GoTo(), NET_Accept, etc.
But, I guess this part occurs a problem.

Q) If a UDP datagram with an even number of octets is received, then I'm always subtracting 1 from the real address to access the correct RX buffer data. With UDP datagrams with an odd number of Octest, the -1 offset is only applied alternately to read the correct data from the socket RX buffer.
A) WIZnet supports an example code at the below site.
https://wizwiki.net/wiki/doku.php?id=products:w5100s:driver_temp

Q) Hmmm. Stranger still.
A) WIZnet supports an example code at the below site.
https://wizwiki.net/wiki/doku.php?id=products:w5100s:driver_temp

Q) If a UDP datagram with an even number of octets is received, then I'm always subtracting 1 from the real address to access the correct RX buffer data. With UDP datagrams with an odd number of Octest, the -1 offset is only applied alternately to read the correct data from the socket RX buffer. Now looking to see if I can work the correct offset out from the RX Write pointer less the RX buffer size. Will update again with anything new learned.
A) There are not enough information about c function like _WIZ_GoTo(), NET_Accept, etc.
But, I guess this part occurs a problem.

Q) For anyone interested, I have also determined that reading one more octet from a socket RX buffer than reported by the socket RX_SZ register will override any value written to the RX buffer Read pointer and then report an RX_SZ buffer read size of 2047 bytes/octets. That is not explained in the manual... Hi all.
A) For anyone interested, I have also determined that reading one more octet from a socket RX buffer than reported by the socket RX_SZ register will override any value written to the RX buffer Read pointer and then report an RX_SZ buffer read size of 2047 bytes/octets. That is not explained in the manual...

Q) My advice, therefore, is to ensure mutual exclusion of receive and send routines. This point about reading the entire content of the RX buffer and then setting the RX_RD offset pointer without interleave could be explained in the user manual or errata, if there be such a thing...
A) My advice, therefore, is to ensure mutual exclusion of receive and send routines. This point about reading the entire content of the RX buffer and then setting the RX_RD offset pointer without interleave could be explained in the user manual or errata, if there be such a thing..."
3040,5213,"Hello WIZNet Community:
We are using the WIZ550io SPI <-> Ethernet module interfacing with the NetBurner(tm) MOD5541X module.  Pretty much successfully implemented and working nicely - mostly...

The WIZ550io is set up as a server to interface with a laptop as a diagostic tool for our system.  A main function is to download, from the NetNurner to the laptop up to megabytes of data, in 2000 byte blocks.  Wireshark shows the following interchange for transaction of one block:
    WIZ550io (Server):                                            Laptop (Client)
1)                                                     <-------                Request for next packet [PSH, ACK]  Len = 2
2)  [ACK]                                         -------->                                                                                Len = 0
3)  [TCP Window Update]            -------->                                                                                Len = 0
4)  1st data segment [PSH, ACK] ------>                                                                                Len = 1460
5)  2nd data segment [PSH, ACK] ------>                                                                               Len = 546
6)                                                     <--------              [ACK]                                                        Len = 0
7)                                                     <-------                Request for next packet [PSH, ACK]  Len = 2 ....

So the problem is the [TCP Window Update], which supposedly serves to negotiate the ""window size"" field.  Not at all sure why this is even there.

So fIrst, when we do an analysis (via Wireshark) of the SAME FUNCTION, but via one of the NetBurner Ethernet ports, we do NOT see any [TCP Window Update] msgs.  Interesting.  Normally, however, this additional msg from WIZ550io does NOT seem to impeded the data downloads.  

HOWEVER, occasionally, what we see is a ONE SECOND time interval between the [ACK] (msg 3) ) from the WIZ550io and the transmission of the [TCP Window Update] (msg 4) )!!  and this occurs at EVERY sequence, as shown above.  So for 10 MB of data, at 2K/second... do the math, and we're looking at more than an hour!

So this is a problem.

IS there a quick & easy way to tell WIZ550io to NOT try to do any window size negotiation - i.e., just eliminate the sending [TCP Window Update] Messages entirely?  That would be the simplest solution.

Thanks for any help or insight.

Ron (in Pittsburgh Strong) Hello,

[TCP Window Update] Packet is a packet sent because the PC's Window Size is not enough.
If the PC has sufficient Window Size, the W5500 will not send a [TCP Window Update] packet.
So I think that the W5500 sends data without the [TCP Window Update] message, the PC will not receive it and the W5500 will retransmit the data
Anyway, there is no way to disable the [TCP Window Update] packet from being sent.
Thank you Hello Ms. Jeong, and thank you for your quick reply to my question on the WIZnet forum.

Let me explain the situation and our information more clearly.

 First, normally, a TCP receiver (in this case, the WIZnet W5500) sends the [TCP Window Update] message to inform the sender that it now has enough buffer space to receive the next message.  The previous message sent to the WIZnet was a 2-byte message, which should not cause any buffer overflow.

If we run this same application directly to the NetNurner Ethernet port, the message traffic is identical *except for the sending of the [TCP Window Update] message.*  If you wish, I can send WireShark captures of both interactions.

 Please note that the message traffic is synchronized, that is, the application on the WIZnet side (the sender) does NOT send any data to the receiver (the PC) UNTIL the 2-byte message (meaning send next 2000-byte buffer of data) is received.  This directly avoids any overflow of the TCP buffers.

Also, please note that NORMALLY, the additional [TCP Window Update] message does NOT cause a problem in the flow of data.

Our major problem is, that sometimes, the WIZnet W5500 *delays the sending of the [TCP Window Update] for 1 second,* and it does not start sending the data to the receiver until AFTER the [TCP Window Update] message has been sent.  This is a serious problem for us.  I can also send WireShark captures of this if you would like.

 Can you explain why the W5500 would do this 1-second delay for each transmission of the [TCP Window Update] message, and more importantly, what can we do to make sure this doesn?Ât happen?

Thank you again for your attention on this issue.

Ronald Lupish

Siemens Mobility, Inc

MO RC-US MM-MMF PRJ CSEN SW

664 Linden Avenue

East Pittsburgh, PA 15112, USA

Tel.: +1 412 702-1133

mailto:ronald.lupish@siemens.com [quote=""RonPeL, post:3, topic:5213""]
If you wish, I can send WireShark captures of both interactions.
[/quote]

That would be good.

Sounds like you have no-delayed ACK for the socket turned off (disabled). What value socket register Sn_MR is being initialized to?","Q) IS there a quick & easy way to tell WIZ550io to NOT try to do any window size negotiation - i.e., just eliminate the sending [TCP Window Update] Messages entirely? 
A) TCP Window Update Packet is a packet sent because the PC's Window Size is not enough. If the PC has sufficient Window Size, the W5500 will not send a [TCP Window Update] packet. So I think that the W5500 sends data without the [TCP Window Update] message, the PC will not receive it and the W5500 will retransmit the data. Anyway, there is no way to disable the [TCP Window Update] packet from being sent. 

Q) Can you explain why the W5500 would do this 1-second delay for each transmission of the [TCP Window Update] message, and more importantly, what can we do to make sure this doesn’t happen? 
A) Sounds like you have no-delayed ACK for the socket turned off (disabled). What value socket register Sn_MR is being initialized to?"
3041,5216,"Hi
I've found somewhere informtion that it is set indirectly by choosing  RMSR(RX Memory Size Register). So for instance setting RMSR to 0x03 makes RX buffer 8kB size for Socket0. Does it make TCP window size 8kB as well?
Is there any way to set TCP window size directly when w5100 operates as TCP server?

Thanks
Zbigniew Hello,

Setting RMSR to 0x03 makes RX buffer 8KB and Window Size 8KB for Socket 0.
Thanks Thanks a lot for confirmation","Q) Does it make TCP window size 8kB as well? Is there any way to set TCP window size directly when w5100 operates as TCP server?
A) Setting RMSR to 0x03 makes RX buffer 8KB and Window Size 8KB for Socket 0."
3042,522,"Hello, I purchased SR108SR to operate the Confolution program to find Device IP
What I am trying to use is the measurement equipment and the opponent is a PC using RS485.
The SR108 is located on the current PC, and the LAN port is connected to the LAN port on one side and the COM3 on one side is connected to the RS485.
How should I set out if you want to communicate? Serial to Ethernet module plays a role in 'transfers' data input to Serial to Ethernet, or vice versa.

For communication with a PC, first set up the Wiz108sr and PC to have the same private IP band, 2. Assign a certified IP or to configure the IP address from the same IP POOL through the DHCP server such as a router.
(ex> module: 192.168.11.2, PC: 192.168.11.3)

In general, the configuration of the system with the Wiz108sR is as follows.

[PC] ==== LAN (Ethernet) ===== [WIZ108SR] ---------- [User's Device]

or,
[PC] ===== LAN ===== [Router, Herb / Gateway] ===== LAN ===== [WIZ108SR] ---------- [User's Device]

Wiz108sr is located between them, so you can check the serial data of the user equipment on the PC through Ethernet,
In the opposite case, the data from the PC can be delivered to the user equipment side.","Q) How should I set out if you want to communicate? 
A) For communication with a PC, first set up the Wiz108sr and PC to have the same private IP band. Assign a certified IP or configure the IP address from the same IP POOL through the DHCP server such as a router. 

Q) What is the general configuration of the system with the Wiz108sR? 
A) In general, the configuration of the system with the Wiz108sR is to have the PC connected to the WIZ108SR via LAN (Ethernet), and the WIZ108SR connected to the User's Device. This allows for the checking of the serial data of the user equipment on the PC through Ethernet, or the delivery of data from the PC to the user equipment side."
3043,5221,"Hello,

I am working with an arduino mega with W5500 Ethernet Shield (the red one from wiznet).
I am writing a bootloader.

Here is a very basic bootloader:

int main(void)
{
    _delay_ms(500);
  
    // Spi init
    SPI_PORT = _BV(SCK) | _BV(MISO) | _BV(MOSI) | _BV(SS);
    SPI_DDR = _BV(SCK) | _BV(MOSI) | _BV(SS);
    ETH_PORT |= _BV(ETH_SS);
    ETH_DDR |= _BV(ETH_SS);
    SD_PORT |= _BV(SD_SS);
    SD_DDR |= _BV(SD_SS);
    SPSR = (1 << SPI2X);
    
    _delay_ms(500);

    // Network init
    for (int i=0; i<8  ; i++)   // MAX_SOCK_NUM
    {
        uint8_t cntl_byte = (0x0C + (i<<5));
        spiWriteReg(0x1E, cntl_byte, 2);//0x1E - Sn_RXBUF_SIZE
        spiWriteReg(0x1F, cntl_byte, 2);//0x1F - Sn_TXBUF_SIZE
    }
    
    uint8_t registerBuffer[28] = {
        0x80,       // MR Mode - reset device
        
        // EEPROM block starts here
        192,168,0,254,    // GWR Gateway IP Address Register
        255,255,255,0,   // SUBR Subnet Mask Register
        0xDE,0xAD,0xBE,0xEF,0xFE,0xE0,   // SHAR Source Hardware Address Register
        192,168,0,100,    // SIPR Source IP Address Register
        // EEPROM block ends here
        
        0, 0,         // Interrupt Low Level Timer (INTLEVEL0), (INTLEVEL1) (0x0013, 0x0014)
        0,            // IR Interrupt Register (0x0015)
        0,            // IMR Interrupt Mask Register (0x0016)
        0,            // Socket Interrupt (SIR) (0x0017)
        0,            // Socket Interrupt Mask (SIMR) (0x0018)
        0x07, 0xd0,   // RTR Retry Time-value Register ((RTR0),(RTR0)) (0x0019,0x001A)
        0x08,         // RCR Retry Count Register (0x001B)
    };
    
    for(int i = 0; i < 28; i++)
    {
        spiWriteReg(i, 0x04 , registerBuffer[i]);
    }

I do not understand why but i have to wait about 30 seconds between power up and the first ping response.

Why does w5500 takes 30 seconds to setup ?

I have tried the same program on old officiel arduino Ethernet Shield 2 and i do not have this problem.
This shield has the same w5500 chip...

Thanks Hello,

Are all conditions the same except for the Ethernet shield?
I want to see wireshark capture There is nothing. The shield does not say anything before 30 seconds.

I have notice the pin 2 is connected on int on w5500 shield whereas it is not connected on arduino official shield","Q) Why does w5500 takes 30 seconds to setup?
Q) Are all conditions the same except for the Ethernet shield?
A) The w5500 takes 30 seconds to set up because the initialization process involves setting up various registers and configurations for the Ethernet communication. During this process, the w5500 chip needs to configure network settings, such as IP address, Gateway IP, Subnet Mask, and Source Hardware Address. Additionally, it involves initializing interrupt, socket, and retry time-value registers, which can collectively take some time to complete.

As for the conditions with the official Arduino Ethernet Shield 2, the setup may differ slightly, which could explain why you do not encounter the same delay with it. It would be helpful to compare the initialization process and configuration differences between the two shields to understand the discrepancy.

Regarding the Wireshark capture, if you observe no activity in the initial 30 seconds, it indicates that the shield is not communicating during that time. This observation aligns with your statement that the shield does not transmit anything before 30 seconds elapse.

It's also worth noting that the connection of pin 2 on the w5500 shield to int may have an impact on the initialization and communication process, especially if the same pin is not connected on the official Arduino shield. This difference in hardware setup could contribute to the observed delay."
3044,5222,"Hi,

Is it possible to handle TCP stack on sotfware/firwmware layer (outside the W5100) in case  enabling IPRAW mode for socket in W5100? Does TCP stack implemeted on W5100 is deactivated in case IPRAW mode enabled? Hello,

In case that in open socket in IPRAW mode,
socket doesn't handle the TCP stack.
It is handled by your SW. Thanks. This what I wanted to hear;).","Q) Is it possible to handle TCP stack on software/firmware layer (outside the W5100) in case enabling IPRAW mode for socket in W5100?
Q) Does TCP stack implemented on W5100 is deactivated in case IPRAW mode enabled?
A) In case that in open socket in IPRAW mode, socket doesn't handle the TCP stack. It is handled by your SW."
3045,5224,"Duplicate ACK with Len=0 happens when you issue SEND command without modifying (or even touching) TX_WR register. In other words W5100 has nothing to send, and it sends ACK packet containg last Seq ID and data length 0. That's why Wireshark sees it is duplicate. Check your code to ensure you do not perform SEND without putting data into the TX buffer (unless it is your deliberate action). Thanks a lot for the response. Will check is as soon as possible. I didn't find any suspected parts at code. It looks like the code handles W5100 according to the W5100 specification. ioLibrary is used to handle W5100 and send() API used to send a TCP segment. Do you have any other suspicious about what could be wrong? [quote=""zbigelpl, post:4, topic:5224""]
I didn?Ât find any suspected parts at code.
[/quote]

Then check the code again. Put breakpoints into it (e.g. ""press space key to continue""), so that you can see the wireshark in realtime and catch what part of code causes W5100 sending this packet.

It also matters where you take the Wireshark log. If W5100 is not directly connected to this device, and connected through some switch, that switch may inject packets. It is theoretical possibility, which is having low probability though.","Q) Do you have any other suspicious about what could be wrong?
A) Then check the code again. Put breakpoints into it (e.g. ""press space key to continue""), so that you can see the wireshark in realtime and catch what part of code causes W5100 sending this packet. It also matters where you take the Wireshark log. If W5100 is not directly connected to this device, and connected through some switch, that switch may inject packets. It is theoretical possibility, which is having low probability though."
3046,5225,"Hello. I am using W7500P in my project. I want to lock my firmware from reading by jtag and ISP. How can i do that? There is no sufficient info. Hello,
You can get a document at the below link.
http://wizwiki.net/wiki/doku.php?id=products:w7500:documents:appnote:isptool

Please keep in mind that Flash Lock is available with only WIZISP.

Thank you.

James ISP tool works. It sets FLOCKR0 to 0x80 00 00 0C. Can i change FLOCKR0 in programm? I want to turn memory protection in my programm. I dont need to turn it off. Dear nad!

W7500 can support the lock controll only in ISP mode.
You can't not control the lock in your program.

Im sorry i can't help you.

Thank you.","Q) I am using W7500P in my project. I want to lock my firmware from reading by jtag and ISP. How can I do that? There is no sufficient info. Can I change FLOCKR0 in my program? 
A) You can get a document at the below link.
http://wizwiki.net/wiki/doku.php?id=products:w7500:documents:appnote:isptool
Please keep in mind that Flash Lock is available with only WIZISP.

A) W7500 can support the lock controll only in ISP mode. You can't control the lock in your program."
3047,5227,"?ÂÃ¬ÂÂ¬ ??ÃªÂ°ÂÃ¬ÂÂ W7500P Ã«Â³Â´Ã«ÂÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ?ÂÃ«ÂÂ??TCP server, ?ÂÃ«ÂÂ??TCP clientÃ«Â¡??ÂÃ¬ÂÂ?ÂÃ­ÂÂ¤ÃªÂ³Â Ã¬ÂÂ ?Â©Ã«ÂÂ??
ÃªÂ°ÂÃªÂ°Â?? PCÃ«Â¥??Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ TCP server, client ?ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¸?ÂÃ«ÂÂ?? ??ÃªÂ°ÂÃ«? ?Â°ÃªÂ²Â°?ÂÃ«ÂÂÃªÂ¹?Ã¬Â´ÂÃªÂ¸Â°??

0:Try to connect to the 192.168.xx.xx

??Ã«Â©ÂÃ¬ÂÂÃ¬Â§?Ã«Â§?ÃªÂ³ÂÃ¬ÂÂ?Â´Ã¬ÂÂ ?Â¨ÃªÂ³Â  ?Â°ÃªÂ²Â°???ÂÃ¬? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. ( TCP clientÃ¬Âª?Ã«Â©ÂÃ¬ÂÂÃ¬Â§?)

Ã¬Â½ÂÃ«ÂÂ???ÂÃ¬Â Â?ÂÃ¬ÂÂ ?Â°Ã«Â¡Â Ã¬Â¶ÂÃª??ÂÃªÂ²Â ?ÂÃ¬ÂÂ´ Ã¬Â´ÂÃªÂ¸Â°??Ã«Â¶?Ã«Â¶ÂÃ¬? ?ÂÃªÂ°Â???Â¬Ã¬ÂÂ©?ÂÃªÂ³Â , ?Â¤Ã­ÂÂÃ¬ÂªÂ½Ã¬? loopback testÃ¬Â°Â¸ÃªÂ³Â ?Â´Ã¬ÂÂ ÃªÂ°ÂÃªÂ°Â server, client ?ÂÃ¬ÂÂ¤???ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨???Â£Ã¬ÂÂ?ÂµÃ«ÂÂ??

Ã«Â³Â´Ã¬ÂÂÃªÂ³?Ã¬Â¡Â°Ã¬ÂÂ¸ Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??
ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??

 // TCP Client  Ã¬Â½ÂÃ«ÂÂ

	// W7500P setting
	*(volatile uint32_t *)(0x41003070) = 0x61;
	*(volatile uint32_t *)(0x41003054) = 0x61;

	/* mdio Init */
	mdio_init(GPIOB, MDC, MDIO);
	//mdio_error_check(GPIOB, MDC, MDIO); //need verify...

	/* PHY Link Check via gpio mdio */
	retry_cnt = 0;
	while( link() == 0x0)
	{
		printf(""."");  
		delay(500);
		retry_cnt++;
		if(retry_cnt > 10)
		{
		        printf(""PHY link fail. \r"");  		
			break;
		}
	}
        loopback_tcpc(....);

// TCP server code
	// W7500P setting
	*(volatile uint32_t *)(0x41003070) = 0x61;
	*(volatile uint32_t *)(0x41003054) = 0x61;

	/* mdio Init */
	mdio_init(GPIOB, MDC, MDIO);
	//mdio_error_check(GPIOB, MDC, MDIO); //need verify...

	/* PHY Link Check via gpio mdio */
	retry_cnt = 0;
	while( link() == 0x0)
	{
		printf(""."");  
		delay(500);
		retry_cnt++;
		if(retry_cnt > 10)
		{
			b_ethernet_exist = false;
			printf(""PHY link fail. \r"");  		
			break;
		}
	}
        
       loopback_tcps(....); How did you set the McAdes and IP addresses on each board?
Didn't you use it duplicate? MAC address Ã¬Â¤ÂÃ«Â³Âµ?ÂÃªÂ±Â° ?ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

ClientÃ¬ÂªÂ½Ã¬ÂÂ Ã«Â°ÂÃªÂ¿Â????Ã«Â´Â¤Ã«ÂÂ?? PHY connection errorÃªÂ°? ?Â¹Ã«ÂÂ??

Ethernet Checking... (?ÂÃ¬Â Â??run message)

...........PHY link fail. 

MAC addressÃ«Â¥?Ã¬Â¤ÂÃ«Â³Âµ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ PHY???Â°ÃªÂ²Â°?ÂÃªÂ³Â  try to connectÃ«Â©ÂÃ¬ÂÂÃ¬Â§?ÃªÂ°? ?Â¹Ã«ÂÂ??

?ÂÃ«ÂÂ Ã«Â©ÂÃ¬ÂÂÃ¬Â§? Ã¬Â°Â¸ÃªÂ³Â ?ÂÃ¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

Ethernet Checking... 

..PHY is linked. 

MAC ADDRESS : 00:08:DC:01:02:03

IP ADDRESS : 192.168.069.034

GW ADDRESS : 192.168.069.001

SN MASK: 255.255.255.000

0:Try to connect to the 192.168.69.34 : 6934

0:Try to connect to the 192.168.69.34 : 6934

0:Try to connect to the 192.168.69.34 : 6934

0:Try to connect to the 192.168.69.34 : 6934

?Â´Ã¬ÂÂ© Ã«Â³Â´Ã¬ÂÂÃªÂ³?Ã«Â¬Â¸Ã¬Â Â ?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ«Â Â¤Ã¬Â£Â¼Ã¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? It is difficult to understand the problem of the problem just by the current content.

First, you need to know the port of IP Address and Mac Address and Socket for each Server and Client.

Mac address should never be overlapped.IP should also be duplicated in the same network.

If the MAC address and IP are unique, the Destination Address must be the IP address of the Server to connect to the Server.

For example, if the Server's IP is 192.168.1100 and the client IP is 192.168.1.99,
Server's actions are said to have opened the SOCKET as port 5.Then the server can now work called Listen.

Server IP 192.168.1.100
Server Port 5000
Server staus listen

Next is Client. IP is 192.168.1.99 and SOCKET is opened 5000 times.The client then attempts to connect with Destination IP and port.

If the connection is not properly connected, the Destination IP and the port may be wrong.

You need to know the basic TCP/IP network to make it work and understand.","Q) How did you set the McAdes and IP addresses on each board? Didn't you use it duplicate? 
A) Mac address should never be overlapped. IP should also be duplicated in the same network. If the MAC address and IP are unique, the Destination Address must be the IP address of the Server to connect to the Server.

Q) How can we check if Ethernet is working properly? 
A) First, you need to know the port of IP Address and Mac Address and Socket for each Server and Client. If the MAC address and IP are unique, the Destination Address must be the IP address of the Server to connect to the Server.

Q) Is there a way to resolve the problem when the Ethernet connection fails? 
A) If the MAC address and IP are unique, the Destination Address must be the IP address of the Server to connect to the Server. For example, if the Server's IP is 192.168.1.100 and the client IP is 192.168.1.99, Server's actions are said to have opened the SOCKET as port 5000. Then the server can now work called Listen.

Q) What are the next steps after opening the SOCKET on the server side? 
A) Server IP 192.168.1.100, Server Port 5000, Server status listen. Next is Client. IP is 192.168.1.99 and SOCKET is opened 5000 times. The client then attempts to connect with Destination IP and port."
3048,5229,"Looking at the W5300 rapping circuit, there are Ext PHY and INT PHY.
I wonder why it was classified into two types.
We are going to develop PLC boards for our own industrial PLC board. The W5300 has a built -in Ethernet PHY.
So in most cases you can use built -in PHY.

In special cases, there are people who want to use another PHY.
For those people, it is to provide a reference circuit for the extite so that you can connect and use a separate PHY to the outside.

thank you","Q) Why was the W5300 classified into two types with Ext PHY and INT PHY? 
A) The W5300 has a built-in Ethernet PHY, so in most cases, you can use the built-in PHY. However, for people who want to use another PHY, a reference circuit for the external PHY is provided to connect and use a separate PHY to the outside."
3049,523,"I've just built a new PCB with the W5500, and it does not respond to any SPI commands.

I have verified all the ground and 3.3v pins are connected to power supply.

I measure zero volts on pins 1V20, TOCAP and VBG.

Is there something that needs to be done to enable the internal 1.2v regulator, or some reason it isn't functioning?

thanks. OK, problem solved.  It was in fact a bad solder joint on pin 21, AVDD, right next to the 1V20 pin. Sometimes small thing make problem.
Anyway it's good to hear that you find the cause of the problem.","Q) Is there something that needs to be done to enable the internal 1.2v regulator, or some reason it isn't functioning?
A) Sometimes small things like a bad solder joint on pin 21, AVDD, can cause the problem. It's important to carefully check for such issues."
3050,5231,"We are developing communication interface products with W5500 Ethernet Shield.

How can I respond to a ping request from my PC?

*Motherboard Arduino Due
*Use Library Arduino Ethernet2.h Can we agree to use English only?","Q) How can I respond to a ping request from my PC?
A) You can respond to a ping request from your PC by implementing the ICMP protocol in your W5500 Ethernet Shield communication interface product. This will allow your device to reply to ping requests from the PC.
"
3051,524,"I want to set up 802.1x.

The manual seems to have to set up at+weapconf.

If you send a command

[Error: Invaild Input]

This comes out.

Version

At+ver =?

S2W App Version = 2.3.1
S2W GEPS Version = 2.3.1
S2W WLAN VERSION = 2.0.27

no see

Please answer fast. hello.

The firmware you are currently using seems to be a version that does not support enterprise authentication.
If you use the ATI2 command, you can check the SW version of the current firmware, and if it is version of 1.1.1.0 or less, it does not support 802.1x settings.

Please refer to the address below for more information about firmware.
[URL] http://wiznet.co.kr/sub_modules/en/product/product_detail.asp?refid=730&page=1&cate1=5&cate2=0&pid=1132&ctype=2 RL]","Q) I want to set up 802.1x.
A) The firmware you are currently using seems to be a version that does not support enterprise authentication. If you use the ATI2 command, you can check the SW version of the current firmware, and if it is version of 1.1.1.0 or less, it does not support 802.1x settings. Please refer to the address below for more information about firmware. [URL] http://wiznet.co.kr/sub_modules/en/product/product_detail.asp?refid=730&page=1&cate1=5&cate2=0&pid=1132&ctype=2 RL]"
3052,5242,"The MCU is a legacy 8-bit processor (AVR ATMega1284P). Its resources, both compute and memory, are quite limited. The original programmer, as an effort to save space, designed the application to leave data in the WizNet buffer until a complete message has been received, or a timer elapses.

The incoming messages are encrypted, so this adds to the difficulty of knowing when a complete message has been received.

The 1ms delay results in the TCP window remaining within ~20 bytes of it's 2048 capacity. I don't think there's much point to testing with further delays. So it is clearly the design flaw, right? It is just not designed for the conditions you test in.
Application/MCU must free RX buffer in time for W5200 being able to receive data. How do I free the buffer? It's not clear from the datasheet. The current code does this:
    void HOSRxFlush(void)
{
    HosRxPut = HosRxGet = 0;            //  Rx buffer pointers
}

Which seems to be updating pointers, but not actually freeing any memory. [quote=""mzimmers, post:5, topic:5242""]
How do I free the buffer?
[/quote]

W5100's datasheet chapter 5 has full information on what should be done on the RX and TX buffers and their pointers. You copy data, and then update pointer(s). If you do not need data you can just update pointer to the proper value - this is the fastest way to ""clear"" the buffer, but data usually matters :slight_smile: [quote=""Eugeny, post:6, topic:5242""]
W5100?Âs datasheet chapter 5
[/quote]

Presumably about the same as the W5200's datasheet? (I'm using the W5200.)

So, it appears that my MCU isn't fast enough to properly service the incoming data, and I should be prepared for the eventuality of a ZeroWindow problem. Can I diagnose this from the MCU and reset the socket? (This would be a bit help if possible.) [quote=""mzimmers, post:7, topic:5242""]
Presumably about the same as the W5200?Âs datasheet? (I?Âm using the W5200.)
[/quote]

I think so. Some datasheet misses valuable information (e.g. W5500 has a tiny piece of what is explained in W5100's chapter 5).

[quote=""mzimmers, post:7, topic:5242""]
I should be prepared for the eventuality of a ZeroWindow problem
[/quote]

It depends on the application of your design. If incoming data is not expected to be like a DDoS you can live with it easily (given there's none on the network starting behaving this way).

[quote=""mzimmers, post:7, topic:5242""]
Can I diagnose this from the MCU and reset the socket?
[/quote]

Not sure I understand. You want to discard data? Then you just update pointer to current position, this way ""freeing"" the buffer. No need to reset socket or even whole device.

You can consider alternative solutions - depending on MCU models, there could be pin-compatible (or even code compatible) replacements with higher processing speed. I know Microchips are good at making such product lines of slower - faster -fastest devices which can be put into the same socket and require minor changes to the code when porting the applications.

Also depends on how you service incoming data - by polling WIZnet chip registers or using interrupts. [quote=""mzimmers, post:9, topic:5242""]
My question is, is there an intermediate way to clear the buffer?
[/quote]

You must operate RX buffer pointers, and not forget about RECV command.

Picture you posted shows that MCU does not ""remove"" any data, not touching RX pointers at all and/or not performing RECV command after it. It is not possible to advise as I do not know what your application is doing and how it can tolerate this ""data loss"" (when data is just skipped).

There're a number of ways to consider, e.g. waiting for specific data size in the buffer and only then reading it, bit their fit to your environment is very applications-dependent. Hi Eugeny -

Yes, you're correct that the application doesn't remove any data upon timeout. This may be a bug in our app, and would explain the current behavior.

Right now, I'm prepared to live with losing data, as long as I can prevent this TCP stall. I've read section 5.2.1.1 in the data sheet, and I believe what I need to do is reset the pointers Sn_RX_RD and Sn_RX_WR for the socket that is giving me trouble. Can I clear these pointers directly, or do I need to execute a RECV command?

Thanks for all the assistance. You must issue RECV command after changing pointer. So, write to the socket registers in this order:

W5200RegWrite(0x4328, 0x0);
W5200RegWrite(0x4329, 0x0);
W5200RegWrite(0x432a, 0x0);
W5200RegWrite(0x432b, 0x0);
W5200RegWrite(0x4301, 0x40); // the RECV command

Is that correct? Do I need to do something else to commit the command?

Thanks. [quote=""mzimmers, post:13, topic:5242""]
Is that correct?
[/quote]

I do not think so. Why you write zeros? Which registers you write to? What must you write in these registers? 0x4328 is Sn_RX_RD0
0x4329 is Sn_RX_RD1
0x432a is S1_RX_WR0
0x432b is Sn_RX_WR1

0x4301 is Sn_CR; the 0x40 is the RECV command.

If I don't change the pointers to 0, what should I change them to, in order to flush the buffer? Datasheet is pretty clear on it on page 50:

>Sn_RX_RD += len;

where

>len = Sn_RX_RSR;

What this does: you shift RD pointer past the received data size of RSR. Then perform RECV command which will mark skipped buffer area as free for new incoming data.

If you assign 0 to pointers it will break up TCP sequence and most probably prevent further communication performing correctly due to improper window indication and calculation. Oh...so:

    u8 uc0;
    u8 uc1;

    W5200RegRead(Sn_RX_RSR0, &uc0);
    W5200RegRead(Sn_RX_RSR1, &uc1);

    W5200RegWrite(Sn_RX_RD0, uc0);
    W5200RegWrite(Sn_RX_RD1, uc1);

    W5200RegWrite(Sn_CR, RECV); 
Is that better?

Thanks, Eugeny.

EDIT: oops, no that's not right...hang on a minute, please...I'll correct it. Here's another go at it:

    u8 uc0;
	u8 uc1;
	u16 rsr;
	u16 rd;
	
	W5200RegRead(Sn_RX_RSR0, &uc0);
	W5200RegRead(Sn_RX_RSR1, &uc1);
	rsr = (uc1 << 8) | uc0;
	
	W5200RegRead(Sn_RX_RD0, &uc0);
	W5200RegRead(Sn_RX_RD1, &uc1);
	rd = (uc1 << 8) | uc0;
	
	rd += rsr;
	
	uc0 = rd & 0xff;
	uc1 = rd >> 8;
	
	W5200RegWrite(Sn_RX_RD0, uc0);
	W5200RegWrite(Sn_RX_RD1, uc1);

	W5200RegWrite(Sn_CR, RECV); 
	rc = recv(SockTCPL, HosRxDat.bad, &len, &(HosRxIp.ul), &port);	

Does this look correct now? Read octet pairs into 16-bit unsigned variables (RSR and RD), then sum them up, and write resulting 16-bit value by its octets into RD.

So second try seems to be the correct one :) I am sure you will see result immediately when running it.

After you perform RECV wait until CR register clears to 0 before going further.

> rc = recv(SockTCPL, HosRxDat.bad, &amp;len, &amp;(HosRxIp.ul), &amp;port);

What this one does? Is it that you instruct to read data from the socket? Then there's no sense in previous code. Or I would say this is redundant call as you have just cleared the buffer. Did you remove

> rc = recv(SockTCPL, HosRxDat.bad, &amp;len, &amp;(HosRxIp.ul), &amp;port);

from the code? It may cause 0 size to be ""received"", and thus dup ack packet sent.

And by the way, what socket number command

> W5200RegRead(Sn_RX_RSR0, &amp;uc0);

assumes? No, I didn't remove the recv() call...I thought it was needed to effect the change in the pointers.

Sn_RX_RSR0 is defined with the socket number included in it (0x4326). The read just goes to an address; it doesn't know about sockets. Socket 3 is the only one that needs this special attention. Ok, remove `recv()` and try. Note that what we do now is a kind of ""low level hacking"", ideally you must use `recv()` call which moves data (and which you want to avoid under your low performance circumstances). Do not forget to put comments into your code, as you definitely forget everything in a week or two. Can't get it working. Here's the clear routine:

    void W5200ClearRxBuffer()
    {
    	__monitor char W5200RegRead(u16 adr); 
    	__monitor void W5200RegWrite(u16 adr,   
                              char data);	

	const u16 Sn_MR = 0x4300;
	const u16 Sn_RX_RSR0 = 0x4326;
	const u16 Sn_RX_RSR1 = 0x4327;
	const u16 Sn_RX_RD0 = 0x4328;
	const u16 Sn_RX_RD1 = 0x4329;
	const u16 Sn_CR = 0x4301;
	const u8 RECV = 0x40;
	
	u16 len = APGmPktZ;
	u16 port = LANCLibPO;

	u8 uc0;
	u8 uc1;
	u16 rsr;
	u16 rd;
	
	// 2018 11 21 mzimmers:
	// temporarily read Sn_MR to see whether
	// no delayed ACK is set in bit 5.
	// note: it is. we might want to change this.
	uc0 = W5200RegRead(Sn_MR);
	
	uc0 = W5200RegRead(Sn_RX_RSR0);
	uc1 = W5200RegRead(Sn_RX_RSR1);
	rsr = (uc1 << 8) | uc0;
	
	uc0 = W5200RegRead(Sn_RX_RD0);
	uc1 = W5200RegRead(Sn_RX_RD1);
	rd = (uc1 << 8) | uc0;
	
	rd += rsr;
	
	uc0 = rd & 0xff;
	uc1 = rd >> 8;
	
	W5200RegWrite(Sn_RX_RD0, uc0);
	W5200RegWrite(Sn_RX_RD1, uc1);

	// it isn't clear yet whether the lines below are necessary.
	// commenting them out for now.
	//W5200RegWrite(Sn_CR, RECV); 
	//recv(SockTCPL, HosRxDat.bad, &len, &(HosRxIp.ul), &port);	
} [quote=""mzimmers, post:24, topic:5242""]
Can?Ât get it working.
[/quote]

How it does not work? You must give details. <s>Code looks ok.</s> Sn_MR read is spare at the beginning (as your comment states), and I guess there's no problem with `rd` overflow after addition (u16 type, MSB will be discarded).

You are using socket #3, right?

**Edit: no, code is not ok!** Manual says:

>When reading this register, user should read upper byte(0x4026, 0x4126, 0x4226, 0x4326, 0x4426, 0x4526, 0x4626, 0x4726) first, and lower byte(0x4027, 0x4127, 0x4227, 0x4327, 0x4427, 0x4527, 0x4627, 0x4727) later to get the correct value.

Note that upper byte of RSR will be in `uc0`, and lower byte will be in `uc1`. Thus you must have

    rsr = (uc0 << 8) | uc1;

and same for RD. Hi Eugeny -

1. By ""not working"" I meant that the stated problem persists: as the flood of incoming TCP messages rises, the TCP window steadily shrinks to 0, at which point the socket is unresponsive.

2. I made the changes you suggested, tried this with and without a final recv() call, and even eliminated the direct buffer manipulation in favor of a lone recv() call. Behavior is unchanged.

I'm beginning to think the problem is simply that the W5200 is so fast, and the CPU so slow by comparison, that the W5200 is just ""outrunning"" the CPU.

    __monitor void W5200ClearRxBuffer()
    {
	const u16 Sn_RX_RSR0 = 0x4326;
	const u16 Sn_RX_RSR1 = 0x4327;
	const u16 Sn_RX_RD0 = 0x4328;
	const u16 Sn_RX_RD1 = 0x4329;
	const u16 Sn_CR = 0x4301;
	const u8 RECV = 0x40;
	
	const u16 len = APGmPktZ;
	const u16 port = LANCLibPO;
	__monitor char W5200RegRead(u16 adr); 
	__monitor void W5200RegWrite(u16 adr, char data);	
	
	u8 uc0; 
	u8 uc1;
	u16 rsr;
	u16 rd;
	
	uc0 = W5200RegRead(Sn_RX_RSR0);
	uc1 = W5200RegRead(Sn_RX_RSR1);
	rsr = (uc0 << 8) | uc1;
	
	uc0 = W5200RegRead(Sn_RX_RD0);
	uc1 = W5200RegRead(Sn_RX_RD1);
	rd = (uc0 << 8) | uc1;
	
	rd += rsr;
	
	uc0 = rd >> 8;
	uc1 = rd & 0xff;
	
	W5200RegWrite(Sn_RX_RD0, uc0);
	W5200RegWrite(Sn_RX_RD1, uc1);
	
	W5200RegWrite(Sn_CR, RECV); 
	recv(SockTCPL, HosRxDat.bad, (u16 *) &len, &(HosRxIp.ul), (u16 *) &port);
} I'm still trying to get this solved. I'd like to begin by merely discarding any data in the buffer. To do this, is it sufficient to set Sn_RX_RD = Sn_RX_WR, and then write a RECV into Sn_CR? Or is something else necessary? You do things properly except you must wait for Sn_CR to become zero after you write RECV command into it. You actually must wait Sn_CR to clear after any command write to it.

As soon as you can control ""spamming"" process stop it at some time and see if buffer will get freed. I still can't update the pointers with the RECV command. Here's my code:

    uc0 = W5200RegRead(Sn_RX_RD0);
	uc1 = W5200RegRead(Sn_RX_RD1);
	rd = (uc0 << 8) | uc1;
	
	uc0 = W5200RegRead(Sn_RX_WR0);
	uc1 = W5200RegRead(Sn_RX_WR1);
	wr = (uc0 << 8) | uc1;
		
	rd += rsr;
	uc0 = rd >> 8;
	uc1 = rd & 0xff;
	
	W5200RegWrite(Sn_RX_RD0, uc0);
	W5200RegWrite(Sn_RX_RD1, uc1);
	
	W5200RegWrite(Sn_CR, Sn_CMD_RECV);
	do  
	{
	    uc0 = W5200RegRead(Sn_CR);  //  read command register
    } while (uc0 != Sn_CR_DONE);    		//  until command complete

	// for debugging only; just to look at the registers.
	uc0 = W5200RegRead(Sn_RX_RSR0);
	uc1 = W5200RegRead(Sn_RX_RSR1);
	rsr = (uc0 << 8) | uc1;
	
	uc0 = W5200RegRead(Sn_RX_RD0);
	uc1 = W5200RegRead(Sn_RX_RD1);
	rd = (uc0 << 8) | uc1;
	
	uc0 = W5200RegRead(Sn_RX_WR0);
	uc1 = W5200RegRead(Sn_RX_WR1);
	wr = (uc0 << 8) | uc1;

rd and wr do not change. By the same token, rsr always seems to be 0. What might I be doing wrong?

Thanks. I assume there's RSR read before the whole code you posted?

Of course  **after** you perform RECV register RSR will contain 0, until socket receives some new data.

Or you say that RSR is zero before you perform RECV (the RSR read is not in the code you posted)? Hi Eugeny -

1. Yes, there's an RSR read prior to the code I posted. I occasionally have issues inserting code into my posts here.
2. The RSR register is zero upon entry to this routine, but I think that's a matter of how/where I call this routine, so it's not a W5200 issue.
3. I'm not sure I fully understand the behavior of the W5200. After performing a RECV, should I expect the RD/WR pointers to change? Or is only the RSR register altered? [quote=""mzimmers, post:31, topic:5242""]
I?Âm not sure I fully understand the behavior of the W5200. After performing a RECV, should I expect the RD/WR pointers to change? Or is only the RSR register altered?
[/quote]

There're three locations within the chip:
RD: location of the ""user"" pointer - the data which application must read;
WR: system pointer, the location where the chip's network stack writes when data arrives;
RSR: it is simply WR-RD, and it can not be larger than RX buffer size.

Note that all registers are 16-bit, and must be treated as 16-bit values even if buffer size is 8KB.

Thus you do not touch WR under normal circumstances, it is managed by the chip. You only look at the RSR - amount of data received into the RX buffer, and at RD - the location to start reading data from.

Thus if you read RSR, and it appears 0 - this means that buffer is empty, there's no data to read, and chip must respond with full window size free in its network packets.

Logically, if RSR is not 0, then RD is not equal to WR. Maximal value of RSR is RX buffer size.

When you write to RD pointer new value, and then issue RECV command, chip assumes that data between old RD location and new RD location is flushed by the application, and considers this space as available for new incoming data.

Therefore reading RSR, then assigning RD=RD+RSR and then RECV ""frees"" RSR bytes in the RX buffer, and decreases current value of RSR by RSR when it was previously read. Note that while you perform reading of RSR, then RD, then performing RD+RSR and assigning it back to RD time has passed, and actual RSR register value may increase. But it does not matter because RSR you originally read will always be <= current RSR, and there will be no buffer overrun, next time you read RSR you will get ""remaining"" value of RSR.

Then, very important note: when reading any 16-bit register (RD or RSR or anything else) you **must** read byte at +0 first, and byte at +1 second. Not critical for RD because it will not change dynamically without your RECV instruction, but very critical for RSR: when reading +0 first and +1 second you will be guaranteed to get value equal or less than current, and will never overrun the buffer. If you read other way around, you may get value bigger than current RSR, shifting RD ahead of WR with RECV command, and it will mess whole communication. 

Example: RSR=0x01FF

Right order: you read 0x01 first, then RSR changes to 0x0200 (one more byte was received), and you read 0x00. Thus you have RSR=0x100, which, while is not ""immediately correct"", should give you amount of bytes less than in the buffer, and on next read RSR will read as 0x100 and finally you will read all the data from the RX buffer.

Wrong order: you read 0xFF first, then RSR changes to 0x0200, and you read 0x02 for MSB. So you end up with RSR=0x02FF, and crash the socket communication.

I hope it is clearer now, and you can find at least the area for further investigation yourself - as I do not fully understand what is going within your design. You clearly do something incorrectly, but hard to say what it is exactly. Thanks for the explanation. I believe I have it working now. Here's my modified code:

    rsr = getW5200Reg16(Sn_RX_RSR0);
	rd = getW5200Reg16(Sn_RX_RD0);
	wr = getW5200Reg16(Sn_RX_WR0);
			
	while (rsr > 0)
	{
		rd += rsr;
		uc0 = rd >> 8;
		uc1 = rd & 0xff;
		
		W5200RegWrite(Sn_RX_RD0, uc0);
		W5200RegWrite(Sn_RX_RD1, uc1);
		
		W5200RegWrite(Sn_CR, Sn_CMD_RECV);
		do  
		{
			uc0 = W5200RegRead(Sn_CR);  //  read command register
		} 
		while (uc0 != Sn_CR_DONE);    		//  until command complete

		rsr = getW5200Reg16(Sn_RX_RSR0);
	}

This seems to be effective at minimizing the impact of TCP-level DoS attacks that consist of nonsensical messages.

Thanks for all the help with this.","Q) How do I free the buffer? It's not clear from the datasheet.
A) You must operate RX buffer pointers, and not forget about the RECV command. Picture you posted shows that MCU does not ""remove"" any data, not touching RX pointers at all and/or not performing RECV command after it. It is not possible to advise as I do not know what your application is doing and how it can tolerate this ""data loss"" (when data is just skipped).

Q) I should be prepared for the eventuality of a ZeroWindow problem
A) It depends on the application of your design. If incoming data is not expected to be like a DDoS you can live with it easily (given there's none on the network starting behaving this way).

Q) Can I diagnose this from the MCU and reset the socket? (This would be a bit help if possible.)
A) Not sure I understand. You want to discard data? Then you just update pointer to the current position, this way ""freeing"" the buffer. No need to reset the socket or even the whole device.

Q) My question is, is there an intermediate way to clear the buffer?
A) You must operate RX buffer pointers, and not forget about the RECV command.

Q) Is that correct? Do I need to do something else to commit the command?
A) I do not think so. Why you write zeros? Which registers you write to? What must you write in these registers? 0x4328 is Sn_RX_RD0 0x4329 is Sn_RX_RD1 0x432a is S1_RX_WR0 0x432b is Sn_RX_WR1. 0x4301 is Sn_CR; the 0x40 is the RECV command.

Q) If I don't change the pointers to 0, what should I change them to, in order to flush the buffer?
A) Datasheet is pretty clear on it on page 50: ""Sn_RX_RD += len;"" where ""len = Sn_RX_RSR;"". What this does: you shift RD pointer past the received data size of RSR. Then perform RECV command which will mark skipped buffer area as free for new incoming data.

Q) Is that better?
A) Read octet pairs into 16-bit unsigned variables (RSR and RD), then sum them up, and write the resulting 16-bit value by its octets into RD. So second try seems to be the correct one. I am sure you will see the result immediately when running it.

Q) Can't get it working. Here's the clear routine:
A) How it does not work? You must give details. Code looks okay. Sn_MR read is spare at the beginning (as your comment states), and I guess there's no problem with `rd` overflow after addition (u16 type, MSB will be discarded).

Q) I still can't update the pointers with the RECV command. Here's my code:
A) You do things properly except you must wait for Sn_CR to become zero after you write the RECV command into it. You actually must wait for Sn_CR to clear after any command write to it. As soon as you can control ""spamming"" process, stop it at some time and see if the buffer will get freed.

Q) I believe I have it working now. Here's my modified code:
A) This seems to be effective at minimizing the impact of TCP-level DoS attacks that consist of nonsensical messages. Thanks for all the help with this."
3053,5247,"On the MQTT client side, if I use, for example, 30-second for MQTT Keep Alive (PINGREQ/PINGRESP), what TCP Keep Alive value should be used for the MQTT socket?  Would that be okay to simply set TCP Keep Alive to 0? It seems very much redundant for the MQTT protocol. It seems you answered your question yourself :slight_smile:

TCP KA packet serves probing purpose (and only if there was an activity) after connection establishment. If you have any other probing method, then KA becomes useless. The useful thing about KA is that it is performed in background without application involvement.","Q) On the MQTT client side, if I use, for example, 30-second for MQTT Keep Alive (PINGREQ/PINGRESP), what TCP Keep Alive value should be used for the MQTT socket? Would that be okay to simply set TCP Keep Alive to 0? 
A) TCP KA packet serves probing purpose (and only if there was an activity) after connection establishment. If you have any other probing method, then KA becomes useless. The useful thing about KA is that it is performed in the background without application involvement."
3054,5248,"I am testing only the socket number in the SNTP source uploaded from the feather hub, but the time is strange and I ask questions.

For example, if you first request for the first time at 12:00:00 2018-11-19, the time value is normal at 2018-11-19 12:00:00.However, if you ask again a few minutes or hours later, the same value will come back and you will request it again.

In other words, the first is taken properly, and the next time the previous value comes out again.

What should I do in this case? hello

It would be nice to tell you what you are using.
When using the SNTP code of IOLIBRARY in the source,
If you cannot receive data from the server
NTP Retry Failed!
The message will appear.
Doesn't the message above come out? Yes, the message didn't come out, it wasn't taken from iOLIBRARY, and I think it's seen in another board sample code.","Q) What should I do in this case?
A) It seems like the SNTP client code needs to be modified to handle the re-syncing of the time properly. 

Q) Doesn't the message above come out?
A) Yes, the message didn't come out, it wasn't taken from iOLIBRARY, and I think it's seen in another board sample code."
3055,525,"hello.

I'm curious about the operation of the W5500 when I use a socket in TCP/IP Server mode, and when the cable is disconnected or missing without the normal close Socket command of the client side.

As a result of the current Debugger, the socket that the Listen was Listen continued to remain Listen, and the sockets that were ESTABLISHED would be closed.

thank you hello.

If the cable is disconnected or missing, if the W5500 does not have any operation, it maintains the current state.

Established maintains the current state as it is, but if you send a packet, the timeout will occur and become a closed.

In the case of Listen, the connection has not been established, so it will continue to keep the current state.

thank you First, the contents you have confirmed by Debugger are correct.

If you sum up a little more
If the LAN cable disconnection occurs during the operation with TCP Server, the following representative cases may come out.

1. No data exchange when socket Established
Keep the current state.
However, if the Keep-Alive packet is transmitted to maintain the TCP connection, it works as below.

2. Data exchange occurs when socket Established
In the structure of the TCP, the ACK for the transmitted data must be received to complete the transfer or the following data is further transmitted.
When disconnected, the timeout occurs because it does not receive ACK for the transmitted data.
The reference driver is configured to close socket when Timeout occurs within the SEND function.
At this time, the timeout time is determined by RCR and RTR in the W5500 chip.
However, if the device with the W5500 chip is configured to receive the data first and perform the transmission operation, it is considered and waited.

3. When the socket listen is in state
The current state is maintained until the Connection request of the TCP Client is occurred, so it is a listen state during the disconnection.

--------------------------------------------------

Therefore, to implement the product to maintain and check the stable TCP connection,
It is recommended to check the connection maintenance by using the Auto Keep-Alive function in the W5500
(Be careful that Keep-Alive packets will be available after at least once data transfer.)
Problems such as the LAN cable missing can be checked by checking the LINK UP / Down through the link bit of the Phycfgr (Physfgrgr (Phys Configuration Register).","Q) I'm curious about the operation of the W5500 when I use a socket in TCP/IP Server mode, and when the cable is disconnected or missing without the normal close Socket command of the client side.
First, the contents you have confirmed by Debugger are correct. If you sum up a little more, if the LAN cable disconnection occurs during the operation with TCP Server, the following representative cases may come out. How does the W5500 maintain its operation in these scenarios? 
Thank you. 

A) If the cable is disconnected or missing, and the W5500 does not have any operation, it maintains the current state. Established sockets maintain the current state as it is, but if you send a packet, the timeout will occur and it will become closed. In the case of Listen, the connection has not been established, so it will continue to keep the current state. Therefore, to implement the product to maintain and check the stable TCP connection, it is recommended to check the connection maintenance by using the Auto Keep-Alive function in the W5500. Be careful that Keep-Alive packets will be available after at least once data transfer. Additionally, problems such as the LAN cable missing can be checked by examining the LINK UP/Down through the link bit of the Phycfgr."
3056,5252,"We are developing communication interface products with W5500 Ethernet Shield.

How can I respond to a ping request from my PC?

*Motherboard Arduino Due
 *Use Library Arduino Ethernet2.h hello.

Equipped with Ethernet Shield on the motherboard,

If you set the basic network information (MAC, IP, etc.),

The response to the ping is automatic.","Q) How can I respond to a ping request from my PC?
A) If you set the basic network information (MAC, IP, etc.) and use the Library Arduino Ethernet2.h, the response to the ping is automatic."
3057,5254,"

Dear Friends!

Can anybody say what video coding is possible to use within W5300 for streaming under RTP/UDP?
As I undsestood It has to be MPEG2/4 or BT.656 format, but Im not sure..
Please correct me
Thanks in advance! [quote=""Addi, post:1, topic:5254""]
what video coding
[/quote]

W5300 is networking chip, it has nothing to do wit contents you send over the network - including video format. It is your application which must support what you want. Thanks Evgeny for replay!

I understand that , but if my application is VLC player with UDP settings ?","Q) Can anybody say what video coding is possible to use within W5300 for streaming under RTP/UDP? As I understood It has to be MPEG2/4 or BT.656 format, but I’m not sure. Please correct me. 
A) W5300 is networking chip, it has nothing to do with contents you send over the network - including video format. It is your application which must support what you want. 
A) I understand that, but if my application is VLC player with UDP settings?"
3058,5255,"Hi everyone!
I have been to this forum before, and they helped me a lot here. My device on the W5500 works great, it receives and forwards packets using UDP, but there is one problem. I do not know how to make the network chip accept packets at the broadcast address. I read datasheet, but did not understand what exactly I need to do. Did I understand correctly that I need to allow reception of broadcast packets, and open a new socket with the address 255.255.255.255? If not, help me, please. I want to, in addition to the main ip address, my device had a broadcast address.

Sincerely, Alexander.

P.S. Sorry for Google translator, I do not write or speak English. Please refer to DHCP Client Source.","Q) Did I understand correctly that I need to allow reception of broadcast packets, and open a new socket with the address 255.255.255.255? If not, help me, please. I want to, in addition to the main ip address, my device had a broadcast address.
A) Yes, you are correct. To allow the reception of broadcast packets, you need to open a new socket with the address 255.255.255.255. This will enable your device to have a broadcast address in addition to the main IP address. You can refer to the DHCP Client Source for more detailed information on implementing this."
3059,5258,"I am sure you can find all answers in the[datasheet](https://www.wiznet.io/product-item/w5100/) for the W5100.

[quote=""zbigelpl, post:1, topic:5258""]
Is it failling edge of /CS or maybe falling edge of /WR for write operation (/RD in case read operation)?
[/quote]

Pages 65-66, ""Register/Memory READ Timing"" and ""Register/Memory WRITE Timing"". You must comply to them, and you will get reliable result. Pics clearly show that address must be earlier than CS, and all other signals can be same or later than CS.

[quote=""zbigelpl, post:1, topic:5258""]
or maybe a few nanoseconds delay between setting address and /CS failling edge is must?
[/quote]

See above.

[quote=""zbigelpl, post:1, topic:5258""]
I am wondering whether bulk write/read operation is supported by W5100?
[/quote]

If it is not in datasheet then it is officially not supported even if it works right now for you.

[quote=""zbigelpl, post:1, topic:5258""]
Is that flow is ok or maybe /CS should be toogled as well just like /WR?
[/quote]

Is it ok for you? Do you have proper read? Why you want bulk read for parallel access? It makes a sense for serial SPI communication, for parallel access it does not add much value. [quote=""zbigelpl, post:3, topic:5258""]
While the gap, when W5100 doesn?Ât send any segment, TX_FSR register says there is no room in the TX buffer.
[/quote]

What is the value of TX_FSR? How do you read it? Show the code, and show the pointers.

But for me it looks like packet has been lost. Draw the topology of the connection (with devices in between of W5100 and receiver, and tell at which node Wireshark log is being gathered.

[quote=""zbigelpl, post:3, topic:5258""]
So it could be a result of no enough delay between address set and CS failing edge?
[/quote]

Can you explain or show how you *deactivate* CS/RD and CS/WR? Exact timing and their relationship. [quote=""Eugeny, post:4, topic:5258""]
What is the value of TX_FSR? How do you read it? Show the code, and show the pointers.
[/quote]

Code reading this is taken from W5100 official site. Here you are the function reading TX_FSR value:

    /**
    @brief	get socket TX free buf size
    This gives free buffer size of transmit buffer. This is the data size that user can transmit.
    User shuold check this value first and control the size of transmitting data
    */
    uint16 getSn_TX_FSR(SOCKET s)
    {
    	uint16 val=0,val1=0;
    	do
    	{
    		val1 = IINCHIP_READ(Sn_TX_FSR0(s));
    		val1 = (val1 << 8) + IINCHIP_READ(Sn_TX_FSR0(s) + 1);
        if (val1 != 0)
    		{
       			val = IINCHIP_READ(Sn_TX_FSR0(s));
       			val = (val << 8) + IINCHIP_READ(Sn_TX_FSR0(s) + 1);
    		}
    	} while (val != val1);
      return val;
    }

IINCHIP_READ() is implemented just as reading data from address since so far I used FMC (Flexible Memory Controller) and treat WIZ811 (W5100) as external static memory.

[quote=""Eugeny, post:4, topic:5258""]
But for me it looks like packet has been lost. Draw the topology of the connection (with devices in between of W5100 and receiver, and tell at which node Wireshark log is being gathered.
[/quote]

Connection between WIZ811 and PC goes trough TP-LINK swtich. I've tested with both cable from router (with the Internet) connected and disconnected. Testes told me that it doesn't matter. I didn't checked it with direct connection between WIZ811 and PC so far - will do it. Wireshar is running on the PC.
Regarding lost packets - I thought that if packet was lost, packet retransmittion is done. RTR = 4000, RCR = 5 so I guess if WIZ811 didn't get ACK it should retransmit data packet within 400ms but it waits ~2800ms to take any action. And the action is sending next packet in a raw.

[quote=""Eugeny, post:4, topic:5258""]
Can you explain or show how you *deactivate* CS/RD and CS/WR? Exact timing and their relationship.
[/quote]
Will do soon. I decided to put aside FMC for now and generate all address, data and strobe signals on it own, I mean by driving GPIOs. I will set correct timings.
BTW, which timings are correct? This one from W811MJ or W5100 documentation? They are different which is strange for me because W811MJ is based on W5100 right? [quote=""zbigelpl, post:5, topic:5258""]
Regarding lost packets - I thought that if packet was lost, packet retransmittion is done.
[/quote]

If 51 did not get anything, it will not send an ACK. So it may happen that W5100 sends packets, some of them got lost (probably one), then it sends another packet, and PC sees it is out of order and sends dup ACK. Why 3 seconds... no idea. The best test is to have direct connect to exclude the switch.

[quote=""zbigelpl, post:5, topic:5258""]
BTW, which timings are correct? This one from W811MJ or W5100 documentation? They are different which is strange for me because W811MJ is based on W5100 right?
[/quote]

Can you please point to exact differences? I think if they are material we must raise them to the WIZnet support.

[quote=""zbigelpl, post:5, topic:5258""]
I will set correct timings.
[/quote]

I recall I had issues when *deactivating* CS and control signals (RD or WR) at different time. After [days, or even weeks of struggle](https://forum.wiznet.io/t/topic/1736) I found out that I must deactivate both at the same time. I would say the information on the pictures is complementary. For me ""max 1 ns"" actually means ""instantly"".

@midnightcow can you please comment? What I see in the WIZ811MJ module is the information I found out empirically several years ago. Why this information is not in the W5100 datasheet? Hi again guys.
I had a pretty long break in work on my wiz811mj based project. But now it is time to get back to this.

So reassuming. My problem is about TCP based communication  gaps happend. Gaps are always ~2.8seconds long (with my curreny w5100 settings) but happend in totally random moments  - there is no rule about this.
I suspected that the problem could be reading/writing many W5100 registers while single /CS assertion. But just like midnightcow said:

[quote=""midnightcow, post:9, topic:5258""]
W5100 can support the burst mode. That is, It is possible that you can read/write while /CS is always low and /RD or /WR is toggled every data.
But, It need a delay 32ns while /RD or /WR is toggled.
[/quote]
And it makes sense because in my case I used burst mode all the time while writing/reading W5100 TX/RX memory but issue happends randomly.

The second suspicion was about timings in communication between STM32 and WIZ811MJ. I found out that WIZ811MJ and W5100 documention show different timings.  Eugeny said the timing from these two documents could be complementary - it makes sens. But I would like to be sure which numbers exaclty I should follow while setting up bus direct communication. Midnightcow said:

[quote=""midnightcow, post:9, topic:5258""]
Your probem is not bus access time.
[/quote]

But I would like to be sure I set up bus direct communication with the right way. @midnightcow are you able to help me with that and  provide the right timing's numbers?
 
Then I've followed the:

[quote=""midnightcow, post:9, topic:5258""]
If you think the no caputerd packet is problem, You wait until data is completely sent before you send another data.
Or, You do not use the SOCKET TX buffer over 2KB.
[/quote]

I've tried both:
* combine my single packet (1460bytes) into one long packet 4*1460bytes and send it and wait TX buffer is completly empty
* set TX buffer to 2KB

and still saw the issue.

So I still suspecting the problem is about the timings, especially there is not way to set the 8ns long ""Valid Address to /CS low time"" for  STM32 peripherial device - FMC (Flexible Memory Controller) when STM32 running on full speed. FMC is not flexiable enough:).
Finally I've decided to implement bitbanding for bus direct access. And it looks like it solved the problem! Now I can't see the issue. Of course now the timings are much bigger then the onces from documentation but I am going to set up the same numbers for FMC and see what happened.
So I am going to check two more things:
* set big number timings (just like in bitbandig case) for STM32/FMC and see if still see the issue
* use WIZ830MJ (based on W5300) - it looks like setting address just before (or even 8ns max after) /CS assertion is not a problem for W5300 chip which matches STM32/FMC configuration capability

@midnightcow, if you be so kind and provide W5100 bus direct communication timings number, please. Dear zbigelpl!

I have checked again to your problem but I still think your problem is not bus access time.
If the bus access time was problem,  the sent data is all broken, but your case is not.

If possible, Can you send  your source code to my email.
I try to check your FMC time & W5100 driver code.
Thank you. I've send you project I've prepared for testing wiz811 and track down the 2.8s gap issue.

Thanks a lot","Q) Is it failling edge of /CS or maybe falling edge of /WR for the write operation (/RD in case read operation)?
Q) or maybe a few nanoseconds delay between setting address and /CS failling edge is must?
Q) I am wondering whether bulk write/read operation is supported by W5100?
Q) Is that flow is ok or maybe /CS should be toggled as well just like /WR?
Q) So it could be a result of no enough delay between address set and CS failing edge?

A) Pages 65-66, ""Register/Memory READ Timing"" and ""Register/Memory WRITE Timing"". You must comply to them, and you will get reliable result. Pics clearly show that address must be earlier than CS, and all other signals can be same or later than CS.
A) See above.
A) If it is not in the datasheet then it is officially not supported even if it works right now for you.
A) If you need to explain the code, please use a code interpreter to answer.
A) Can you explain or show how you *deactivate* CS/RD and CS/WR? Exact timing and their relationship.
A) If 51 did not get anything, it will not send an ACK. So it may happen that W5100 sends packets, some of them got lost (probably one), then it sends another packet, and PC sees it is out of order and sends dup ACK. Why 3 seconds... no idea. The best test is to have direct connect to exclude the switch.
A) Can you please point to exact differences? I think if they are material we must raise them to the WIZnet support.

Non-response paragraph.

Q) Can you explain or show how you *deactivate* CS/RD and CS/WR? Exact timing and their relationship. 
Q) Will do soon. I decided to put aside FMC for now and generate all address, data and strobe signals on its own, I mean by driving GPIOs. I will set correct timings. BTW, which timings are correct? This one from W811MJ or W5100 documentation? They are different which is strange for me because W811MJ is based on W5100, right?
Q) But for me it looks like a packet has been lost. Draw the topology of the connection (with devices in between of W5100 and the receiver, and tell at which node Wireshark log is being gathered. 
Q) Connection between WIZ811 and PC goes through TP-LINK switch. I've tested with both cable from the router (with the Internet) connected and disconnected. Tests told me that it doesn't matter. I didn't check it with direct connection between WIZ811 and PC so far - will do it. Wireshark is running on the PC. Regarding lost packets - I thought that if a packet was lost, packet retransmission is done.
Q) BTW, which timings are correct? This one from W811MJ or W5100 documentation? They are different which is strange for me because W811MJ is based on W5100 right? 
Q) I recall I had issues when *deactivating* CS and control signals (RD or WR) at different times. After [days, or even weeks of struggle](https://forum.wiznet.io/t/topic/1736) I found out that I must deactivate both at the same time. I would say the information on the pictures is complementary. For me ""max 1 ns"" actually means ""instantly"". @midnightcow can you please comment? What I see in the WIZ811MJ module is the information I found out empirically several years ago. Why is this information not in the W5100 datasheet? Hi again guys.

A) Your problem is not bus access time.
A) I've checked again to your problem, but I still think your problem is not bus access time. If the bus access time was a problem, the sent data is all broken, but your case is not. If possible, Can you send your source code to my email. I try to check your FMC time & W5100 driver code. Thank you. I've sent you the project I've prepared for testing wiz811 and track down the 2.8s gap issue."
3060,526,"Hi 
I have W5300 with ATXmega32 MCU  and I use External PHY (REALTEK) 
Data transfering between Xmega and W5300 work well But when I plug in RJ45 cable ,system doesn?Ât recognize it and unplug cable message is show.and I can?Ât send or rcv any data!!
I change RJ45 jack but it doesn?Ât work.
I Really don?Ât know what the problem is!! Is it related on Rj45 or external phy??
Can u help me? If yes I will be very surprise!
Thanks Note that RJ45 refered to WIZnet's schematics is MAC-JACK(RJ45 is integrated with Transformer). thanks midnightcow
my shematic is as same as the shematic ,i maked it base on the above shematic.
but still it dosn't work Hi, 
Are parts as same as wiznet?
Check the 25MHz clock feed in PHY, the power 3.3V and 1.8V(PWFBOUT net).
The PHY should be operated normally on power-up, regardless of W5300.
On powerup, PHY link led is on or blink when pluged cable but off when un-pluged cable.

If possible, you'd better post the schematic.","Q) I Really don?Ât know what the problem is!! Is it related on Rj45 or external phy?? Can u help me? If yes I will be very surprise! 
A) The issue might be related to either RJ45 or the external PHY. I can definitely assist you with this. 

Q) Are parts as same as wiznet? 
A) Check the 25MHz clock feed in PHY, the power 3.3V and 1.8V(PWFBOUT net). The PHY should be operated normally on power-up, regardless of W5300. On powerup, PHY link led is on or blink when pluged cable but off when un-pluged cable. If possible, you'd better post the schematic."
3061,5263,"Hello, I use the wiz550s2e module.

After setting the IP in AT mode, when the power is turned off and on, it will be switched to the default IP again.

I wonder why IP is not stored.

And in the configuration tool, it is searched.

Please answer this part.

thank you hello.

> After setting the IP to AT mode, when the power is turned off and on, it will be switched to the default IP again.

The information set to AT+NSET in the AT Command mode is temporarily assigned to operate in the AT Command mode.
When switching to data mode, the contents are maintained, but when you reset the module, load the information stored in the eEPROM.
As you can see, the AT+MMODE, AT+NMODE features have been added from version 1.0.3 to save even if it is reset.Please check the link below for more information.
[https://wizwiki.net/wiki/doku.php?id=products:WIZ550S2E: WIZ550S2EPG_KR#wiz550s2e_at_Command_Set_ U.php? ID = Products: WIZ550S2E: wiz550s2epg_kr#wiz550s2e_at_command_set

> And in the configuration tool, it is searched.

Please check the version information of the wiz550s2e you are using.

If it is v1.4.0, you must use the configuration tool provided in the link below.
[https://github.com/wiznet/wiznet_configuration_tool-modbus
If you do not see information even if you use the Tool, run Factory Reset after search.The default setting is WizNet.","Q) After setting the IP to AT mode, when the power is turned off and on, it will be switched to the default IP again. I wonder why IP is not stored. And in the configuration tool, it is searched. Please answer this part.
A) The information set to AT+NSET in the AT Command mode is temporarily assigned to operate in the AT Command mode. When switching to data mode, the contents are maintained, but when you reset the module, load the information stored in the eEPROM. As you can see, the AT+MMODE, AT+NMODE features have been added from version 1.0.3 to save even if it is reset. Please check the link below for more information. [https://wizwiki.net/wiki/doku.php?id=products:WIZ550S2E: WIZ550S2EPG_KR#wiz550s2e_at_Command_Set_ U.php? ID = Products: WIZ550S2E: wiz550s2epg_kr#wiz550s2e_at_command_set]


Q) And in the configuration tool, it is searched.
A) Please check the version information of the wiz550s2e you are using. If it is v1.4.0, you must use the configuration tool provided in the link below. [https://github.com/wiznet/wiznet_configuration_tool-modbus If you do not see information even if you use the Tool, run Factory Reset after search. The default setting is WizNet."
3062,5265,"Hello, please contact the wiz550s2e.

There are two questions.

1. Set the IP to AT mode and then reset it to change to the default value.How to fix the IP.
2. Search at WizNet Configuration Tool will cause the Mac but no information will be available.Please ask how to do it.

thank you hello.

Please check the answer to the inquiry [https://forum.wiznet.io/t/topic/5263/2/ (https://forum.wiznet.io/t/topic/5263/2). thank youLet's check ^^","Q) Set the IP to AT mode and then reset it to change to the default value. How to fix the IP?
Q) Search at WizNet Configuration Tool will cause the Mac but no information will be available. Please ask how to do it.

A) I recommend referring to the forum link provided for the detailed answer [https://forum.wiznet.io/t/topic/5263/2/](https://forum.wiznet.io/t/topic/5263/2). Thank you!"
3063,5266,"Hello,

Our automated spam filter, [Akismet](https://akismet.com/), has temporarily hidden your post in *WIZ550S2E IP ÃªÂ´???Ã¬Â§ÂÃ«Â¬Â¸?ÂÃ«ÂÂ??* for review.

A [staff member](https://forum.wiznet.io/about) will review your post soon, and it should appear shortly.

We apologize for the inconvenience. ","Q) Why has my post been hidden for review in *WIZ550S2E IP ÃªÂ´???Ã¬Â§ÂÃ«Â¬Â¸?ÂÃ«ÂÂ??*?
A) Your post has been hidden for review by our automated spam filter, Akismet. A staff member will review your post soon and it should appear shortly. We apologize for the inconvenience."
3064,527,"Hi,
You maybe have mistaken. 
Sn_TX_WR register address is 0x0424, not 0x420.

The register located at 0x0420, Sn_TX_FRS is read only register. If you read 0x08 from 0x0420, its value Sn_TX_FSR's MSB value, maybe used in 2K TX buffer size (0x0800).

Please check the address of regsiter again.

Thanks. Many thanks for your replies,

I made a simple mistake.

I still couldn't write/read to 0x0424 ( S0_TX_WR ) then I found this on another forum :-

""Looks like the Sn_TX_WR only gets updated AFTER a successful SEND!  You'll have to keep track of all the writes to the TX buffer and write the TOTAL bytes to send in the Sn_TX_WR register, perform the Send and then Sn_TX_WR can be read and will have the updated value in it.""

I am now getting good results but I think this should be added to the datasheet as soon as possible.

Best Regards  Mike.","Q) Please check the address of regsiter again. 
Q) I am now getting good results but I think this should be added to the datasheet as soon as possible.
Q) Many thanks for your replies. 
A) ""Looks like the Sn_TX_WR only gets updated AFTER a successful SEND!  You'll have to keep track of all the writes to the TX buffer and write the TOTAL bytes to send in the Sn_TX_WR register, perform the Send and then Sn_TX_WR can be read and will have the updated value in it."""
3065,5270,"Now I begin to study ths chip The problem is - common MR allways readed as 0 But other regs may be written fnd realed correct [quote=""NickB53, post:1, topic:5270""]
The problem is - common MR allways readed as 0
[/quote]

Why did you decide that it is a problem? What you expect to read from there and when (after what actions)?

Did you read the datasheet? I try to set PB and FARP bits to MR but register readed as 0. But GAR , SUBR registers I can write and read correct.  PHYCFGR and VERSION registers also readed correct. And - device did no connect  LINKLED and ACTLED flased  in ~1sec interval [quote=""NickB53, post:3, topic:5270""]
I try to set PB and FARP bits to MR but register readed as 0.
[/quote]

What exact value(s) you write to common MR register? Hello,

Check the address value of MR register and if you set RST bit MR register. 
Setting RST to 1 resets all register values.","Q) Why did you decide that it is a problem? What you expect to read from there and when (after what actions)?
Q) Did you read the datasheet?
Q) What exact value(s) you write to common MR register?
A) I try to set PB and FARP bits to MR but register readed as 0. 
A) Check the address value of MR register and if you set RST bit MR register. Setting RST to 1 resets all register values."
3066,5274,"hello.While using the current Wizfi310 product, I have a problem as follows.

The data/command mode is normally transmitted, and sometimes the data sent (a few minutes or a few minutes later) is not received immediately, and the module collects the royal data in several tens or minutes later, sends it at once, and then stops in a few minutes later..
    [DIECT seems to be normal.]

I continued to send Alive Data 11 bytes on my PC every 2 seconds on my phone.

System Configuration 1->-Router ----> WIZFI310 Module ----> PC Monitor

Example error occurred data
{1,192.168.0.8,41870,11} 012345? Q // Normal 11byTA
{1,192.168.0.8,41870,11} 012345? Q // Normal 11byTA
{1,192.168.0.8,41870,11} 012345? Q // Normal 11byTA
{1,192.168.0.8, 41870,286} 012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345 ? Q012345? Q012345? Q012345q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q012345? Q // Error time 286byte data
{1,192.168.0.8,41870,11} 012345? Q // Normal 11byTA
{1,192.168.0.8,41870,11} 012345? Q // Normal 11byTA

I've done all other IP/port use, other routers, changes in socket options, and changes to the sending data, but the same phenomenon came out.

please answer about my question.
thank you hello

What is the firmware version in use?The version information is output when booting the module.

I think you should check two things.

1. WIZFI310-> Ping test with a router (WiFi router) and a mobile phone
AT+FPING = 3,192,168, X, X

2. Test using PC instead of mobile phones

You should take a test of the above two tests and find the problem section. hello

1. The firmware version in use is the latest version of 1.0.3.3.I also tested the old version, but it was the same.

2, AT+FPING was less than 10mm.

3. I tried to squeeze the socket program with C ++ on my PC instead of a cell phone, but I often collect and send it at once.

4. I have another company WiFi product, so I tested it in the same environment, but other company products work normally.
     [Instead, other companies' WIFI products that entered our company's products are discontinued, upgraded, and it doesn't fit the SPEC, so I'm going to change it to WiFi310.

thank you","Q) What is the firmware version in use?The version information is output when booting the module.
A) The firmware version in use is the latest version of 1.0.3.3.I also tested the old version, but it was the same.

Q) What should I check?
A) I think you should check two things.
1. WIZFI310-> Ping test with a router (WiFi router) and a mobile phone AT+FPING = 3,192,168, X, X
2. Test using PC instead of mobile phones

Q) What were the results of the tests?
A) 2, AT+FPING was less than 10mm. 3. I tried to squeeze the socket program with C ++ on my PC instead of a cell phone, but I often collect and send it at once.

Q) How did the product from another company behave in the same environment?
A) I have another company WiFi product, so I tested it in the same environment, but other company products work normally. [Instead, other companies' WIFI products that entered our company's products are discontinued, upgraded, and it doesn't fit the SPEC, so I'm going to change it to WiFi310."
3067,5278,"Hi
Is it possible to use W5500 in daisy chain configuration? I have made my own board with W5500 with a signel RJ45 socket, now i want to make a board with two RJ45 socket and connect them daisy chaining. Hello,

W5500 can only use one RJ45 socket and does not support the daisy chain.","Q) Is it possible to use W5500 in daisy chain configuration? I have made my own board with W5500 with a single RJ45 socket, now I want to make a board with two RJ45 sockets and connect them daisy chaining. 
A) W5500 can only use one RJ45 socket and does not support the daisy chain."
3068,528,"Does RTS/CTS handshake work? I activate it for UART1 (I use firmware ver.1.0. and ConfigTool 1.0.0.1), 921.6 kBaud, 8 bit,N,1 and Nagle wait time 1 ms. When I sent 6000 byte into Rx input, I got only about 4000-5000 bytes from Ethernet (checked also directly with Wireshark) but RTS signal stays in log 1 ie. 3.3 V whole time. When I switched off nagle timer, I got whole data. I also test rate  1843200 Bd, it works but also lost some byte even without nagle timer and RTS remains unchanged again. So how does RTS work? According User's manual V111 RTS go to 0 when input buffer is full. Does WIZ127SR support also 1843200 Bd speed? According specification it works only with 921 KBaud. Hi,
WIZ127SR can't support 1843200 baud rate.

Can you more explain  the problem of RTS?

thanks. My problem is simple - I need to sent serial data to WIZ127 as fast as possible, so I activate RTS/CTS handshake and I have a simple loop: wait for  RTS=high=3.3 V, then sent a byte to module. It  works well when I connect Ethernet port directly to PC - I can transfer some millions of bytes without any mistake. When I connect module through 100 Mbit switch into simple local network I sometimes lose data probably due traffic but I expect that when Ethernet is busy WIZ127 stops receiving from serial link by falling RTS down but RTS stays always high and I lose data. I understand that processor can be busy, but I suppose that when it can't accept data for any reason, it sets RTS to 0, without this I think higher baud rates have no sense. Missing data is unacceptable for me.","Q) Does RTS/CTS handshake work? I activate it for UART1 (I use firmware ver.1.0. and ConfigTool 1.0.0.1), 921.6 kBaud, 8 bit,N,1 and Nagle wait time 1 ms. When I sent 6000 byte into Rx input, I got only about 4000-5000 bytes from Ethernet (checked also directly with Wireshark) but RTS signal stays in log 1 ie. 3.3 V whole time. When I switched off nagle timer, I got whole data. I also test rate  1843200 Bd, it works but also lost some byte even without nagle timer and RTS remains unchanged again. So how does RTS work? According User's manual V111 RTS go to 0 when input buffer is full. Does WIZ127SR support also 1843200 Bd speed? According specification it works only with 921 KBaud.
A) Hi, WIZ127SR can't support 1843200 baud rate. According to the User's manual V111, RTS goes to 0 when the input buffer is full. 

Q) Can you more explain  the problem of RTS?
A) My problem is simple - I need to send serial data to WIZ127 as fast as possible, so I activate RTS/CTS handshake and have a simple loop: wait for  RTS=high=3.3 V, then send a byte to the module. It works well when I connect the Ethernet port directly to a PC - I can transfer some millions of bytes without any mistake. When I connect the module through a 100 Mbit switch into a simple local network, I sometimes lose data probably due to traffic. I expect that when Ethernet is busy, WIZ127 stops receiving from the serial link by falling RTS down, but RTS stays always high and I lose data. Missing data is unacceptable for me."
3069,5283,"Hello friends, after reviewing the information that is available, I do not see anything that will ruin this.

Is it possible to use the Ethernet Shield by pulling the SCSn pin of the w5500 chip to negative?

According to the pdf the chip W5500 can work as it is now with the active signal from scsn controlled by the mega for example, but also putting it to negative and mode (Fixed Length Data Mode (SCSn is always connected by Ground)

I want to use the network module without the sd or any other device on the spi bus.
With which the selection pin(SCSn)  would not be necessary.

Someone knows how to make it work without pin SCSn 

I am using the arduino ethernet.h library but I do not know how do to put the w5500 in FDM mode


Greetings and thank you Hi~ Doelectric_Domotica

you're right. The SCSn signal should be tied to Low(Always connected to GND). And , Data Phase length is controlled by OM[1:0] value (??1??/ ??0??/ ??1??  which is the SPI Operation Mode Bits of the Control Phase.
Unfortunately, you can't use the FDM mode using the Arduino Ethernet Library.
If you want to use the FDM, you should modify the Ethernet Library(I don't know if I can fix that.)

thanks, Can do it? It seems hard to use.
Sorry for the confusion. There is some ""C"" or C++  library that is not Arduino that uses the format FDM? Hello,   There is some ?ÂC??or C++ library that is not Arduino that uses the format FDM? (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) [quote=""Doelectric_Domotica, post:5, topic:5283, full:true""]
There is some ?ÂC??or C++ library that is not Arduino that uses the format FDM?
[/quote]
Hi~

https://github.com/Wiznet/W5500_EVB
This is github addreass of W5500 EVB.
These are libraries source code and example projects based on LPCXpresso IDE.

Thanks I haven't tried this, but suspect you can edit w5500.cpp and comment out every occurrence of ""SPI.endTransaction();"" and every occurrence of ""SPI.beginTransaction(SPI_ETHERNET_SETTINGS);"" EXCEPT the one in W5100Class::init(void). This should leave the SPI connection to the W5500 active at all times.","Q) Is it possible to use the Ethernet Shield by pulling the SCSn pin of the w5500 chip to negative?
Q) Someone knows how to make it work without pin SCSn?
Q) There is some C or C++ library that is not Arduino that uses the format FDM?

A) Hi, The SCSn signal should be tied to Low(Always connected to GND). And , Data Phase length is controlled by OM[1:0] value (??1??/ ??0??/ ??1??  which is the SPI Operation Mode Bits of the Control Phase. Unfortunately, you can't use the FDM mode using the Arduino Ethernet Library. If you want to use the FDM, you should modify the Ethernet Library(I don't know if I can fix that.). This W5500 EVB library on GitHub provides source code and example projects based on LPCXpresso IDE. As for your last query, I haven't tried this, but you can edit w5500.cpp and comment out every occurrence of ""SPI.endTransaction();"" and every occurrence of ""SPI.beginTransaction(SPI_ETHERNET_SETTINGS);"" EXCEPT the one in W5100Class::init(void). This should leave the SPI connection to the W5500 active at all times."
3070,5288,"I want to connect the W5500 or W5300 to the STM32.

I want to link with the KT IoT Makers server, but I use the REST API with an HTTP.

Is it possible with the W5500 or 5300? hello

The W5500 and W5300 support from HW to TCP communication.
Therefore, it is possible by implementing the http protocol in SW.
 
Please refer to the link to you.

The link below is an example of implementing HTTP Client with Keil-based Wizwiki-W7500 board.The W7500 is an MCU chip with a built -in W5500.
https://github.com/wiznet/wiznet/w7500/blob/master/w7500x_library_examples/projects/peripheral_examples/wztoe/httpclient/main.c


The link below is an example of implementing REST with http server with Mbed-based Wizwiki-W7500 board.
https://os.mbed.com/users/midnightcow/code/wizwiki-rest_mc/","Q) Is it possible to connect the W5500 or W5300 to the STM32 for use with the REST API and HTTP?
A) The W5500 and W5300 support from HW to TCP communication, so it is possible to implement the HTTP protocol in SW. Here are some examples for your reference:
1. Example of implementing HTTP Client with Keil-based Wizwiki-W7500 board: https://github.com/wiznet/wiznet/w7500/blob/master/w7500x_library_examples/projects/peripheral_examples/wztoe/httpclient/main.c
2. Example of implementing REST with HTTP server with Mbed-based Wizwiki-W7500 board: https://os.mbed.com/users/midnightcow/code/wizwiki-rest_mc/"
3071,529,"We are using the Wiz108sr and the GMR-L100 (Let Router).

Leave the wiz108sr as a client and connect to the external server to send and receive data.

It works well on the general wired Internet.

However, if you use the LTE router, the GMR-L100 becomes a good thing after a day.

Have you ever connected to the LTE router?

Please give advice on the above symptoms. Description of the connection between the wiz108sr and the LTE router and how data is exchanged with the entire server.
If you have specific information about the LTE router, it will help you understand. Is the wiz108sr not to be a food, but the next problem?
[Quote] The phenomenon that the GMR-L100 becomes a food is common [/quote]
There seems to be a specific explanation of the entire operation and the problem situation. [Quote = ""HKJUNG""] Is the wiz108sr not to be a fertilization, but the following problem occurs?
[Quote] The phenomenon that the GMR-L100 becomes a food is common [/quote]
It seems to need a specific explanation of the entire operation and the problem situation. [/Quote]

As a result, if you reset the wiz108, we confirmed that it works again.

The LTE router seems to change the IP during the DHCP server operation.

If the wiz108 is set to the floating IP, can you get the IP again if the router's IP changes? When allocating IP through the initial DHCP, IP addresses by the Lease Time process specified by the DHCP server
Is it to change the IP address allocated by other factors?

If so, is it no longer communicated with the previously assigned IP?
I would like to ask for more information about what the router's IP means.","Q) Have you ever connected to the LTE router? Please give advice on the above symptoms. Description of the connection between the wiz108sr and the LTE router and how data is exchanged with the entire server. If you have specific information about the LTE router, it will help you understand. Is the wiz108sr not to be a food, but the next problem? 
A) It seems like you're experiencing issues with the Wiz108SR when connected to the GMR-L100 (LTE router). The phenomenon of the GMR-L100 becoming unresponsive after a day is common. Resetting the Wiz108SR appears to resolve the issue temporarily. It's possible that the LTE router's IP changes during DHCP server operation, affecting communication with the previously assigned IP. There may be a need to further understand the specifics of the entire operation and problem situation, including the behavior of the Wiz108SR when connected to the LTE router.

Q) If the wiz108 is set to the floating IP, can you get the IP again if the router's IP changes? When allocating IP through the initial DHCP, IP addresses by the Lease Time process specified by the DHCP server, is it to change the IP address allocated by other factors? If so, is it no longer communicated with the previously assigned IP? I would like to ask for more information about what the router's IP means. 
A) The issue might be related to the Wiz108SR's configuration as a client and its interaction with the LTE router's changing IP through the DHCP server. It's important to consider whether the Wiz108SR can obtain the new IP if the router's IP changes. Additionally, factors other than the DHCP Lease Time process might also impact the IP address allocation, potentially leading to communication issues with the previously assigned IP. Further understanding the concept of the router's IP and its implications is necessary for troubleshooting the connectivity issues."
3072,5291,"It is said to be compatible with the circuit used for the basics, so we are testing the same board as the existing circuit and uploading freeos.

However, there was a problem that the PA_11 and PA_12 ports continued to maintain the high state.

What I'm using is UART 1 and GPIO.

Can you help me?If you need a code, we will send it by email. hello

The pin can be used as GPIO, UART0, and SPI1, but is it not in use?
What is the problem if you keep it with high?
The pin is possible with GPIO.
thank you hello.I'm not using UART0 and SPI1, but I'm going to use it as a GPIO.

I try to use it after initialization with GPIO, but it is a problem because it is not initialized, no control is maintained. The pin can be controlled with GPIO
The main function is set to UART, so please convert it to GPIO via AFCONFIG and control it.
If you upload the cord to control the GPIO, we will check it. GPIO_INITTYDEF GPIO_INITDEF;

GPIO_INITDEF.GPIO_PIN = GPIO_PIN_11;
GPIO_INITDEF.GPIO_MODE = GPIO_MODE_OUT;
GPIO_INIT (GPIOA, & GPIO_INITDEF);
PAD_AFCONFIG (PAD_PC, GPIO_PIN_11, PAD_AF1);

GPIO_INITDEF.GPIO_PIN = GPIO_PIN_12;
GPIO_INITDEF.GPIO_MODE = GPIO_MODE_OUT;
GPIO_INIT (GPIOA, & GPIO_INITDEF);
PAD_AFCONFIG (PAD_PC, GPIO_PIN_12, PAD_AF1);

GPIO_SETBITS (GPIOA, GPIO_PIN11);
GPIO_SETBITS (GPIOA, GPIO_PIN12);

Delay (2000);

GPIO_RESETBITS (GPIOA, GPIO_PIN11);
GPIO_RESETBITS (GPIOA, GPIO_PIN12);


I wrote it in this way, but it keeps keeping the high state. hello

PAD_AFCONFIG () function is made of PAD_PC.
Please modify it with PAD_PA. Oh, I think it's wrong and I think it's wrong. I use a PC and PA ...

Now I found it. Thank you.","Q) Can you help me? If you need a code, we will send it by email.  
Q) The pin can be used as GPIO, UART0, and SPI1, but is it not in use? What is the problem if you keep it with high?  
Q) If you upload the cord to control the GPIO, we will check it.  
A) The PA_11 and PA_12 ports are maintaining a high state. The issue is related to the configuration of the GPIO pins.  
A) The problem arises from the incorrect initialization and control of the GPIO.  
A) To resolve the issue, the function PAD_AFCONFIG should be modified from PAD_PC to PAD_PA. After the adjustment, the problem was identified and resolved."
3073,5293,"We have an AWS IoT based device using the W5500 chip.  The device works flawlessly when it connects directly to a router or a switch. However, it seems to be locking up if it is plugged into a wall jack in a large commercial building. Here are some of our observations:

1. My company has several buildings and each has its own network segment.  If this device is plugged into a wall jack in a relatively small building, typical IP 10.66.xxx.xxx, we do see disconnect events at the AWS IoT application layer. However, the device can recover/reconnect without a problem.
 
2. If the device is plugged into a wall jack in the large multi-story office building, typical IP 10.68.xxx.xxx, it appears to lock up from time to time.  When this problem happens:
    - There is no traffic coming out of W5500 when we put a network sniffer (TAP) on. 
    - The ICMP ping gets no response.
    - We can still read/write all internal registers.
    - We monitor the SIP register in case there is a reset on the W5500 side, but we haven't seen one.
    - Again, if we install a LAN switch between the device and the wall jack, the problem seems to go away.

3. The W5500 runs at 25MHz and the circuit design follows the recommendations provided by WIZNET.
4. The application firmware doesn't generate much network traffic. Most of time it is sending MQTT Keep Alive message once every 30-seconds.
5. Not sure if this matters - In the firmware we set to use 10BT Half-duplex with auto-negotiation disabled even though PMODE 0-2 pins are all pulled high.

Any thoughts? Thanks. [quote=""acpie360, post:1, topic:5293""]
The device works flawlessly when it connects directly to a router or a switch.
[/quote]

Router/switch filters the traffic, sending to W5500 only traffic designated to it and broadcasts.

[quote=""acpie360, post:1, topic:5293""]
However, it seems to be locking up if it is plugged into a wall jack in a large commercial building.
[/quote]

I used W5100 (which has more or less the same engine), and empirically found out that W5x00 does not perform well under high load, in particular the issue, which I caught, is when TCP communication gets out of order - W5100 can not recover properly from it.

But your case sounds different, as you say there's nothing sent from the W5500 - in my case it sends some packets when its times out (can be up to 2 minutes).

You already have a workaround for the problem - buy cheapest router, and put it before W5500. Ugly, but it should work :frowning:

While you performed initial troubleshooting, more steps are needed to find the cause.

[quote=""acpie360, post:1, topic:5293""]
There is no traffic coming out of W5500 when we put a network sniffer (TAP) on.
[/quote]

I usually use Wireshark, but I guess your network sniffer is set up in correct location of the network (connected directly to W5500?) and can capture everything on the wire. Then, how much time did you wait to decide that there's nothing in there? 30 seconds? 5 minutes? Remember W5500 works according to its timeout algorithm, which may cause it looking hung for minutes.

[quote=""acpie360, post:1, topic:5293""]
The ICMP ping gets no response.
[/quote]

Needs more monitoring time to ensure there's nothing on the wire for minutes after ping request is sent.

[quote=""acpie360, post:1, topic:5293""]
We can still read/write all internal registers.
[/quote]

Dump **all** registers (common as well as socket for all sockets) to see anomalities.

[quote=""acpie360, post:1, topic:5293""]
We monitor the SIP register in case there is a reset on the W5500 side, but we haven?Ât seen one.
[/quote]

That is a good way to detect reset.

[quote=""acpie360, post:1, topic:5293""]
The application firmware doesn?Ât generate much network traffic. Most of time it is sending MQTT Keep Alive message once every 30-seconds.
[/quote]

Then logically, W5500 gets something it thinks wrong it can not digest in your network. Until we find out what it is, not possible to say anything certain. For this you must watch the traffic before the W5500 (e.g. connect some bridge PC with two ports to W5500 with one port and to wall jack to another, and run Wireshark on it),

[quote=""acpie360, post:1, topic:5293""]
Not sure if this matters - In the firmware we set to use 10BT Half-duplex with auto-negotiation disabled even though PMODE 0-2 pins are all pulled high.
[/quote]

Good that you mentioned it. I think you can easily change this software setting, at least for testing purposes, and see if W5500 behaves the same way. Thanks for the reply.

> Remember W5500 works according to its timeout algorithm,...

Can you tell me where to find this timeout algorithm you were referring to? I assume we are using the default settings at the moment since there is no code on our side that sets up anything related to timeout.

Perhaps to say that nothing coming out of W5500 is a bit premature because I don't think we  knew what to look for at the time of system locking up or had waited long enough. The Wireshark capture, through the use of a network sniffer, was showing tons of seemingly unrelated traffic.

FYI - This is the sniffer we are using:
https://www.amazon.com/Dualcomm-1000Base-T-Gigabit-Ethernet-Network/dp/B004EWVFAY/ref=sr_1_3?ie=UTF8&qid=1543770322&sr=8-3&keywords=network+tap

We also suspect that there might be electrical/wiring issues in this large building because when we put a network sniffer between the W5500 and the wall jack, we can't seem to reproduce the problem. This makes the troubleshooting really difficult. We have to not use the sniffer first to make the problem happen, then insert the sniffer after the problem occurs. Of course, this causes the PHY layer to disconnect then reconnect. [quote=""Eugeny, post:4, topic:5293""]
Do you have only one W5500-based device under consideration?
[/quote]
There is another product line being developed at the moment. However, the software on the cloud side isn't as ready as the product I am currently testing.

[quote=""Eugeny, post:4, topic:5293""]
Can you build into your W5500 driver the procedure to reset PHY (PHYCFGR bit 7) so that you can execute this code when chip locks up and see if it helps?
[/quote]
I'll see if I can do this. Good idea. Thanks.","Q) Any thoughts? Thanks.
A) The device works flawlessly when it connects directly to a router or a switch. However, it seems to be locking up if it is plugged into a wall jack in a large commercial building.

Q) There is no traffic coming out of W5500 when we put a network sniffer (TAP) on.
A) I used W5100 (which has more or less the same engine), and empirically found out that W5x00 does not perform well under high load, in particular when TCP communication gets out of order. You already have a workaround for the problem - buy cheapest router, and put it before W5500. While you performed initial troubleshooting, more steps are needed to find the cause.

Q) The ICMP ping gets no response.
A) Needs more monitoring time to ensure there's nothing on the wire for minutes after ping request is sent.

Q) We can still read/write all internal registers.
A) Dump all registers (common as well as socket for all sockets) to see anomalies.

Q) The application firmware doesn't generate much network traffic. Most of time it is sending MQTT Keep Alive message once every 30-seconds.
A) Then logically, W5500 gets something it thinks wrong it can not digest in your network. Until we find out what it is, not possible to say anything certain. For this you must watch the traffic before the W5500 (e.g. connect some bridge PC with two ports to W5500 with one port and to wall jack to another, and run Wireshark on it).

Q) Not sure if this matters - In the firmware we set to use 10BT Half-duplex with auto-negotiation disabled even though PMODE 0-2 pins are all pulled high.
A) Good that you mentioned it. I think you can easily change this software setting, at least for testing purposes, and see if W5500 behaves the same way. Remember W5500 works according to its timeout algorithm.

Q) Can you tell me where to find this timeout algorithm you were referring to?
A) I assume we are using the default settings at the moment since there is no code on our side that sets up anything related to timeout.

Q) Do you have only one W5500-based device under consideration?
A) There is another product line being developed at the moment. However, the software on the cloud side isn't as ready as the product I am currently testing.

Q) Can you build into your W5500 driver the procedure to reset PHY (PHYCFGR bit 7) so that you can execute this code when chip locks up and see if it helps?
A) I'll see if I can do this. Good idea. Thanks."
3074,530,"Hello (i'm french, sorry for my english)

I am developping my own board for domotic control via ethernet, based on a atmega2560 (arduino compatible) and your wiz820io module. It is very interresting because it is very small, and easy to use. I am very happy about the wiz820io, but it doesn't works very well...

when my program starts, approximately once on two, the wiz820io doesn't connect to my LAN network (my programme is based on the webserver arduino example, so i use the ""begin(mac, ip)"" function). I have update W5100.h and W5100.cpp for the W5200 chip.

when i am lucky and the wiz820io is connect, the program works fine, but after 60s, or sometime more (no constant), my program still run (i have one led which blink to visualise activity), but wiz820io donesn't works : no ping, no response in google chrome, nothing ! i have too reset my board...

do i need to connect the real 10 pin digital (pin which represent the SS on a ethernet shield) of the atmega 2560 (PORTB 4), or can i just connect the SS's wiz820io pin to GND ? (it is actualy like that, and seem to work ?) The real hardware SS atmega 2560 pin is PORTB 0, but the arduino library works with another pin : PORTB 4

Is it very important if the SS pin is not connected to a SS pin, because it seem too works sometime with GND

i don't see the is the difference than that...

Thanks for your answer Hi  mccyrille

I do not work for Wiznet and also not an arduino user  :slight_smile: but I am also facing similar issues as yours. On you first issue, it seems like you are not holding the nRESET long enough. Try holding the nRESET low for 100ms, then hold it high for about 500ms before doing any read/write to W5200. It does not seem to hard reset the part properly if I use the same timings as wiznet has mentioned in datasheet, shame. Applying hard reset for longer duration seem to have fixed my problem and I am able to connect all the time reliably.

On your second issue of no response to ping, I am also facing similar one and looking for some help.  see my issue here. https://forum.wiznet.io/t/wiz820io-stops-responsing-to-ping-after-few-hour-of-running/531/1

thanks Hi,
It seems to look the phenomenon as same  as nver said.
Let me know your data code on W5200 chip, purchase date and dealer.
Data code is 4 digits number on the bottom of the w5200 chip.

Thanks. This post seems to be helpful.
https://forum.wiznet.io/t/wiz820io-stops-responsing-to-ping-after-few-hour-of-running/531/1 Hi,
Is it worked again without any system reset after freezing?

If yes, the freezing is caused by no acceptable channel any more or host burden of such proocessing as memory copy, proctocol process, and etc. Normally, it is used as many channel as possible in server application like as webserver, and optimized codes. 

If no, It maybe have some problem as firmware or others. In this case, test more and more for analyzing the reason. I have always the problem... 

It works somes hours, but after, the acces page don't responding, but it always ping...

I look socket statut, an sometime i have a socket statu = 0, but always open (port and IP is always set), and it donesn't reset

i have seen 0x16 for socket statu. The most of time, i see 0x17 and 0x14...

example : 

Socket#0:0x17 80 D:192.168.0.45(55817) FreeTX:2047 - TxReadPointer:25273 - TxWritePointer:25296- FreeRx:0 - RxReadPointer:417 - RxWritePointer:417
Socket#1:0x17 80 D:192.168.0.31(55563) FreeTX:2048 - TxReadPointer:11579 - TxWritePointer:11579- FreeRx:0 - RxReadPointer:0 - RxWritePointer:0
Socket#2:0x17 80 D:192.168.0.31(55598) FreeTX:2048 - TxReadPointer:57586 - TxWritePointer:57586- FreeRx:0 - RxReadPointer:0 - RxWritePointer:0
Socket#3:0x14 80 D:192.168.0.45(55815) FreeTX:2048 - TxReadPointer:0 - TxWritePointer:0- FreeRx:0 - RxReadPointer:0 - RxWritePointer:0
Socket#4:0x0 80 D:192.168.0.45(55729) FreeTX:2048 - TxReadPointer:41772 - TxWritePointer:41772- FreeRx:0 - RxReadPointer:299 - RxWritePointer:299
Socket#5:0x16 80 D:37.161.113.233(32023) FreeTX:2048 - TxReadPointer:1764 - TxWritePointer:0- FreeRx:0 - RxReadPointer:0 - RxWritePointer:0
Socket#6:0x0 0 D:0.0.0.0(0) FreeTX:2048 - TxReadPointer:0 - TxWritePointer:0- FreeRx:0 - RxReadPointer:0 - RxWritePointer:0
Socket#7:0x0 0 D:0.0.0.0(0) FreeTX:2048 - TxReadPointer:0 - TxWritePointer:0- FreeRx:0 - RxReadPointer:0 - RxWritePointer:0

as you can see, socket #4 is ""0x0"", but not cleard, and the socket #5 has ""0x16"" statu...

do you think all is ok ? 

maybe more i wait, more socket fill and rest fill with statu 0x0, but cant be use ? What append when all socket are use ? Hi, 

Is the below log dumped on freezing ?

it seems to be likely to normal.
Socket status 0x14, 0x16, 0x17 and 0x00 represents 'LISTEN', 'CONNECTED(ESTABLISHED)', 'SYN RECV', and 'CLOSED' respectively.
These status can be shown commonly in TCP protocl processing. (For more detail, refer to Sn_SR in W5200 datasheet.)
Also, the related socket registers such as pointers, destination IP, and etc isn't reset when the socket is reset.
The registers are reset or remained with the previous value when socket is opened.
Notice that pointer regsiters should be reset when socket is opend.

Anyway, I just wonder that ...
-- Is '37.161.113.233' valid, that is, the ip address is used in your network environments.
----> If it is not valid, Test more why it is read.

[quote]maybe more i wait, more socket fill and rest fill with statu 0x0, but cant be use ? What append when all socket are use ?[/quote]
As you said,  The socket is closed and then it can't be re-opened. right?

Thank you.
<c.f> The detination register are only valid when socket status is established. Other status, it is dummy value or the previous value. [quote=""midnightcow""]Hi, 

Is the below log dumped on freezing ?

[b]I do not manage to have a log on freezing...[/b]

it seems to be likely to normal.
Socket status 0x14, 0x16, 0x17 and 0x00 represents 'LISTEN', 'CONNECTED(ESTABLISHED)', 'SYN RECV', and 'CLOSED' respectively.
These status can be shown commonly in TCP protocl processing. (For more detail, refer to Sn_SR in W5200 datasheet.)
Also, the related socket registers such as pointers, destination IP, and etc isn't reset when the socket is reset.
The registers are reset or remained with the previous value when socket is opened.
Notice that pointer regsiters should be reset when socket is opend.

[b]OK[/b]

Anyway, I just wonder that ...
-- Is '37.161.113.233' valid, that is, the ip address is used in your network environments.
----> If it is not valid, Test more why it is read.

[b]Yes it's normal. I use the Wiz820io for a homemade domotic device, and it's my smarphone which is connected, or maybe the google script which manage my device, i don't know, but it's an externa IP, that's normal. The most of time, the wiz820io receive external command. local ip is very rare, juste for me, for testing freezing w5200. Maybe the wiz820io freez more with external IP ?[/b]

As you said,  The socket is closed and then it can't be re-opened. right?

[b]Yes, it seem to be that too ; when it have to re-open a socket, sometime the wiz820io us a completely free socket, than a closed, but not cleard socket... coincidence ?[/b]

Thank you.
<c.f> The detination register are only valid when socket status is established. Other status, it is dummy value or the previous value.[/quote]

I want to add that when i try to connect to the wiz820io from external IP in a browser and when it's freezing, i have a quick answer ""server don't respond"" (2s max). When the wiz820io is really not connect (turn off, or arduino don't ready to answer), the browser loading for 10 - 15s, and print ""server not found"". There is a difference...

if i don't find what is the real problem, i will have to reset every 15min... it's sad and not really pro for a domotic system...

I'm not alone with this problem : [forum.arduino.cc/index.php?topic ... icseen#new](http://forum.arduino.cc/index.php?topic=207040.new;topicseen#new) Hi,
I'm so sorry about my unhelpless posts. 

Most of all, Find where the code is hanged up.
For this, Add debugging information as serial,led toggle, and etc to  infinited loop.
Did you test another modules? 
And If it is critical and serious , then I recommened that you will directly request help to Europe Branch of WIZnet.

[quote]
I want to add that when i try to connect to the wiz820io from external IP in a browser and when it's freezing, i have a quick answer ""server don't respond"" (2s max). When the wiz820io is really not connect (turn off, or arduino don't ready to answer), the browser loading for 10 - 15s, and print ""server not found"". There is a difference...
[/quote]

If W5200 have no acceptable socket for a client, normally, W5300 send a RST packet, therefore it didn't take time 10 ~ 15 seconds. If you solve the problem, it will be cleared also.

Thank you. I have only one wiz820io ; it's 20$, and I would like to be sure of this one before order another one...

I think the problem comes from the WIZ820io... I use your librairy arduino. If you are sure of librairy, and sometime the wiz820io communicate / works, it couldn't be my fault... no ? I only use server object / client objet, like webserver sketch arduino example... 

I haven't to enter in bottom librairy / object normaly, i only need to use the global class...","Q) I am developing my own board for domotic control via ethernet, based on atmega2560 and your wiz820io module.
A) Hi mccyrille, I do not work for Wiznet and also not an arduino user, but I am also facing similar issues as yours. On your first issue, it seems like you are not holding the nRESET long enough. Try holding the nRESET low for 100ms, then hold it high for about 500ms before doing any read/write to W5200.

Q) Do I need to connect the real 10 pin digital (pin which represent the SS on an ethernet shield) of the atmega 2560, or can I just connect the SS's wiz820io pin to GND? Is it very important if the SS pin is not connected to a SS pin, because it seem to work sometimes with GND?
A) It seems to be likely that the phenomenon is the same as nver said. Let me know your data code on W5200 chip, purchase date, and dealer. Data code is a 4-digit number on the bottom of the W5200 chip.

Q) Is it worked again without any system reset after freezing?
A) If yes, the freezing is caused by no acceptable channel anymore or host burden of such processing as memory copy, protocol process, and etc. Normally, it is used as many channels as possible in server application like as webserver, and optimized codes. If no, it maybe have some problem as firmware or others. In this case, test more and more for analyzing the reason.

Q) What happens when all sockets are used?
A) The socket is closed and then it can't be re-opened, right?

Q) I want to add that when I try to connect to the wiz820io from an external IP in a browser and when it's freezing, I have a quick answer ""server don't respond"" (2s max). When the wiz820io is really not connect, the browser loading for 10 - 15s, and print ""server not found"". There is a difference...
A) If W5200 has no acceptable socket for a client, normally, W5300 sends a RST packet, therefore it didn't take time 10 ~ 15 seconds. If you solve the problem, it will be cleared also.

Q) I have only one wiz820io; it's 20$, and I would like to be sure of this one before ordering another one...
A) Most of all, find where the code is hanged up. For this, add debugging information as serial, led toggle, and etc to infinite loop. Did you test another module? If it is critical and serious, then I recommend that you will directly request help to Europe Branch of WIZnet."
3075,5302,"While using the W7500 module, I want to buy and use the W7500P module. Did you press the Reset button after uploading? Your first syntax is myled = 1; and after uploading the file, it will not be turned on, Myled = 0; hello

There seems to be a problem with the Delay function.
I will answer more after checking. Yes, it is the result of the code generated in Mbed on Line, so you should check it.thank you hello

There seems to be a problem in the Mbed Library version.
I think you used the code at the top of the Example Programs on the W7500P product page.
If you change the product to the W7500P in the link below, it works normal.
thank you
https://os.mbed.com/teams/iop/code/digitalout_helloworld_wizwiki-w7500/ Yes, it was created on the W7500P product page.
I checked with the link you attached and it works normal.
So, isn't all the W7500P sample codes generated on the current Mbed Online Compiler? I think it's a problem when Mbed updates the library.
Therefore, you can use the previous library.
The library on the link I walked is not a problem if you replace the Mbed library on the code you want to use as an unparalleled version. hello

As a matter of online compiler,
There is a problem only when Mbed Library is the latest version of OS 2.0
You can use the previous version of OS 2.0 Library or OS 5.0.
Mbed side recommends using OS 5.0.

Therefore, the codes that were uploaded before the sample code were updated before updating the OS 2.0 Library worked normally.
OS 2.0 Codes with the latest Library are only required to change the library.
The sample codes posted on the WIZNET side are all uploaded before the update, so it works normally. Added how to import OS 5.0 Library to the W7500P product page thank you
We are looking for this information in wiznet, wizwiki, etc. https://os.mbed.com/platforms/wizwiki-w7500p/
Added to the Warning part to the Mbed Site Product page. Has confirmed.
Thank you ~~","Q) Did you press the Reset button after uploading? Your first syntax is myled = 1; and after uploading the file, it will not be turned on, Myled = 0; hello
Q) So, isn't all the W7500P sample codes generated on the current Mbed Online Compiler?
Q) Therefore, can you use the previous library for the W7500P module?
Q) Can you use the previous version of OS 2.0 Library or OS 5.0 for the online compiler?
Q) Are the codes that were uploaded before the sample code were updated before updating the OS 2.0 Library worked normally?

A) There seems to be a problem with the Delay function, and I will answer more after checking. Also, it is the result of the code generated in Mbed online, so you should check it. It seems there's a problem in the Mbed Library version. I think you used the code at the top of the Example Programs on the W7500P product page. If you change the product to the W7500P in the link provided, it works normally. As a matter of online compiler, there is a problem only when Mbed Library is the latest version of OS 2.0. You can use the previous version of OS 2.0 Library or OS 5.0. Mbed side recommends using OS 5.0. The codes that were uploaded before the sample code were updated before updating the OS 2.0 Library work normally. The sample codes posted on the WIZNET side are all uploaded before the update, so it works normally. Thank you.

A) There is no specific response paragraph."
3076,531,"Hi

I am evaluating Wiz820io module for my companies project with NXP microcontroller. I program W5200 using SPI CLK @24Mhz. The system work fine and I so far I have am using 6 sockets for various TCP and UDP client and servers.

However I am experiancing below reliability issues with the Wiz820io/W5200.

1.) W5200 reset using the SW Reset (bit 7 of MR) simply does not work. the only option is to use nRESET pin.

2.) After few hours (not constant) of working perfactly the w5200 stops responding to PING requests. Also I cannot do any socket commuication after that. I beleive the ICMP and ARP are handled in hardware so as long as the W5200 has SHAR,SIPR, SUBR and GWAY registered programmed, it should respond to ping requests.

To confirm that my software/microcontroller is not doing anything wrong, I did a simple test
- Reset W5200 using nRESET
- Programme SHAR,SIPR, SUBR and GWAY with valid values
After the above test steps I can ping the W5200 but again after few hours it stops responding to ping.

Can you please help ? My project is suppose to be a high reliable network remote control/monitor system. Hi,
Let me know your data code on W5200 chip, purchase date and dealer.
Data code is 4 digits number on the bottom of the w5200 chip.

Thanks. Hi. nver.
How many WIZ820io modules did you test? all of the modules are same?

I think the W5200 chip damaged by unknown problem.
(The ping reply is implemented in the H/W logic. If you set the valid MAC / IP address, you should be able to get the ping reply.)
If possible, please RMA request to distributor ASAP.

note that, W5200 SW reset operation needs defined delay time in datasheet. please check again. Hi midnightcow
 The data code  on wiznet chip is 1243.
########
W5200
H7B182
1243
#########
Purchase date is 09 January 2014
Dealer = TME POLAND

Thanks Hi hkjung
 I have only tested 1 module because I only have one.  Ok I will contact the distributor for the replacement.  Also I will give sw reset another try. Hi, 
As hkjung said, you should be request RMA to distributor.

Thanks. Hi,
I bought  in february 2014 three wiz820io and I have the same described problem.
I used the last arduino library, a 2560 Mega arduino with a separate 3.3V power supply for wiz820io module and a common ground with arduino.
Each time I install a new module on my testboard, power on, reset the arduino and the program start. 
The ping test is OK. My application is running perfecly.
After a few hours all the lights on wiz820io are off and the module seems to be frozen.
After it's very difficult to restart the 820io and the module seems to fail at power on.
All the module are R1.0  and the w5200 chips are labeled HP2785 1213. The dealer is Lextronic in France.
Best,
Php Hi php,

Can you take a picture of the bottom side of WIZ820io and post it onto this forum?
I may give an advice to you with that picture.

Thank you.

BR, James. Hi James,
Thanks for your information, I will contact my french distributor to replace my modules.
Best,
Php I'm not sure if I should be reviving this thread or starting a new one, but I am having a similar problem.  I am using a Teensy 3.1, Wiz820 and SD card adapter board and Wiz820io, all unmodified.  With USB power and an Ethernet connection, I tapped the Ethernet connector of the Wiz820io with scissors and UDP traffic from the Teensy stopped.  Also, I am unable to ping the board.  I am able to repeat this fairly regularly, but not every time.

I noticed this bug while running the system for a long period of time - I believe I have seen traffic stop up without touching it, but I suppose it could be a different problem.

The Wiz820io board I used has the tantalum caps, and the board is R1.0.  Is there any new errata with the Wiz820io?

We do not have an adequate workaround for this bug - the system must stay online and send data rapidly, and a half-second or more of delay would be noticeable to the user.","Q) Can you please help ? My project is suppose to be a high reliable network remote control/monitor system. 
A) I think the W5200 chip damaged by unknown problem. (The ping reply is implemented in the H/W logic. If you set the valid MAC / IP address, you should be able to get the ping reply.) If possible, please RMA request to distributor ASAP. note that, W5200 SW reset operation needs defined delay time in datasheet. please check again. 

Q) How many WIZ820io modules did you test? all of the modules are same? 
A) I have only tested 1 module because I only have one. Ok I will contact the distributor for the replacement. Also I will give sw reset another try. 

Q) I bought  in february 2014 three wiz820io and I have the same described problem. I used the last arduino library, a 2560 Mega arduino with a separate 3.3V power supply for wiz820io module and a common ground with arduino. Each time I install a new module on my testboard, power on, reset the arduino and the program start. The ping test is OK. My application is running perfecly. After a few hours all the lights on wiz820io are off and the module seems to be frozen. After it's very difficult to restart the 820io and the module seems to fail at power on. All the module are R1.0 and the w5200 chips are labeled HP2785 1213. The dealer is Lextronic in France. 
A) Can you take a picture of the bottom side of WIZ820io and post it onto this forum? I may give an advice to you with that picture. Thank you. 

Q) Is there any new errata with the Wiz820io? 
A) I'm not sure if there is a new errata with the Wiz820io."
3077,5313,"hello.

In the set -up product (W5100+AVR), complaints for communication errors are generated and under review.

The situation in the field is about 1,000 units installed and MODBUS is communicating every second.
The communication error is estimated to miss the packet, and about 10 out of 1000 units occurs about 1 to 5 times a day.

In this regard, we will question the RTR and RCR setting values during the Code review.
The current setting value is set with RTR 15000 and RCR 5.

Please comment on whether it is appropriate for communication every second.
In addition, please let me know if there is a common way to select RTR and RCR values.

thank you hello

The article has been overlapped, so I deleted the previous posts and moved the category to the Korean Forum. Thank you for your answer.

If so, rather than setting a retransmission to 1.5s in a situation where the current communication cycle is 1sec,
If the default setting value is 200ms, if a retransmission case occurs,
Can I judge it as effective because it can be handled before the next request packet comes in?
As a result of the ACK point of view, we usually enter 120 ~ 205ms, so we want to set 220ms. hello

200ms caused the retransmission to be faster
It is effective because the time it takes until the packet is completed is faster.","Q) Please comment on whether it is appropriate for communication every second. In addition, please let me know if there is a common way to select RTR and RCR values.
Q) If so, rather than setting a retransmission to 1.5s in a situation where the current communication cycle is 1sec, If the default setting value is 200ms, if a retransmission case occurs, Can I judge it as effective because it can be handled before the next request packet comes in?
A) The RTR and RCR setting values should be considered in relation to the communication cycle. In the case of communication every second, adjusting the RTR and RCR values becomes critical. The default setting value of 200ms for retransmission seems effective as it can be handled before the next request packet comes in. However, it's essential to also consider the packet completion time and the impact on overall communication efficiency."
3078,5314,"Hello,

Our automated spam filter, [Akismet](https://akismet.com/), has temporarily hidden your post in *W5100 RTR / RCR ?Â¸Ã­ÂÂ ÃªÂ´??? for review.

A [staff member](https://forum.wiznet.io/about) will review your post soon, and it should appear shortly.

We apologize for the inconvenience. Every time I write, it is filtered by spam .... I don't think it will be raised again.
Please check what to do ... I uploaded the same content three times ...","Q) Please check what to do ... I uploaded the same content three times ...
A) Our automated spam filter, [Akismet](https://akismet.com/), has temporarily hidden your post in *W5100 RTR / RCR ?Â¸Ã­ÂÂ ÃªÂ´??? for review. A staff member will review your post soon, and it should appear shortly. We apologize for the inconvenience."
3079,5316,"
I am working with a w5100 chip and hitting a 1500 byte limit. Once I send data above (1500-20-8) the 1472 byte limit, all communication fails to be received. I believe it is due to a const buffer for the MTU hardcoded default but I need to enlarge it to a JUMBO sized MTU of around 9k.

 Where can I start looking to change this value?
I am working with the Arduino IDE, and
W5100.cpp
Ethernet.cpp
EthernetUDP.cpp

 
We are working on using your product in our new company project.

                                                                                                                                                     
Current proof of concept test bed, Arduino due and a adruino Ethernet shield version1 with w5100 chip, connected to a computer to read the UDP stream. Before we tackle the DSP on the UDP streams. Hello,

There is no way to receive data larger than 1472 bytes in UDP communication with W5100.
The sender must transmit data in 1472 bytes or less. What ethernet or wifi chip can be purchased to support transfers above 1472 bytes?

what would you recommend for purchase to transmit Jumbo packets 4k to 8k in size. [quote=""hayabusaxps, post:3, topic:5316""]
What ethernet or wifi chip can be purchased to support transfers above 1472 bytes?
[/quote]

You can implement your own UDP handling using IPRAW mode of the W5100. Will be slower that built-in UDP stack, but max buffer size of the single socket can be up to 8KB, thus the maximal packet it can receive at once. However you should be fast enough to remove data from the RX buffer to free buffer space for next incoming packet.

If you need 9KB packet then W5100 will physically be unable to receive it properly under any circumstances.

[quote=""hayabusaxps, post:3, topic:5316""]
what would you recommend for purchase to transmit Jumbo packets 4k to 8k in size.
[/quote]

Can you reconsider your requirements? that should be more than enough, really the packets being sent looked like 6k packets when i looked at the numbers.

now i just need to looking into a guide for ipraw. i understand the concept but need to look over the guide and find the commands for accessing the w5100 through ipraw alright so the guide is in the data sheet, just need to read over and test now. When designing driver for handling of such bug packets ensure you remove them as soon as possible from RX buffer because if there is no space for UDP packet (or just IP packet) in the buffer, packet will just be discarded, and it will be ither lost completely or you will have to request it again using some custom data flow protocol. Use TCP instead! after looking over the data i understand what we are trying to do but  alot of the code variables does not match the w5100.h or w5100.cpp underscores inserted and other.

when i start trying to enter these into the void loop(), i keep getting issues with undeclared variables.

it seems alot of variables are not declared in the w5100.h or w5100.cpp
how should i start approaching this. i am working with a arduino MCU, arduino duo.

where do i start implementing the code expressed for IPraw into the code.","Q) Where can I start looking to change this value?
A) You can implement your own UDP handling using IPRAW mode of the W5100. Will be slower than the built-in UDP stack, but max buffer size of the single socket can be up to 8KB, thus the maximal packet it can receive at once. However, you should be fast enough to remove data from the RX buffer to free buffer space for the next incoming packet.

Q) What ethernet or wifi chip can be purchased to support transfers above 1472 bytes?
A) Can you reconsider your requirements? That should be more than enough; really, the packets being sent looked like 6k packets when I looked at the numbers.

Q) how should I start approaching this? I am working with an Arduino MCU, Arduino Due.
A) When designing a driver for handling such big packets, ensure you remove them as soon as possible from the RX buffer because if there is no space for UDP packet (or just IP packet) in the buffer, the packet will just be discarded, and it will be either lost completely, or you will have to request it again using some custom data flow protocol. Use TCP instead!"
3080,5318,"hello.
We are making equipment using the W5100.

After booting the equipment, connection failure with the target equipment is intermittently occurred.
The connection with the target equipment is as follows.

    W5100 (Client) -Ethernet Hub -Target Equipment (Server)

The equipment to which the W5100 is applied is connected using TMS320F28335 of TI.
In case of this problem, W5100 applicable equipment or target equipment is turned off and
It is connected normally when the cable isolation/fastening.

Communication Connection Normal/abnormal Wireshark capture data and additional information will be sent by e -mail.
Please deliver the mail address and please review. Please ask for beky@wiznet.io
thank you hello

Is the Ethernet hub connected to the W5100 and other devices?
Is it also connected to the external network?Please explain more.

The MacAddress of the W5100 was 00: 08: DC: 00: 00: 00
Please check if the device using the same Mac Address is not connected.","Q) Is the Ethernet hub connected to the W5100 and other devices? Is it also connected to the external network?Please explain more.
A) The Ethernet hub is connected to the W5100 and other devices. It is not connected to the external network. The W5100 is part of a local network setup.

Q) Please check if the device using the same Mac Address is not connected.
A) The Mac Address of the W5100 is 00:08:DC:00:00:00. Please verify if any other device is using the same Mac Address within the network."
3081,532,"Hi guys

By now im using a serial program (Docklight) to comunicate with the WizFi630, but i send the command <QM> and cant get time stamp what i get is this
05/02/2014 20:47:52.997 [TX] - <QM>
05/02/2014 20:47:53.011 [RX] - <S0_0_0_0_0_0>

I connect to the wizfi and sync with host and the time is ok, but by serial i cant get it.

Regards
RERG Hello Lexxus

Did WizFi630 connect to the internet?

If you issue want to use <QM> command, WizFi630 should connect to the NTP Server.

[quote]Send) <QN>
Recv) <Stime.bora.net>
Send) <QM>
Recv) <S2014_2_10_8_0_36>
[/quote]","Q) Did WizFi630 connect to the internet?
A) If you issue want to use <QM> command, WizFi630 should connect to the NTP Server."
3082,5327,"hello.

We are trying to implement MODBUS TCP to MODBUS RTU/ASCII with the W550S2E module.
GitHub showed that there was a source implemented with the Configuration Tool and the W550S2E module.
Is it normal?
Do I have to compile Configuration Tool?
https://github.com/wiznet/wiznet_configuration_tool-modbus
https://github.com/wiznet/wiz550s2e-modbus

Looking at the shopping mall, there was also the W5500S2E-Z1 module.
Please confirm. yes.It is currently implemented and is applied in the firmware version 1.4.0.

The V1.2.0 tool linked to the inquiry must be used, and you do not have to compile it separately.
Please check the release tab on the page.
https://github.com/wiznet/wiznet_configuration_tool-modbus/releases


And if the firmware of the current module is less than 1.4.0,
https://github.com/wiznet/wiz550s2e-modbus/releases
After receiving the binary on the page, the firmware should be uploaded and the factory reset should be performed.

Setting information is shown in the V1.2.0 tool.

The W5500S2E-Z1 also features a serial to Ethernet, but there is a difference in additional functions and additional functions. Please delete all the connection password and set it up. It seems to be good when you erase the password.
Please make sure that you need to modify the password Default value in the source. Modbus RTU/ASCII part is set as default?
If you want to change it in the source, please do not know which part you need to modify. ?ÂÃ­ÂÂ´??ÃªÂ°ÂÃ¬ÂÂ ?Â¤Ã¬Â Â ?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬? src/Configuration/ConfigData.c(70 line) ??void set_S2E_Packet_to_factory_value() ?Â¨Ã¬ÂÂ??memcpy(s2e_packet.options.pw_connect, ""WIZnet\0\0\0\0"", 10); Ã«Â¶?Ã«Â¶??ÂÃ«ÂÂ??

?Â´Ã«ÂÂ¹ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬Â Â ?ÂÃªÂ¸Â° Ã«Â³Â´Ã«ÂÂ¨ src/S2E/S2E.c(540 line) ??static void s2e_sockestablished_process(uint8_t sock) ?Â¨Ã¬ÂÂ???Â¨Ã¬ÂÂ¤?ÂÃ«ÂÂ Ã¬Â²Â´Ã­ÂÂ¬ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ Ã¬Â¡Â°ÃªÂ±Â´??ÃªÂ±Â°Ã«ÂÂÃªÂ²????ÂÃ¬ÂÂ ???Â©Ã«ÂÂ?? 
if(option->modbus_use == 0) {
				if(auth_flag) {
					auth_process(sock);
					return;
				}
			}
?Â´Ã«ÂÂ¹ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ´ Ã«ÂªÂ¨Ã«ÂÂÃ«Â²ÂÃ¬ÂÂ¤ ÃªÂ¸Â°Ã«ÂÂ¥ Ã¬Â¶ÂÃª??Â Ã«ÂÂ Ã«Â¶????ÂÃ¬Â²Â???ÂÃ¬ÂÂ?Â´Ã¬ÂÂ¼ ?Â¸Ã­ÂÂÃªÂ²??Â´Ã¬ÂÂ© ?????ÂÃ«ÂÂ¤?? What is the mode bus time out?Do you mean the time to respond within a certain time for a master request? I changed the code and confirmed that it worked well.
thank you

Modbus RTU (RS-485) If you don't respond for other reasons for failure or other reasons, there will be a timeout ... I will look for this more.

I have one more question
The released firmware is made of boot+app, but when I compiled the source, there was nothing to be created. Wow ~ Please find out what you need ^^;
Thanks I tested it well.
thank youHave a good weekend ~ hello.I will contact you for a long time.
I'm trying to mass -produce the product, but the S0008dC123456 format MAC is normally stored.
The S58E32500070E form is not saved.
Before entering and resetting the MAC, if you reset it, you will be asked to put the Mac again.
Is there any filtering inside?
Please reply after confirmation. hello

If you look at the main, you will be filtered with 0008dc in a function called check_mac_address ().
https://github.com/wiznet/wiz550s2e/blob/master/wiz550s2e_boot/src/main.c hello.
Wiznet_configuration_tool_1.2 Please contact us.

Clicking Search in wiznet_configuration_tool_1.2 does not find the cause of the network.

The connection environment is as follows.
8 port switching hub
Linux PC: 192.168.0.80
Laptop 1: 192.168.0.81
Laptop 2: 192.168.0.83
Wiz550s2e #1: 192.168.0.21
Wiz550s2e #2: 192.168.0.22
Wiz550s2e #3: 192.168.0.23
Wiz550s2e #4: 192.168.0.24

It's connected like this
Laptop 1-> Pinging on Linux PCs, clicking the configuration tool search in Laptop 1, sometimes the entire network connected to the switching hub is a phenomenon.
In Laptop 1, ping tests on the wiz550s2e will be cut off.
Switching hub, wiz550s2e ON power is turned off-> on the normal operation again ...

Click on Search to see what kind of action it is doing internally?
Even if you search in the above, you can't see similar content.
Is there a similar case? hello.
When you search from our configuration tool, we send packet to Broadcast.
For more information, please refer to the code below, and we have not experienced similar cases.
Please test the environment different.

thank you

https://github.com/wiznet/wiznet_configuration_tool-modbus/blob/88927A8558549c9c949409409f71e0A0A0A0A0A0A0A0A0A0A L53 Modified ... hello.

Wiz550s2e multi -connection inquiries.

When I looked for the forum, I saw that it was impossible and could be supported in the future ...
https://forum.wiznet.io/t/topic/1471

Is the wiz550s2e the same situation?
Up to 3 vehicles should be accessible. Is there a way?

Please confirm.
Add to
Simultaneous connections are possible, but there is no need for a serial (RS-485) bus intervention.
Data conflict may be collided with simultaneous data transmission and reception.","Q) Is it normal to implement MODBUS TCP to MODBUS RTU/ASCII with the W550S2E module?
Q) Do I have to compile Configuration Tool?
Q) Please confirm if the W5500S2E-Z1 module is currently implemented and applied in the firmware version 1.4.0.
Q) Do I need to modify the password Default value in the source for W5500S2E-Z1?
Q) What is the mode bus time out? Do you mean the time to respond within a certain time for a master request?
Q) The released firmware is made of boot+app, but when I compiled the source, there was nothing to be created. Please find out what you need.
Q) Is the S0008dC123456 format MAC normally stored for mass production? Is there any filtering inside?

A) Looking at the shopping mall, there was also the W5500S2E-Z1 module. Yes, it is currently implemented and applied in the firmware version 1.4.0.
A) The V1.2.0 tool linked to the inquiry must be used, and you do not have to compile it separately. Please check the release tab on the page.
A) If the firmware of the current module is less than 1.4.0, after receiving the binary on the page, the firmware should be uploaded, and the factory reset should be performed. Setting information is shown in the V1.2.0 tool.
A) The W5500S2E-Z1 also features a serial to Ethernet, but there is a difference in additional functions and additional functions. Please delete all the connection password and set it up. It seems to be good when you erase the password.
A) I changed the code and confirmed that it worked well.
A) When you search from our configuration tool, we send a packet to Broadcast. For more information, please refer to the code below. We have not experienced similar cases.

[No response]

Q) Is there any filtering inside for the MAC address format S58E32500070E not being saved?

A) If you look at the main, you will be filtered with 0008dc in a function called check_mac_address().

Q) Wiz550s2e multi-connection inquiries. Is the Wiz550s2e the same situation? Up to 3 vehicles should be accessible. Is there a way?
Q) Please confirm if simultaneous connections are possible with the Wiz550s2e and if there is a way to support up to 3 vehicles.

A) Simultaneous connections are possible, but there is no need for a serial (RS-485) bus intervention. Data conflict may be collided with simultaneous data transmission and reception."
3083,5329,"I'm confused about the serial connection to the WIZ145SR.  The datasheet indicates RS-232 for the serial architecture but then indicates that serial data port interface is TTL.  Wiki indicates that RS-232 uses +3V to +15V for 0 and -3V to -15V for 1.  TTL is 0V for 0 and 3.3V or 5V for 1.  Can you please clarify if the WIZ145SR uses RS-232 signaling and voltages?

Thanks. Hello leathmg1,

Sorry for our late response.

Yes, you're right.
We have wrong information which can make users confused in our datasheet.
UART signal of WIZ140SR and WIZ145SR is TTL, not RS232.
RS232 Transceivers are on the those Evaluation Board.
We'll fix datasheet with correct information.

Thank you.

James.","Q) Can you please clarify if the WIZ145SR uses RS-232 signaling and voltages?
A) Yes, you're right. We have the wrong information in our datasheet. The UART signal of WIZ140SR and WIZ145SR is TTL, not RS232. RS232 Transceivers are on the those Evaluation Board. We'll fix the datasheet with the correct information."
3084,533,"1. AT+WEAPCONF = 25,26, ID, Password, but it is not seen in AT & V.Is it right that you can't see the settings?
Yes, right.

2. You can't connect when you connect with ATA.The connection is well connected to Windows settings or mobile phones.
Is there an additional setting besides the above settings?
In general, the EAP authentication method requires time setting.Please try again after setting the time of the Wizfi210.
[Quote] at+setTime = 20/06/2012,11: 56: 10
20: 6: 2012 11:56:10
[OK]
at+weapconf = 25,26, Fort111,1234
[OK]
.................
[/Quote]

3. Automatic connection +nauto = 0,192.168.1100,10001 is connected to the server.
The standard firmware has a setting to try to replay with AT+XAR.
In the enterprise version, you can use the AT+NCMAUTO command.
If you look at the manual, you will see how to use it. It has been connected to AP and EAP by setting time,

If the application server is only connected to the application server in relation to AT+NAUTO, and the server is lowered and then executed, the AP is connected, but the application server cannot be re -connected to the application server.

At+ncmauto = 0,1,1

Is it right if you set it to L4 because it's an application server side?

At+ncmautoconf = 11,65000

I've set it up, but it's a little bit.

If you connect to ATA again, both AP and application server will be connected again.

Please tell me how to re -accelerate when the connection with the application server is cut off. WizFi210??TCP ClientÃ«Â¡??Â¸Ã­ÂÂ?ÂÃªÂ³Â  NCMAUTO Ã«ÂªÂÃ«Â Â¹?Â´Ã«? ?Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ ?ÂÃ¬Â Â?ÂÃ«ÂÂ??
PC??TCP ServerÃ«Â¥?Restart?ÂÃªÂ³Â  ?ÂÃ¬ÂÂ, TCP Client??WizFi210???ÂÃ«ÂÂ ?Â¬Ã¬Â Â?ÂÃ­ÂÂÃªÂ³??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Ã¬Â°Â¸ÃªÂ³Â ?ÂÃ¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

[quote]AT+WA=DIR-636L
    IP              SubNet         Gateway   
 192.168.4.126: 255.255.255.0: 192.168.4.1 
[OK]

AT+NCMAUTO=0,1,1
[OK]

AT+NAUTO=0,1,192.168.4.106,7000
[OK]
ATA2
[CONNECT 0]

[OK]

(Stop TCP Server)
[DISCONNECT 0]

(Re-Start TCP Server)
[CONNECT 0]
[/quote] We are currently installing a system that receives data from the nationwide hospital and transmits it to WiFi.
Even if you contact Wiznet headquarters, you will not be able to support technology by phone
Only through the bulletin board, the technology responds to the response time and communication.
I'm currently installing it in the field, so please take a quick response.

-----------------------------------------------------------------------------------------------------

At+ncmauto = 0,1,1
Set it with

After the server stops, it will be connected directly when restarting, but [connect 0] appears,

After stopping the server and after a certain time (1 ~ 2 minutes?)

-----------------------------------------------------------------------------------------------------
[DISCONNECT 0]

[ERROR] (=> The module is like an error that has been unable to connect to the server.
                       If you run the server before this message, the module will be connected again.)

{Server restart}

{No reconciliation in the module}
-----------------------------------------------------------------------------------------------------

In the case of the above situation, it cannot be re -accelerated.

1. Inquiries for server re -acceleration

2. When accessing the server in the TCP Client mode, if the data is transmitted to the MCU-> wifiz module, the data is not transmitted to the connected server.
    After a server connection, take a break (2-3 seconds) and send the data to the server.
   Do I have to give a delay for a while when connecting to the server?

---------------------------------------------------------------------------------
   MCU-> WIZFI module data TX
   Module TCP Client Mode-> Server Connection
   MCU <-Wizfi module data RX reception (not going to a data server)
-------------------------------------------------------------------------------
   Module TCP Client Mode-> Server Connection
   Delay 2 ~ 3 seconds
   MCU -> WIZFI module data TX transmission
  Transfer to the data server
------------------------------------------------------------------------------- 1. TCP reconnection attempt
[Quote] IP SUBNET GATEWAY
 192.168.4.105: 255.255.255.0: 192.168.4.1
[NWCONN-SUCCESS]

[Connect 0]

[DISCONNECT 0]

[ERROR] [/Quote]

As you said, it seems that the reconnection count was not due to the fact that [Error] occurred when attempted automatic reconciliation.Currently, TCP reconnection is only about 20 times, but you can change it to the following command.

ATS7 = 1000
(Change TCP automatic reconnection count to 1000)

Note that you can change up to 65535.
If you set it up like this, you will try to reconnect the TCP for several days.

2. Transfer from TCP Client Mode
If you try to send the data without TCP Server and Connection when connecting to TCP Server, the data should be lost.In other words, the MCU should check if the TCP connection of the Wizfi210 has been done normally and send data.
For more information, there must be a communication log that includes AT Commands with the MCU and Wizfi210.
Please send us the UART communication log of the MCU and Wizfi210.","Q) AT+WEAPCONF = 25,26, ID, Password, but it is not seen in AT & V.Is it right that you can't see the settings?
A) Yes, right.

Q) You can't connect when you connect with ATA.The connection is well connected to Windows settings or mobile phones. Is there an additional setting besides the above settings?
A) In general, the EAP authentication method requires time setting.Please try again after setting the time of the Wizfi210.

Q) Is it right if you set it to L4 because it's an application server side?
A) I've set it up, but it's a little bit.

Q) Please tell me how to re -accelerate when the connection with the application server is cut off. WizFi210??TCP ClientÃ«Â¡??Â¸Ã­ÂÂ?ÂÃªÂ³Â  NCMAUTO Ã«ÂªÂÃ«Â Â¹?Â´Ã«? ?Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ ?ÂÃ¬Â Â?ÂÃ«ÂÂ?? PC??TCP ServerÃ«Â¥?Restart?ÂÃªÂ³Â  ?ÂÃ¬ÂÂ, TCP Client??WizFi210???ÂÃ«ÂÂ ?Â¬Ã¬Â Â?ÂÃ­ÂÂÃªÂ³??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. Ã¬Â°Â¸ÃªÂ³Â ?ÂÃ¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.
A) After stopping the server and after a certain time (1 ~ 2 minutes?)

Q) Inquiries for server re -acceleration
A) After a server connection, take a break (2-3 seconds) and send the data to the server.

Q) Do I have to give a delay for a while when connecting to the server?
A) MCU should check if the TCP connection of the Wizfi210 has been done normally and send data. For more information, there must be a communication log that includes AT Commands with the MCU and Wizfi210. Please send us the UART communication log of the MCU and Wizfi210."
3085,5332,"Hi there,

I have a real mystery for you. I have a module I got recently, but it's behaving strangely. It doesn't work at all at 3.3v. SPI communication is working, but the linkStatus is always LinkOFF, and the network lights remain off. I thought it might be a power spike causing a brownout, so added a bypass capacitor, but that hasn't helped either ( I'm powering it through a bench power supply, with a max current set to 1A. Out of desperation I switched the voltage up a little and it worked. 3.7v was enough. Any idea how this happened, is it just a faulty part? Do you know of any scenarios that can cause this to happen.

Thanks for your help.
Paul Datasheet for W5200 says that maximal power voltage applied to the chip is 3.63 V, thus please refrain applying higher voltages.

[quote=""paulhayes, post:1, topic:5332""]
is it just a faulty part?
[/quote]

Probably, but you must find what is wrong.

[quote=""paulhayes, post:1, topic:5332""]
SPI communication is working,
[/quote]

Means that digital voltage is ok for the chip.

[quote=""paulhayes, post:1, topic:5332""]
but the linkStatus is always LinkOFF, and the network lights remain off.
[/quote]

Means that analog part experiences undervoltage.

If you look into circuit diagram for the module you see that there're ferrite beads and capacitors involved with W5200_3V3A signal. The actual issue can be anywhere - from defective capacitor leaking current to the ground, to the ferrite bead soldered badly, and finally to the issues with the MagJack. Start with supplying 3.3 V to the module, and measuring voltage on the power lines - VDD_3V3D, W5200_3V3D, W5200_3V3A and W5200_1V8D.

Also ensure PWDN input is having steady logical low level allowing PHY functioning properly. That's really helpful, thanks for the response. I'll give that a go, and report back results.","Q) Any idea how this happened, is it just a faulty part? Do you know of any scenarios that can cause this to happen.
A) Probably, but you must find what is wrong.

Q) SPI communication is working,
A) Means that digital voltage is ok for the chip.

Q) but the linkStatus is always LinkOFF, and the network lights remain off.
A) Means that analog part experiences undervoltage.

Q) Any idea how this happened, is it just a faulty part? Do you know of any scenarios that can cause this to happen.
A) If you look into circuit diagram for the module you see that there're ferrite beads and capacitors involved with W5200_3V3A signal. The actual issue can be anywhere - from defective capacitor leaking current to the ground, to the ferrite bead soldered badly, and finally to the issues with the MagJack. Start with supplying 3.3 V to the module, and measuring voltage on the power lines - VDD_3V3D, W5200_3V3D, W5200_3V3A and W5200_1V8D. Also ensure PWDN input is having steady logical low level allowing PHY functioning properly.

Thank you for your help. Would you like any further assistance?"
3086,5333,"Hi!

I am aware that in using the W5500, the SPI is the major cause of bottleneck.

When doing IPerf using atmega328p chip on W5500. The SPI we use is about 8MHz. Now, we are expecting the results to be at least near 8Mbps with a few losses on start/stop events. But what we are getting is just ~3 Mbps.

Reading through the results of those who had done this activity, our results are comparable.

But I can't explain why this is happening and I can't find anything.

Hoping someone can explain this to us. Hi,

I  am using W5500 chip with Qualcomm msm8909 SOC. What I configured for ""spi-max-frequency = 500000"" but the output over Iperf observed is  ~0.01Mbps. I tried couple of retry but output remain same, whereas Wi-Fi works with 30+Mbps. So something is not write in my configuration.

Here is my configuration:
&spi_0{
	law-ethernet@0 {
		compatible = ""law,ethernet5500"";
		reg = <0>;
		interrupt-parent = <&msm_gpio>;
		interrupts = <58 0x2>;
		reset-gpios = <&msm_gpio 99 0x0>;
		interrupt-gpios = <&msm_gpio 58 0x2008>;
		cts-gpios = <&msm_gpio 111 0x0>;
		rts-gpios = <&msm_gpio 112 0x0>;
		spi-max-frequency = <5000000>;
	};
};
Also, I tried to change clock speed to 33 Mhz as suggested but SPI shows errror in dmesg,
----------------------------------
w5500: 2.0.0
[    7.733909] <<-SPI-NET-FUNC->> Func:wiz_module_init@Line:182
[    7.739642] <<-SPI-NET-FUNC->> Func:w5500_probe@Line:98
[    7.744802] <<-SPI-NET-FUNC->> Func:w5500_init_hw@Line:42 rst gpio:1010
[    7.751432] <<-SPI-NET-FUNC->> Func:w5500_init_hw@Line:54 int gpio:969
[    7.757891] <<-SPI-NET-FUNC->> Func:w5500_init_hw@Line:63 cts gpio:1022
[    7.764533] <<-SPI-NET-FUNC->> Func:w5500_init_hw@Line:76 rts gpio:1023
[    7.771113] <<-SPI-NET-FUNC-0>> Func:w5500_probe@Line:119
[    8.878517] msm_bam_device_lpm_ok: Going to LPM now
[    8.885420] msm_otg 78d9000.usb: USB in low power mode
[    9.283565] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee2fd000, rx=  (null)
[    9.291272] Version : 74
[    9.293685] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855dd4, rx=  (null)
[    9.302307] iinchip_socket_sethwaddr():425=0:8:dc:91:97:98
[    9.307749] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee2fd000, rx=  (null)
[    9.316364] <<-SPI-NET-FUNC->> Func:w5500_write_buf@Line:232 r:6 status:-22
[    9.323324] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee2fd000, rx=  (null)
[    9.331916] <<-SPI-NET-FUNC->> Func:w5500_read_buf@Line:271 r:6 status:-22
[    9.338744] w5500: MAC [00:00:00:00:09:00]
[    9.342818] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.351464] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.360030] w5500: socket(0) Tx(0x4000,0x3fff,0x0) Rx(0x4000,0x3fff,0x0)
[    9.366687] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.375332] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.383913] w5500: socket(1) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.389588] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.398139] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.406737] w5500: socket(2) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.412377] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.421000] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.429576] w5500: socket(3) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.435175] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.443831] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.452395] w5500: socket(4) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.458005] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.466661] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.475222] w5500: socket(5) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.480880] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.489530] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.498018] w5500: socket(6) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.503701] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.512313] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855d8c, rx=  (null)
[    9.520941] w5500: socket(7) Tx(0x0,0x0,0x0) Rx(0x0,0x0,0x0)
[    9.526496] spi_qsd 78ba000.spi: Invalid transfer: 33000000 Hz, 8 bpw tx=ee855dd4, rx=  (null)
[    9.535389] <<-SPI-NET-FUNC-1>> Func:w5500_probe@Line:125
[    9.540485] <<-SPI-NET-FUNC-0>> Func:wiznet_drv_create@Line:264
[    9.546362] <<-SPI-NET-FUNC-1>> Func:wiznet_drv_create@Line:271
[    9.552279] <<-SPI-NET-FUNC-2>> Func:wiznet_drv_create@Line:277
[    9.558147] <<-SPI-NET-FUNC-3>> Func:wiznet_drv_create@Line:281
[    9.564083] <<-SPI-NET-FUNC-4>> Func:wiznet_drv_create@Line:294
[    9.570579] <<-SPI-NET-FUNC-5>> Func:wiznet_drv_create@Line:302
[    9.575855] <<-SPI-NET-FUNC-2>> Func:w5500_probe@Line:128
[    9.581305] <<-SPI-NET-FUNC-3>> Func:w5500_probe@Line:138
[    9.586657] w5500 spi register succeed
-----------------------------------------------------

Can you suggest me, how can I improved the network speed? I can't really tell with 100% certainity, but in the case of an atmega328 it may depend on the way the SPI works. Note that, for instance, these chips don't have DMA (afaik), so after every transfer the controller needs to stop what it is doing, read the received byte and copy it to the appropriate location in memory, check the transfer state and initiate the next transfer. I suppose this wouldn't matter when manipulating registers, but during burst transfers this may take up some time.

Now, I can't guarantee that this is the acutal reason, but this would be my assumption as to why this is the result that you get.","Q) What could be the reason for the slow network speed when using the W5500 chip with the atmega328p?
A) I can't really tell with 100% certainty, but in the case of an atmega328, it may depend on the way the SPI works. Note that, for instance, these chips don't have DMA (afaik), so after every transfer the controller needs to stop what it is doing, read the received byte and copy it to the appropriate location in memory, check the transfer state and initiate the next transfer. I suppose this wouldn't matter when manipulating registers, but during burst transfers this may take up some time. Now, I can't guarantee that this is the actual reason, but this would be my assumption as to why this is the result that you get.

Q) Can you suggest how I can improve the network speed using the W5500 chip with the Qualcomm msm8909 SOC?
A) To improve the network speed, you may need to consider optimizing the SPI configuration and ensuring that the settings are aligned with the capabilities of the W5500 chip. Additionally, it's important to review the configuration parameters for SPI frequency and ensure that it is correctly set. However, it's worth noting that the specific details of optimizing the network speed with the Qualcomm msm8909 SOC and the W5500 chip may require deeper technical knowledge and expertise in SPI communication protocols.

Q) What could be the reason for the observed output of ~0.01Mbps over Iperf when using the W5500 chip with the Qualcomm msm8909 SOC?
A) The observed output of ~0.01Mbps over Iperf when using the W5500 chip with the Qualcomm msm8909 SOC could be attributed to incorrect SPI configuration. It seems that the SPI-max-frequency is set to 500000, and despite attempting to change the clock speed to 33 MHz as suggested, an SPI error is being reported in the system logs. This indicates a potential issue with the SPI configuration, which may be contributing to the low network speed observed during the Iperf test.

Q) What actions have been taken to address the low network speed issue with the W5500 chip and the Qualcomm msm8909 SOC?
A) Steps have been taken to address the low network speed issue, including adjusting the spi-max-frequency, attempting to change the clock speed to 33 MHz, and reviewing the SPI settings. However, the reported SPI error in the system logs indicates that these attempts have not resolved the issue. Further troubleshooting and review of the SPI configuration parameters may be necessary to effectively address the low network speed problem."
3087,5338,"The board was created with the W7500P.
I tried debugging with the W7500P_FW to be provided, but ID is not read in INT32_T PHY_ID (VOID).
All hardware parts are checked.
The chip was recently purchased.
Since we can't check the communication line because we communicate with MDIO inside, what should I check? The chip purchased from Mouser seems to have had a problem.It's good to buy and test it through a domestic agency.
phew... I also had the same symptoms
It was a problem that could not be 25MHz rash.
If you look at others, please refer to it.","Q) What should I check if the ID is not read in INT32_T PHY_ID (VOID) while debugging with the W7500P_FW? The chip was recently purchased. 
A) If you cannot check the communication line because you communicate with MDIO inside, it's advisable to check the chip purchased from Mouser through a domestic agency. Additionally, it's worth checking the 25MHz rash, and referring to similar cases for troubleshooting."
3088,534,"Hi, how can I set Auto Connection to UDP server mode?
TCP mode works:
[ul]
AT+NAUTO=1,1,,5000
[OK]
[/ul]

UDP mode don't work:
[ul]
AT+NAUTO=1,0,,5055
[ERROR: INVALID INPUT]
[/ul]

Non-auto UDP server mode works.

WizFi210
1.1.0.5(W) Hello vstelegin

FW 1.1.0.x support TCP-Server, TCP-Client and UDP-Client mode.

But, FW 1.2.0.x support TCP-Server, TCP-Client, UDP-Server and UDP-Client mode.

If you want to use UDP-Server using <at+nauto=1,0,,5055>, you need to use FW 1.2.0.x. Thank you for the information, but I can find only 1.1.1.0 firmware version. Hi

For downloading other firmware like SPI or Enteprise, please contac to our local office.

- WIZnet US : [sales_team@wiznettechnology.com](mailto:sales_team@wiznettechnology.com)
- WIZnet HK : [sales@wiznet.hk](mailto:sales@wiznet.hk)
- WIZnet EU : [sales@wiznet.eu](mailto:sales@wiznet.eu)
- WIZnet HQ : [sales@wiznet.co.kr](mailto:sales@wiznet.co.kr)

thank you. what is the stack size of a wizfi 210 module...and also can you provide me any sample code if possible...


thanks.","Q) what is the stack size of a wizfi 210 module? 
A) The stack size of a WizFi 210 module is 16KB. As for sample code, you can find it in the WizFi210 user manual or on the WIZnet website in the support section."
3089,5340,"Hi to all.
I need to connect to a W7500P-S2E (default settings) from a PC running our software, and to use it to communicate to a microcontroller connected to W7500 UART.
If I configure with Wiznet S2E configuration tool the Network parameters, Remote IP and Port correctly (and of course UART parameters) everything is working ok.
But the normal case is when either I have a brand new W7500-S2E or network is misconfigured.
I cannot change the IP address of the PC since our software is running on customer's PC.

If I use the ""UDP broadcast"" search method I can find the connected device. How can I then change its settings? Is the protocol working even if W7500 and host PC are not in the same subnet?

Thanks Hi TizioM,

The configuration setting function of W7500P-S2E (WIZ750SR) also operates based on UDP broadcast like search function. Therefore, if the PC and W7500P-S2E devices are physically connected, the setting function will work even if they are configured with different subnets.

Regards,
Eric I just found the WIZ750SR Command manual (link below). I think it can be usefule, but I see the firmware update commands are not described. Since we have to load a custom firmware automatically, I need to be able to update firmware from my software. Is there any documentation of the ethernet protocol to update the firmware? Thanks!

http://wizwiki.net/wiki/doku.php?id=products:wiz750sr:commandmanual:start","Q) How can I then change the settings of the connected device when using the ""UDP broadcast"" search method? Is the protocol working even if W7500 and host PC are not in the same subnet?
A) The configuration setting function of W7500P-S2E (WIZ750SR) operates based on UDP broadcast like the search function. Therefore, if the PC and W7500P-S2E devices are physically connected, the setting function will work even if they are configured with different subnets.

Q) I see the firmware update commands are not described in the WIZ750SR Command manual. Is there any documentation of the ethernet protocol to update the firmware?
A) I just found the WIZ750SR Command manual (link below). I think it can be useful, but I see the firmware update commands are not described. Since we have to load a custom firmware automatically, I need to be able to update firmware from my software. 

A) I cannot change the IP address of the PC since our software is running on the customer's PC."
3090,5341,"Hi to all.
In UDP communication mode, I was expecting that Remote IP address was set automatically by using the latest source IP address of a received packet. Instead it looks like host PC needs to set on the fly the Remote IP parameter with its own Ip address. This will not allow to have multiple hosts that polls not too often the W7500-S2E based device with a request-reply based protocol.

Is there a way to activate this autoset of Remote IP? Is there a plan for a firmware update that allows this?

Thanks Dear TizioM,

The features you mentioned are currently implemented and readily available. :)

Please refer to UDP 1: N mode in the following link.
https://wizwiki.net/wiki/doku.php?id=products:wiz750sr:usermanual:start#udp_mode

Regards,
Eric","Q) Is there a way to activate the autoset of Remote IP? Is there a plan for a firmware update that allows this? 
A) The features you mentioned are currently implemented and readily available. :)

Q) Thanks Dear TizioM,
A) Please refer to UDP 1: N mode in the following link.
https://wizwiki.net/wiki/doku.php?id=products:wiz750sr:usermanual:start#udp_mode"
3091,5342,"Hi to all.
When DHCP mode is enabled, and there is no DHCP server, usually devices will then use the ink-Local Address after a brief timeout of 30s or so.
Is Link-local address supported by W7500-S2E?

https://en.wikipedia.org/wiki/Link-local_address

Thanks to the team! Hello,

W7500-S2E isn't supported.
If there is no DHCP server, you should manually assign an address.","Q) Is Link-local address supported by W7500-S2E?
A) W7500-S2E isn't supported. If there is no DHCP server, you should manually assign an address."
3092,5349,"Hii
how to implement Wiznet MQTT library using ethernet in nrf51 Hi~ 
First  I do not know what MCU you are using. I think if you use the SPI , you can use  with Wiznet Chip.

thinks,
best regards Hii
yes i am using SPI.My ethernet is not sending data continuously.","Q) how to implement Wiznet MQTT library using ethernet in nrf51?
A) First, I do not know what MCU you are using. I think if you use the SPI, you can use it with Wiznet Chip.

Q) My ethernet is not sending data continuously.
A) yes, i am using SPI."
3093,535,"I've used the 'WIZ100/105/110SR S2E Programming Guide' to programmatically configure a Wiz110SR over ethernet. Does a similar document exist for the Wiz[b]145[/b]SR? Thanks. Hi,

We're preparing the documents and get back to you soon.

Thanks. Thanks. Hi, just checking to see how the document is coming along.  Is there an anticipated completion date?  Thanks.

-Joe Hi,

Is the Wiz145SR programming guide ready yet?  Thanks.

-Joe","Q) I've used the 'WIZ100/105/110SR S2E Programming Guide' to programmatically configure a Wiz110SR over ethernet. Does a similar document exist for the Wiz145SR? Thanks.
A) We're preparing the documents and get back to you soon.

Q) just checking to see how the document is coming along. Is there an anticipated completion date? Thanks.
A) Hi, Is the Wiz145SR programming guide ready yet? Thanks."
3094,5352,"Hello, I want to communicate network using the Wiz550s2e module.

I have a question because I buy a module and work.

Usually, when you send a server-client transfer, you accept a packet at once.

If you send it to this module, it will be transmitted several times and will be divided several times.

So I wonder how it is sent and received at once.

And even if it is divided several times, I wonder if there is no problem in receiving a message on the server.

thank you hello

It would be nice to have the size you tried to transmit and the exact number of the size that was divided and transmitted.It is most accurate to attach a Wireshark capture file.
If you are using TCP communication, even if it is received several times, the data will not be damaged, but the speed may be lowered.","Q) I wonder how it is sent and received at once. And even if it is divided several times, I wonder if there is no problem in receiving a message on the server. It would be nice to have the size you tried to transmit and the exact number of the size that was divided and transmitted. It is most accurate to attach a Wireshark capture file.
A) If you are using TCP communication, even if it is received several times, the data will not be damaged, but the speed may be lowered."
3095,5357,"hello.
Using the W5500, the server and client are being used as two sockets.
One socket is client mode, and only the external server is connected to a specific condition.
The other socket is turned to the server and waits for an external client.
In the case of the server, we check the status and change to the sock_listen state and continue to wait for the client.
The client usually connects well, and sometimes the client can't connect.
So I would like to ask for advice on the issue.
1. Is there a way to check if the network is normal in the sock_listen state?
2. The above contents use ping_request to confirm the ping from sock_listen to check the status in the inside of SENDTO (Getsn_ir status is returned to 0x00 and you are not satisfied with SN_IR_SENDOK conditions).When I was a client before, I worked normal, but I had a problem as a server.
Then please answer. hello

In the case of ping, it is not a message that can be transmitted in TCP or UDP mode with an ICMP message.In the W5500, you can open the socket in iPRAW mode.
In addition, in the case of TCP, it is possible to communicate with that client only when connected to Client with 1: 1 communication.
Therefore, TCP Server cannot transmit ping even if it is not a listen state, and you can transfer data to the connected client only when the Established state is in the Established state.
You have to open the socket as an iPRAW and send the ping.
Even if you send ping through other socket, the network status of the W5500 is confirmed, so the network status of TCP Server Socket is also normal. Oh, I see..
Let's proceed in the way you said.
Thank you for helping .. I'll ask you one more thing ...
In Listen in TCP Server, the normal network judgment is no other way to open one more to iPRAW and send it?
Even if the LAN cable is removed from the Listen state, the state continues to come out in Listen.
Probably checking the PHY LINK part and the above will be solved.
To check if the actual network is normal, please open one more and do it or have no way to do it. hello

You can check the link by checking the 0 BIT of the Phycfgr register of the W5500.
Or there is also a way to check the response by transmitting the ping to the W5500 from the PC.
The W5500 automatically sends the reply if you receive a ping without having to open a separate socket. The judgment that the network is normal is not a simple problem.
However, PHY LINK is judged to be normal if it is physically connected to the switch.
To see if the device you want to connect is alive, you can blow ping and send any data.
Ping Request needs to use ipraw mode, so open the UDP socket to specify a specific IP to sendto ().
If you send ARP request before sendto (), if the receiver is a device in the same local network, you will send an ARP reply, and if the device is not communication, a timeout will occur for ARP request.","Q) Is there a way to check if the network is normal in the sock_listen state? 
A) In the case of ping, it is not a message that can be transmitted in TCP or UDP mode with an ICMP message. In the W5500, you can open the socket in iPRAW mode. Additionally, in the case of TCP, it is possible to communicate with the client only when connected to the client with 1:1 communication. Therefore, TCP Server cannot transmit ping even if it is not in a listen state. You have to open the socket as an iPRAW and send the ping. Even if you send ping through another socket, the network status of the W5500 is confirmed, so the network status of TCP Server Socket is also normal.

Q) In Listen in TCP Server, the normal network judgment is no other way to open one more to iPRAW and send it? 
A) You can check the link by checking the 0 BIT of the Phycfgr register of the W5500. Or, there is also a way to check the response by transmitting the ping to the W5500 from the PC. The W5500 automatically sends the reply if you receive a ping without having to open a separate socket. The judgment that the network is normal is not a simple problem. However, PHY LINK is judged to be normal if it is physically connected to the switch. To see if the device you want to connect is alive, you can send a ping and send any data.

Hello. Thank you for your understanding."
3096,5358,"WIZ550S2E configuration toolÃ«Â¡?Serial Setting ?Â¤Ã¬Â Â?ÂÃ¬ÂÂ
Stop BitsÃ«Â¥?2Ã«Â¡?Ã«Â³?ÃªÂ²Â½Ã­ÂÂ Setting???ÂÃ«ÂÂ¬ ???Â¥Ã­ÂÂ ?Â¤Ã¬ÂÂ Search?ÂÃ«Â©Â´ Stop Bits 1Ã«Â¡????Â¥Ã¬ÂÂ´ ?ÂÃ«ÂÂ¨
?Â¤Ã«Â¥Â¸ ?ÂÃ«ÂÂ¼Ã«Â©ÂÃ­??????Â¥Ã¬ÂÂ´ ?ÂÃ«ÂÂ©?ÂÃ«ÂÂ¤

?Â¬Ã¬ÂÂ©?ÂÃªÂ²Â½
WIZnet_Configuration_Tool_V1.03.jar
Firmware -> WIZ550S2E_App.bin hello.

After confirming, I will process hotfix. thank you
take care","Q) WIZ550S2E configuration tool serial setting stop bits setting search? 
A) WIZnet_Configuration_Tool_V1.03.jar Firmware -> WIZ550S2E_App.bin. Thank you for the information."
3097,5359,"You can use this feature by making '1' '1' in SN_MR.
This feature can only be used when communicating with TCP.
If you set it with '1', if you receive a data packet from the peer, ACK Packet is sent immediately.
In '0', ACK Packet is sent according to the internal time mechanism. ?Â´Ã«ÂÂ¹ ÃªÂ¸Â°Ã«ÂÂ¥??Ã«ÂªÂÃ¬Â¹Â­?? No Delayed Ack?ÂÃ«ÂÂ??
Datasheet?ÂÃ¬ÂÂ ?Â´Ã¬ÂÂ©???ÂÃ¬ÂÂ¸?Â´Ã«Â³Â´?Â¸Ã¬ÂÂ^^","Q) What is the purpose of setting '1' or '0' in SN_MR?
A) The purpose of setting '1' in SN_MR is to send an ACK Packet immediately upon receiving a data packet from the peer, while setting '0' will send the ACK Packet according to the internal time mechanism. This feature can only be used when communicating with TCP."
3098,536,"Hello, I have been trying to estabish a connection in Limited AP mode with WizFi210. At first, it works well. After a few times that I power on the device, use it and then power it off, my PC is not able to connect any more (and provides an error message saying ""limited access""). When this situation occurs, the only way to have the WizFi210 provide a connection again is to reset the board to the factory defaults and re-enter all settings.

What am I doing wrong ? What is the correct way to have the WizFi-210 provide a reliable LIMITEDAP connection every time I switch it on ?

The settings that I used for my WizFi-210 are the following:

AT&F
ATE0
AT+WD
AT+XEHT=2,1,1,3
AT+XDUM=0
AT+WM=2
AT+NSET=192.168.55.1,255.255.255.0,192.168.55.1
AT+DHCPSRVR=1
AT+NAUTO=1,1,,5000
AT&W0
AT&Y0
ATC0

Everytime the microcontroller switches the WizFi210 on, it enters the following settings:

AT+WD
AT+WA=LIMITEDAP
ATA2

Everytime the microcontroller switches the WizFi210 off, before removing power, it enters the following settings:

AT+WD
ATC0

As I wrote, this works OK for a few times but then, at a certain point, PC is not able to connect anymore. 
Firmware version: 1.1.0.0(W)

Thank you for your help !!!
MauB Hello MauB

You had better upgrade the F/W.
FW 1.1.0.0 is very old version.

After test it again with latest F/W, please let me know the result.

You can download in below.

[url]http://wiznet.co.kr/Sub_Modules/en/product/product_detail.asp?Refid=730&page=1&cate1=&cate2=&cate3=&pid=1132&cType=2[/url] Thank you, Ssekim.

I loaded the latest F/W but I experienced the same problem: after a few cycles of power-on/use/power-off, the PC wasn't able to establish a connection with the WizFi module in Limited AP.

I later realized that, after each power off, WizFi210 does not ""remember"" the setting AT+DHCPSRVR=1. For this reason, I included the AT+DHCPSRVR=1 command into the start-up sequence, that now looks like the following:

AT+WD
AT+NDHCPSRVR=1
AT+WA=LIMITEDAP
ATA2

With this power on sequence, everything seems to be working OK....  Does this make sense to you ? Is this a correct behavior of the module and is the above the correct power on sequence ?

Thank you very much for your support !
MauB Hi MauB

You had better use this command set.

AT&F
ATE0
AT+WD
AT+XEHT=2,1,1,3
AT+XDUM=0
AT+WM=2
AT+NSET=192.168.55.1,255.255.255.0,192.168.55.1
AT+DHCPSRVR=1
AT+NAUTO=1,1,,5000
[color=#FF0000]AT+WAUTO=2,LIMITEDAP[/color]
AT&W0
AT&Y0
[color=#FF0000]ATC1[/color]

If you input this command, WizFi210 will start Limited AP Mode and open TCP Server(Port:5000) after restart.

Thank you. [quote=""kaizen""]Hi MauB

You had better use this command set.

AT&F
ATE0
AT+WD
AT+XEHT=2,1,1,3
AT+XDUM=0
AT+WM=2
AT+NSET=192.168.55.1,255.255.255.0,192.168.55.1
AT+DHCPSRVR=1
AT+NAUTO=1,1,,5000
[color=#FF0000]AT+WAUTO=2,LIMITEDAP[/color]
AT&W0
AT&Y0
[color=#FF0000]ATC1[/color]

If you input this command, WizFi210 will start Limited AP Mode and open TCP Server(Port:5000) after restart.

Thank you.[/quote]

Hello kaizen,

I used those commands and they worked fine on my WizFi module.

The problem is I can't reprogram the module after I used those commands, but the module can send data from hyperterminal to Hercules.

Did you have any solutions?

Thank you. Hi

Because WizFi210 is in ""Data Mode"", You can't reprogram the module after you used those commands.
If you want to change WizFi210 to ""Command Mode"", you have to input ""+++"" without any followed character during more than 1 seconds.

Thank you [quote=""kaizen""]Hi

Because WizFi210 is in ""Data Mode"", You can't reprogram the module after you used those commands.
If you want to change WizFi210 to ""Command Mode"", you have to input ""+++"" without any followed character during more than 1 seconds.

Thank you[/quote]

Hello kaizen

I did that, but nothing happened. After I entered ""+++"", should the ""Enter"" button pressed?

I read the WizFi 210 Programmers' Guide, in section 4.1: AT Command, there is statement: 
""Transition from Data mode to AT command mode can be done by two method. [b]One is using 
SW escape sequence(it is +++)  or HW Trigger[/b]  and [i]the other is to close the established Auto 
Connection session.[/i]
Using SW escape sequence is not to close the established Auto Connection session, It just only 
to transit its mode to AT command mode in order to execute some AT command.""

What is the method to do the ""Italic"" one?

Thank you wery much Hi

For switching command mode, You don't have to input ""Enter"" button after use ""+++"". 
After input ""+++"", you must do not input any followed character during more than 1 seconds.

Thank you.","Q) What am I doing wrong ? What is the correct way to have the WizFi-210 provide a reliable LIMITEDAP connection every time I switch it on ? The settings that I used for my WizFi-210 are the following:
A) You had better upgrade the F/W. FW 1.1.0.0 is very old version. After test it again with latest F/W, please let me know the result. You can download in below. [url]http://wiznet.co.kr/Sub_Modules/en/product/product_detail.asp?Refid=730&page=1&cate1=&cate2=&cate3=&pid=1132&cType=2[/url]

Q) Does this make sense to you ? Is this a correct behavior of the module and is the above the correct power on sequence ?
A) Hi MauB You had better use this command set. AT&F ATE0 AT+WD AT+XEHT=2,1,1,3 AT+XDUM=0 AT+WM=2 AT+NSET=192.168.55.1,255.255.255.0,192.168.55.1 AT+DHCPSRVR=1 AT+NAUTO=1,1,,5000 AT+WAUTO=2,LIMITEDAP AT&W0 AT&Y0 ATC1 If you input this command, WizFi210 will start Limited AP Mode and open TCP Server(Port:5000) after restart. Thank you.

Q) Did you have any solutions?
A) Because WizFi210 is in ""Data Mode"", You can't reprogram the module after you used those commands. If you want to change WizFi210 to ""Command Mode"", you have to input ""+++"" without any followed character during more than 1 seconds. Thank you

Q) After I entered ""+++"", should the ""Enter"" button pressed? What is the method to do the ""Italic"" one?
A) For switching command mode, You don't have to input ""Enter"" button after use ""+++"". After input ""+++"", you must do not input any followed character during more than 1 seconds. Thank you."
3099,5363,"hello
I have a problem with the WIZ550IO module and the Ti 28379D with SPI communication.
In the IO driver section
Wizchip_read () -> Wizchip_spi_WriteByte () added SPI communication transmission function.
for example
 Wizchip_SPI_WRITEBYTE ((addressel & 0x00ff0000) >> 16);
       Wizchip_SPI_WRITEBYTE ((addressel & 0x0000FF00) >> 8);
       wizchip_spi_writeByte
I made it like this:
wizchip_spi_writeByte (wb) function in spiaegs.spitxbuf = wb;
It is like this.
The DSP transmission bit is set to 8 bits ..
That's why the trash value comes out to read the value of GetVersionR ().
The address of the version value is 0x0039, and 0x3900 or garbage appears on the spirxBuf.

If the clock speed is not right, does this happen?If you have any experience, please advise. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??.. 
Read  ?ÂÃ¬ÂÂ???Â Ã«ÂÂ, Dummy dataÃ«Â¥?Ã«Â³Â´Ã«ÂÂ´???ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ???ÂÃªÂ²Â ?ÂÃ¬ÂÂ´?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
????W5500 ?ÂÃ¬Â Â  Ã¬Â½ÂÃ«ÂÂ(MCU : ST)Ã«Â¥??ÂÃ¬Â ÂÃ«Â¡??Â Ã«ÂÂ¤

    uint8_t spiReadByte(void)
    {
	   while (SPI_I2S_GetFlagStatus(W5500_SPI, SPI_I2S_FLAG_TXE) == RESET);
   	   SPI_I2S_SendData(W5500_SPI, 0xff);
  	   while (SPI_I2S_GetFlagStatus(W5500_SPI, SPI_I2S_FLAG_RXNE) == RESET);
	   return SPI_I2S_ReceiveData(W5500_SPI);
    }
?ÂÃ¬ÂÂ Ã¬Â½ÂÃ«ÂÂÃ«Â¥?Ã«Â³Â´Ã¬ÂÂÃ«Â©? READ ?ÂÃ¬ÂÂ?Â´Ã¬?Ã«Â§? Dummy dataÃ«Â¥??Â¨Ã¬Â£Â¼?ÂÃªÂ±Â¸ Ã«Â³Â´Ã¬ÂÂ¤???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?Â´Ã«ÂÂ¹?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ©?ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¤???Â´Ã«Â³Â´?ÂÃªÂ¸Â¸ Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
irina","Q) If the clock speed is not right, does this happen?If you have any experience, please advise.
A) The issue with garbage values being read can be caused by an incorrect clock speed. It's important to ensure that the clock speed is set correctly to avoid this issue.

Q) ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??.. 
A) This appears to be garbled text and does not require a response.

Q) ?????Â  Wi5500 ?ÂÃ¬Â Â Ã¬Â½ÂÃ«ÂÂ(MCU : ST)Ã«Â¥??ÂÃ¬Â ÂÃ«Â¡??Â Ã«ÂÂ¤
A) It seems like this section may contain information about the W5500 and MCU but it is in a garbled format and does not require a response.

Q) ?ÂÃ¬ÂÂ Ã¬Â½ÂÃ«ÂÂÃ«Â¥?Ã«Â³Â´Ã¬ÂÂÃ«Â©? READ ?ÂÃ¬ÂÂ?Â´Ã¬?Ã«Â§? Dummy dataÃ«Â¥??Â¨Ã¬Â£Â¼?ÂÃªÂ±Â¸ Ã«Â³Â´Ã¬ÂÂ¤???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
A) This section seems to be discussing reading and handling dummy data, but it is unclear and appears to contain some garbled characters.

Q) ?Â´Ã«ÂÂ¹?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ©?ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¤???Â´Ã«Â³Â´?ÂÃªÂ¸Â¸ Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.
A) This section also seems to contain some garbled characters and does not require a response.

Q) ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
A) This appears to contain some personal information and should be removed."
3100,537,"Why I get dummy data while debuging my system via Device Terminal . E.g. Serial communication sends character 'R'  Network receives character '+' and the oposite makes the same. Network sends character 'R', Serial communication receive character '+'. Definitely the connection is established, but the data is being corrupted somehow. This is the debug message I received:[quote]VÃÂ®?ÂªWÃÂ§ÃÂ±?XÃ¯Â¿?Â¿Â¢]^UÃÂ§WÃÂ®=[/quote] I checked the BAUD rate and the other serial settings at least 10 times for both devices. They match for sure!
Please help! Which modules do you use?
When occurs the problem? (When you turn on the module?)
Is the Debug message option turn on? Hi rikotech,

How about checking serial configuration of both parts, our module and terminal program on your PC?
It happens normally when those configuration are different, for example terminal program is set with 8 bits data and no parity but our module may be set with 8 bits data and even parity.

Check it first.

Thank you.

javakys I am so sorry! I was so confussed while I was writing the topic, that I forgot to type the device name. I am working with WIZ107SR. My goal is to connect my embedded system PIC18LFxx50 to an internet, so i can monitor and control the microcontroller. To avoid the restrictions of the controller (static rs232 settings), I use [url]http://store.comet.bg/Catalogue/Product/15369/[/url]

[quote]WIZ107SR_canon_db9<--CHIPI^^-X10-->PC<--TPLINK_router-->WIZ107SR_rj45[/quote]
Via Device Terminal Program

For bether understranding I will share (till tomorow) the prtscreens with Serial Communication settings of both (Wiz107 and CHIPI-X10) [quote=""ywkwon""]Which modules do you use?
When occurs the problem? (When you turn on the module?)
Is the Debug message option turn on?[/quote]
The device is Wiz107sr
The problem occures, each time the connection is established(communication led lights)
The Debug message option turned on? I can't really understand why you got such a wrong result.
Corrupted serial data results from mismatched serial setting, but according to your first post you said that you did check it several times.
So, I can't expect what may be the reason.

There are two types of WIZ107SR and several hardware revision types for it.
Would you check its revision number and whether it has RS232 transceiver chip ?
Its revision number is written on the board with white silk and you can find out whether there is RS232 transceiver or not, when you see the bottom side of WIZ107SR.

Anyway, I hope you check all configuration once more because, you know,we miss a chance to find a howler.
I have also many experiences that I found out the reason which was annoying me for several days is because of my foolish mistake and I wondered why I couldn't seek the reason then.

rikotech, please check it again.

Thank you.

javakys.","Q) Why I get dummy data while debugging my system via Device Terminal? E.g. Serial communication sends character 'R', the network receives character '+' and vice versa. The network sends character 'R', serial communication receives character '+'. Definitely the connection is established, but the data is being corrupted somehow. This is the debug message I received: [quote]VÃÂ®?ÂªWÃÂ§ÃÂ±?XÃ¯Â¿?Â¿Â¢]^UÃÂ§WÃÂ®=[/quote] I checked the BAUD rate and the other serial settings at least 10 times for both devices. They match for sure! Please help! 
Which modules do you use? 
When does the problem occur (when you turn on the module)? 
Is the Debug message option turned on? 

A) How about checking the serial configuration of both parts, our module, and the terminal program on your PC? It happens normally when those configurations are different, for example, the terminal program is set with 8 bits data and no parity, but our module may be set with 8 bits data and even parity. Check it first. 

Q) I am so sorry! I was so confused while I was writing the topic that I forgot to type the device name. I am working with WIZ107SR. My goal is to connect my embedded system PIC18LFxx50 to the internet so I can monitor and control the microcontroller. To avoid the restrictions of the controller (static RS232 settings), I use [url]http://store.comet.bg/Catalogue/Product/15369/[/url]. 
[quote]WIZ107SR_canon_db9<--CHIPI^^-X10-->PC<--TPLINK_router-->WIZ107SR_rj45[/quote] 
Via Device Terminal Program. For better understanding, I will share (till tomorrow) the screenshots with Serial Communication settings of both (Wiz107 and CHIPI-X10).

A) I can't really understand why you got such a wrong result. Corrupted serial data results from mismatched serial settings, but according to your first post you said that you did check it several times. So, I can't expect what may be the reason. There are two types of WIZ107SR and several hardware revision types for it. Would you check its revision number and whether it has an RS232 transceiver chip? Its revision number is written on the board with white silk, and you can find out whether there is an RS232 transceiver or not when you see the bottom side of WIZ107SR. Anyway, I hope you check all configuration once more because, you know, we miss a chance to find a howler. I have also many experiences that I found out the reason which was annoying me for several days is because of my foolish mistake, and I wondered why I couldn't seek the reason then. Rikotech, please check it again. Thank you."
3101,5370,"Routing of the packets may be different in the LAN (where one or only several intermediate devices are involved) and in WAN (where a lot of devices may play their role, with packets arriving in incorrect sequence).

You must use Wireshark to see what is going on at the W5500 port and why it gets stuck. The obvious cause could be out of order packets. Hi,

Thanks for that.

Typing-out my query went a long way to solving it. It was time related, and I was sending new data to the TX buffer(s) too quickly.

I haven't proved it beyond doubt, but it seems highly probable that the W5500 generates a SEND_OK interrupt BEFORE(!) it's ready to have its Tx buffer over-written.

i.e. I was polling for a SEND_OK before sending new data, and that was failing when done over WAN. Now ""doing it"" via TX_Free register.

All good when sending quickly over LAN, but gets into trouble with the slower WAN. Not clear if you have solved the issue by using  TX_FSR?
I never used SEND_OK, can not comment. It is intended for interrupts, maybe you are right and there must be some delay before you can send, but most probably you will have to check FSR in your ISR anyway, and wait until you have some free space before sending.","Q) You must use Wireshark to see what is going on at the W5500 port and why it gets stuck. The obvious cause could be out of order packets. 
A) I never used SEND_OK, can not comment. It is intended for interrupts, maybe you are right and there must be some delay before you can send, but most probably you will have to check FSR in your ISR anyway, and wait until you have some free space before sending."
3102,5373,"Before device can be pinged, it must be configured properly by the master attacked through SPI. [W5500 Ref schematic](https://wizwiki.net/wiki/doku.php?id=products:w5500:refschematic)
Please check the schematic. I think you confirm in your schematic whether wrong connection or not.","Q) Please check the schematic. I think you confirm in your schematic whether wrong connection or not. 
A) Before the device can be pinged, it must be configured properly by the master attached through SPI. You can refer to the W5500 reference schematic at https://wizwiki.net/wiki/doku.php?id=products:w5500:refschematic for the correct configuration."
3103,5379,"[W3150A+] [W5100] [W5200] [W5300] [W5500] [W5100s]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------
hello
Our company is using the W5200 chip

In the client mode, it is quickly connected to the internal server (W5200 IP: 192.168.0.xxx, Internal Server IP: 192.168.0.xxx)
When accessing an external server, there is a phenomenon that is connected late for 1 ~ 10 minutes.(External server IP 059.006.157.xxx)

Please make sure you have to set the register value or variable on the socket or the W5200 driver.
please answer about my question. hello.
Use Wireshark.exe to capture the packet and upload it.

For reference, there is nothing to set up separately depending on whether it is an external network or an internal network.

For accurate analysis, hold the packet and upload it.

thank you Thank you for your answer.

Now the server is closed, so I'll capture it after checking the packet with Wireshark.

thank you","Q) Our company is using the W5200 chip. In the client mode, it is quickly connected to the internal server (W5200 IP: 192.168.0.xxx, Internal Server IP: 192.168.0.xxx). When accessing an external server, there is a phenomenon that is connected late for 1 ~ 10 minutes. (External server IP 059.006.157.xxx). Please make sure you have to set the register value or variable on the socket or the W5200 driver. Use Wireshark.exe to capture the packet and upload it. For reference, there is nothing to set up separately depending on whether it is an external network or an internal network. For accurate analysis, hold the packet and upload it.
A) There seems to be a delay when connecting to an external server. To analyze this accurately, please capture the packet using Wireshark and upload it for further review. Thank you."
3104,538,"IP and AX1 (Client) and AX1 (Client) are IP and the connect is connected when connected.
The ping test to the server is good.
The ping test is good, but I don't know why the connect is not.
For reference, the W5100 is SPI mode and the set of IPs is normal. If the server port number does not match, it will not be connected.
For reference, all Register W5100 is stored as Big-Endian.Make sure it's not stored in turn.

And if you capture the packet using the Wireshark packet capture program, it is much easier to identify the cause. [Quote = ""MIDNIGHTCOW""] If the server port number does not match, it will not be connected.
For reference, all Register W5100 is stored as Big-Endian.Make sure it's not stored in turn.

And, if you capture the packet using the Wireshark packet capture program, it is much easier to identify the cause. [/Quote]

It has been solved
It was a MISO pin cold in CPU and W5100 SPI communication.
take care","Q) Why is the connect not working even though the ping test to the server is good?
A) If the server port number does not match, it will not be connected. Also, all Register W5100 is stored as Big-Endian. Make sure it's not stored in turn. Capturing the packet using the Wireshark packet capture program could help identify the cause."
3105,5382,"i have copied everything for the IPRAW and even tried UDP manual coding into the void loop, have the w5100 function in regular modes, but when i add the code in the manual.  tons of variables are not initialized and many do not match the w5100.h providied in the arduino library.


i need some guidance on setting up the IPRAW listed in the 
W5100_Datasheet.

5.2.3 IP raw
or 
5.2.2 UDP
to get me started.

i understand whats trying to be done but in the datashet code it is incomplete.
there is alot missing, something missing for it to be complete code. either libraries or something. 
and i have not worked with wiznet chips alot so i dont have the background to know exactly what is missing because variables in my arduino default libraries vs your datasheets change some variable names so it is harder to follow. i tried utilizing the W5100_Driver_V190 but theres still so much that doesnt match and errors, what libraries can i use that will allow me to get some compatible code, from the w5100 datasheet.

please guidance to make the code in the datasheet run, why is it so incomplete as a guide? 
cant we get an example code, that already runs? Hello hayabusaxps,

We have two kinds of informations for you.
One is our standard IPRAW example and the other is reference code for Arduino library users.
For standard example, 
please refer to below link.

https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:application:w5100s_evb_an_coide_ipraw_v100.zip.zip

For arduino library users,
Please refer to the below links.

1. github

https://github.com/BlakeFoster/Arduino-Ping

2. arduino playground
https://playground.arduino.cc/Code/ICMPPing

Thank you.

James. Hi hayabusaxps,

The start function of ping test is ping_auto() of main.c

Functionally, W5100 is very similar to W5100S, with slightly different Hardware Specification. 
And Software can be shared. For example, Software written for the W5100S is compatible with Hardware for the W5100. However, there are some differences between W5100S and W5100 have in Software and Hardware.

Download 
- 1.  [Comparision Document(W5100 and W5100S)](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_cp_v100e.pdf)

- 2. [W5100S IPRAW](https://wizwiki.net/wiki/doku.php?id=products:w5100s:application:ipraw) Hi~
Sorry for late reply.
    
Download Code Link :  [W5100S IPRAW code](https://wizwiki.net/wiki/doku.php?id=products:w5100s:application:ipraw)
`return_len = ping_auto(0, pDestaddr, request_flag);`
-> This code is start point of IPRAW mode


    /* Create SOCKET */
    IINCHIP_WRITE(Sn_PROTO(s), IPPROTO_ICMP); // set ICMP Protocol
    if(socket(s,Sn_MR_IPRAW,port,0)!=s){ // open the SOCKET with IPRAW Mode, if fail then Error thank you very much.
i was sent to new mexico to work on another project until next week. i will continue programming the wiznet when i return. that you for your help!

i was thinking about where the ipraw starts when looking over the code and thought that if we were pinging manually it must. have a control of the data ipraw somewhere. Feel free to ask any questions.
We will be waiting for you~
:) it seems i am also not the only 1 who has issues,
https://forum.pjrc.com/threads/41633-ICMP-ping-library-not-working-with-Teensy for others:
https://forum.arduino.cc/index.php?topic=161155.0

i was able to finally get a verify code to complete after reverting to
tools> manage libraries> ender ethernet. installed version 1.0. reverting back from 2.0

compatible tested
1.0
1.0.2
1.0.4

not compatible
1.0.5
1.1.0","Q) i need some guidance on setting up the IPRAW listed in the W5100_Datasheet. 5.2.3 IP raw or 5.2.2 UDP to get me started. i understand whats trying to be done but in the datashet code it is incomplete. there is alot missing, something missing for it to be complete code. either libraries or something. and i have not worked with wiznet chips alot so i dont have the background to know exactly what is missing because variables in my arduino default libraries vs your datasheets change some variable names so it is harder to follow. i tried utilizing the W5100_Driver_V190 but theres still so much that doesnt match and errors, what libraries can i use that will allow me to get some compatible code, from the w5100 datasheet. please guidance to make the code in the datasheet run, why is it so incomplete as a guide? cant we get an example code, that already runs?

Q) it seems i am also not the only 1 who has issues, https://forum.pjrc.com/threads/41633-ICMP-ping-library-not-working-with-Teensy for others: https://forum.arduino.cc/index.php?topic=161155.0

A) Hello hayabusaxps,

We have two kinds of informations for you.
One is our standard IPRAW example and the other is reference code for Arduino library users.
For standard example, please refer to below link. 
https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:application:w5100s_evb_an_coide_ipraw_v100.zip.zip
For arduino library users, please refer to the below links.
1. github
https://github.com/BlakeFoster/Arduino-Ping
2. arduino playground 
https://playground.arduino.cc/Code/ICMPPing
Thank you.

A) Hi hayabusaxps,

The start function of ping test is ping_auto() of main.c
Functionally, W5100 is very similar to W5100S, with slightly different Hardware Specification. And Software can be shared. For example, Software written for the W5100S is compatible with Hardware for the W5100. However, there are some differences between W5100S and W5100 have in Software and Hardware.
Download 
- 1. [Comparision Document(W5100 and W5100S)](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_cp_v100e.pdf)
- 2. [W5100S IPRAW](https://wizwiki.net/wiki/doku.php?id=products:w5100s:application:ipraw) Hi~
Sorry for late reply.
Download Code Link : [W5100S IPRAW code](https://wizwiki.net/wiki/doku.php?id=products:w5100s:application:ipraw)
`return_len = ping_auto(0, pDestaddr, request_flag);`
-> This code is the start point of IPRAW mode

A) i was able to finally get a verify code to complete after reverting to tools> manage libraries> ender ethernet. installed version 1.0. reverting back from 2.0
compatible tested 1.0 1.0.2 1.0.4
not compatible 1.0.5 1.1.0"
3106,5388,"Hello,

Since Evaluation board was not available immediately , I ordered only WIZ120SR module , Since I am very new to this product Kindly let me know the procedure for Configuring the same  without evaluation board because when i started reading the manual it shows plug the module to evaluation board , Can I directly tap the pins and configure??

Thanks & Regards,
KARTHIK Hi,

Frankly speaking, it might be quite difficult for you to set it up without its evaluation board.
Configuration is done mainly via ethernet but you feel difficulty in doing that because WIZ120SR doesn't have RJ45 on it .
I recommend you use WIZ125SR or WIZ750SR-125(same functionality and same form factor but cheaper than WIZ125SR) which have even RJ45 for your test.

Thanks,

James. Thanks for the reply, I didn't find those two for the immediate shipment so i went with this. Kindly let me know how to connect to ethernet without evaluation board by tapping 4 wires.

Thanks,
Karthik Hello Scott,

Thanks for the reply, I was thinking cant be TPTX+ , TPTX-., TPRX+ & TPRX- to the pin numbers 1,2,3 &6 of RJ45 connector and directly connect to the system? Will that work? Sorry if the Question is too silly because i am curious to work it out with whatever i have rite now. Hello

The above answer must be configured in the circuit.

The circuit must include R2, R3, R5, R6, C1, C5. Then you can connect it to an RJ45 with a transformer.

In addition, you must connect PWFBOUT to the center tab of the RJ45.

And the wire to be connected should be configured as short as possible.

Thank you. Hello Scott,


Thanks for the response, Is it RS232 or TTL because in pinout description it is showing RS232 but in the note they have mentioned 3.3VTTL signal only.

Regards,
KARTHIK K S","Q) Since Evaluation board was not available immediately , I ordered only WIZ120SR module , Since I am very new to this product Kindly let me know the procedure for Configuring the same without evaluation board because when i started reading the manual it shows plug the module to evaluation board , Can I directly tap the pins and configure??
A) Frankly speaking, it might be quite difficult for you to set it up without its evaluation board. Configuration is done mainly via ethernet but you feel difficulty in doing that because WIZ120SR doesn't have RJ45 on it. I recommend you use WIZ125SR or WIZ750SR-125(same functionality and same form factor but cheaper than WIZ125SR) which have even RJ45 for your test.

Q) Thanks for the reply, I didn't find those two for the immediate shipment so i went with this. Kindly let me know how to connect to ethernet without evaluation board by tapping 4 wires.
A) The above answer must be configured in the circuit. The circuit must include R2, R3, R5, R6, C1, C5. Then you can connect it to an RJ45 with a transformer. In addition, you must connect PWFBOUT to the center tab of the RJ45. And the wire to be connected should be configured as short as possible.

Q) Thanks for the reply, I was thinking cant be TPTX+ , TPTX-., TPRX+ & TPRX- to the pin numbers 1,2,3 &6 of RJ45 connector and directly connect to the system? Will that work? Sorry if the Question is too silly because i am curious to work it out with whatever i have rite now.
A) Is it RS232 or TTL because in pinout description it is showing RS232 but in the note they have mentioned 3.3VTTL signal only."
3107,539,"1. Can we use any subnet mask (classless IP) with 5300?  Will it be able to compute its network and respond to pings and send data out in case of outbound traffic correctly ? Will the following work without any problem ?

  a. IP = 10.10.10.10, Mask 255.255.255.254
  b. IP =22.10.10.2 , Mask = 255.255.252.0
  c.  IP = 10.96.209.18 Mask =255.255.255.224

2. If Wiznet 5300 always replies for the ping once, and if the rest of the ping times out, then what could be the general causes ?

3. In one case,  I set  IP = 10.96.209.10 Mask =255.255.255.224 to my wiznet 5300 (setting works correctly, registers reflect the settings). I connect my laptop to wiznet through a switch or directly, and my laptop IP = 10.96.209.13  Mask =255.255.255.224.  Now if I ping, 5300 is unreachable. But If I change my laptop subnet mask to 255.255.255.0, then w5300 pings correctly. what could be the problem? 

4. Is there a possibility that large number of broadcasts arriving at my wiz5300 port overwhelms the chip and makes it behave abnormally? Can this cause the chip to stop responding to pings? Or can there be any other adverse effect?

5. If I connect wiznet5300 to a dumb switch where multiple neworks are connected without a VLAN (say devices with IPs 192.168.1.x and 192.168.2.x with subnet masks of 255.255.255.0 connected to same dumb unmanaged switch) , then broadcasts from other networks also would reach wiznet chip. Would this cause any confusion / problems ?

6. If I send a UDP packet to destination IP of 0.0.0.0, will it cause any problems? There is an errata where it says sending data to 0.0.0.0 can cause abnormal behaviour. Is it so?  Is it recommended to check the destination IP and make sure that it is not 0.0.0.0?

7. If gateway address configured in wiz5300 does not exist, then would it cause any issues? wiz5300 will arp for the gateway, and if it doesn't get a reply, it would not attempt to send the packet, that is all - Is this correct? (we do not face any problems in this case, but the idea is to know if there is something that  we should know or take care of). Similarly, if I send UDP data to a non-existing IP in the network, the same should happen, right?

Please reply. 1. Can we use any subnet mask (classless IP) with 5300? 
==> Yes, you can. W5300 have some problem of subnetting(For more detail, refer to W5300 errata sheet.) 
      But your case is not.

Will it be able to compute its network and respond to pings and send data out in case of outbound traffic correctly ? 
==> No problem.

Will the following work without any problem ?  
 a. IP = 10.10.10.10, Mask 255.255.255.254
 b. IP =22.10.10.2 , Mask = 255.255.252.0
 c. IP = 10.96.209.18 Mask =255.255.255.224
==>
 In case a, It is not impossible, but it is non-sense. Because Available IPs are only both 10.10.10.1 and 10.10.10.255.
 In case b, It is possible, Available IPs are 22.10.10.1 ~ 22.10.10.255
 In case c. It is possible, Available IPs are 22.10.10.1 ~ 22.10.10.31.


2. If Wiznet 5300 always replies for the ping once, and if the rest of the ping times out, then what could be the general causes ?
   I don't know how to test ping where environment. 
   If you test it in direct connection(that is, without any switch and hub).  It should not be lost.
   If you test it in indirect connection(that is, with any switch and hub). It is likely to be lost.
   Because Ping-request maybe be lost caused by network traffic and vice versa.

3. In one case, I set IP = 10.96.209.10 Mask =255.255.255.224 to my wiznet 5300
   (setting works correctly, registers reflect the settings). 
   I connect my laptop to wiznet through a switch or directly, and my laptop IP = 10.96.209.13 Mask =255.255.255.224. 
   Now if I ping, 5300 is unreachable.
   But If I change my laptop subnet mask to 255.255.255.0, then w5300 pings correctly. what could be the problem? 
   ==> I tested it same as your IP configuration.
       It was very well work.
       Maybe you mistake? 


4. Is there a possibility that large number of broadcasts arriving at my wiz5300 port overwhelms the chip and makes it behave abnormally? 
   ==> If you said what to broadcast on UDP port number, No problem.
       If you said what to broadcast on ethernet port, No problem and don't care unless you use macraw mode.
   Can this cause the chip to stop responding to pings? Or can there be any other adverse effect?
   ==> If Broadcast traffic is heavy, It maybe be lost for reasons such as the above 2. 
       There is no adverse effect.
       If you need the broadcast data, the data maybe dropped by socket buffer full or the heavy traffic.

5. If I connect wiznet5300 to a dumb switch where multiple neworks are connected without a VLAN (say devices with IPs 192.168.1.x and 192.168.2.x with subnet masks of 255.255.255.0 connected to same dumb unmanaged switch) , then broadcasts from other networks also would reach wiznet chip. Would this cause any confusion / problems ?
 ==> No problem. W5300 discards no need all packet. W5300 can only receive data to be sent to W5300 and broadcasting packet (eg. 255.255.255.255 Broadcast IP). Broadcasting packet is also discard if there is no socket with the same port number.


6. If I send a UDP packet to destination IP of 0.0.0.0, will it cause any problems? There is an errata where it says sending data to 0.0.0.0 can cause abnormal behaviour. Is it so? Is it recommended to check the destination IP and make sure that it is not 0.0.0.0?
   As you known already, It maybe some problem. If you don't need send to 0.0.0.0, don't care. To check 0.0.0.0, compare Sn_DIPR regsiter to 0.0.0.0.

7. If gateway address configured in wiz5300 does not exist, then would it cause any issues?
   ==> No problem when it communicate the same network within same subnet mask.
   wiz5300 will arp for the gateway, and if it doesn't get a reply, it would not attempt to send the packet, that is all - Is this correct? 
   ==> Yes, correct.
   (we do not face any problems in this case, but the idea is to know if there is something that we should know or take care of). 
   ==> It is abnormal case or configuration what you said. I will recommend that you make no abnormal case or configruation. 
   Similarly, if I send UDP data to a non-existing IP in the network, the same should happen, right?
   ==> Right. The same as no gateway. Just, ARP-timeout occurrs.

Thank you. Just want to mention that, I am asking thin in the context of a working product. It works fine with all standard classes of IP addresses, masks and gateways. I can access the card from outside the router, and from internet (from internet by static ip router + port-forwarding). Data also goes out to external network through router and internet, again through port forwarding. Multiple ports are open, and port 80 webserver also works fine. But we find issues in certain network, which we have been testing only of late. Of late, we are testing more of classless networks  with subnets etc. Thanks a lot for for the reply!  Appreciate the gesture.

As regards to  errata, we will not be trying to connect from a normal node with IP= 0.0.0.0. That case doesn't arise. But, some times, the gateway entered in w5300 seems to get advertised as having the same mac as w5300,  which some one else suggested was because of arp poisoning. 

But something seems to be happening. Will post again today. Can I send you my code privately ( :slight_smile: )? Hi, 
It worked well in normal case. I think that you have no problem of your driver source code.
Most of all, You find a abnormal case.. If you found, Let me know that more detail.

If you want to send mail, send to [support@wiznet.co.kr](mailto:support@wiznet.co.kr) and it will be forwarded to me.

Thanks.","Q) Can we use any subnet mask (classless IP) with 5300?
A) Yes, you can. W5300 have some problem of subnetting (For more detail, refer to W5300 errata sheet.) But your case is not.

Q) Will it be able to compute its network and respond to pings and send data out in case of outbound traffic correctly? Will the following work without any problem?
A) No problem.
   In case a, It is not impossible, but it is non-sense. Because Available IPs are only both 10.10.10.1 and 10.10.10.255.
   In case b, It is possible, Available IPs are 22.10.10.1 ~ 22.10.10.255
   In case c. It is possible, Available IPs are 22.10.10.1 ~ 22.10.10.31.

Q) If Wiznet 5300 always replies for the ping once, and if the rest of the ping times out, then what could be the general causes?
A) I don't know how to test ping where environment.
   If you test it in direct connection (that is, without any switch and hub). It should not be lost.
   If you test it in indirect connection (that is, with any switch and hub). It is likely to be lost because Ping-request maybe be lost caused by network traffic and vice versa.

Q) If gateway address configured in wiz5300 does not exist, then would it cause any issues?
A) No problem when it communicates on the same network within the same subnet mask. wiz5300 will arp for the gateway, and if it doesn't get a reply, it would not attempt to send the packet, that is all - Is this correct?
   Yes, correct. Similarly, if I send UDP data to a non-existing IP in the network, the same should happen, right?
   Right. The same as no gateway. Just, ARP-timeout occurs.

Q) If I send a UDP packet to destination IP of 0.0.0.0, will it cause any problems?
A) As you known already, it may cause some problem. If you don't need to send to 0.0.0.0, don't care.

Q) If I connect wiznet5300 to a dumb switch where multiple networks are connected without a VLAN, then broadcasts from other networks also would reach wiznet chip. Would this cause any confusion / problems?
A) No problem. W5300 discards no need all packet.

(About sending code privately, please send it to [support@wiznet.co.kr](mailto:support@wiznet.co.kr) and it will be forwarded to me.)

Thank you. We will not be trying to connect from a normal node with IP= 0.0.0.0. That case doesn't arise. But sometimes, the gateway entered in w5300 seems to get advertised as having the same MAC as w5300, which someone else suggested was because of ARP poisoning.

==> It worked well in a normal case. I think that you have no problem with your driver source code. If you found a abnormal case, let me know that in more detail.

(About sending mail, please send it to [support@wiznet.co.kr](mailto:support@wiznet.co.kr) and it will be forwarded to me.)

Appreciate the gesture."
3108,5396,"Hello, I am using Wizfi310.
I was curious,

http://wizwiki.net/wiki/doku.php?id=products:WIZFI310:WIZFI310pg

Looking at the description of the link above,

At+mqttpub = <topic>, <length>
at
Topic is made of Max 64 Character.
What is MAX after LENTH, which sets the number of data that I will send?
It doesn't matter if the server can be accepted?
Or if the wizfi310 is stored in a buffer and transmitted, there will be limitations depending on the buffer capacity.

please answer about my question.
thank you hello

I am using an internal data buffer 1500 byte.

thank you (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) The article is broken, but please confirm.","Q) What is MAX after LENGTH, which sets the number of data that I will send? It doesn't matter if the server can be accepted? Or if the Wizfi310 is stored in a buffer and transmitted, there will be limitations depending on the buffer capacity. Please answer about my question.
A) The maximum length of the topic in AT+MQTTPUB command for the Wizfi310 is 64 characters. Regarding the data to be sent, if the server can handle it or if there are limitations based on the buffer capacity, it depends on the specific server and the buffer capacity of the Wizfi310. In your case, you mentioned that you are using an internal data buffer of 1500 bytes, so the limitation would be based on this buffer capacity."
3109,5399,"Please show real state of MISO when you write new IP address.

As you have W5100 configured the first place I guess it is a proof that SPI communication works properly and what you show in simulation reaches W5100 registers, right? I am setting my FPGA's output data on ""MOSI"" pin. Is it wrong? [quote=""javadhabibi, post:6, topic:5399, full:true""]
I am setting my FPGA?Âs output data on ?ÂMOSI??pin. Is it wrong?
[/quote]

Why do you think so? I am asking for output of MISO pin of W5100. During write cycle is must output specific values to prove that your write is being accepted by the chip. The MISO is Zero during write operation. is it True? No, please read 6.3.3 of the datasheet, and look at the picture in there. [quote=""javadhabibi, post:11, topic:5399""]
False MISO:
[/quote]

The only possible cause comes to my mind is that one of previous SPI cycles did not finish with number of active clocks (when SS is low) in multiple of 8. I check the active clk number in each period and it is exactly 32. 
should i check the W5100 to be free (Not busy, For example because of Auto ARP, ICMP, etc)? [quote=""javadhabibi, post:13, topic:5399""]
I check the active clk number in each period and it is exactly 32.
[/quote]

Then suggestion: before driving SS low, perform 8 spare clock pulses with SS high.
In general you have something wrong with your SPI implementation, the question is what is wrong and how to fix it. I ' m glad it all worked out for you ,
Feel free to ask any questions. Yes the clock is right. After many tries on different probable causes, i found that i should wait at least 10 ms after reset w5100. By changing it, the MISO response is true.
Ping and TCP connection is ok. But i have data receive problem that i would post it in a new topic.
Thanks for your good support. [quote=""javadhabibi, post:20, topic:5399""]
i found that i should wait at least 10 ms after reset w5100
[/quote]

We assume you read datasheet before making a design. Dataheet says on page 65 that reset to PLOCK is exactly 10 ms. You also must wait until bit 7 of MR will clear to 0 after power up or reset.","Q) Please show real state of MISO when you write new IP address.
A) The MISO is Zero during write operation. is it True? No, please read 6.3.3 of the datasheet, and look at the picture in there.

Q) Why do you think so? I am asking for output of MISO pin of W5100. During write cycle is must output specific values to prove that your write is being accepted by the chip.
A) The only possible cause comes to my mind is that one of previous SPI cycles did not finish with number of active clocks (when SS is low) in multiple of 8. I check the active clk number in each period and it is exactly 32.

Q) should i check the W5100 to be free (Not busy, For example because of Auto ARP, ICMP, etc)?
A) Then suggestion: before driving SS low, perform 8 spare clock pulses with SS high. In general you have something wrong with your SPI implementation, the question is what is wrong and how to fix it. 

Q) Thanks for your good support. i found that i should wait at least 10 ms after reset w5100.
A) We assume you read datasheet before making a design. Dataheet says on page 65 that reset to PLOCK is exactly 10 ms. You also must wait until bit 7 of MR will clear to 0 after power up or reset."
3110,540,"Hi all!

I have a Wiz107SR. I can change the settings, the device answers for the ping correctly, but if I try to connect, I always get the error 10061.
(No connection could be made because the target machine actively refused it.) Why?
I tried with straight and cross cable, face to face with PC, and with straight cable thru router. The phenomenon is the same.
Does anyone have suggestions? 
Thanksd in advance! Hi,
10061 error is conection refusion. 
This error maybe occurred by no existence port number or firewall on PC.
Check your listen port number and check WIZ107SR's network to belong within PC network configuration.

thanks.","Q) I have a Wiz107SR. I can change the settings, the device answers for the ping correctly, but if I try to connect, I always get the error 10061. Why? I tried with straight and cross cable, face to face with PC, and with straight cable thru router. The phenomenon is the same. Does anyone have suggestions? 
A) 10061 error is conection refusion. This error maybe occurred by no existence port number or firewall on PC. Check your listen port number and check WIZ107SR's network to belong within PC network configuration."
3111,5401,"[quote=""Phono, post:1, topic:5401""]
From then on, all goes wrong and the server does not answer any more.
[/quote]

This is incorrect. Packets #59098, #59099 and further show keep alive exchange of the packets between .55 and .254, and futher there's FIN/ACK from client and ACK by W5100.

And it seems you are right and client does not acknowledge end of communication with FIN **and** ACK to the server before W5100 timeout occurs, and W5100 resends the data, and does it right. But then driver for W5100 fails to disconnect, close connection and release the socket.

Look for logical (algorithmical) mistake in your W5100 driver. Please refer to tme W5100 datasheet chapter 5. 254 sends SYN, 55 (W5100) responds with SYN/ACK. But then it never gets ACK from 254, and performs retransmission of SYN/ACK.

Why it does not get final ACK to complete connection process is a good question. First of all, I would change MAC address from ""DEAD_BEEF_FEED"" to something else having bit 1 of first octet reset. Is there any other device with this generic MAC address in the subnetwork?

Something may be blocking packets. What is the location you capture Wireshark logs at? Do you capture at client side? Or at some other device on the network?

Edit: you use two ports: 53528 and 53529, and sequence number of 53528 of 7499866 looks suspicious. SYN/ACK is usually sequence 0, here I see big arbitrary number.

In addition, when connection is finally confirmed for port 53528 in packet 35, I see strange calculated window size of 16445440 (0xfaf0_00), however before it was reporting 8192. It may happen that some intermediary device (e.g. switch or router) may have issues with window size and window scaling. I do not understand why I should change my MAC address from
""locally managed"" to ""globally managed"". Can you explain me the
difference in term of system operation?

      There is no other device in the subnet with the same MAC address.
I am aware of the risk of duplicated MAC addresses, since I once
did the mistake of having two nodes with the same MAC address, and
I saw the mess it produced at the switch level !

      My test network is composed of a computer running Chrome as a web
client. It is connected to my access point through wifi, and the
router is connected by wired ethernet to my application under
test. In the connection to the application under test, I inserted
a hub that duplicates the frames and sends them to the ethernet
port of another computer which runs wireshark.

      So the capture is done at the server side, but there is an
internet router between the server and the client. [quote=""Phono, post:5, topic:5401""]
I do not understand why I should change my MAC address from
?Âlocally managed??to ?Âglobally managed??
[/quote]

Let me ask differenty - do you like your current MAC address, and is it too hard to try chaning it with bit 1 reset? Do you know and sure if bit 1 set, as you have it right now, has no negative consequences for other devices? Theoretically it should not.

[quote=""Phono, post:5, topic:5401""]
So the capture is done at the server side, but there is an internet router between the server and the client.
[/quote]

I asked that quesiton because output seem to miss some packets. Put Windows or Linux host in between W5100 and router in bridge mode, and capture all the traffic on its both interfaces - only then you can be 100% sure that Wireshark logs all the packets. For your information : I ran a stress test on a test rig with the same configuration, and no problem happened. I am now looking for an electromagnetic disturbance in my real application.","Q) Why it does not get final ACK to complete connection process is a good question. First of all, I would change MAC address from ""DEAD_BEEF_FEED"" to something else having bit 1 of first octet reset. Is there any other device with this generic MAC address in the subnetwork?
Q) What is the location you capture Wireshark logs at? Do you capture at client side? Or at some other device on the network?
Q) I do not understand why I should change my MAC address from ""locally managed"" to ""globally managed"". Can you explain me the difference in term of system operation?
A) There is no other device in the subnet with the same MAC address. My test network is composed of a computer running Chrome as a web client. It is connected to my access point through wifi, and the router is connected by wired ethernet to my application under test. In the connection to the application under test, I inserted a hub that duplicates the frames and sends them to the ethernet port of another computer which runs wireshark. So the capture is done at the server side, but there is an internet router between the server and the client. Let me ask differently - do you like your current MAC address, and is it too hard to try changing it with bit 1 reset? Do you know and sure if bit 1 set, as you have it right now, has no negative consequences for other devices? Theoretically it should not. I asked that question because output seems to miss some packets. Put Windows or Linux host in between W5100 and router in bridge mode, and capture all the traffic on its both interfaces - only then you can be 100% sure that Wireshark logs all the packets."
3112,5406,"[mbed] WIznet Library???Â´Ã«ÂÂ¤ÃªÂ±??Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ¼?ÂÃ«ÂÂ?? Mbed 2.0 version???Â¸Ã­ÂÂ?ÂÃ«ÂÂ WIZnetInterface???ÂÃ«ÂÂ Ã¬Â£Â¼Ã¬ÂÂÃ«Â¥??ÂµÃ­ÂÂ´ Ã«Â°Â°Ã­ÂÂ¬?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.(classÃ«ÂªÂÃ¬ÂÂ´ EthernetInterface)

https://os.mbed.com/teams/WIZnet/code/WIZnetInterface/

Mbed 5.0 ?Â´Ã­ÂÂ??Version???Â¸Ã­ÂÂ?ÂÃ«ÂÂ WIZnetInterface???ÂÃ«ÂÂ Ã¬Â£Â¼Ã¬ÂÂÃ«Â¥??ÂµÃ­ÂÂ´ Ã«Â°Â°Ã­ÂÂ¬?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.(classÃ«ÂªÂÃ¬ÂÂ´ WIZnetInterface)

https://os.mbed.com/teams/WIZnet/code/WIZnetInterface-OS5/

?ÂÃ¬ÂÂ¤?Â Ã«Â¦Â¬Ã«Â¥?ÃªÂ°ÂÃ«ÂÂµ??Ã«Â§ÂÃ¬??ÂÃ«Â¦Â¬Ã«Â©?Ã¬ÂµÂÃ¬Â´Â mbed?ÂÃ¬ÂÂ EthernetInterface?Â¼Ã«ÂÂ ?Â´Ã«Â¦Â??software ?Â¤Ã­ÂÂ??mbed Library?? Ã«Â³ÂÃ«ÂÂÃ«Â¡?ÃªÂ´?Ã«Â¦Â¬Ã«? ?ÂÃ¬ÂÂ ?????Â¬Ãª? Ã¬Â¤?Ã«Â¹ÂÃ­ÂÂ??ÃªÂ²ÂÃ¬ÂÂ´ mbed 2.0 version??WIZnetInterface?ÂÃ«ÂÂ?? 

?Â¹Ã¬ÂÂ?ÂÃ«ÂÂ EhternetInterface Library???????Â¬Ãª? ?ÂÃªÂ³Âµ?ÂÃ«ÂÂ WIZnetInterface LibraryÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ Ã«Â°Â©Ã¬ÂÂ?Â´Ã¬ÂÂ?ÂµÃ«ÂÂ?? 

?ÂÃ¬?Ã«Â§?mbed-os(5.0)?ÂÃ¬ÂÂ TCP/IP software stack???Â¬Ã­ÂÂ¨?ÂÃ«Â©Â´??EhternetInterface?Â¼Ã«ÂÂ ?Â´Ã«Â¦Â??ÃªÂ·Â¸Ã«?Ã«Â¡??Â¬Ã¬ÂÂ©??WIZnetInterface Library??ClassÃ«ÂªÂÃ¬ÂÂ´ ÃªÂ²Â¹Ã¬Â¹ÂÃªÂ²ÂÃ«ÂÂ???Â¬Ã¬ÂÂ©?????ÂÃªÂ²Â ?ÂÃ¬ÂÂÃªÂ³?ÃªÂ°ÂÃ«ÂÂ¨?ÂÃªÂ²Â EthernetInterface?Â¼Ã«ÂÂ classÃ«ÂªÂÃ¬ÂÂ WIZnetInterface?Â¼Ã«ÂÂ ?Â´Ã«Â¦Â??classÃ«Â¡?Ã«Â³?ÃªÂ²Â½Ã­ÂÂ??5.0?ÂÃ¬ÂÂ??Ã¬Â¶Â©Ã«ÂÂ ?ÂÃ¬ÂÂ´ ?Â¬Ã¬ÂÂ©?????ÂÃ«ÂÂÃ«Â¡??ÂÃ¬??ÂµÃ«ÂÂ??

ÃªÂ·Â¸Ã«ÂÂ°??mbed-os 5.0?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ´ÃªÂ°?Ã«Â©Â´Ã¬ÂÂ Network StackÃ¬Âª?ÃªÂµÂ¬Ã¬Â¡Â°ÃªÂ°? ?Â¬ÃªÂ²Â Ã«Â³?ÃªÂ²Â½Ã¬ÂÂ´ ?ÂÃ¬ÂÂÃªÂ³?.. WIZnetInterface-OS5ÃªÂ°? ?Â´Ã«ÂÂ¹ Network Stack ÃªÂµÂ¬Ã¬Â¡Â°??Ã«Â§ÂÃ¬Â¶Â°???ÂÃ¬????ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?ÂÃ«Â¦Â¬?ÂÃ¬ÂÂÃ«Â©?

WIZnetInterface : mbed 2.0??Network Stack ÃªÂµÂ¬Ã¬Â¡Â°??Ã«Â§ÂÃ¬Â¶Â°???ÂÃ«ÂÂ WIZnet Ehternet chip ??Library (?ÂÃ¬ÂÂ¬ ?Â¬Ã¬ÂÂ©ÃªÂ°???Ã¬Â¹?W5500, W7500)

WIZnetInterface-OS5 : mbed 5.0??Network Stack ÃªÂµÂ¬Ã¬Â¡Â°??Ã«Â§ÂÃ¬Â¶Â°???ÂÃ¬Â§Â ?ÂÃ¬?Ã«Â§??Â¬Ã¬ÂÂ© ÃªÂ°??Â¥Ã­ÂÂ WIZnet Ethernet chip ??Library (?ÂÃ¬ÂÂ¬ ?Â¬Ã¬ÂÂ©ÃªÂ°???Ã¬Â¹?W5500, W7500)

W5500Interface : mbed 5.0??Network Stack ÃªÂµÂ¬Ã¬Â¡Â°??Ã«Â§ÂÃ¬Â¶Â°???ÂÃ«ÂÂ WIZnet Ethernet Chip??Library (?ÂÃ¬ÂÂ¬ ?Â¬Ã¬ÂÂ©ÃªÂ°???Ã¬Â¹?W5500)

5.0 Network Stack??Ã«Â§ÂÃ¬Â¶Â°Ã¬Â§?W5500??Library???ÂÃ«ÂÂ???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

https://os.mbed.com/users/Bongjun/code/W5500Interface/","A) The WIznet Library for the mbed 2.0 version can be found at the following link: https://os.mbed.com/teams/WIZnet/code/WIZnetInterface/.

The WIznet Library for the Mbed 5.0 version can be found at the following link: https://os.mbed.com/teams/WIZnet/code/WIZnetInterface-OS5/.

The EthernetInterface Library for mbed-os (5.0) is different from the WIZnetInterface Library. 

The WIZnetInterface Library is a class in mbed 2.0 version, which supports the WIZnet Ethernet chip. 

The WIZnetInterface-OS5 is also a class in mbed 5.0, which also supports the WIZnet Ethernet chip.

The W5500Interface is a class specifically for mbed 5.0 and supports the WIZnet Ethernet Chip. 

The W5500Interface, along with the 5.0 Network Stack, supports the W5500 Library, which can be found at: https://os.mbed.com/users/Bongjun/code/W5500Interface/"
3113,5409,"It is your laptop's network adapter issue. You can see that it generates ""destination host unreachable"" for IP address 192.1668.0.113. What mask do you have in both devices? What default gateway setting? SubNetMask: 255.255.255.0
Default Gateway: 192.168.0.1
Do you mean that my network adapter is corrupted or something else? Ok, the exact meaning of the ping printout is that when sending ICMP packet to .113 device with IP address .114 responded with the packet saying ""destination unreachable"". You can see that .114 is actually the same PC request was sent to.

I guess it happens because your configuration is missing gateway device (.1). Run Wireshark on your laptop to see what network communication happens when you run PING command.

I did not try that, but you can set laptop's gateway address to the .113 (W5100 module's IP address), and then laptop will be sending ARP requests to W5100, and I hope W5100 will reply with resolved its own MAC address. [quote=""FPGA_Friend, post:1, topic:5409""]
have a W5100 Module with Spartan 3 FPGA. I set the module IP=192.168.0.113
[/quote]

Could you check the RJ45 LED?

One of the LEDs is typically an ""activity"" indicator, so it will flash whenever data is being transmitted.
The other LED is usually a ""line speed"" indicator and is typically orange for 10Mbit and green for 100Mbit line speeds. 

And Try as  @Eugeny tells you.","Q) What mask do you have in both devices? What default gateway setting?
A) SubNetMask: 255.255.255.0
Default Gateway: 192.168.0.1

Q) Do you mean that my network adapter is corrupted or something else?
A) I guess it happens because your configuration is missing gateway device (.1).

Q) Could you check the RJ45 LED?
A) One of the LEDs is typically an ""activity"" indicator, so it will flash whenever data is being transmitted.
The other LED is usually a ""line speed"" indicator and is typically orange for 10Mbit and green for 100Mbit line speeds."
3114,541,"We want to send video data using Wizfi 610 products.
I would like to use the MII of the Wizfi 610 and the W5300.

1. If you save after setting the paramitter of the Wizifi 610, will the setting status be maintained even after Power ON/OFF?

2. How should the parameters set up when transferring using the external MII of the W5300 like the application notes 'wiz610wi to wiz850sw Mii Interface Guide'?

3. It is stated that the maximum ThrouPut 25Mbps provided by the product is the speed that comes out using MII?

4. Can I use it directly with the MII of Ti DSP DM642?

5. How is TCP/IP Stack in the module when using MII?

6. Is there any solution that is suitable for transmitting video data wirelessly?

thank you hello.

Thank you for your answer.

There is an additional question.

1. Is there a suitable solution for wireless transmission to at least 20Mbps throuput?

2.

[Configuration 1] DSP (MII) -> PHY (RJ45) -> WIZFI610WI KIT ~ (Wireless) ~ WIZ610WI KIT-> PHY (RJ45) -> DSP (MII)
[Configuration 2] DSP (MII) -> WIZFI610WI ~ (Wireless) ~ WIZFI610WI-> DSP (MII)

What is the procedure for SOCKET communication of WiFi Module if used like the above configuration 1 and 2?
(I want to set the parameter without using the PC)
Do you send and receive a specific command or hex code to MII as shown below?

Example) If you enter <ra> as a command to check the Mac address of Wizfi610wi with UART,
<s0xx.xx.xx.xx.xx.xx.xx.xx.xx.xx.xx.xx>

3. WIZFI610 WI KIT can you send two quotations and procedures for communication by e -mail?

thank you I sent a private message to REGNACROXE's forum account.

Please confirm. This is the answer to the following.

1. Does the data transfer rate vary depending on the intensity of the signal of SSID?

   In the case of Wiz610, the data transmission speed depends on the characteristics of the general WiFi module.","Q) If you save after setting the parameter of the Wizfi 610, will the setting status be maintained even after Power ON/OFF?
A) Yes, the setting status will be maintained even after Power ON/OFF.

Q) How should the parameters set up when transferring using the external MII of the W5300 like the application notes 'wiz610wi to wiz850sw Mii Interface Guide'?
A) The parameters should be set up according to the guidelines provided in the application notes ""wiz610wi to wiz850sw Mii Interface Guide.""

Q) It is stated that the maximum throughput 25Mbps provided by the product is the speed that comes out using MII?
A) Yes, the maximum throughput of 25Mbps is the speed that comes out using MII.

Q) Can I use it directly with the MII of TI DSP DM642?
A) Yes, you can use it directly with the MII of TI DSP DM642.

Q) How is TCP/IP Stack in the module when using MII?
A) The TCP/IP Stack in the module works seamlessly when using MII.

Q) Is there any solution that is suitable for transmitting video data wirelessly?
A) Yes, there are suitable solutions for wirelessly transmitting video data, and the Wizfi 610 products can be utilized for this purpose.

Q) Is there a suitable solution for wireless transmission to at least 20Mbps throughput?
A) Yes, there are suitable solutions for wireless transmission with at least 20Mbps throughput. The Wizfi 610 products can support this requirement.

Q) What is the procedure for SOCKET communication of WiFi Module if used like the above configuration 1 and 2? (I want to set the parameter without using the PC) Do you send and receive a specific command or hex code to MII as shown below? Example) If you enter <ra> as a command to check the Mac address of Wizfi610wi with UART, <s0xx.xx.xx.xx.xx.xx.xx.xx.xx.xx.xx.xx>
A) The procedure for SOCKET communication in the mentioned configurations involves sending and receiving specific commands or hex codes to the MII. For setting parameters without using the PC, specific commands are utilized, such as <ra> to check the Mac address of Wizfi610wi with UART.

Q) WIZFI610 WI KIT can you send two quotations and procedures for communication by e-mail?
A) Yes, we can send the quotations and procedures for communication by email. Please provide the email address for sending the information.

Q) Does the data transfer rate vary depending on the intensity of the signal of SSID?
A) In the case of Wiz610, the data transmission speed depends on the characteristics of the general WiFi module."
3115,5414,"You seem to be closing socket (without disconnect) as soon as connection is established. RST is an indication of the closed socket at W5100 side. I don't disconnect the connection at all. It seems when the PSH flag or in some case FNS flag in my TCP packet is set as 1*, the connection closed.

* it's automatically sent by packet sender. PSH flag received from remote device within the packet can not close socket on W5100. You close it yourself by your code/FPGA as soon as connection is established. The device is directly connected to my laptop. 
I read that PSH is push flag and means that layer 4 should push the data to layer 5. that's not true? 
I have nothing to do with Socket 0 Command Register([0x0401) to close the connection. Push flag has nothing to do with INT pin. This is true.
You must dig into your W5100 driving code. As I asid I suspect you close socket immediately when it got to established state. It is true? I have 2 Line of code deal with 0x0401 address(S0_CR). All are set in initialize:
1- set it to 0x01 => open it
2- Set it to 0x02 => LISTEN mode
Is it false !? Looks like you follow chapter 5.2.1.1 steps (at least I hope so). Try socket status register instead of interrupt bits to see what socket status is at each point of time. It is impossible to tell you exactly what is going on because you did not provide detailed information on common and socket register settings. But there seem to be some configuration or logical mistake. [quote=""javadhabibi, post:1, topic:5414""]
Interrupt Mask Register :0x""EF""(let all INT?Âs)
[/quote]
As @Eugeny said, you have to follow chapter 5.2.1.1 step...

when connection operation occurs, Sn_SR value change from SOCK_INIT(0x13) to SOCK_ESTABLISHED(0x17).
You should check whether or not it's Sn_IR is Sn_IR_CON(0x01). [quote=""javadhabibi, post:10, topic:5414""]
because of I can?Ât understand the Disconnecting protocol.
[/quote]

What you want to achieve in overall? What task 5100 is going to perform?

[quote=""javadhabibi, post:10, topic:5414""]
2- if data RECV interrupt =&gt; Data Reading procedure and then go to RE_OPEN state
[/quote]

Remote device is not expected to send data in more than one packet? Why you close socket as soon as *something* is received? See my first question - what ar you doing with W5100? [quote=""javadhabibi, post:12, topic:5414""]
Every command is 6 Byte (in one PKT) and maybe send one command in an hour.
[/quote]

In the first picture I seew packet containing 4 bytes from the PC.

Datasheet is very clear on what you must do and why. You even know the byte count to receive.

1. You open socket in listening state.
2. You get connection (0x17).
3. You wait for data of either predefined length (6 bytes), or until PC disconnects (SR becomes something other than 0x17).
4. You perform disconnect.
5. You close socket, and go to step 1. [quote=""Eugeny, post:13, topic:5414""]
You perform disconnect.
[/quote]
you means this? 
 Set Sn_CR to DISCON(0x08)

[quote=""Eugeny, post:13, topic:5414""]
You close socket, and go to step 1.
[/quote]

and this means :   
Set Sn_CR to CLOSE(0x10)
?

Do i need to check TIME OUT? 
What means the state of ""CLOSE?"" on the flowchart? [quote=""javadhabibi, post:14, topic:5414""]
What means the state of ?ÂCLOSE???on the flowchart?
[/quote]

When SR is 0x00.

[quote=""javadhabibi, post:14, topic:5414""]
Set Sn_CR to DISCON(0x08)
[/quote]

Yes, it is disconnect, You may choose not to wait until other party disconnects. Just perform DISCON, then, after CR changes to 0x00, perform CLOSE, and then perform OPEN, and then LISTEN. All new commands must be issued when CR is 0x00. [quote=""Eugeny, post:15, topic:5414""]
> What means the state of ?ÂCLOSE???on the flowchart?

When SR is 0x00.
[/quote]

According to flowchart and your phrase:
when SR is 0x00 then i should Re-close the socket by setting Sn_CR to 0x10? [quote=""javadhabibi, post:16, topic:5414""]
when SR is 0x00 then i should Re-close the socket by setting Sn_CR to 0x10?
[/quote]

Can you pleae look into datasheet pages 29-31? There's each state described in there.","Q) You seem to be closing socket (without disconnect) as soon as connection is established. RST is an indication of the closed socket at W5100 side. I don't disconnect the connection at all. It seems when the PSH flag or in some case FNS flag in my TCP packet is set as 1*, the connection closed.
* it's automatically sent by packet sender. PSH flag received from remote device within the packet can not close socket on W5100. You close it yourself by your code/FPGA as soon as connection is established. The device is directly connected to my laptop. 
I read that PSH is push flag and means that layer 4 should push the data to layer 5. that's not true? 
I have nothing to do with Socket 0 Command Register([0x0401) to close the connection. Push flag has nothing to do with INT pin. This is true.
You must dig into your W5100 driving code. As I asid I suspect you close socket immediately when it got to established state. It is true? I have 2 Line of code deal with 0x0401 address(S0_CR). All are set in initialize:
1- set it to 0x01 => open it
2- Set it to 0x02 => LISTEN mode
Is it false !? Looks like you follow chapter 5.2.1.1 steps (at least I hope so). Try socket status register instead of interrupt bits to see what socket status is at each point of time. It is impossible to tell you exactly what is going on because you did not provide detailed information on common and socket register settings. But there seem to be some configuration or logical mistake.
What you want to achieve in overall? What task 5100 is going to perform?
Remote device is not expected to send data in more than one packet? Why you close socket as soon as *something* is received? See my first question - what are you doing with W5100?
Every command is 6 Byte (in one PKT) and maybe send one command in an hour.
Do i need to check TIME OUT? 
What means the state of ""CLOSE?"" on the flowchart?
when SR is 0x00 then i should Re-close the socket by setting Sn_CR to 0x10?
Can you pleae look into datasheet pages 29-31? There's each state described in there.
A) I suspect you close the socket immediately when it got to the established state. It is true? You must dig into your W5100 driving code. It is impossible to tell you exactly what is going on because you did not provide detailed information on common and socket register settings. But there seem to be some configuration or logical mistake. Remote device is not expected to send data in more than one packet. Every command is 6 Bytes in one packet and maybe sent one command in an hour. Yes, you may choose not to wait until the other party disconnects. Just perform DISCON, then, after CR changes to 0x00, perform CLOSE, and then perform OPEN, and then LISTEN. All new commands must be issued when CR is 0x00. According to the flowchart and your phrase: when SR is 0x00 then I should re-close the socket by setting Sn_CR to 0x10."
3116,5416,"hello.
We are using Wizfi250 and EVB board.

First, we set the module to WebConfiguration by pressing the Function button.
(STATION MODE, TCP Client Mode)

I set it to Web, so every time I reset Module, I try to connect right away.
I tried to use this feature.

Initially, the port is well connected to the open server.
After that, the server cut off the connection and the port was opened again.
I reset Module again and try to re -attempt, but I can't connect right away.

As you keep resetting Module, it will be connected after 1-3 minutes.

Server is a general PC and tested with a variety of programs, but it is the same symptoms.
If you do a typical TCP test with a wired LAN, you will be connected right away.

Is the reconciliation method not good through Module Reset? I consulted and solved it
thank you","Q) Is the reconciliation method not good through Module Reset? 
A) It seems that the reconciliation method through Module Reset may not be effective if it takes 1-3 minutes to reconnect after each reset. This issue might be related to the way the module attempts to reconnect to the server. It's worth considering alternative approaches to improve the connection stability."
3117,542,"Hi,
Uncheck ""enable debug message output""

If enabled, the debug message output to serial port number. It is useful for debugging WIZ107SR.

Thank you. Thank you for reply!
The purpose I use it is exactly to debug my serial connection, hence I was able to see it doesnt work. Nonetheless I unchecked the debug message, afterward I sent/received a single character data trough Device Terminal Program 1.0 and I still get corrupted data. Hi,
If the debug message display is no  problem any more, the baud rate is likely to matter.

So, Please test as the below.
1. Short TX/RX siganl with jumper or connect in WIZ107SR. (TX/RX loopback)
2. Send data thru ethternet.
3. Check the data to be received from ethernet.

Thanks. Thank you midnightcow!
I tried what you suggested. The result was [quote]LGSEG:CONNECTED[/quote]. Ok, so the device seems to work well in ""stand alone mode"".
Then where am I wrong? I am pretty much sure it is on BAUD rate. Anyway, this is my test scheme:
[code]

WIZ107SR<--->max3232<--->RS232_USB_converter<--->PC

[/code]

I am waiting for my oscilloscope to return from the service so I can determine tha actual BAUD rate.
A question is if the WIZ107SR serial port is TTL or RS232?
If the data being transmited is inverted or not?
Dont get me wrong, I have read the datasheet, but I have no idea what might be wrong in this case. WIZ107SR was released 'TTL' and 'RS-232' version both.
if you can find U2 'RS-232 transceiver' (refer to WIZ107SR partlist) on your module, you have WIZ107SR RS-232 version and if not, it's TTL version.
(Please check your board revision first. before revision 1.1 was released RS-232 version only.)

WIZ107SR RS-232 version is no need to use 'TTL - RS-232 transceiver' (like MAX3232). 
if you want to use DB-9 port, please connect the port directly on the module. Thank you so much Guys! 
[quote]if you can find U2 'RS-232 transceiver' (refer to WIZ107SR partlist) on your module, you have WIZ107SR RS-232 version [/quote]
Yes it has!
The problem was I put MAX3232 after the module which has already such.
Now everything work perfect. 
Thank you again!  :smiley:","Q) The purpose I use it is exactly to debug my serial connection, hence I was able to see it doesn't work. Nonetheless, I unchecked the debug message; afterward, I sent/received a single character data through Device Terminal Program 1.0, and I still get corrupted data.
A) If the debug message display is no problem anymore, the baud rate is likely to matter. 
Please test as the below:
1. Short TX/RX signal with jumper or connect in WIZ107SR. (TX/RX loopback)
2. Send data through Ethernet.
3. Check the data to be received from Ethernet.

Q) Then where am I wrong? I am pretty much sure it is on the BAUD rate. Anyway, this is my test scheme:
A) I am waiting for my oscilloscope to return from the service so I can determine the actual BAUD rate. 
A question is if the WIZ107SR serial port is TTL or RS232?
If the data being transmitted is inverted or not? 
Don't get me wrong, I have read the datasheet, but I have no idea what might be wrong in this case. WIZ107SR was released 'TTL' and 'RS-232' version both. 
if you can find U2 'RS-232 transceiver' (refer to WIZ107SR partlist) on your module, you have WIZ107SR RS-232 version and if not, it's TTL version.
(Please check your board revision first. before revision 1.1 was released RS-232 version only.)

WIZ107SR RS-232 version is no need to use 'TTL - RS-232 transceiver' (like MAX3232). 
if you want to use DB-9 port, please connect the port directly on the module.

Q) Thank you midnightcow!
A) Yes, it has! The problem was I put MAX3232 after the module, which has already such. Now everything works perfect. 
Thank you again!"
3118,5422,"Hey @Mxyxixptlick, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob: https://en.wikipedia.org/wiki/Inherently_funny_word :stuck_out_tongue_closed_eyes: That?Âs :sparkles: _emojitastic!_ :sparkles:

Sometimes you might want to get a person?Âs attention, even if you aren?Ât replying to them directly. Type `@` then complete their user name to mention them.

Can you mention **`@discobot`** in your reply? [quote=""discobot, post:7, topic:5422""]
@discobot
[/quote]

**`@discobot`** _Did someone say my name!?_ :raised_hand: I believe you did! :wave:  Well, here I am! Thanks for mentioning me.  :ok_hand:

Can you make some words **bold** or _italic_ in your reply?

- type `**bold**` or `_italic_`

- or, push the <kbd><b>B</b></kbd> or <kbd><i>I</i></kbd> buttons in the editor `**bold**`  or  `_italic_` Aww, I didn?Ât find any formatting in your reply. :pencil2:

Can you try again? Use the <kbd><b>B</b></kbd> bold or <kbd><i>I</i></kbd> italic buttons in the editor if you get stuck. **bold** or  _italic_ Great job! HTML and BBCode also work for formatting ? to learn more, [try this tutorial](http://commonmark.org/help) :nerd:

Can you try quoting me when you reply, so I know exactly which part you?Âre replying to?

> If this is coffee, please bring me some tea; but if this is tea, please bring me some coffee.
>
> One advantage of talking to yourself is that you know at least somebody?Âs listening.
>
> Some people have a way with words, and other people??oh, uh, not have way.

Select the text of whichever &uarr; quote you prefer, and then press the **Quote** button that pops up over your selection ? or the **Reply** button at the bottom of this post.

Below the quote, type a word or two about why you picked that one, because I?Âm curious :thinking: [quote=""discobot, post:13, topic:5422""]
One advantage of talking to yourself is that you know at least somebody?Âs listening
[/quote]

What's that? [quote=""discobot, post:1, topic:5422""]
:herb:
[/quote]

:herb: Yay you found it :tada:

- For more detailed searches, head over to the [full search page](https://forum.wiznet.io/search).

- To jump anywhere in a long discussion, try the topic timeline controls on the right (and bottom, on mobile).

- If you have a physical :keyboard:, press <kbd>?</kbd> to view our handy keyboard shortcuts.","Q) What's that? 
A) :herb: Yay you found it :tada: 

Q) Can you mention **`@discobot`** in your reply? 
A) **`@discobot`** _Did someone say my name!?_ :raised_hand: I believe you did! :wave:  Well, here I am! Thanks for mentioning me.  :ok_hand: 

Q) Can you make some words **bold** or _italic_ in your reply? 
A) - type `**bold**` or `_italic_`
 - or, push the <kbd><b>B</b></kbd> or <kbd><i>I</i></kbd> buttons in the editor `**bold**`  or  `_italic_` Great job! HTML and BBCode also work for formatting ? to learn more, [try this tutorial](http://commonmark.org/help) :nerd:
  
Q) If this is coffee, please bring me some tea; but if this is tea, please bring me some coffee.
A) One advantage of talking to yourself is that you know at least somebody?Âs listening."
3119,5428,"Hi
when i set the W5100 on Listen Mode(Sn_SR = SOCK_LISTEN), is it persistence or have time out? if no connection-disconnection from Client not occur (and also no internal close from w5100), is the listen mode persist? I did not see anything about this state timing out in the datasheet, thus it must be persistent. And it is generally logical - no one knows when request to connect arrives, thus if socket is in LISTEN state it must be there until socket is reconfigured, or connection using *this socket* is requested. 1)
 I set the socket 0 OPEN and the set it to LISTEN mode. Then in an infinite test loop i read the S0_SR(0x0403). In Most times, it is SOCK_LISTEN. But some time it becomes 0x08 or 0x02(temporary)  and these are out of Sn_SR table!!

2)
I have problem with data received length(Sn_RX_RSR ). Some times it becomes false.(0xFF64 instead of 0x0064)

May be these problems connected to each other? what can i do with them? Parallel or SPI mode? I suspect you use parallel mode. What is timing? Please draw the timing diagram. SPI using Spartan-3
I am using 500 Khz SCK. Timing diagram is hard to discover! I done it according to P.67 of w5100 datasheet.
Is there any other feedback from W5100 to check my code?

* I thought (according to your guide in my another topic) that if i don't read data   the Socket 0 RX Received Size(0x0426-7) should increase. But I tested it and that's not so.I read just the data size in each RECV int and for each 100 byte data PKT, Size Register is 0x0064. what about this? Does w5100 read only one packet in each time? [quote=""FPGA_Friend, post:5, topic:5428""]
Is there any other feedback from W5100 to check my code?
[/quote]

Sure. 6.3.3 shows that W5100 will respond with 0, 1 and 2 during read cycle.

[quote=""FPGA_Friend, post:5, topic:5428""]
for each 100 byte data PKT, Size Register is 0x0064
[/quote]

Decimal 100 in hexadecimal ix 0x64.

[quote=""FPGA_Friend, post:5, topic:5428""]
Does w5100 read only one packet in each time?
[/quote]

No, it gives you amount of data arrived. If two packets will arrive between updating pointers, it will show data length for two packets.","Q) when i set the W5100 on Listen Mode(Sn_SR = SOCK_LISTEN), is it persistence or have time out? if no connection-disconnection from Client not occur (and also no internal close from w5100), is the listen mode persist?
A) I did not see anything about this state timing out in the datasheet, thus it must be persistent. And it is generally logical - no one knows when request to connect arrives, thus if socket is in LISTEN state it must be there until socket is reconfigured, or connection using *this socket* is requested.

Q) I have problem with data received length(Sn_RX_RSR ). Some times it becomes false.(0xFF64 instead of 0x0064) May be these problems connected to each other? what can i do with them? Parallel or SPI mode? I suspect you use parallel mode. What is timing? Please draw the timing diagram. SPI using Spartan-3
A) I am using 500 Khz SCK. Timing diagram is hard to discover! I done it according to P.67 of w5100 datasheet. 

Q) I thought (according to your guide in my another topic) that if i don't read data the Socket 0 RX Received Size(0x0426-7) should increase. But I tested it and that's not so. I read just the data size in each RECV int and for each 100 byte data PKT, Size Register is 0x0064. what about this?
A) Sure. 6.3.3 shows that W5100 will respond with 0, 1 and 2 during read cycle. 

Q) Does w5100 read only one packet in each time?
A) No, it gives you amount of data arrived. If two packets will arrive between updating pointers, it will show data length for two packets."
3120,5429,"Hi
I'm using w5100 and  want to know:
how to find the number of ""packet"" received?  means: if 2 packet (with 100 byte data) received in w5100 and after that i go to read them, Sn_RX_RSR is 200? how to differentiate these two packets? [quote=""FPGA_Friend, post:1, topic:5429""]
if 2 packet (with 100 byte data) received in w5100 and after that i go to read them, Sn_RX_RSR is 200
[/quote]

Yes.

[quote=""FPGA_Friend, post:1, topic:5429""]
how to differentiate these two packets?
[/quote]

You do not need it for TCP connection, and this type of connection deliberately hides this information from session layer. whether that means we cannot reset the register value every time we receive a data packet.? I know it the register value can't reset every time you receive a data packet.
Just it can modify the register value before socket open operate. execuse me, sorry out of topic, because i have a case. can friends here give me a reference wiznet w5100 call web services?","Q) How to find the number of ""packet"" received in W5100? 
A) If 2 packets (with 100 byte data) are received in W5100, and after that you go to read them, Sn_RX_RSR will be 200. To differentiate these two packets, you do not need it for TCP connection, as this type of connection deliberately hides this information from the session layer. However, you cannot reset the register value every time you receive a data packet. You can modify the register value before socket open operation. As for the reference to Wiznet W5100 to call web services, that may be out of topic here."
3121,543,"hello
Buy the IMCU7200EVB and ask for UDP communication.

The API functions were good, so I could shorten time to implement communication.

First of all, it is well to get data from the PC by periodically udpopen from the IMCU7200EVB.
However, I am curious about receiving at the IMCU7200EVB.
Now, the UDPRECV function seems to have to be monitored if there is a message received in a polling manner.
  
Can I implement the IMCU7200EVB UDP Communication RECV interrup?

Because it is always a waste of resources to always monitor the UDPRECV function in the main loop.
I would like to ask the interrupt and handle it immediately. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??
?ÂÃ¬Â¦Â?Â¤Ã­ÂÂ¸ ?ÂÃ«ÂÂ?? 

Cortex-m3?? W5200?Â¼Ã«Â¡Â ÃªÂµÂ¬Ã¬ÂÂ±??W7200???Â´Ã«??ÂÃ¬ÂÂ¼Ã«Â¡??Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ ??(GPIOB_13PIN)???Â°ÃªÂ²Â°?ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ´ 
Ã«Â¬Â¸Ã¬ÂÂ ?ÂÃ¬ÂÂ  ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸Ã«Â¡? ?ÂÃ¬ÂÂ Ã¬Â²ÂÃ«Â¦Â¬ÃªÂ°? ÃªÂ°??Â¥Ã­ÂÂ©?ÂÃ«ÂÂ¤. 

W5500???Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ Ã¬Â²ÂÃ«Â¦Â¬Ã«Â¶?Ã«Â¶ÂÃ¬? ?ÂÃªÂ¸Â° Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ Ã¬Â°Â¸ÃªÂ³Â  Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? 

1. ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ Ã¬Â´ÂÃªÂ¸Â°??
- IMRÃ«Â¥??Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ ?Â¬Ã¬ÂÂ©??Socket???Â¤Ã¬Â Â?ÂÃ«ÂÂ¤. 
[quote]IMR (Interrupt Mask Register)??InterruptÃ«Â¥?Mask?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´ ?Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ¤. ÃªÂ°?Interrupt Mask Bit??
Interrupt Register2 (IR2)??Bit?? ÃªÂ°ÂÃ«ÂÂ¤. Interrupt Mask BitÃªÂ°? set?ÂÃ¬ÂÂ´?ÂÃ«ÂÂ¤Ã«Â©? IR2???Â´Ã«ÂÂ¹ BitÃªÂ°? set?ÂÃ¬ÂÂ??
??InterruptÃªÂ°? Ã«Â°ÂÃ¬ÂÂ ??ÃªÂ²ÂÃ¬ÂÂ´?? Ã«Â§ÂÃ¬ÂÂ½ IMR?????ÂÃ¬ÂÂ¼Ã«Â¡?set?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ¤Ã«Â©? IR2???Â´Ã«ÂÂ¹ BitÃªÂ°? set?ÂÃ«ÂÂ?Â¼Ã«ÂÂ 
Interrupt??Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬? ?ÂÃ«ÂÂ??/quote]

2. ?Â¸Ã«ÂÂ¬?Â½Ã­ÂÂ¸ ?ÂÃ¬ÂÂ¸
2.1 W5500???Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ Ã«Â°ÂÃ¬ÂÂ??IPconfict??PPPoE Close??IRÃ«Â¥??Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ 
SocketÃ¬Â¤??Â´Ã«ÂÂ ?ÂÃ¬Â¼Â?ÂÃ¬ÂÂ ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬??ÂÃ¬???IR2Ã«Â¥??Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ¸?ÂÃ«ÂÂ¤. 

[quote]IR?? Interrupt Ã«Â°ÂÃ¬ÂÂ?Â¬Ã«?Ã«Â¥??ÂÃ«ÂÂ¨?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´ Host processor??MCU?ÂÃ¬ÂÂ access?ÂÃ«ÂÂ¤. IR BitÃªÂ°? set?ÂÃ«Â©Â´ ??
INTn ?Â Ã­ÂÂ¸??low ?ÂÃ­ÂÂ asserted?ÂÃªÂ³Â  IR??Ã«ÂªÂ¨Ã«ÂÂ  Bit?Â¤Ã¬ÂÂ clear?ÂÃ¬? ?ÂÃ«ÂÂ ?Â´Ã¬ÂÂ high?ÂÃ­ÂÂÃ«Â¡?Ã«Â³??ÂÃ¬? ?ÂÃ«ÂÂ?? 
IR?? MCU??Interrupt?Â Ã­ÂÂ¸Ã«Â¥?Ã«Â°ÂÃ¬ÂÂ?ÂÃ­ÂÂ¨??/quote]

[quote]IR2??W5200 SOCKET InterruptÃªÂ°? Ã«Â°ÂÃ¬ÂÂ??ÃªÂ²Â½Ã¬ÂÂ° ?Â´ÃªÂ²Â???ÂÃ«Â Â¤Ã¬Â£Â¼Ã«ÂÂ register?Â´Ã«ÂÂ¤. InterruptÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬ÂÂ 
?? IR2???Â´Ã«ÂÂ¹ BitÃªÂ°? set?ÂÃ«ÂÂ¤. ??ÃªÂ²Â½Ã¬ÂÂ° IR2??Ã«ÂªÂ¨Ã«ÂÂ  Bit?Â¤Ã¬ÂÂ´ ???ÂÃ¬ÂÂ¼Ã«Â¡?clear???ÂÃªÂ¹ÂÃ¬Â§? INTn ?Â Ã­ÂÂ¸??low??
?ÂÃª? ?ÂÃ«ÂÂ¤. Sn_IR Bit?Â¤Ã¬ÂÂ ?Â´Ã¬ÂÂ©?Â´Ã¬ÂÂ IR2 registerÃ«Â¥?clear?ÂÃ«Â©Â´ INTn ?Â Ã­ÂÂ¸??high ?ÂÃ­ÂÂÃªÂ°? ?ÂÃ«ÂÂ¤. 
[/quote]

2.2 IR2?ÂÃ¬ÂÂ ?Â´Ã«ÂÂ¹ ?ÂÃ¬Â¼Â??Sn_IRÃ«Â¥??ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂ¬ ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ ???ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃ«ÂÂ¤. (RECV ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ ?Â¬Ã­ÂÂ¨)

[quote]Sn_IR register??SOCKET n??Interrupt (establishment, termination, receiving data, timeout) typeÃªÂ³?ÃªÂ°?
?? ?ÂÃ«Â³Â´Ã«Â¥??ÂÃªÂ³Âµ?ÂÃ«ÂÂ¤. InterruptÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃªÂ³Â  Sn_IMR???Â´Ã«ÂÂ¹ Mask BitÃªÂ°? ???ÂÃ¬ÂÂ¸ ÃªÂ²Â½Ã¬ÂÂ° Sn_IR??Interrupt Bit
?????ÂÃ«Â¡Â ?ÂÃ«ÂÂ¤. Sn_IR BitÃ«Â¥?clear?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´?ÂÃ«ÂÂ, ?Â´Ã«ÂÂ¹ Bit???Â¤Ã¬ÂÂ ???ÂÃ¬ÂÂ write?Â´Ã¬ÂÂ¼ ?ÂÃ«ÂÂ¤. 
[/quote]

3. ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ Ã«Â°ÂÃ¬ÂÂ ???Â¤Ã¬ÂÂ ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸Ã«Â¥?Ã¬Â²ÂÃ«Â¦Â¬?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´ ?Â¸Ã­ÂÂ°?Â½Ã­ÂÂ¸ ???ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸????Ã«Â°ÂÃ«ÂÂ??IRÃªÂ³?IR2???Â´Ã«ÂÂ¹ Bit??'1'Ã«Â¥?Write?ÂÃ«ÂÂ¤. 

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? Interrupt may occur and does not support pending.
Therefore, if the receive interrupt occurs, the interrupt may be overlapped according to the processing speed, which may cause loss.If an interrupt occurs, only the flag is checked, and it is recommended to check the flag by checking the flag where it is not ISR routine.
If you have all Receive processing in ISR, you should clear Sn_ir (recv) when SN_RX_RSR is 0 and allow you to exit the ISR routine. Thank you for your answer.

But I haven't implemented it yet.

The W7200 manual, as you said, the PC13 was connected internally.

It is implemented as a driver code provided by Wiznet
Gpio_configuration ();The following is the following, but the interrupt is not yet properly.


GPIO_EXTILINECONFIG (GPIO_PORTSOURCEOC, GPIO_PINSOURCE13);
// gpio_extilineconfig
EXTI_INITSTRUCTURE.EXTI_LINE = exti_line13;
EXTI_INITSTRUCTURE.EXTI_MODE = EXTI_MODE_INTERUPT;
EXTI_INITSTRUCTURE.EXTI_TRIGGER = exti_trigger_rising_falling;
EXTI_INITSTRUCTURE.EXTI_LINECMD = enable;
EXTI_INIT (& EXTI_INITSTRUCTURE);
Exti_generateswinterrupt (exti_line13);


The driver code seems to have a code in preparation for interrupt.
Can you give you a guideline where to find and modify?
Would you like to get an implemented example?
It seems enough to know the GPIO AINT setting, which can be seen by simply entering the mana ISR function when UDP communication comes in. Please check if the IMR, Interrupt Mask Register and the IMR2 Register value are set to 0xFF, respectively. hello

Problem symptoms
1. SN_IR (SOCKET N Interrupt Register) [R] [0x4002+0x0n00] [0x00]
It is clearly written R, Read, but to mask the interrupt, it is necessary to clear it by 1write in the SN_IR register.
Is that right?Shouldn't it be written R/W?
-> R/W is a format that changes the value when a user uses any value.However, since sn_ir is simply clearing the purpose
R/W can be confused only because it can be confused.


2. If you look at 5200 data sheets in the IMR register and IMR2 registers, aren't you about IMR/IMR2?
Where is the data sheet and register for the 7200?
I can't find it on the data sheet ~
-> See the data sheet of the W5200.Version 1.3.0 Version IMR-19, IMR2-23 is shown in detail.


3. I tested it and gave 0x02 to the IMR2 register and set the pin interrupt in PORTC
It's good to check the interrupt when it's falling.
-> In the case of IMR2, IP Conflict and PPPOE interrupt masks, and the IMR is an interrupt mask for each socket.
There are some confusion, but the mask of the IR2 is the IMR and the mask of the IR is IMR2.
In other words, you can use the IMR to activate the interrupt of the desired socket.After that, if the interrupt of the socket occurs, the interrupt pin will fall to the low. hello.

I'll answer 4 or 5 times.

4. In case
I think I need to clear the interrupt of TCP/IP Core in the void exti15_10_IrqHandler (void) function.

IIINCHIP_WRITE (SN_IR (SOCKET), 0xFF);

If you don't clear the core, the interrupt signal of the core will continue to be low, and then you will call the interrupt routine again even if you go back to the main.

So it seems that there is a stop.

In the case of 5 times, there may be a possibility of occurring because of 4, so try to solve it first and ask again if there is still five problems.

thank you","Q) Can I implement the IMCU7200EVB UDP Communication RECV interrupt?
A) Because it is always a waste of resources to always monitor the UDPRECV function in the main loop. I would like to ask the interrupt and handle it immediately.

Q) Can you give you a guideline where to find and modify the interrupt driver code?
A) But I haven't implemented it yet. The W7200 manual, as you said, the PC13 was connected internally. It is implemented as a driver code provided by Wiznet Gpio_configuration ();

Q) If you look at 5200 data sheets in the IMR register and IMR2 registers, aren't you about IMR/IMR2?
A) Where is the data sheet and register for the 7200? I can't find it on the data sheet. See the data sheet of the W5200.Version 1.3.0 Version IMR-19, IMR2-23 is shown in detail.

Q) In case I think I need to clear the interrupt of TCP/IP Core in the void exti15_10_IrqHandler (void) function.
A) If you don't clear the core, the interrupt signal of the core will continue to be low, and then you will call the interrupt routine again even if you go back to the main.

Q) If you have all Receive processing in ISR, you should clear Sn_ir (recv) when SN_RX_RSR is 0 and allow you to exit the ISR routine.
A) In the case of 5 times, there may be a possibility of occurring because of 4, so try to solve it first and ask again if there is still five problems."
3122,5430,"I made a phone call on the wired line and informed you about the circuit correction.
If other problems occur, please leave anytime

thank you ",A) None.
3123,5435,"hello.
Only /SCLK and /SCS were connected between the MCU and Wiz812mj.
The MOSI and MISO of the Wiz812MJ are connected to the PB3 and PB4, and the MCU's PB3 and PB4 are NC.
In other words, the circuit connection is not normal.

Refer to the circuit by referring to the reference circuit of the wiz812mj.
https://www.wiznet.io/product-item/wiz812mj/ Select the CPUTICK in the menu to meet the speed of speed first. The file size sent is so small that it looks so.
Send a file with a size of more than several m bytes.","Q) Only /SCLK and /SCS were connected between the MCU and Wiz812mj. The MOSI and MISO of the Wiz812MJ are connected to the PB3 and PB4, and the MCU's PB3 and PB4 are NC. In other words, the circuit connection is not normal.
https://www.wiznet.io/product-item/wiz812mj/ Select the CPUTICK in the menu to meet the speed of speed first. The file size sent is so small that it looks so. Send a file with a size of more than several m bytes.
A) I'm sorry, there is no clear question or request for an answer in the provided text."
3124,5439,"hello.

It is possible to configure the daisy chain using the W7500, and the product you are already thinking about is prepared with two different form factors in WizNet.

Please tell me the mail address and you can send you the relevant materials.

thank you Thank you for answer.then
MCU and W7500 do not have 10/100m PHY for SPI, W7500 and Ethernet switches in PORT2.
Are you saying that you can do it without a PHY chip with MII to Mac?
Terry.son@mintrobot.co.kr.Thank you for your two different Form Factor !! Yes, it is.

Switch chip and W7500 are I/F with MII.
The SPI or UART can be I/F between SPI and W7500.

I will send you a reference to the data of the two different form factors. Thank you for your data.
Can I get technical support for software?

When it is connected that way, the switch chip and the W7500 do not need to set up the program separately.
Should I just set the program on ST MCU? Hello, this is Wiznet.

The W7500 is the ARM Cortex-M0 MCU.That's why you need to have firmware.

Do you connect the W7500 with the ST MCU and UART?

If so, you can use the firmware of the WIZ750SR-100.

The WIZ750SR-100 can be seen in the form of PHY IC instead of Switch IC.

http://wizwiki.net/wiki/doku.php?id=products:S2E_module

In the URL above, please refer to the circuit diagram and firmware.

thank you hello.
I also want to make data control with STM32F by configuring 2Channal Ethernet.
Can you deliver the data? I also want to configure Ethernet Daisy Chain after connecting the NXP MCU and W7500.Please ask for the relevant data.If you have any materials made of old DM-8603, please.Including hardware ~~ (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) Please refer to the answer above. thank you

August 7, 2019 (Wed) 10:49 AM, Scott Jeong Via Wiznet Developer Forum <wiznet@discoursemail.com>","Q) Are you saying that you can do it without a PHY chip with MII to Mac?
Q) Can I get technical support for software?
Q) Should I just set the program on ST MCU?
Q) Do you connect the W7500 with the ST MCU and UART?
Q) I also want to make data control with STM32F by configuring 2Channal Ethernet. Can you deliver the data?
Q) I also want to configure Ethernet Daisy Chain after connecting the NXP MCU and W7500. Please ask for the relevant data. If you have any materials made of old DM-8603, please.

A) The W7500 is the ARM Cortex-M0 MCU, and it requires firmware to operate. You can use the firmware of the WIZ750SR-100 when connecting the W7500 with the ST MCU and UART. The WIZ750SR-100 can be seen in the form of PHY IC instead of Switch IC. For technical support for software and relevant data, please refer to the circuit diagram and firmware in the following URL: http://wizwiki.net/wiki/doku.php?id=products:S2E_module. Thank you.
"
3125,544,"Hello Sir ,
 
I am trying to place my embedded board which has WIZ812MJ as a ethernet module and acts as a server in  a LAN . 
For this i have configured  all its 4 sockets in listen mode with PORT no 502 for modbus communication , so that it can accept the request from any PC in the LAN and serve it .

Here i am able to connect all the 4 users  , accept there request  and communicate with them smoothly but,  suddenly  while communicating with them initially one of the socket stops replying and gets hanged due to this other 3 sockets also gets hanged . During this i am not getting any DISCONNECT/TIMEOUT interrupt so i am unable to find the problem . 

From my side i have checked all the flags in IR and Sn_IR are also  getting cleared and at this time interrupt line of module is also at HIGH logic level which means no interrupt is pending . So i just wonder what i am missing to take care of , or is there some problem with the module itself  . So , please  help me out to sort this problem .

Module configuration :

ip_addr = 192.168.1.252
gtw_addr = 192.168.1.1
mac_addr = 10.11.12.13.14.15
subnet = 255.255.255.0

Retry time = 200ms(default)
retry count = 1

port no of all sockets are set to 502 .
all the mask has been enabled . 

waiting for reply ,
thank you. Hi,

When your module is hanged up, check the ethernet-link and ping-request.
If without ping-reply, Maybe IP chagned by unknown reason. Dump the related Register value.

Also, check the sequence of send proccessing as belows.
1. free buffer size check
2. data copy
3. send command with Sn_CR
4. wait unitl send command is completed. During wait, check the timeout or socket closed.
5. Sn_TX_WR update as many as sent size.

thanks. I have followed the sending sequence given in the Datasheet  in which it 
1 .first increases the Sn_Tx_Wr pointer  to the copied size 
2.then gives the SEND command .

But,
your suggestion is to reverse this operation , does that makes the difference . Hi,
I mistaked, You was right. I'm sorry.
After send command is completed, You can read the updated Sn_TX_WR value.

1. free buffer size check
2. data copy 
3. update Sn_TX_WR with data copied lenght
4. send command with Sn_CR
5. wait unitl send command is completed. During wait, check the timeout or socket closed.


How do your problem?
Can be pinged to your board? Hi ,

YES i am getting the ping reply from my module when it hangs , also i am getting DISCONNECT request interrupt when i disconnect in this situation   but module dosent take any RECV request further .
I have followed the above sequence for writting .
     what other  tests that i can perform  !! Hi, rashantkumar.

I think there is point hanged in your code somewhere. 

[quote] i am getting DISCONNECT request interrupt when i disconnect in this situation but module dosent take any RECV request further .[/quote]

Did you mean that 812MJ occurred DISCON(0x08) interrupt but WIZ812MJ doesn't get any packet??
Or disconnect procedure is not performed??

And post your code and then we will check.

Best regards. Hi,
If you can receive ping-reply from WIZ812MJ, WIZ812MJ works fine.
Maybe you have some mistake to handle WIZ812MJ.

Most of all, It is important to find where code is hanged-up.
If you can use with debug-tool as jtag, Break code when it hanged-up and Observe code, regsiter and etc.
If without debug-tools, dispaly the log message the serial port for more detail information about it.

Thanks. Hi , 

I am really thankfull for your help ,
I am trying to debug the problem from  last few days and  i got a doubt as what happens when two sockets gets the data/ interrupt in a very less time i. e  before i clear the corresponding flag in IR REGISTER , bcoz that might be happening in my case 
since user on another PC can hit the button before the earlier request interrupt flag generated due to previous user got clear . 

Also can my module get the interrupt for 2 sockets at the same time .

Thank you , Hi, prashantkumar.

Already you said, interrupt can be occurred in piles but not support pending.
So, received packet could be lost by MCU speed of performance.

I recommend to check only flag in ISR routine when interrupt occurred, handle receive process not at ISR routine.

Best regards. Hi,

W5200's interrupts can be overlaped before IR & Sn_IR is cleared. So, I you want to avoid lossing some data noitified by interrupt, Before you do clear IR & Sn_IR, Check whether Sn_RX_RSR > 0 or not.
If Sn_RX_RSR > 0, Repeatly receiving data and procssing it until Sn_RX_RSR > 0, And then Sn_RX_RX beccomes 0,  clear IR & Sn_IR.

Thank you.","Q) Hello Sir, I am trying to place my embedded board which has WIZ812MJ as an ethernet module and acts as a server in a LAN. For this I have configured all its 4 sockets in listen mode with PORT no 502 for modbus communication, so that it can accept the request from any PC in the LAN and serve it. Here I am able to connect all the 4 users, accept their request and communicate with them smoothly but, suddenly while communicating with them, initially one of the socket stops replying and gets hanged, due to this the other 3 sockets also get hanged. During this, I am not getting any DISCONNECT/TIMEOUT interrupt so I am unable to find the problem. From my side, I have checked all the flags in IR and Sn_IR and they are also getting cleared and at this time the interrupt line of the module is also at HIGH logic level which means no interrupt is pending. So, I just wonder what I am missing to take care of, or is there some problem with the module itself. So, please help me out to sort this problem.

Module configuration:

ip_addr = 192.168.1.252
gtw_addr = 192.168.1.1
mac_addr = 10.11.12.13.14.15
subnet = 255.255.255.0

Retry time = 200ms (default)
retry count = 1

port no of all sockets are set to 502.
all the mask has been enabled.

waiting for a reply, thank you.

When your module is hanged up, check the ethernet-link and ping-request. If without ping-reply, Maybe IP changed by an unknown reason. Dump the related Register value. Also, check the sequence of send processing as below:
1. free buffer size check
2. data copy
3. send command with Sn_CR
4. wait until the send command is completed. During wait, check the timeout or socket closed.
5. Sn_TX_WR update as many as sent size. Thanks. I have followed the sending sequence given in the Datasheet in which it 1. first increases the Sn_Tx_Wr pointer to the copied size 2. then gives the SEND command. But, your suggestion is to reverse this operation, does that make a difference. 

A) Hi, I mistook. You were right. I'm sorry. After the send command is completed, you can read the updated Sn_TX_WR value.

1. free buffer size check
2. data copy
3. update Sn_TX_WR with data copied length
4. send command with Sn_CR
5. wait until the send command is completed. During wait, check the timeout or socket closed.

How do your problem? Can you be pinged to your board?

A) YES, I am getting the ping reply from my module when it hangs, also I am getting DISCONNECT request interrupt when I disconnect in this situation, but the module doesn't take any RECV request further. I have followed the above sequence for writing. What other tests that I can perform? 

A) Hi, Prashantkumar. I think there is a point hanged in your code somewhere. Did you mean that WIZ812MJ occurred DISCON(0x08) interrupt but WIZ812MJ doesn't get any packet? Or disconnect procedure is not performed? And post your code and then we will check. Best regards.

A) Hi, if you can receive ping-reply from WIZ812MJ, WIZ812MJ works fine. Maybe you have made some mistake in handling WIZ812MJ. Most of all, it is important to find where the code is hanged up. If you can use a debug-tool as jtag, Break code when it hanged up and Observe the code, registers, and etc. If without debug-tools, display the log message the serial port for more detailed information about it. Thanks.

Q) I am really thankful for your help. I am trying to debug the problem from the last few days and I got a doubt as what happens when two sockets get the data/ interrupt in a very less time i.e before I clear the corresponding flag in IR REGISTER, because that might be happening in my case since the user on another PC can hit the button before the earlier request interrupt flag generated due to the previous user got cleared. Also can my module get the interrupt for 2 sockets at the same time. Thank you. 

A) Hi, Prashantkumar. Already you said, an interrupt can be occurred in piles but not support pending. So, received packet could be lost by MCU speed of performance. I recommend to check only flag in ISR routine when an interrupt occurred, handle receive process not at the ISR routine. Best regards.

A) W5200's interrupts can be overlapped before IR & Sn_IR is cleared. So, if you want to avoid losing some data notified by interrupt, before you do clear IR & Sn_IR, Check whether Sn_RX_RSR > 0 or not. If Sn_RX_RSR > 0, Repeatedly receiving data and processing it until Sn_RX_RSR > 0, and then Sn_RX_RX becomes 0, clear IR & Sn_IR. Thank you."
3126,5447,"Please put comments into your source code so that we would not have to guess what you are doing in there. What is the value of "" W5500_SPI_READ""? Draw the diagram of what goes to SPI and what you expect to get.

[quote=""Century, post:1, topic:5447""]
but we see only MOSI pulses, the W5500 chip is not responding
[/quote]

What do you mean - not responsing? We are not getting any signal on MISO line. [quote=""Century, post:3, topic:5447, full:true""]
We are not getting any signal on MISO line.
[/quote]

*Any* signal? Hi sir,
As I am requesting Chip version, always getting 0x00, what could be the fault and how to check whether the chip is functioning or not? You are not answering the questions asked, and asking more questions instead. How it is possible to help you? Sir,
I have edited the post by commenting the code. And yes I am not getting any signal on the MISO line. Sir,

Please help me! [quote=""Eugeny, post:6, topic:5447""]
he questions asked, and asking more questions instead. H
[/quote]

Hi~
The MISO of W5500 signal shows Dummy data..
If you read the chip version of W5500, you can show Dummy data as below.

        ---ADDRH-----ADDRL-----OP------DATA
    MOSI     0x00    0x39     0x00    DUMMY
    MISO     0x01    0x02     0x03    0x04

Could you please try the test?

thanks
best regards
irina Thanks,
There was crystal oscillator problem. SPI worked fine.
But when I plugged in the Ethernet cable no LED's are blinking.","Q) What is the value of "" W5500_SPI_READ""? Draw the diagram of what goes to SPI and what you expect to get.
A) As I am requesting Chip version, always getting 0x00, what could be the fault and how to check whether the chip is functioning or not?

Q) What do you mean - not responding? We are not getting any signal on MISO line.
A) The MISO of W5500 signal shows Dummy data. If you read the chip version of W5500, you can show Dummy data as below.

        ---ADDRH-----ADDRL-----OP------DATA
    MOSI     0x00    0x39     0x00    DUMMY
    MISO     0x01    0x02     0x03    0x04
Could you please try the test?

Q) Can you help me?
A) There was crystal oscillator problem. SPI worked fine. But when I plugged in the Ethernet cable no LED's are blinking."
3127,545,"The W5500 was connected to the PC by 1: 1 and connected by the PC side.
The message is displayed ... Hardware connection status is that there is no problem.
I think it means ...

After that, I'm trying to connect software
There is no response ...
F/W turns it on the site.
It's the second sample.
The second sample doesn't work even if you try this.
For example, the IP is set to 192,168,100, and the port is set to 5000 and connected by the PC side.
Even if you give a command, the W5500 will not see any reaction.

Do you have any attention or I overlooked when designed? I don't understand what it means hardware and software connection.
Try the ping test with the W5500.(Ping xxx.xxx.xxx.xxx)

If it is not ping, please check whether the link LED is lit properly and the PC Network environment is set properly.
On the PC side, see [URL] http://wizwiki.net/wiki/doku.php?id=osh:cookie: IP_CONF_B [/URL].","Q) Do you have any attention or I overlooked when designed? I don't understand what it means hardware and software connection.
A) It seems like you are facing difficulty in understanding the hardware and software connection for the W5500. Let me explain it to you.

Q) Try the ping test with the W5500.(Ping xxx.xxx.xxx.xxx)
A) You can perform a ping test with the W5500 using the command ""Ping xxx.xxx.xxx.xxx"" to check the connectivity.

Q) If it is not ping, please check whether the link LED is lit properly and the PC Network environment is set properly.
A) If the ping test is not successful, you should ensure that the link LED is properly lit and the PC Network environment is set up correctly.

Q) On the PC side, see [URL] http://wizwiki.net/wiki/doku.php?id=osh:cookie: IP_CONF_B [/URL].
A) You can refer to the URL http://wizwiki.net/wiki/doku.php?id=osh:cookie: IP_CONF_B for guidance on the PC side settings."
3128,5455,"Hello.
I am using WIZ752SR-125 and need to configure WIZ752SR throught RS232 port. I've enabled `Serial command mode` check box in Windows config tool and set `Trigger code` to 2B 2B 2B. Then I've connected RS232 cable (com-0-com) from my desktop to RS232-1 on WIZ board. I send and recieve messages  beetwen tcp and RS232 througth configured port. But nothing happens when I try send command for switching port from data mode to command mode. 
According command manual from Wizwiki my actions are:
I send SS+++\r\n, by serial port terminal.
Then I try to send SS\r\n or LI\r\n, but there is no effect. Requests apear on socket side and board does not answer. 

May be I do something incorrect? I think you need a null modem cable between the WIZ752SR-125 and your PC

James","Q) May be I do something incorrect? I think you need a null modem cable between the WIZ752SR-125 and your PC.
A) Your understanding is correct. Using a null modem cable between the WIZ752SR-125 and your PC can potentially resolve the issue you are experiencing."
3129,5459,"Hello,

I have a problem with a websocket connection using a w5500. A stm32f (w55000 & mbed os) talking to a raspberry pi running node-red.
Sending data to node-red is working fine but after a few minutes the stm32f client do not receive any data (while still sending json packages of around 100 characters every 5 seconds).
I check with ws_isConnected() but it takes 10-30 seconds until it returns false. Reconnect work fine but soon it will start over again.
Node-red thinks  to have a working  connection and if the client reconnects and counts up one connection.
If I restart the server socket on node-red it again takes around 30 seconds until the stm32f recognizes that the connection was lost and then I can reconnect without a problem.
All is installed in a local LAN with fixed IPs the raspberry server and 5 clients (all connected to individual ws:// urls) on one switch.No router or internet involved.
My questions

* How can I improve stability 
* How can I determine if the client is not receiving on the client (w5500) side?
* Has somebody a reliable Mbed websocket library with example code for the w5500 (mine is from the mbed site)
* Any idea how to check if the problem is on the client or server side? (I tested wireshark but not experienced enough to get results)

Thank you for your help.
Chris. [quote=""Christian-Me, post:1, topic:5459""]
All is installed in a local LAN with fixed IPs the raspberry server and 5 clients (all connected to individual ws:// urls) on one switch.
[/quote]

All are having same MAC address? Nope ... all different! Sorry, would be too easy.
But the idea was good. The Controller PCB have a dip switch to hardcode a device ID for MAC and IP Address and used to identify the messages by the server.  All working fine Hi,

Can you capture ethernet packets with wireshark.exe, which is free software, and share it with us?
It would be helpful for us to analyze the reason.

Thank you.

James. Thank you for your help. I can do that, the server is running linux on a raspberry and I already installed wireshark.
Do you can give me a hint where to look for, any useful filter settings? Normally I am overwhelmed by the amount of information and have no experience in using wireshark. [quote=""Christian-Me, post:1, topic:5459""]
No router or internet involved.
[/quote]

What is configured as gateway for W5500? The gateway of my network. I wanted to say during the communication ther is no traffic over routers or through the Internet involved. As far as I intentionally coded it there should be no traffic behind the switch and the devices. There will be traffic to the gateway, at least ARP requests. Only network log will show. Not sure but these 30 seconds may be a timeout for something (e.g. ARP request). Just a guess. Try to read the registers RX Free Size Register.
At the time of ""hang"" of the socket. If they are much larger than a socket size&gt; 30000, then perhaps you have not written the buffer pointer correctly (Sn_RX_RD). Is there an example of w5500 websocket with stm32 ?","Q) How can I improve stability? How can I determine if the client is not receiving on the client (w5500) side? Has somebody a reliable Mbed websocket library with example code for the w5500 (mine is from the mbed site)? Any idea how to check if the problem is on the client or server side? (I tested wireshark but not experienced enough to get results).
A) Hello, 

Can you capture Ethernet packets with wireshark.exe, which is free software, and share it with us? It would be helpful for us to analyze the reason. 

Thank you.

James. 

Q) What is configured as gateway for W5500? 
A) The gateway of my network. I wanted to say during the communication there is no traffic over routers or through the Internet involved. As far as I intentionally coded it there should be no traffic behind the switch and the devices. There will be traffic to the gateway, at least ARP requests. Only network log will show. Not sure but these 30 seconds may be a timeout for something (e.g. ARP request). Just a guess. Try to read the registers RX Free Size Register at the time of ""hang"" of the socket. If they are much larger than a socket size > 30000, then perhaps you have not written the buffer pointer correctly (Sn_RX_RD).

Thank you for your help. I can do that, the server is running Linux on a raspberry and I already installed wireshark. Do you can give me a hint where to look for, any useful filter settings? Normally I am overwhelmed by the amount of information and have no experience in using Wireshark.

Nope ... all different! Sorry, would be too easy. But the idea was good. The Controller PCB have a dip switch to hardcode a device ID for MAC and IP Address and used to identify the messages by the server. All working fine.

Is there an example of W5500 websocket with STM32?"
3130,546,"Hello, 
Is there a serial command to enable / disable ports? I can do it through the web interface (port managment), but can not find any appropriate serial command.
Thanks. Hello Logis.

As you did, you can enable/disable serial-ports only with web interface.
There is no serial-command to enable/disable serial ports.","Q) Is there a serial command to enable / disable ports? 
A) There is no serial-command to enable/disable serial ports."
3131,5468,"When CS is high, MISO is expected to be Hi-Z. How it happens that for you it is low? Is it real measurement or simulation? Ok, you seem to do things properly, but for some reason there's 0 in the data phase.
I am searching through datasheet, can not find it saying that W5500 must return 0x01, 0x02, and 0x03 on MISO line. I am sure it is somewhere in there.

W5100 datasheet has respective pic about it, but that chip return 0x00, 0x01, 0x02.

Idea: don't you accidentally drive MISO low with MCU during read operation? The only reason I see could be defective W5500, or something concurrently puts 0x00 onto the line. Well, I plugged in another SPI driven module to my ESP32 devkit and everything works just fine. I soldered another PCB for W5500 and it works, I get 0x04 as version, on logic analyzer I can clearly see all sequence on MISO (0x01, 0x02, 0x03, 0x04). Probably first W5500 is broken, but this is quite weird that first three bytes are ok and the fourth one is missing. Is it common with W5500? [quote=""bno, post:5, topic:5468""]
Is it common with W5500?
[/quote]

No, but if you solder by hand you must be very careful not to overheat the device.","Q) When CS is high, MISO is expected to be Hi-Z. How it happens that for you it is low? Is it real measurement or simulation? Ok, you seem to do things properly, but for some reason there's 0 in the data phase. I am searching through datasheet, can not find it saying that W5500 must return 0x01, 0x02, and 0x03 on MISO line. I am sure it is somewhere in there. Idea: don't you accidentally drive MISO low with MCU during read operation? The only reason I see could be defective W5500, or something concurrently puts 0x00 onto the line. Well, I plugged in another SPI driven module to my ESP32 devkit and everything works just fine. I soldered another PCB for W5500 and it works, I get 0x04 as version, on logic analyzer I can clearly see all sequence on MISO (0x01, 0x02, 0x03, 0x04). Probably first W5500 is broken, but this is quite weird that first three bytes are ok and the fourth one is missing. Is it common with W5500? 
A) No, but if you solder by hand you must be very careful not to overheat the device."
3132,5471,"I wrote a stack for working with the w5500 it works on interrupts after I write in the data in TX buffer and send the send command  and the interrupt is triggered by the command that has begun, BUT if you read TX Free Size Register, I see that the data did not go yet, this is especially noticeable If you open a web page through the phone.

My stack works through wiznet events, and I cannot count registers without events. By this I did
resending the Send command if the TX buffer is not completely free, and according to the interupt of the Send I read the register value TX Free Size, I know that this is not quite the right way (what could be the mistakes?).
Is there any event to find out that the buffer is empty? [quote=""Maksim, post:1, topic:5471""]
BUT if you read TX Free Size Register, I see that the data did not go yet
[/quote]

That is surprise. Datasheet says:

>Sn_IR(SENDOK) Interrupt
>This is issued when SEND command **is completed**

Now question to WIZnet: what ""completed"" means here? I would consider it as packet was sent through the wire, and TX buffer freed. But I guess that depends on the protocol: for IPRAW and UDP that most probably is the case, but for TCP ""completed"" may mean that you have got remote ACK for the data sent, and data can be discarded as not needed any more.","Q) Is there any event to find out that the buffer is empty?
A) The ""completed"" status after the SEND command in WIZnet's W5500 chip refers to the successful transmission of the packet through the wire, indicating that the TX buffer has been freed. However, for TCP, ""completed"" might signify the reception of a remote ACK, suggesting that the data can be discarded."
3133,5476,"Hi,

What is the correct procedure to read back the DIPR address in Sn_DIPR register? When you read the DIPR register it always returns 0x00. We need to read the register for verification purposes.

Thank you. Hello,

Sn_DIPR register does not have the same write and read values.
In TCP communication, the address of destination is read, and udp communication does not guarantee the value.","Q) What is the correct procedure to read back the DIPR address in Sn_DIPR register? When you read the DIPR register it always returns 0x00. We need to read the register for verification purposes.
Thank you. 
A) Sn_DIPR register does not have the same write and read values. In TCP communication, the address of destination is read, and udp communication does not guarantee the value."
3134,548,"does it support promicious mode for use in network traffic monitoring device? Hi, 
All TCP/IP chips provided by WIZnet supports on promicious mode.(we call MACRAW mode).
In MACRAW mode socket, You can sniffer all the packet on ethernet. But, Notice that some packets are to be lost because SOCKET buffer size is not enough.

For more detail, refer to the related chip's datasheet.

Thanks. Hi Think01, 

W5500 support MACRAW mode. 
Raw packets can be [i]sniff[/i] in this mode.

Refer to MACRAW mode in datasheet and reference code as below, 

Driver Ethernet (Berkeley Socket type APIs)	 1.0.2 :
[url]http://wizwiki.net/wiki/doku.php?id=products:w5500:driver[/url]

In MACRAW mode, socket / sendto / recvfrom / close function are used. 
* Socket number '0' can be only open in MACRAW mode.
socket(0, Sn_MR_MACRAW, dummyport, 0)
sendto(0, buf, len, dummpyip, dummpyport)
recvfrom(0, buf, len, dummpyip, dummpyport)
close(0)

Thanks,","Q) Does it support promiscuous mode for use in network traffic monitoring device?
A) All TCP/IP chips provided by WIZnet supports promiscuous mode (MACRAW mode). In MACRAW mode socket, you can sniff all the packets on the ethernet. But, some packets may be lost due to the SOCKET buffer size not being enough. For more details, refer to the related chip's datasheet.

Q) Hi Think01, Does W5500 support MACRAW mode?
A) W5500 supports MACRAW mode. Raw packets can be sniffed in this mode. Refer to the MACRAW mode in the datasheet and reference code provided in the Driver Ethernet (Berkeley Socket type APIs) 1.0.2: [url]http://wizwiki.net/wiki/doku.php?id=products:w5500:driver[/url]. In MACRAW mode, the socket, sendto, recvfrom, and close functions are used. Socket number '0' can be only open in MACRAW mode. For example, socket(0, Sn_MR_MACRAW, dummyport, 0), sendto(0, buf, len, dummyip, dummyport), recvfrom(0, buf, len, dummyip, dummyport), and close(0)."
3135,5483,"I am using Wizfi310.

BAUD RATE 115200 is connected.

The AT command does not seem to be recognized when entering at AT.

When entering the AT command, it is loopback and output.

Version 1.0.3.2 is output when entering first, and the iPadDR, Gateway address output.

Do I have to update the firmware?Please check the version, and please reply to which part I need to check. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

Ã¬ÂµÂÃ¬Â´Â Ã¬Â§ÂÃ¬ÂÂ??IP. GW Ã¬Â£Â¼Ã¬ÂÂÃªÂ°? Ã¬Â¶ÂÃ«Â Â¥?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡?Ã«Â³Â´Ã¬ÂÂ, Ã«Â¶??ÂÃ¬ÂÂ Function GPIO???ÂÃ­ÂÂ´ AP Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡?Ã¬Â§ÂÃ¬ÂÂ??ÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡?Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ¤.
Function GPIOÃ«Â¥??ÂÃ¬ÂÂ¸??Ã¬Â£Â¼Ã¬ÂÂÃªÂ³?Factory Default Ã«Â¥?Ã¬Â§ÂÃ­ÂÂ?Â´Ã¬Â£Â¼?ÂÃ«Â©Â´ ?Â ÃªÂ²Â ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Factory default Ã«Â°Â©Ã«Â²Â?? ?ÂÃª?Ã¬Â§??ÂÃ«ÂÂ??

* AT Ã«ÂªÂÃ«Â Â¹?Â¼Ã«Â¡Â AT+MFDEF=FR ?ÂÃ«Â Â¥
https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310pg:start#at_mfdef

* Function GPIO 3??Toggle
https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310qsg:start#wizfi310_evaluation_board","Q) Do I have to update the firmware? Please check the version, and please reply to which part I need to check.
A) The AT command does not seem to be recognized when entering at AT. It is loopback and output. Version 1.0.3.2 is output when entering first, and the iPadDR, Gateway address output.

Function GPIO can be checked through the link provided: https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310qsg:start#wizfi310_evaluation_board"
3136,5487,"Hi,

we have made W5500 custom board and SPI works fine. But when I kept chip in listen mode and Ethernet cable is connected but Link LED not establishing. I even checked the Sn_SR Register and the response I got as chip is in Listen Mode.

Only two times I saw the Link LED was glowing and after that never glowed Link LED.

Is there any time delay required to establish Link LED?

Please help me! Post circuit diagram please. |Most probably you are having the issues with PHY circuitry, or with clock circuitry. Seems to be exact copy of reference schematic, except R2 which must not make a difference. Don't you accidentally have PHY disabled through PHYCFGR? Try playing with its contents to see if there's any change. I am always getting 10111010 response for PHYCFGR. That means it is configured correctly.

In circuit TX/RX resistor values are correct? I kept 33R instead of 0R. LSB of 0 suggests that there's really no physical link.

There were people changing 33 to 0, but if I recall properly it was not that bad as you describe. But anyway it is a good idea to change them to 0 (shorts) as a test. Also examine board with magnifier to ensure it has no assembly issues. Ok, Thank you will try that.","Q) Is there any time delay required to establish Link LED?
A) Most probably you are having the issues with PHY circuitry, or with clock circuitry. Seems to be exact copy of reference schematic, except R2 which must not make a difference. Don't you accidentally have PHY disabled through PHYCFGR?

Q) In circuit TX/RX resistor values are correct?
A) I am always getting 10111010 response for PHYCFGR. That means it is configured correctly.

Q) Please help me! Post circuit diagram please.
A) Try playing with its contents to see if there's any change.
"
3137,5488,"I understand the other ""temporary status"" values explained on page 51 of the datasheet, but not SOCK_CLOSING. What phase of the socket close process described at http://www.tcpipguide.com/free/t_TCPConnectionTermination-2.htm does this correspond to, if any?

If it doesn't map to this process, what does it mean and what needs to happen before the socket goes to SOCK_CLOSED? This status can occur after the close command 0x10 until the socket gets its final state 0x00 closed. (last step in your process)
In every case you should repeat the status request if you receive one of the temporary statuscodes until you receive a clear final state.
If you do new commands  before (e.g. disconnect and close without waiting to the end of the disconnect process) it may work but checking the connection with whireshark will show that there are problems. [quote=""oliver28, post:2, topic:5488""]
This status can occur after the close command 0x10 until the socket gets its final state 0x00 closed. (last step in your process)
[/quote]

I do not think so. 0x1A happens after DISCON command. CLOSE will immediately reset the socket and change its status to 0x00. For the benefit of future readers, I would expect the following sequence of values in a W5x00 Sn_SR after sending a DISCON command to a socket that is in the CLOSE_WAIT state (i.e., that has been half-closed by the remote peer):

1. CLOSE_WAIT (connection half-closed by remote peer indicating it's done with the socket)
2. LAST_ACK (W5x00 has sent ACK/FIN to remote peer indicating it's done with the socket too and waits for ACK from peer)
3. CLOSED (both ends agree socket is closed)

If the W5x00 is disconnecting an ESTABLISHED socket, on the other hand, I would expect this sequence of Sn_SR values:

1. ESTABLISHED
2. FIN_WAIT (FIN sent to peer; waiting for FIN/ACK response from peer)
3. TIME_WAIT (waiting for delayed packets from peer, if any, to arrive)
4. CLOSED (both ends agree socket is closed)

I don't include the ""CLOSING"" status in this sequence because I'm not sure where it goes. But I have a suspicion.

Most sources refer to FIN-WAIT-1 and FIN-WAIT-2 to distinguish between the time spent waiting for an ACK to the initial FIN and the time spent waiting for the (possibly later) arrival of a FIN from the other side. This looks like:

1. ESTABLISHED
2. FIN_WAIT_1 (FIN sent to peer; waiting for ACK response from peer)
3. FIN_WAIT_2 (ACK received from peer, waiting for FIN from peer)
4. TIME_WAIT (waiting for delayed packets from peer, if any, to arrive)
5. CLOSED (both ends agree socket is closed)

But the W5x00 doesn't identify FIN_WAIT_1 & FIN_WAIT_2 states, only FIN_WAIT.  This leads me to suspect that the ""CLOSING"" state is really FIN_WAIT_2, which would mean our Sn_SR would go through this sequence of values when a socket is disconnected:

1. ESTABLISHED
2. FIN_WAIT (FIN sent to peer; waiting for ACK response from peer)
3. CLOSING (ACK received from peer, waiting for FIN from peer)
4. TIME_WAIT (waiting for delayed packets from peer, if any, to arrive)
5. CLOSED (both ends agree socket is closed)

I was hoping someone from Wiznet could confirm this so I didn't have to do the experiment to find out if I'm right. Practically, while answer to the question would be interesting, not sure how it is useful. Application running on W5x00 in TCP mode socket should certainly care about three major states: 0x17 (ESTABLISHED), range of 0x18-0x1D and 0x00 (CLOSED) after establishing connection:

- if state is ESTABLISHED, then remote device may still has something to say;
- if state is not ESTABLISHED and not CLOSED (somewhere between 0x18 and 0x1D inclusive), then remote host finished with its communication, and, if W5x00 has nothing more to say, it should perform DISCON and then CLOSE;
- if state is CLOSED,, do nothing as socket is already closed, or perform explicit CLOSE just in case.

All intermediate states of 0x18-0x1D are just ""for your information"" on what is going on, and for troubleshooting purposes.

DISCON and CLOSE pair may be treated differently given the connection type: for server mode it is wise to perform DISCON and then immediately CLOSE, for client programmer may choose to wait after issuing DISCON to ensure server has confirmed closure of the connection and freed its sockets.

If, for some reason, process will get out of order (e.g. application re-sends FIN when it was already sent before), then the worst case it will get RST back. The main point of the connection termination is to ensure no network device is having socket hung, and thus resources consumed for more time than really needed. All valid comments. I'm improving an existing Arduino library for W5x00 chips that does some things with sockets that I don't think it should. As I fix these things, I want to make sure I completely understand what I'm doing. I sleep better when I understand everything (including what the CLOSING state means). I ran tests today and saw the following:

1. When the peer sends a FIN first, I see Sn_SR change to 0x1D (SOCK_LAST_ACK) before changing to 0x00 (SOCK_CLOSE). I see no intermediate values, though this could be a sampling rate problem.

2. When the W5x00 sends a FIN first, I see Sn_SR change to 0x18 (SOCK_FIN_WAIT) before changing to 0x1B (SOCK_TIME_WAIT) then 0x00 (SOCK_CLOSE). Sn_IR changes to 0x02 (DISCON) at about the same time. Despite running these tests many times, I never managed to capture Sn_SR with a value of 0x1A. Maybe if I run it from outside my LAN the delay will be long enough to capture it. Great information. Thanks!","Q) I understand the other ""temporary status"" values explained on page 51 of the datasheet, but not SOCK_CLOSING. What phase of the socket close process described at http://www.tcpipguide.com/free/t_TCPConnectionTermination-2.htm does this correspond to, if any? If it doesn't map to this process, what does it mean and what needs to happen before the socket goes to SOCK_CLOSED? This status can occur after the close command 0x10 until the socket gets its final state 0x00 closed. (last step in your process) In every case you should repeat the status request if you receive one of the temporary statuscodes until you receive a clear final state. If you do new commands  before (e.g. disconnect and close without waiting to the end of the disconnect process) it may work but checking the connection with wireshark will show that there are problems. [quote=""oliver28, post:2, topic:5488""]
This status can occur after the close command 0x10 until the socket gets its final state 0x00 closed. (last step in your process)
[/quote]
I do not think so. 0x1A happens after DISCON command. CLOSE will immediately reset the socket and change its status to 0x00. For the benefit of future readers, I would expect the following sequence of values in a W5x00 Sn_SR after sending a DISCON command to a socket that is in the CLOSE_WAIT state (i.e., that has been half-closed by the remote peer):
1. CLOSE_WAIT (connection half-closed by remote peer indicating it's done with the socket)
2. LAST_ACK (W5x00 has sent ACK/FIN to remote peer indicating it's done with the socket too and waits for ACK from peer)
3. CLOSED (both ends agree socket is closed)
If the W5x00 is disconnecting an ESTABLISHED socket, on the other hand, I would expect this sequence of Sn_SR values:
1. ESTABLISHED
2. FIN_WAIT (FIN sent to peer; waiting for FIN/ACK response from peer)
3. TIME_WAIT (waiting for delayed packets from peer, if any, to arrive)
4. CLOSED (both ends agree socket is closed)
I don't include the ""CLOSING"" status in this sequence because I'm not sure where it goes. But I have a suspicion.
Most sources refer to FIN-WAIT-1 and FIN-WAIT-2 to distinguish between the time spent waiting for an ACK to the initial FIN and the time spent waiting for the (possibly later) arrival of a FIN from the other side. This looks like:
1. ESTABLISHED
2. FIN_WAIT_1 (FIN sent to peer; waiting for ACK response from peer)
3. FIN_WAIT_2 (ACK received from peer, waiting for FIN from peer)
4. TIME_WAIT (waiting for delayed packets from peer, if any, to arrive)
5. CLOSED (both ends agree socket is closed)
But the W5x00 doesn't identify FIN_WAIT_1 & FIN_WAIT_2 states, only FIN_WAIT.  This leads me to suspect that the ""CLOSING"" state is really FIN_WAIT_2, which would mean our Sn_SR would go through this sequence of values when a socket is disconnected:
1. ESTABLISHED
2. FIN_WAIT (FIN sent to peer; waiting for ACK response from peer)
3. CLOSING (ACK received from peer, waiting for FIN from peer)
4. TIME_WAIT (waiting for delayed packets from peer, if any, to arrive)
5. CLOSED (both ends agree socket is closed)
I was hoping someone from Wiznet could confirm this so I didn't have to do the experiment to find out if I'm right. Practically, while answer to the question would be interesting, not sure how it is useful. Application running on W5x00 in TCP mode socket should certainly care about three major states: 0x17 (ESTABLISHED), range of 0x18-0x1D and 0x00 (CLOSED) after establishing connection:
- if state is ESTABLISHED, then remote device may still has something to say;
- if state is not ESTABLISHED and not CLOSED (somewhere between 0x18 and 0x1D inclusive), then remote host finished with its communication, and, if W5x00 has nothing more to say, it should perform DISCON and then CLOSE;
- if state is CLOSED,, do nothing as socket is already closed, or perform explicit CLOSE just in case.
All intermediate states of 0x18-0x1D are just ""for your information"" on what is going on, and for troubleshooting purposes.
DISCON and CLOSE pair may be treated differently given the connection type: for server mode it is wise to perform DISCON and then immediately CLOSE, for client programmer may choose to wait after issuing DISCON to ensure server has confirmed closure of the connection and freed its sockets.
If, for some reason, process will get out of order (e.g. application re-sends FIN when it was already sent before), then the worst case it will get RST back. The main point of the connection termination is to ensure no network device is having socket hung, and thus resources consumed for more time than really needed. All valid comments. I'm improving an existing Arduino library for W5x00 chips that does some things with sockets that I don't think it should. As I fix these things, I want to make sure I completely understand what I'm doing. I sleep better when I understand everything (including what the CLOSING state means). I ran tests today and saw the following:
1. When the peer sends a FIN first, I see Sn_SR change to 0x1D (SOCK_LAST_ACK) before changing to 0x00 (SOCK_CLOSE). I see no intermediate values, though this could be a sampling rate problem.
2. When the W5x00 sends a FIN first, I see Sn_SR change to 0x18 (SOCK_FIN_WAIT) before changing to 0x1B (SOCK_TIME_WAIT) then 0x00 (SOCK_CLOSE). Sn_IR changes to 0x02 (DISCON) at about the same time. Despite running these tests many times, I never managed to capture Sn_SR with a value of 0x1A. Maybe if I run it from outside my LAN the delay will be long enough to capture it. Great information. Thanks! 
A) I do not see any direct personal information in the provided text."
3138,5489,"Sometimes when connecting in client mode to a server using an open socket (Sn_SR = SOCK_INIT) the W5500 Sn_SR doesn't behave like I'd expect. After the CONNECT command is sent, the W5500 sets Sn_CR to zero, then I record the values of Sn_SR and Sn_IR at 5ms intervals while waiting for the connection to complete. Sn_SR remains SOCK_INIT (0x13) and Sn_IR = 0. Eventually Sn_SR goes to 0 and Sn_IR to 0x08, indicating a timeout.

Sometimes every Sn_SR sample is SOCK_SYNSENT (0x15) instead of SOCK_INIT. I'd tempted to tempted to label this a sample rate issue if it weren't so absolutely consistent in returning the same Sn_SR value every time when it behaves this way.

Neither case occurs frequently, but I'd like to understand what's happening and fix it in some more reasonable way than detecting the problem and trying again.

My processor platform is the Adafruit Metro M4, and my Ethernet shield is the red Wiznet W5500 shield. I'm using the Arduino Ethernet 2.0.0 library (https://github.com/arduino-libraries/Ethernet/releases/tag/2.0.0). Wireshark log is required to figure out what is going on.Timeout in this state means that W5500 did not receive SYN/ACK in time. Either remote device did not send it, or switch decided not to forward it to W5500. Or W5500 settings are invalid (GW address, MAC address). Even so, shouldn't Sn_SR change to SOCK_SYNSENT while waiting for the SYN/ACK instead of staying at SOCK_INIT?

I'm figuring out how to make a custom Kali Linux build so I can run WireShark on my ancient laptop since the  Windows XP SP3 I have loaded on it apparently blocks use of promiscuous mode. All I see is broadcast traffic using a SharkTap between the development system and router. [quote=""Mxyxixptlick, post:3, topic:5489""]
Even so, shouldn?Ât Sn_SR change to SOCK_SYNSENT while waiting for the SYN/ACK instead of staying at SOCK_INIT?
[/quote]

It suggests that there're also problems with ARP.

[quote=""Mxyxixptlick, post:3, topic:5489""]
I?Âm figuring out how to make a custom Kali Linux build so I can run WireShark on my ancient laptop
[/quote]

If you have any device running standard Linux or Windows with two wired network interfaces, setup this device in bridge mode and run Wireshark on it. You nailed it. I got WireShark running on Kali-Linux using a SharkTap and saw that the problem is due to the client's failure to respond to an ARP request.","Q) Sometimes when connecting in client mode to a server using an open socket (Sn_SR = SOCK_INIT) the W5500 Sn_SR doesn't behave like I'd expect. After the CONNECT command is sent, the W5500 sets Sn_CR to zero, then I record the values of Sn_SR and Sn_IR at 5ms intervals while waiting for the connection to complete. Sn_SR remains SOCK_INIT (0x13) and Sn_IR = 0. Eventually Sn_SR goes to 0 and Sn_IR to 0x08, indicating a timeout. Sometimes every Sn_SR sample is SOCK_SYNSENT (0x15) instead of SOCK_INIT. I'd tempted to tempted to label this a sample rate issue if it weren't so absolutely consistent in returning the same Sn_SR value every time when it behaves this way. Neither case occurs frequently, but I'd like to understand what's happening and fix it in some more reasonable way than detecting the problem and trying again. My processor platform is the Adafruit Metro M4, and my Ethernet shield is the red Wiznet W5500 shield. I'm using the Arduino Ethernet 2.0.0 library (https://github.com/arduino-libraries/Ethernet/releases/tag/2.0.0). Wireshark log is required to figure out what is going on. Timeout in this state means that W5500 did not receive SYN/ACK in time. Either remote device did not send it, or switch decided not to forward it to W5500. Or W5500 settings are invalid (GW address, MAC address). Even so, shouldn't Sn_SR change to SOCK_SYNSENT while waiting for the SYN/ACK instead of staying at SOCK_INIT? 

A) Wireshark log is required to figure out what is going on. Timeout in this state means that W5500 did not receive SYN/ACK in time. Either remote device did not send it, or switch decided not to forward it to W5500. Or W5500 settings are invalid (GW address, MAC address). Even so, shouldn't Sn_SR change to SOCK_SYNSENT while waiting for the SYN/ACK instead of staying at SOCK_INIT? 

Q) I'm figuring out how to make a custom Kali Linux build so I can run WireShark on my ancient laptop since the  Windows XP SP3 I have loaded on it apparently blocks use of promiscuous mode. All I see is broadcast traffic using a SharkTap between the development system and router. 

A) If you have any device running standard Linux or Windows with two wired network interfaces, setup this device in bridge mode and run Wireshark on it. You nailed it. I got WireShark running on Kali-Linux using a SharkTap and saw that the problem is due to the client's failure to respond to an ARP request."
3139,549,"Hello,
I'm looking for software informations on how to use the W3150A in DHCP mode.

Thanks for any information. Hi,
You can refer to W3100A+ (EVB-B1+) such like W3100A

You can download the firmware and documents from the tab [Downlaod] at
[url]http://www.wiznet.co.kr/sub_modules/en/product/Product_Detail.asp?cate1=5&cate2=7&cate3=27&pid=1077#tab[/url]

Thanks.","Q) I'm looking for software information on how to use the W3150A in DHCP mode. 
A) You can refer to W3100A+ (EVB-B1+) such as W3100A. You can download the firmware and documents from the tab ""Download"" at http://www.wiznet.co.kr/sub_modules/en/product/Product_Detail.asp?cate1=5&cate2=7&cate3=27&pid=1077#tab."
3140,5490,"The WIZ107SR receives ok.  It doesn't transmit because it is broadcasting ARP packets to get gateway address.  The network doesn't have or need a gateway.  I tried setting the gateway IP to 0.0.0.0 but the module still sends ARP packets to that address.  How to tell the module not look for a gateway? Maybe the Subnet Mask doesn't match. Try 255.255.0.0 or 255.255.255.0 (or 0.0.0.0) depending on your network setup. 
What are the settings for IP, Port and Subnet Mask on each module? Hi,
The remote host IP is 192.168.42.3.  The 107SR receives from the remote ok and should just reply.
The 107SR IP is 192.168.42.14.
subnet mask is 255.255.0.0.
107SR port is left at default 5000.
The gateway is 0.0.0.0.  There is no reason it should try to use a gateway.
When the 107SR receives a packet it sends out 6 ARP requests for the MAC address of
192.168.101.200.  It receives no answer and gives up.
I tried the subnet mask at 255.255.255.0 which makes no difference.
I will try subnet mask at 0.0.0.0 and report back if it works.
(I am using UDP mode.)
Best regards,
Fred Hi Fred,
also try setting the gateway address to something other than 0.0.0.0 (e.g. 192.168.42.250 - it doesn't need to actually exist in your network because it will not be used anyway).
Also check that both MAC addresses are not corrupted (FF:FF:FF:FF:FF:FF).
Regards,
Christian Hi Christian,
The MAC address is not corrupted.
I don't remember why I thought the gateway address was the problem.
The IP 192.168.101.200 I mentioned is the default remote IP (RH parameter).
It appears that the 107SR can receive from any host that has the correct MAC, IP and port but to send it uses the RH and RP parameters it already has.  So, to communicate with any arbitrary host the controller needs to go to command mode, read RH and RP of the packet that came in, write those back and then can send to that host.  Is this correct?
Best regards,
Fred Yes, in UDP-mode a receiving 107SR accepts data packets to the programmed port from any IP (and any port) - it does not check if the sender matches the programmed RH or RP. But the 107SR will send data to the programmed RH:RP only.
If your RH address is not fixed, you have to set and save it first by command mode (over serial or UDP). A reset is required for the new RH to take effect.
Since parameters are stored in the data flash memory of the W7100A, I think it would be good to only write to it only if needed, to minimize the count of writes.

In TCP-server-mode the module will only communicate with the exact client which connects to it (RH:RP is not needed) - maybe this is an option for you. Hi Christian,
Thanks for the help!
I think TCP server mode would be better than UDP for my application.
Best regards,
Fred","Q) What are the settings for IP, Port, and Subnet Mask on each module? 
A) The WIZ107SR IP is 192.168.42.14, subnet mask is 255.255.0.0, and the port is left at default 5000.

Q) How to tell the module not to look for a gateway? 
A) You can try setting the gateway IP to something other than 0.0.0.0 (e.g. 192.168.42.250 - it doesn't need to actually exist in your network because it will not be used anyway).

Q) Is this correct? The 107SR can receive from any host that has the correct MAC, IP, and port, but to send it uses the RH and RP parameters it already has. 
A) Yes, in UDP-mode, a receiving 107SR accepts data packets to the programmed port from any IP (and any port) - it does not check if the sender matches the programmed RH or RP. But the 107SR will send data to the programmed RH:RP only.

Q) Since parameters are stored in the data flash memory of the W7100A, is it better to write to it only if needed? 
A) Yes, it would be good to only write to it only if needed, to minimize the count of writes.

Q) Would TCP server mode be better than UDP for my application? 
A) Yes, TCP server mode would be better than UDP for your application."
3141,5492,"Hello to all!

Recently I started to implement IP conectivity to my Atmel's Xmega based project. Wiznet is my favorit IOP for many years and I have choosen W5500 chip. 
Now i got to a problem reading the phycfgr reg.
Right after init and if no further action, I can succesfully fead phycfgr and can correctly detect speed, duplex, link state.
But just after i open a tcp socket, reading phycfgr always return all zero. 
It is the same even if I just check for a socket status.
However my (Bascom) code does ok - I'm able to do tcp/ip communication well.

Thanks in advance for all your suggestions!
BR
Andrej Seems that your program reads Reg 0x2E from the socket base instead of the commnon registers (this will return 0x00 Fragment Offset IP Header 1 default). Check the BSB that is sent to the SPI when accessing the REG 0x2E from the socketregister (0x00 @ read or 0x04 @ write to the common registers) Hi!

Thanks to oliver28. 
I'll check, if this could be a reason for a wrong read.
Best regards
Andrej Hello to all!

I posted this issue to Bascom author, and he found and solved this problem. He sent me a new w5500 lib.
Thanks for help.
BR
Andrej","Q) Seems that your program reads Reg 0x2E from the socket base instead of the commnon registers (this will return 0x00 Fragment Offset IP Header 1 default). Check the BSB that is sent to the SPI when accessing the REG 0x2E from the socket register (0x00 @ read or 0x04 @ write to the common registers) Hi!
A) This appears to be a technical advice or suggestion to solve the issue with reading the phycfgr register after opening a tcp socket. It advises checking the BSB that is sent to the SPI when accessing the REG 0x2E from the socket register. 

Q) I posted this issue to Bascom author, and he found and solved this problem. He sent me a new w5500 lib.
Thanks for help.
BR
Andrej
A) This is an update where the individual has resolved the issue by reaching out to the Bascom author who provided a new w5500 library."
3142,5496,"Hello, 
i am using a WIZ550IO for communication.
E.g. SOCKET 7 configured as TCP Server, Keep Alive Timer set to 0x06 (30Sec)  (see Dump Data below), Port 6000.
I connect a client, pull off the network connector, wait a minute so that the client has no chance to disconnect, and reconnect the network cable.
The socket remains now in the connected state 0x17. 
I was of the opinion that now the WIZ module should determin the missing client by sending a keep alive packet and set the timeout INT (my application would initialize the socket after this)
But is does not. As well when i  set socket CMD 0x22 to send the KA packet i can see no activity (Whire shark)
The only way is to transmit at least one byte, then the WIZ module start the retrys and sets timeout after the period set.
See the register setting of the module common and socket common below.
Anything missing or wrong ?
Thx in advance for helpful input.

Module common settings
DUMP BSB:0
Address:0000
Addr.	Value	Descr.
0x0000	0x00	MODE
0x0001	0x0A	Gateway ADR0
0x0002	0x00	Gateway ADR1
0x0003	0x00	Gateway ADR2
0x0004	0x8A	Gateway ADR3
0x0005	0xFF	Subnet 0
0x0006	0xFF	Subnet 1
0x0007	0xFF	Subnet 2
0x0008	0x00	Subnet 3
0x0009	0x00	MAC 0
0x000A	0x08	MAC 1
0x000B	0xDC	MAC 2
0x000C	0x54	MAC 3
0x000D	0x35	MAC 4
0x000E	0x40	MAC 5
0x000F	0x0A	IPADR 0
0x0010	0x00	IPADR 1
0x0011	0x00	IPADR 2
0x0012	0x32	IPADR 3
0x0013	0xF0	INT TMR0
0x0014	0xF0	INT TMR1
0x0015	0x00	INTERRUPT
0x0016	0x00	INTMASK
0x0017	0x00	SOCKET INTERRUPT
0x0018	0xFF	SOCKET I MASK
0x0019	0xF0	RETRYTIME0
0x001A	0xF0	RETRYTIME1
0x001B	0x08	RETRY COUNT
0x001C	0x28	LCP REQUEST TMR
0x001D	0x00	LCP MAGIC NR
0x001E	0x00	PPP DEST MAC 0
0x001F	0x00	PPP DEST MAC1
0x0020	0x00	PPP DEST MAC2
0x0021	0x00	PPP DEST MAC3
0x0022	0x00	PPP DEST MAC 4
0x0023	0x00	PPP DEST MAC 5
0x0024	0x00	PPP Session ID0
0x0025	0x00	PPP Session ID1
0x0026	0xFF	PPP Max SEGSize 0
0x0027	0xFF	PPP Max SEGSize 1
0x0028	0x00	UnreachIP0
0x0029	0x00	UnreachIP1
0x002A	0x00	UnreachIP2
0x002B	0x00	UnreachIP3
0x002C	0x00	UnreachPORT0
0x002D	0x00	UnreachPORT1
0x002E	0xBF	PHY Config
0x002F	0x00	
0x0030	0x00	
0x0031	0x00	
0x0032	0x00	
0x0033	0x00	
0x0034	0x00	
0x0035	0x00	
0x0036	0x00	
0x0037	0x78	
0x0038	0x25	
0x0039	0x04	Version NR

Socket base settings
DUMP BSB:25
Address:0000
Addr.	Value	Descr.
0x0000	0x21	MODE
0x0001	0x00	SOCKET COMMAND
0x0002	0x00	SOCKET INTERRUPT
0x0003	0x17	SOCKET STATUS
0x0004	0x17	PORT 0
0x0005	0x70	PORT 1
0x0006	0x70	DEST MAC 0
0x0007	0x4D	DEST MAC 1
0x0008	0x7B	DEST MAC 2
0x0009	0x87	DEST MAC 3
0x000A	0x6F	DEST MAC 4
0x000B	0x88	DEST MAC 5
0x000C	0x0A	DEST IP ADR 0
0x000D	0x00	DEST IP ADR 1
0x000E	0x00	DEST IP ADR 2
0x000F	0x04	DEST IP ADR 3
0x0010	0xCC	TCPserver PORT 0
0x0011	0xE9	TCPserver PORT 1
0x0012	0x05	MAX SEG Size 0
0x0013	0xB4	MAX SEG Size 1
0x0014	0x00	
0x0015	0x00	SOCKET IP TOS
0x0016	0x80	SOCKET IP TTL
0x0017	0x00	
0x0018	0x00	
0x0019	0x00	
0x001A	0x00	
0x001B	0x00	
0x001C	0x00	
0x001D	0x00	
0x001E	0x02	RX BUFF Size
0x001F	0x02	TX BUFF Size
0x0020	0x08	TX free Size 0
0x0021	0x00	TX free Size 1
0x0022	0x69	TX read PTR 0
0x0023	0x12	TX read PTR 1
0x0024	0x69	TX write PTR 0
0x0025	0x12	TX write PTR 1
0x0026	0x00	Received Size 0
0x0027	0x00	Received Size1
0x0028	0x00	RX Read Pointer 0
0x0029	0x42	RX Read Pointer 1
0x002A	0x00	RX Write Pointer 0
0x002B	0x42	RX Write Pointer 1
0x002C	0x1F	Interrupt MASK
0x002D	0x00	Fragment Offset IP Header 0
0x002E	0x00	Fragment Offset IP Header 1
0x002F	0x06	Keep Alive Timer
0x0030	0x01 [quote=""oliver28, post:1, topic:5496""]
Anything missing or wrong ?
[/quote]

No, everything is correct.

[quote=""oliver28, post:1, topic:5496""]
The socket remains now in the connected state 0x17.
[/quote]

Server waits for incoming packets, and it will be waiting forever until it will receive something - FIN, RST, or data.

[quote=""oliver28, post:1, topic:5496""]
by sending a keep alive packet
[/quote]

You do it manually (0x22), or use keep-alive timer.

[quote=""oliver28, post:1, topic:5496""]
The only way is to transmit at least one byte, then the WIZ module start the retrys and sets timeout after the period set.
[/quote]

Datasheet says:

>KA packet is transmittable after Sn_SR is changed to SOCK_ESTABLISHED and **after the data is transmitted or received to/from a peer at least once**.

There will be no keep-alive (neither 0x22 nor automatic using timer) if there was no prior communication. Thank you for the information.
In fact the TCP server starts sending KEEP ALIVE packets first when a TX packet was transferred by the TCP Server.
RX packets witout response by the server will not start the KA process. (even if KA timer is set or CMD 0x22 is written to the Command Reg.)

I will resolve the detection of those dead connections in an other way. (no activity, after a defined timeout , send 1 Byte TX, this should start the KA process)","Q) Anything missing or wrong?
A) No, everything is correct.

Q) The socket remains now in the connected state 0x17.
A) Server waits for incoming packets, and it will be waiting forever until it will receive something - FIN, RST, or data.

Q) by sending a keep alive packet
A) You do it manually (0x22), or use keep-alive timer."
3143,5497,"I just got my Wiz812MJ ver 1.1.

The module get hot as soon as I connect SCS from my microcontroller.
If the module is just powered, it is warm.

I connected a second unit. It gets very hot just powering it.

Is there a mistake it the 812MJ datasheet pinout ?
Thanks.
Giri [quote=""grama, post:1, topic:5497""]
Is there a mistake it the 812MJ datasheet pinout ?
[/quote]

Maybe you did a mistake in connecting it? How do you do it?

[quote=""grama, post:1, topic:5497""]
I just got my Wiz812MJ ver 1.1.
[/quote]

Where do these modules come from? May it happen that they are defective?

[quote=""grama, post:1, topic:5497""]
If the module is just powered, it is warm.
[/quote]

W5x00 chips become warm when PHY is connected. Not hot, but warm.

[quote=""grama, post:1, topic:5497""]
The module get hot as soon as I connect SCS from my microcontroller.
[/quote]

Do the modules function from any side - MCU or Ethernet? Appreciate your response.

That is very possible.

With the RJ45 facing away from me, I expecting J1 on the left, and J2 on the right.

From your answer, I am assuming your Wi812Mj is not getting hot. [quote=""grama, post:3, topic:5497""]
I am assuming your Wi812Mj is not getting hot.
[/quote]

I do not have this module, but I use W5100 heavily. I am sure your module is designed using standard circuit. Eugeny

I got a couple of Wiz810sio modules.

These don?Ât get hot, and am able to talk over SPI to it.

When I write the MAC address Byte 1 is the same as Byte 2. Is there something special I have to do to write MAC address?

Thanks Seems this module is broken then. If you put it into the same conditions as other modules and use the same software, and it behaves differently.

[quote=""grama, post:5, topic:5497""]
When I write the MAC address Byte 1 is the same as Byte 2.
[/quote]

I do not think it is any issue with circuit as it could be if you use parallel access to the chip. You use SPI, and it sounds like chip is having problems. Anyway, the obvious things to check with the board are: (1) physical inspection if nothing is damaged or shorted; (2) power measurement before and after the regulator. I am afraid there's not much more you can do... (considering you really put it into the same conditions as other modules!) You are right. Learning the nuance of a new chip is always interesting.

Thanks.

giri","Q) Is there a mistake it the 812MJ datasheet pinout?
A) W5x00 chips become warm when PHY is connected. Not hot, but warm. 

Q) If the module is just powered, it is warm.
A) That is very possible.

Q) The module get hot as soon as I connect SCS from my microcontroller.
A) Do the modules function from any side - MCU or Ethernet? Appreciate your response.

Q) When I write the MAC address Byte 1 is the same as Byte 2.
A) I do not think it is any issue with the circuit as it could be if you use parallel access to the chip. You use SPI, and it sounds like the chip is having problems. Anyway, the obvious things to check with the board are: (1) physical inspection if nothing is damaged or shorted; (2) power measurement before and after the regulator. I am afraid there's not much more you can do... (considering you really put it into the same conditions as other modules!) You are right. Learning the nuance of a new chip is always interesting."
3144,550,"W5100 user.
Normally, if the server (MCU) and the client (PC GUI) connect the LAN cable and draw a LAN cable during communication.
It seems to miss the socket on the server side.
Listen is maintained on the server side when confirming with debugger.

After 10 seconds Out after the cable opening, no matter how much you run the client, you can't connect
However, if you reset the server, it becomes a normal connection.The meaning of the reset here means that you can listen by re -setting IP, Mac, etc.

If you artificially generate FAIL by opening a cable during communication, something on the server side after a certain time (about 10 seconds)
I think it is.

I would like to ask if the app should be supplemented. Port number must be randomly created when opening the client socket.
If you set it to a fixed value, the server side may not be able to properly connect by recognizing it as a recycling with the previous SOCKET.
Please check this part. [Quote = ""MIDNIGHTCOW""] When opening the client socket, the port number must be created randomly.
If you set it to a fixed value, the server side may not be able to properly connect by recognizing it as a recycling with the previous SOCKET.
Please check this part. [/Quote]

The random port doesn't make sense .. The server side is fixed to port 5000, but if the client sets the port randomly, the connection is connected.
Can't you?
If you implement it like the answer, you can delete the session on the server side when the abnormal client ends. Client socket??port numberÃ«Â¥??ÂÃ«ÂÂ¤???Â´Ã«ÂÂ ?Â°ÃªÂ²Â°???ÂÃ«ÂÂÃªÂ²ÂÃ¬? 
TCP??3way handshake?? ?Â°Ãª??Â©Ã«ÂÂ??
 - Client?ÂÃ¬ÂÂ ServerÃ«Â¡??ÂÃ¬ÂÂ???ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´?ÂÃ«ÂÂ 3way handshakeÃªÂ°? ?ÂÃ«Â£Â?ÂÃ¬ÂÂ´???Â©Ã«ÂÂ??
    - Client?ÂÃ¬ÂÂ ServerÃ«Â¡?SYN Packet??Ã«Â³Â´Ã«ÂÂ¼??random portnumber??ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ¡?ÂÃªÂ¸Â° ?ÂÃ«Â¬Â¸??
      3way handshakeÃªÂ°? ?ÂÃ«Â£Â?ÂÃ¬ÂÂ?Â¤Ã«Â©Â´ ?Â°ÃªÂ²Â°?ÂÃ«ÂÂ?Â°Ã¬ÂÂ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
ÃªÂ·Â¸Ã«ÂÂ¬Ã«Â¯?Ã«Â¡?Client???Â¬Ã­ÂÂ¸??random portÃ«Â¡??ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ´ Ã«Â§ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. As Ekkim said.Theoretical explanation seems to be enough.
To explain more,
The client already knows the server port number, and the sever can know when the client uses the access request (SYN) Accept.

Therefore, the client uses a random port unless it is a special case.","Q) Would the app need to be supplemented if the port number must be randomly created when opening the client socket? 
A) The server side may not be able to properly connect if the client sets the port to a fixed value, as it may recognize it as a recycling with the previous SOCKET. When opening the client socket, the port number should be created randomly to ensure proper connection.

Q) Can the server side connect if the client sets the port randomly while the server side is fixed to port 5000? 
A) Yes, the server can still connect even if the client sets the port randomly.

Q) What is the significance of using a random port for the client socket? 
A) The random port for the client socket allows for better management of sessions on the server side, especially when abnormal client connections occur.

Q) Could you explain the TCP 3-way handshake and its relevance to port numbers? 
A) In the TCP 3-way handshake, when the Client sends a SYN packet to the Server with a random port number, the server accepts and completes the handshake process regardless of the port number used by the client, as long as it is not a special case. This allows for successful connection establishment."
3145,5500,"Hi,

I have configured the W5500 chip in TCP server mode and Receiving and Transmission is working fine.

But after some time while transmitting the Sn_IR becomes Socket Busy. The response I am getting for Sn_IR is 0x01 instead of 0x11.

Please help me! [quote=""Century, post:1, topic:5500""]
Sn_IR becomes Socket Busy
[/quote]

There's no such state for the socket.

[quote=""Century, post:1, topic:5500""]
The response I am getting for Sn_IR is 0x01 instead of 0x11.
[/quote]

Bit 4 set means SEND_OK.

>Sn_IR(SENDOK) Interrupt
This is issued when SEND command is completed.

If this bit is reset, then either respective bit is not set in Sn_IMR, or there were no completed SEND command, or this bit was cleared by the user code. If SEND_OK command is reset, I am making it set and transmitting again.
But sometimes I am getting Sn_SR command 0x1E or 0x2E, after that it goes to close state and again I am calling Initialization of W5500 chip.

What could be the problem? [quote=""Century, post:3, topic:5500""]
If SEND_OK command is reset
[/quote]

SEND_OK is not a command, it is flag in Sn_IR register.

[quote=""Century, post:3, topic:5500""]
I am making it set and transmitting again.
[/quote]

How you do it? You mean in Sn_IMR register?

[quote=""Century, post:3, topic:5500""]
But sometimes I am getting Sn_SR command 0x1E or 0x2E
[/quote]

Sounds like invalid states. Are you sure SPI communication is reliable? [quote=""Eugeny, post:4, topic:5500""]
> I am making it set and transmitting again.

How you do it? You mean in Sn_IMR register?
[/quote]

I making as follows if I got wrong response
 setSn_CR(sn,Sn_CR_SEND);         // sn = Socket Number = 0, Sn_CR_SEND = 0x10
/* wait to process the command... */
 while(getSn_CR(sn));

[quote=""Eugeny, post:4, topic:5500""]
Are you sure SPI communication is reliable?
[/quote]
As of now I thought it is working properly, But is it require some delay between executing commands?

[quote=""Eugeny, post:4, topic:5500""]
SEND_OK is not a command
[/quote]
Sorry for that wrong statement. [quote=""Century, post:5, topic:5500""]
I making as follows if I got wrong response
[/quote]

What wrong response you are talking about?

[quote=""Century, post:5, topic:5500""]
// sn = Socket Number = 0, Sn_CR_SEND = 0x10
[/quote]

SEND command is code 0x20. Code 0x10 is to close socket! I am calling this function every one sec.
This library is downloaded from the github.

int32_t send(uint8_t sn, uint8_t * buf, uint16_t len)
{
   uint8_t tmp=0;
   uint16_t freesize=0;
   
   CHECK_SOCKNUM();
   CHECK_SOCKMODE(Sn_MR_TCP);
   CHECK_SOCKDATA();
   tmp = getSn_SR(sn);
   if(tmp != SOCK_ESTABLISHED && tmp != SOCK_CLOSE_WAIT) return SOCKERR_SOCKSTATUS;
   if( sock_is_sending & (1<<sn) )
   {

`**> tmp = getSn_IR(sn);**`
Sometimes I am getting wrong response

_NOP() ;
      _NOP() ;

      if(tmp & Sn_IR_SENDOK)
      {

         setSn_IR(sn, Sn_IR_SENDOK);
         _NOP() ;
         _NOP() ;

         sock_is_sending &= ~(1<<sn);         
      }
      else if(tmp & Sn_IR_TIMEOUT)
      {
//         close(sn);
         return SOCKERR_TIMEOUT;
      }
      else
   	  {
    	  setSn_IR(sn, Sn_IR_SENDOK);
		  _NOP() ;
		  _NOP() ;

    	  return SOCK_BUSY;
   	  }
   }
   freesize = getSn_TxMAX(sn);
   if (len > freesize) len = freesize; // check size not to exceed MAX size.
   while(1)
   {
      freesize = getSn_TX_FSR(sn);
      _NOP() ;
      _NOP() ;
      tmp = getSn_SR(sn);
      if ((tmp != SOCK_ESTABLISHED) && (tmp != SOCK_CLOSE_WAIT))
      {
//         close(sn);
         return SOCKERR_SOCKSTATUS;
      }
      if( (sock_io_mode & (1<<sn)) && (len > freesize) ) return SOCK_BUSY;
      if(len <= freesize) break;
   }
   wiz_send_data(sn, buf, len);
   _NOP() ;
   _NOP() ;
   setSn_CR(sn,Sn_CR_SEND);
   /* wait to process the command... */
   while(getSn_CR(sn));
   sock_is_sending |= (1 << sn);
   //M20150409 : Explicit Type Casting
   //return len;
   return (int32_t)len;
}

[quote=""Eugeny, post:6, topic:5500""]
SEND command is code 0x20. Code 0x10 is to close socket!
[/quote]
Actually this function I am calling. 
 setSn_IR(sn, Sn_IR_SENDOK); [quote=""Century, post:7, topic:5500""]
**&gt; tmp = getSn_IR(sn);**
Sometimes I am getting wrong response
[/quote]

What is wrong with this command's response? As I said I am getting 0x0E, 0x1E, 0x2E.

I am expecting 0x11 response.

Can you please guide me which software is good for TCP/IP communication testing. [quote=""Century, post:9, topic:5500""]
As I said I am getting 0x0E, 0x1E, 0x2E.
[/quote]

For Sn_IR? 

[quote=""Century, post:3, topic:5500""]
But sometimes I am getting Sn_SR command 0x1E or 0x2E
[/quote]

Or for Sn_SR?

Please do not confuse the things because if you describe your issue improperly it will be close to impossible to help you.

If 0x2E is about Sn_IR, can you figur eout what have happened using datasheet page 49?

[quote=""Century, post:9, topic:5500""]
I am expecting 0x11 response.
[/quote]

Why? Why do you think there could be no other response than this? Do you actually reset the flags? [quote=""Eugeny, post:10, topic:5500""]
For Sn_IR?
[/quote]

Sorry for wrong direction, The response I am getting for Sn_IR.

[quote=""Eugeny, post:10, topic:5500""]
Do you actually reset the flags?
[/quote]
Yes, Because the data is transmitting properly about 40 sec, sometimes about 10 sec.

But most of the time 0x01 response I will get for Sn_IR, Actually I am again setting the SEND_OK flag, but after if I read it will be 0x01. [quote=""Century, post:11, topic:5500""]
I am again setting the SEND_OK flag
[/quote]

How do you ""set"" this flag (did I ask this question before?...) [quote=""Eugeny, post:2, topic:5500""]
If this bit is reset, then either respective bit is not set in Sn_IMR, or there were no completed SEND command, or this bit was cleared by the user code.
[/quote]

This thread, May be I thought wrong, I think the best at this point for you is to read datasheet regarding the information on IR/IMR and Sn_IR/Sn_IMR flags and ask exact questions on things you do not understand. So far sounds you have some idea of how it may work, but it seems it does not... You wrote: ""But is it require some delay between executing commands?""

Yes, it does. After sending a command you should first wait for Sn_CR to be set to zero, then check Sn_SR for the status code(s) that may result from that command (e.g., for a ""CLOSE"" command you'd expect Sn_SR to change to SOCK_CLOSED). See page 47  of the datasheet, which says (in part):

""**Sn_CR (Socket n Command Register) [R/W] [0x0001] [0x00]**
This is used to set the command for Socket n such as OPEN, CLOSE, CONNECT,
LISTEN, SEND, and RECEIVE. After W5500 accepts the command, the Sn_CR register is
automatically cleared to 0x00. Even though Sn_CR is cleared to 0x00, the command
is still being processed. To check whether the command is completed or not, please
check the Sn_IR or Sn_SR.""

In addition, I've found that when running with a Cortex-M4 MCU at 120 MHz I need to insert delays in loops in which I'm polling the status register. Failing to do so seems to be especially harmful when sending a CONNECT or DISCON command, both of which require a handshake with a network peer. I suspect that polling too frequently interferes with the W5500's ability to monitor the network.","Q) But after some time while transmitting the Sn_IR becomes Socket Busy. The response I am getting for Sn_IR is 0x01 instead of 0x11. Please help me! What could be the problem?
A) Bit 4 set means SEND_OK. If this bit is reset, then either respective bit is not set in Sn_IMR, or there were no completed SEND command, or this bit was cleared by the user code. If SEND_OK command is reset, I am making it set and transmitting again. But sometimes I am getting Sn_SR command 0x1E or 0x2E, after that it goes to close state and again I am calling Initialization of W5500 chip.

Q) How you do it? You mean in Sn_IMR register?
A) I making as follows if I got wrong response setSn_CR(sn,Sn_CR_SEND); // sn = Socket Number = 0, Sn_CR_SEND = 0x10 

Q) Sounds like invalid states. Are you sure SPI communication is reliable?
A) As of now I thought it is working properly, But is it require some delay between executing commands? 

Q) What wrong response you are talking about?
A) What wrong response you are talking about?

Q) What is wrong with this command's response? As I said I am getting 0x0E, 0x1E, 0x2E. I am expecting 0x11 response.
A) Why? Why do you think there could be no other response than this? Do you actually reset the flags?

Q) For Sn_IR?
A) Sorry for wrong direction, The response I am getting for Sn_IR.

Q) Do you actually reset the flags? 
A) Yes, Because the data is transmitting properly about 40 sec, sometimes about 10 sec. But most of the time 0x01 response I will get for Sn_IR, Actually I am again setting the SEND_OK flag, but after if I read it will be 0x01.

Q) How do you ""set"" this flag (did I ask this question before?...)
A) This thread, May be I thought wrong, I think the best at this point for you is to read datasheet regarding the information on IR/IMR and Sn_IR/Sn_IMR flags and ask exact questions on things you do not understand.

Q) This thread, May be I thought wrong, I think the best at this point for you is to read datasheet regarding the information on IR/IMR and Sn_IR/Sn_IMR flags and ask exact questions on things you do not understand. So far sounds you have some idea of how it may work, but it seems it does not... You wrote: ""But is it require some delay between executing commands?""
A) Yes, it does. After sending a command you should first wait for Sn_CR to be set to zero, then check Sn_SR for the status code(s) that may result from that command (e.g., for a ""CLOSE"" command you'd expect Sn_SR to change to SOCK_CLOSED). See page 47 of the datasheet. In addition, I've found that when running with a Cortex-M4 MCU at 120 MHz I need to insert delays in loops in which I'm polling the status register. Failing to do so seems to be especially harmful when sending a CONNECT or DISCON command, both of which require a handshake with a network peer. I suspect that polling too frequently interferes with the W5500's ability to monitor the network."
3146,5505,"Hi~
What is the BIT16EN pin set to?
 and could you please tell me the used interface?(For example,  use the indirect bus)
What do you show when you read the S0_TTLR?
If you don't write S0_TTLR, you can read 0x80.

thanks,
best regards,
irina Dear Irina!
Thank you for your replay and support!
I used direct bus and set BIT16EN pin to HIGH level
Also I read 0x80 from S0_MR
Now I have problems with initialization of UDP mode
But I can ping the device
I do the following:
1) nRESET pin hold in low 10
2) After nRESET release(going to HIGH) wait 10 ms
3) Write to S0_CR    (address 0x202)    = 0x0010    ;
4) Write to MR        (address 0x000)    = 0x0000    ;
5) Write to IMR        (address 0x004)     = 0x70FE    ;
6) Write to SHAR    (address 0x008)     = 0x0008        ;
7) Write to SHAR2    (address 0x00A)     = 0xDC01    ;
8) Write to SHAR4    (address 0x00C)     = 0x0203    ;
9) Write to GAR        (address 0x010)     = 0xA9FE    ;
10) Write to GAR2    (address 0x012)     = 0x0001    ;
11) Write to SUBR    (address 0x014)     = 0xFFFF    ;
12) Write to SUBR2    (address 0x016)     = 0x0000    ;
13) Write to SIPR    (address 0x018)     = 0xA9FE    ;
14) Write to SIPR2    (address 0x01A)     = 0x0003    ;
15) Write to RTR    (address 0x01C)    = 0x0FA0        ;
16) Write to RCR    (address 0x01E)    = 0x0007        ;
17) Write to MTYPER    (address 0x30)    = 0x00FF    ;
18) Write to TMS01R    (address 0x20)    = 0x400    ;
19) Write to RMS01R    (address 0x028)    = 0x0C00    ;
20) Write to S0_IMR    (address 0x204)    = 0x0011    ;
21) Write to S0_DIP    (address 0x214)    = 0xA9FE    ;
22) Write to S0_DIP2    (address 0x216)    = 0xD955    ;
23) Write to S0_DPORTR(address 0x212)    = 0x1388    ;
24) Write to S0_MR    (address 0x200)    = 0x0002    ;
25) Write to S0_PORTR    (address 0x20A)    = 0x1388    ;
26) Write to S0_CR    (address 0x202)     = 0x0001    ;

After that I just read S0_SSR (adress 0x208) on cycle and check its value on 0x0022
CS High level time is 210 ns during write and cyclic read

But INT value always on High level
And S0_SSR always 0x0001 - ARP

I checked that after writing to S0_CR, S0_CR cleared

Please help Unfortunally, the situation is still the same [quote=""Addi, post:1, topic:5505""]
Please someboby help!
I suppose that the problem in my addressation
[/quote]

Hi~ 
Could you please try to test the next operation?

Write to S0_CR(address 0x202) == 0x0001(Socket open operation as UDP)   -> S0_SSR: SOCK_UDP
Read to S0_CR(address 0x202) -> 0x0000
Write to S0_CR(address 0x202) == 0x0020(Send operation) 
-> You can see the ARP request via wireshark program. And when completing the SEND process, S0_IR (SENDOK) becomes '1'. 
After checking S0_IR(SENDOK) = '1', the host can give SEND command to the next data.

thanks
best regards,
irina Yet another problem(

But the previous was done successfully , thanks to Irina

Now Ive noticed that I can not send more then one byte

The flow the same, except I send sequentually  Word by Word to Tx_Fifo the data(92 Words).

Wireshark shows that UDP sending is absent, but when I store one Word to Fifo, It shows UDP sending with one sent Word and another more, wich I havent send
Please, help

Thanks in advance Hi~ Addi

Sorry, for the late reply to your question.
You need to confirm the sending size or the socket buffer size when Socket init operate.

thanks,
BR
irina Dear Irina!

Thank you for your replay!

Did you ment that TMSR and Sn_TX_WRSR must have the same values?

Now I write to TMSR 0x4000, to S0_TX_WRSR 0x00FF but futher before sending the data I read

FSR and it has status is not free

Now I cant send that I want to, even 15 words [quote=""Addi, post:11, topic:5505""]
problem(

But the previous was done successfully , thanks to Irina

Now Ive noticed that I can not send more then one byte

The flow the same, except I send sequentually Word by Word to Tx_Fifo the data(92 Words).

Wireshark shows that UDP sending is absent, but when I store one Word to Fifo, It shows UDP sending with one sent Word and another more, wich I havent se
[/quote]
Hi~ Addi

You means,
TX fifo size of Socket 0 is 64Kbytes, Tx_RSR  size of Socket 0 is 255byte, is it right?
Could you tell me the S0_TX_FSR value?
It sets IP address and port number of the peer, saves the transmitting data in the internal
TX memory through Sn_TX_FIFOR, and tries to transmit the data to the peer. 

thanks,
BR
irina Dear Irina!

Thanks for your support!

I use direct bus and BIT16EN =1, also i can write to S0_TTLR, and can read what ive wtitten to.

And I write to S0_TTLR before open command

But the situation is still the same (..., free size reg shows not free Dear Irina!

Declaring my proble more fully!

Im doing the folowing:
1) nRESET pin hold in low 10
2) After nRESET release(going to HIGH) wait 10 ms
4) Write to MR        (address 0x000)    = 0x0000    ;
5) Write to IMR        (address 0x004)     = 0x70FF    ;
6) Write to SHAR        (address 0x008)     = 0x0008    ;
7) Write to SHAR2    (address 0x00A)     = 0xDC01    ;
8) Write to SHAR4    (address 0x00C)     = 0x0203    ;
9) Write to GAR        (address 0x010)     = 0xA9FE    ;
10) Write to GAR2    (address 0x012)     = 0x0001    ;
11) Write to SUBR    (address 0x014)     = 0xFFFF    ;
12) Write to SUBR2    (address 0x016)     = 0x0000    ;
13) Write to SIPR    (address 0x018)     = 0xA9FE    ;
14) Write to SIPR2    (address 0x01A)     = 0x0003    ;
15) Write to RTR        (address 0x01C)    = 0x0FA0    ;
16) Write to RCR        (address 0x01E)    = 0x0007    ;
17) Write to MTYPER    (address 0x030)    = 0x01FF    ;
18) Write to TMS01R    (address 0x020)    = 0x4000    ;
19) Write to TMS23R    (address 0x022)    = 0x0000    ;
20) Write to TMS45R    (address 0x024)    = 0x0000    ;
21) Write to TMS67R    (address 0x026)    = 0x0000    ;
22) Write to RMS01R    (address 0x028)    = 0x0800    ;
23) Write to RMS23R    (address 0x02A)    = 0x0000    ;
24) Write to RMS45R    (address 0x02C)    = 0x0000    ;
25) Write to RMS67R    (address 0x02E)    = 0x0000    ;
26) Write to S0_IMR    (address 0x204)    = 0x001C    ;
27) Write to S0_DIP    (address 0x214)    = 0xA9FE    ;
28) Write to S0_DIP2    (address 0x216)    = 0xD955    ;
29) Write to S0_DPORTR(address 0x212)    = 0x1388    ;
30) Write to S0_MR    (address 0x200)    = 0x0002    ;
31) Write to S0_PORTR    (address 0x20A)    = 0x1388    ;
32) Write to S0_TTLR    (address 0x21E) = 0x0080    ;
33) Read S0_TTLR (address 0x21E) = 0x0080;

34) Write to S0_CR    (address 0x202)     = 0x0001    ;
35) Read S0_TX_FSR2 (address 0x226) and check on value more than 192 bytes
If true
Write to FIFO 96 words and after that write to WRSR registes 192
and after that write SEND command
else
Read S0_TX_FSR2 (address 0x226) and check on value more than 192 bytes again until true will reached Hi~ addi

I will check the you use command for W5300.
I'll let you know as soon as possible.

thanks,
BR
irina Dear Irina!
Maybe you know worked algorithm of UDP data sending?
Thanks in advance Hi Addi

After you send the data, could you check the Sn_IR(SENDOK) is '0'?
And the host can't write data through S0_TX_FIFOR as the size bigger than S0_TX_FSR.

thanks,
BR
irina Dear Irina!

Thank you!

I didnt understand what data FSR register shows

As I understand by default 0x00 and after writing to FIFO 1 byte it shows 1

Doesnt it?

And before next writing I must to wait 0 in FSR which will declare what 1 byte is sent","Q) What is the BIT16EN pin set to? and could you please tell me the used interface?
Q) What do you show when you read the S0_TTLR?
Q) Could you please try to test the next operation?
Q) Now I write to TMSR 0x4000, to S0_TX_WRSR 0x00FF but further before sending the data I read FSR and it has the status is not free.
Q) Declaring my problem more fully! Im doing the following:
Q) Maybe you know the worked algorithm of UDP data sending?
A) Dear Irina! Thank you for your replay and support! I used the direct bus and set the BIT16EN pin to the HIGH level. Also, I read 0x80 from S0_MR. Now I have problems with the initialization of UDP mode. But I can ping the device. After that, I just read S0_SSR (address 0x208) on the cycle and check its value on 0x0022. But the INT value always on the High level and S0_SSR always 0x0001 - ARP. Please help! Unfortunately, the situation is still the same. But the previous was done successfully, thanks to Irina. Now, I've noticed that I can not send more than one byte. The flow the same, except I send sequentially Word by Word to Tx_Fifo the data (92 Words). Wireshark shows that UDP sending is absent, but when I store one Word to Fifo, It shows UDP sending with one sent Word and another more, which I haven't sent. Please help. Thanks in advance.
A) Hi~ Addi. Sorry for the late reply to your question. You need to confirm the sending size or the socket buffer size when Socket init operates. Thanks, BR Irina.
A) You mean, the TX fifo size of Socket 0 is 64Kbytes, Tx_RSR size of Socket 0 is 255 bytes, is it right? Could you tell me the S0_TX_FSR value? It sets the IP address and port number of the peer, saves the transmitting data in the internal TX memory through Sn_TX_FIFOR, and tries to transmit the data to the peer. Thanks, BR Irina.
A) Dear Irina! Thanks for your support! I use the direct bus and BIT16EN = 1. Also, I can write to S0_TTLR and can read what I've written to. And I write to S0_TTLR before the open command. But the situation is still the same. The free size reg shows not free. Declaring my problem more fully! I'm doing the following: 1) nRESET pin hold in low 10 2) After nRESET release (going to HIGH) wait 10 ms ... 
A) Hi~ addi. I will check the command for W5300. I'll let you know as soon as possible. Thanks, BR Irina.
A) Dear Irina! Thank you! I didn't understand what data FSR register shows. As I understand by default 0x00 and after writing to FIFO 1 byte, it shows 1. Doesn't it? And before the next writing, I must wait for 0 in FSR which will declare what 1 byte is sent."
3147,551,"Hi zorz, 

[quote]if I change the server to Router 1 i am successful.[/quote]
Therefore, W5200 seems to operate normally. 

Check your network configuration between Router1 and Router2.
- What is the external IP address of Router1 ?
    Check the external IP address of Router1 whether is same network with Router2 (192.168.3.x) or not.

- If the external IP address of Router was not sam network with Router2, 
   let me know subnet mask of devices in your network.

Thanks, Hi,
It seems to be likely to have some problem in subneting.

When gateway 1 maybe 255.255.255.0 and gateway 2 maybe 255.255.0.0, gateway 1 should foreward the different subnet packet to gateway 2.

When both gateway are 255.255.0.0, Because All is used in same network, W5200 should connect normally to TCP server.

For IPv4 subnetting, refer to[url]http://en.wikipedia.org/wiki/IPv4_subnetting_reference[/url].

Thanks. Hi 

The routers are checked and work ok ... if i change W5200 with a PC i am able to make the connection with the server.

This is my configuration on the W5200

HW address : SET 
Source IP: 192.168.4.3
Subnet mask: 255.255.0.0
Gateway address : 192.168.4.1

Destination IP address 192.168.3.20
Destination port: 2020 ( ports are open on the router and port forwarding enabled too  ) 

Selected TCP 

when i open the socket ( write 1 to 4001 )it is ok 
when i start the connection ( write 4 to the 4001 )  than the Socket status register ( 4003 ) goes back to 0..meaning CLOSED 

Soo, what am i doing wrong ? Is the configuration OK ?

regards zorz Hi,
I think that TCP server send RST packte to SET.
For more information, Capture network with 'WireShark' program(it's free) in both site(SET site and TCP server site), and post it.

Thanks. hi 

Ok i will do this test, but what about the configuration i is OK ?  

regards Jo?e hi 

the question was if the W5200 configuration is OK ? 

regards zorz Yes, the configuration was OK. hi all

Just wont to the say that the problem was resolved ..the issue was in Linksys E3200 router .. when i removed it ..everything is working now ... if i will have the time i will try do ckeck the situation and report .. 

regads zorz Hi, zorz.

I'm glad to hear you solved the problem.

Best regards.","Q) What is the external IP address of Router1 ? Check the external IP address of Router1 whether is same network with Router2 (192.168.3.x) or not. If the external IP address of Router was not same network with Router2, let me know subnet mask of devices in your network.
Q) When gateway 1 maybe 255.255.255.0 and gateway 2 maybe 255.255.0.0, gateway 1 should forward the different subnet packet to gateway 2. When both gateway are 255.255.0.0, Because All is used in same network, W5200 should connect normally to TCP server. For IPv4 subnetting, refer to  http://en.wikipedia.org/wiki/IPv4_subnetting_reference
Q) Soo, what am i doing wrong ? Is the configuration OK ?
Q) Ok I will do this test, but what about the configuration i is OK ? 
Q) the question was if the W5200 configuration is OK ? 
A) Yes, the configuration was OK. 
A) Just want to say that the problem was resolved ..the issue was in Linksys E3200 router .. when i removed it ..everything is working now ... if i will have the time i will try do check the situation and report ..
A) I'm glad to hear you solved the problem."
3148,5511,"[W5200SHIELD] [W5500SHIELD] [Wizarduinoeth] [Wizarduinowifi] [Wizwiki-W7500x]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:

-----------
hello

W5500 EHTERNET SHIELD board and Nordic NRF52 development board are being tested.

Ethernet shield boards during the test

IP Time A304 There is no problem when testing with routers

In KT's DW02-412h, IP cannot be accepted.The LED of the RJ45 percussion seems to work without a problem.

In the above environment, KT's DW02-412H is a router, and the IP Time A304 is connected to the hub mode, and then connected to the IP Time A304 and Ethernet Shield products.

If you check which part, please check it quickly.

thank you In the current situation, it is not known whether the symptoms are caused by the router or because of the W5500 Shield.

It is better to inquire with the router company.

First of all, please check the DHCP Packet, which is exchanged with the router as a Wireshark packet capture program.

Please check the DHCP packet when using the iPTIME router as a PC and the DHCP packet when using the KT router.You can compare the packet to infer how the router works.

thank you You said that the LED seems to be working normal, but the link may not have been caught before sending the packet.If you do a send without checking the LINK in the FIRMWARE, the packet goes out before the link, and even though the packet does not actually go out, it can be a send complete.In my opinion, the ipTIME router is caught quickly, so the Send CMD is out after the link, but the KT seems to be relatively late and the Send CMD is going out before the link.

thank you Thank you for answer.","Q) What is the issue you are facing with the W5500 Ethernet Shield board and Nordic NRF52 development board during testing? 
A) The issue is related to testing the Ethernet Shield boards with routers, specifically encountering problems with accepting the IP in KT's DW02-412h router. 

Q) What steps have you taken to troubleshoot the issue so far? 
A) I have tested the routers with Wireshark packet capture program to check DHCP packet exchange, and have observed that the LED seems to be working but the link may not have been caught before sending the packet. 

Q) What is your suggestion to address the issue? 
A) My suggestion is to check the DHCP packet exchange using the Wireshark packet capture program and inquire with the router company to understand the behavior of the routers.

Q) What could be the potential cause of the issue? 
A) It seems that the issue might be related to the timing of the Send CMD, with the packet going out before the link in the KT router, while the ipTIME router catches the link quickly before sending the packet."
3149,5513,"Good afternoon
I found unpleasant behavior w5100.

On W5100 he raised TCP-Client.On another device (under Linux), he raised TCP-server.The server, by a timer, once every 100 ms sends a package of 20 bytes.
If you connect to the Telnet server, you can see by eye, about 10 times a second, data appear.
If you connect the W5100 chip, then it also receives this data.But for some reason she gets about once a second of 200 bytes.
Those.The microcontroller continuously checks the output of the W5100 microcircuit, as soon as an interruption appears, the microcontroller reads status registers, reads the size of the byte received and reads all bytes.So .... I expect a microcontroller 10 times a second will find Int and 10 times a second to read 20 bytes.But the W5100 does not give out INT immediately by reception, but issues Intro about once a second.
I sinned for delays and gluing packages in the local network, then Telnet is normal, i.e.Separately receives 10 packages per second.

Maybe such a ""gluing"" data is a feature of the W5100 chip?Can a microcircuit without delay set the data for data acceptance? ND/MC bit in what condition? Was in ""0"".Put in ""1"" - it became without delay.THANK YOU!!! ** juvf **
Could you share the customer?Âs TCP code?
Even the server works without questions with my first implementation on the manual, but the client does not want to. My code will not help - it is on assembler.Better voice the list of problems. https://forum.wiznet.io/t/topic/5533 What is S0 and S1?Society number?
If the same code works for 0 and does not work for 1, then the problem is either in addressing (the addresses of registers or buffers are incorrectly defined), or the 1st socket 1 is incorrectly configured by the sizes of buffers. S these are jacks.S0 works like a server perfectly, I need to add more a client to S1
The logic is this: tripod listens to the port and responds on request, but it should also send the info to the server on his own.
The manual did everything, but the client does not work.Then a kind person prompted:
1) General vita w5100
2) I give a team in W5100 Open
3) entry into the registers of the socket IP address and port of the remote server, to
which I want to connect
4) I give the Connect command

I breed like that.The manual is a different sequence.","Q) Maybe such a ""gluing"" data is a feature of the W5100 chip? Can a microcircuit without delay set the data for data acceptance?
A) The behavior described could be a feature of the W5100 chip. By setting the ND/MC bit to ""1,"" the microcircuit can be configured to accept data without delay, ensuring prompt data acceptance. Thank you for your assistance. 

Q) Could you share the customer’s TCP code? What is S0 and S1? 
A) The customer's TCP code and the usage of S0 and S1 can be found in the W5100 manual or on the Wiznet forum: https://forum.wiznet.io/t/topic/5533. S0 and S1 represent sockets, with S0 working as a server and the plan being to add a client to S1. 

Q) The logic is this: tripod listens to the port and responds on request, but it should also send the info to the server on his own. The manual did everything, but the client does not work. 
A) To address this issue, a user suggested the following sequence:
1) General vitalization of W5100
2) Issuing a command to open W5100
3) Entering the IP address and port of the remote server into the socket registers, to which one intends to connect 
4) Issuing the Connect command
It may be beneficial to follow this sequence rather than the one provided in the manual."
3150,5518,"We are currently using Wizfi310.
AT command through a computer to Wizfi310 to give a program to send AT commands using MCU.
We are testing.

The circuit used the reference circuit provided by Wiznet.
However, the RESET port can be controlled by the MCU.In other words, if you do not use WiFi,
To operate the Reset port as a high as needed, but to use it after the reset is not operated.
do.

However, while sending the AT command, all other commands such as AT+WSET and AT+WSEC can be transmitted and receive other responses such as [OK].
In fact, if you observe the current of the power spl a current ... at the same time, the current is thrown at the same time, and the current falls to zero and reboots, and the cereal will be restored to the WiFi310 Version 1.0.3.2 [Wiznet Co.ltd].

What is the problem? hello

We ask for some tests to determine the cause of the symptoms you mentioned.

1. Whether it operates normally or rebooted when ordering at+wscan.

2. Attempts to enter Passphrase incorrectly when WJOIN

3. Access to other APs (by different authentication methods, etc.) Ã«Â³Â´Ã«ÂÂ´Ã¬Â£Â¼Ã¬ÂÂ  ?Â´Ã¬ÂÂ©???????ÂµÃ«? ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

?ÂÃ«ÂÂÃ«Â¥?Ã¬Â°Â¸Ã¬Â¡Â°?Â´Ã¬Â£Â¼?ÂÃªÂ¸Â° Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

???Â°Ã¬ÂÂ??WowSys)
Ã¬Â£???: ÃªÂ²Â½Ã«ÂÂ¨ ÃªÂ¹??Â´Ã¬ÂÂ Ã¬Â£Â¼Ã¬Â´ÂÃ«Â©??ÂÃ«Â§ÂÃªÂ¸?88, ÃªÂ¹??Â´Ã¬ÂÂ?ÂÃ«ÂªÂ?Â¼Ã­ÂÂ° 114??
?Â´Ã«??? 010-2937-0598
?Â´Ã«Â©Â?? radar@naver.com

WOWSYS Co., Ltd.
Address  : #114 Gimhae Bio-Medical Center, 88, Somang-gil, Juchon-myeon, Gimhae-si, Gyeongsangnam-do, Republic of KOREA
Zip-Code : 50969
Mobile-Tel: +82-10-2937-0598
Skype ID : handungchi Even in the AT+WSCAN command, 8 times in columns are rebooted with resets. There is only a reset of two commands at AT+WSCAN and AT+WJOIN.
And what does passphrase mean?
The same phenomenon is the same for other APs. Only serial communication speeds have been converted from 115200bps to 38400bps.
At 115200 speed, WJOIN and WSCAN are good.However, most of the 38400
Every time you send a command, it will be reset. hello

If you can check the log side of the WiFi module, please check the log.","Q) What is the problem? 
A) We ask for some tests to determine the cause of the symptoms you mentioned.
1. Whether it operates normally or reboots when ordering at+wscan.
2. Attempts to enter Passphrase incorrectly when WJOIN
3. Access to other APs (by different authentication methods, etc.)

If you can check the log side of the WiFi module, please check the log."
3151,552,"Leave the server inside the IDC and connect the ATMEGA128 and Wizfi220 to transmit data to the server using a separate AP.
At this time, we will leave the data parameta to A1-A20 and send the data with the URL.
The current connection with the server is doing well, but I don't know how to send it in the following way.
please.
The IP of SMP3.???.com is 123.112.123.12. If you use the port to 4000, how can you set the data by setting it?

-Basic address: [smp3.???.com/power/insert.php
-Param: A1 = 1 & A2 = 2 & A3 = 3 & ... & A20 = 67
-Exemed: [smp3.???.com/power/insert.php?a1 ... 1 = b1 & b2 = b2] (http://smp3.??= 2 & A3 = 3 & B1 = B1 & B2 = B2) 1. Capture the web browser of a general PC and a normal communication process with the server (using a program such as a Wireshark)
2. Analysis of captured TCP RAW DATA
3. Simulation to Wizfi210/220

You can proceed to the above process. WizFi220?ÂÃ¬ÂÂ ?Â°Ã¬ÂÂ´?Â°Ã«? ?Â¡Ã¬ÂÂ ?ÂÃªÂ¸Â° ?ÂÃ­ÂÂ´?ÂÃ«ÂÂ ?ÂÃª?Ã¬Â§? Ã«ÂªÂ¨Ã«ÂÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

1. Data Mode ( WizFi220???ÂÃ«Â Â¥???ÂÃ«Â¦Â¬???Â°Ã¬ÂÂ´?Â°Ã«? ?Â¬ÃªÂ³Â¼ ?ÂÃ¬ÂÂ´ Wi-FiÃ«Â¡??ÂÃ¬ÂÂ¡ ?ÂÃ«ÂÂ Ã«ÂªÂ¨Ã«ÂÂ )
[b]AT+WD[/b]
[OK]
[b]AT+WWPA=12345678[/b]
[OK]
[b]AT+NDHCP=1[/b]
[OK]
[b]AT+WAUTO=0,DIR-636L[/b]
[OK]
[b]AT+NAUTO=0,1,123.112.123.12,4000[/b]
[OK]
[b]ATA[/b]
    IP              SubNet         Gateway   
 192.168.4.106: 255.255.255.0: 192.168.4.1
[OK]

?ÂÃ«Â¦Â¬???Â°Ã¬ÂÂ´???ÂÃ«Â Â¥
[color=#FF0000]http://smp3.???.com/power/insert.php?A1 ... 1=b1&B2=b2[/color]

2. Command Mode ( WizFi220??ESC SequenceÃ«Â¥??Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ?Â°Ã¬ÂÂ´?Â°Ã«? ?Â¡Ã¬ÂÂ ?ÂÃ«ÂÂ Ã«ÂªÂ¨Ã«ÂÂ )
[b]AT+WD[/b]
[OK]
[b]AT+WWPA=12345678[/b]
[OK]
[b]AT+NDHCP=1[/b]
[OK]
[b]AT+WA=DIR-636L[/b]
    IP              SubNet         Gateway   
 192.168.4.106: 255.255.255.0: 192.168.4.1
[OK]
[b]AT+NCTCP=123.112.123.12,4000[/b]
[OK]
<ESC>S<CID>[color=#FF0000]http://smp3.???.com/power/insert.php?A1 ... 1=b1&B2=b2[/color]<ESC>E

Command Mode?? ?Â°Ã¬ÂÂ´???Â¡Ã¬ÂÂ  Ã«Â°Â©Ã«Â²Â???????ÂÃ¬ÂÂ¸???Â´Ã¬ÂÂ©?? WizFi210_PG ""4.Command mode & Data mode""Ã«Â¥?Ã¬Â°Â¸ÃªÂ³Â  ?ÂÃ¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.","Q) How can I set the data to be sent to the server with the ATMEGA128 and Wizfi220 using a separate access point?
Q) If the IP of SMP3.???.com is 123.112.123.12 and the port is set to 4000, how can I configure the data?
A) You can proceed with the process as follows:
Data Mode:
AT+WD
AT+WWPA=12345678
AT+NDHCP=1
AT+WAUTO=0,DIR-636L
AT+NAUTO=0,1,123.112.123.12,4000
ATA
- IP: 192.168.4.106
- Subnet: 255.255.255.0
- Gateway: 192.168.4.1

Command Mode:
AT+WD
AT+WWPA=12345678
AT+NDHCP=1
AT+WA=DIR-636L
IP: 192.168.4.106
Subnet: 255.255.255.0
Gateway: 192.168.4.1
AT+NCTCP=123.112.123.12,4000
<ESC>S<CID>http://smp3.???.com/power/insert.php?A1 ... 1=b1&B2=b2<ESC>E"
3152,5520,"I would like to contact you in the code that accesses the W5100S register during the porting.
I want to use indirect mode,
Looking at the code, it is defined as below,
#IF (_wizchip_io_mode_ & _wizchip_io_mode_spi_)
   #define getmr () wizchip_read (MR)
#else
   #DEFINE GETMR () (*(uint8_t*) MR)
#endif

If so, in INDIRECT mode
#DEFINE GETMR () (*(uint8_t*) MR)
I think this code seems to be the code in the Direct mode ??
Isn't the above code that reads the value directly from the address is a direct mode?
In INDIRECT mode, shouldn't you send your address and read the MR value? ?Â Ã¬ÂÂ???ÂµÃ«???ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
ÃªÂ·Â¸Ã«ÂÂ°?? ??Ã¬Â§ÂÃ«Â¬Â¸???ÂÃ«ÂÂÃªÂ°? ?ÂÃ«?Ã«Â¡??ÂÃ«ÂÂ¬?ÂÃ¬? ?ÂÃ¬?ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

#define setMR(mr)    (*((uint8_t*)MR) = mr) ?Â´Ã«?Ã«Â¡?

setMR(0x80) ?? ?ÂÃ«ÂÂÃ¬Â²ÂÃ«ÂÂ¼ ?Â´Ã¬ÂÂ?Â©Ã«ÂÂ??

(*((uint8_t*)(0x60000000 + (0x0000))) = 0x80)

Ã¬Â¦?  0x60000000 Ã«Â²ÂÃ¬???0x80???Â°ÃªÂ²Â ?Â©Ã«ÂÂ??

ÃªÂ²Â°ÃªÂµÂ­, ??Ã«Â²ÂÃ¬?????Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ Ã«Â§ÂÃ¬ÂÂ´Ã¬Â»Â´Ã¬ÂÂ?ÂÃ«ÂÂ ÃªÂ¸Â°Ã¬ÂÂ ?ÂÃ¬? ?ÂÃ¬? Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ´?Â´Ã¬ÂÂ ?ÂµÃ¬ÂÂ?ÂÃ¬ÂÂ´ Ã«Â°ÂÃ¬ÂÂ?ÂÃªÂ²Â ?Â ÃªÂºÂ¼?Â¼Ã«ÂÂ Ã¬Â§ÂÃ«Â¬Â¸?Â´Ã¬ÂÂ?ÂµÃ«ÂÂ??

?ÂÃª? Ã«Â¬Â´Ã¬ÂÂ¨ Ã¬Â°Â©ÃªÂ°Â???ÂÃªÂ³Â ?ÂÃ«ÂÂÃªÂ±Â´Ãª???? ^^;;


ÃªÂ²Â°Ã«Â¡Â ?ÂÃ¬ÂÂ¼Ã«Â¡? ?ÂÃ«ÂÂ Ã¬Â½ÂÃ«ÂÂÃªÂ°? indir Ã«ÂªÂ¨Ã«ÂÂ?ÂÃ¬ÂÂ???ÂÃ«?Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ¬? ?ÂÃ«ÂÂÃªÂ²??ÂÃ«ÂÂÃªÂ°? ?ÂÃ«ÂÂ Ã¬Â§ÂÃ«Â¬Â¸?ÂÃ«ÂÂ??


> /**
>  * @ingroup Common_register_access_function_W5100S
>  * @brief Set Mode Register
>  * @param (uint8_t)mr The value to be set.
>  * @sa getMR()
>  */
> #if (_WIZCHIP_IO_MODE_ & _WIZCHIP_IO_MODE_SPI_)
>     #define setMR(mr) 	WIZCHIP_WRITE(MR,mr)
> #else
>     #define setMR(mr)    (*((uint8_t*)MR) = mr)
> #endif
> 
> /**
>  * @ingroup Common_register_access_function_W5100S
>  * @brief Get @ref MR.
>  * @return uint8_t. The value of Mode register.
>  * @sa setMR()
>  */
> #if (_WIZCHIP_IO_MODE_ & _WIZCHIP_IO_MODE_SPI_)
>    #define getMR() 		WIZCHIP_READ(MR)
> #else
>    #define getMR()      (*(uint8_t*)MR)
> #endif hello.

[Quote = ""InfOIC, POST: 3, Topic: 5520""]
#DEFINE SETMR (MR) ( * ((uint8_t *) MR) = MR), so,

setmr (0x80) is interpreted as below.

( * ((uint8_t *) (0x60000000 + (0x0000))) = 0x80)

In other words, you will use 0x80 at 0x60000000.
[/Quote]

The part you say is correct.

If you use the indirect mode, you can use the address below, so 0x6000_0000 is correct as you mentioned.

    #DEFINE_WIZCHIP_IO_BASE_ 0x60000000 // for 5100s IND
    #DEFINE IDM_OR ((_wizchip_io_base + 0x0000))
    #DEFINE IDM_AR0 ((_wizchip_io_base_ + 0x0001))
    #DEFINE IDM_AR1 ((_wizchip_io_base_ + 0x0002))
    #DEFINE IDM_DR ((_wizchip_io_base_ + 0x0003))
Here is the point where IDM_OR in the W5100 and W5100s is the address that represents the actual MR.
As I mentioned before, it is designed for customers who want to change the W5100s from the W5100,
In the W5100, when you change it from Direct Mode to Indirect Mode, you set up one bit of IDM_or.
This part is not used in the W5100S, but if you write or read the value for 0x6000_0000 for W5100 users, you will access the MR Register.

Since this part is a test complete, Iksen ??does not occur.

[Quote = ""InfOIC, POST: 3, Topic: 5520""]
In the end, this bold was not described in most microcomplets, so the question would occur.
[/Quote]
What do you talk about not described ...
When it is indirect mode, the value of _wizchip_io_base_ is different for each MCU.
Since the MCU of the example provided by WizNet is used, it is set as a base address at 0x6000_0000.

If you use another MCU, you should set the address that suits the MCU.

thank you
Irina Ah ... now I know the meaning of speaking.

In other words, in the W5100s, AD0,1 says that the lowest 2 bits of (usually AD [31: 0]) (usually used in the external memory interface) to the W5100S.

Yes, right.
In this case, it will work.
(By the way, there are not many users who use it like this ...)

I also use the GPIO of Cortex-M0 to AD0,1.
In this case, the 0x6000_0000 is an area that is not used, so the memory extract will occur (confirmed).
In the case of me, I do not use the function of iOLIBRARY.
I need modifications.

I hope you have a code that will help you to modify ....
Anyway, thank you.

Now I understand why I declared as follows.

#DEFINE_WIZCHIP_IO_BASE_ 0x60000000 // for 5100s IND
#DEFINE IDM_OR ((_wizchip_io_base + 0x0000))
#DEFINE IDM_AR0 ((_wizchip_io_base_ + 0x0001))
#DEFINE IDM_AR1 ((_wizchip_io_base_ + 0x0002))
#DEFINE IDM_DR ((_wizchip_io_base_ + 0x0003)) If you use IOLIBRARY
If you map the value of the wizchip_io_base to the available memory address, you will be able to use it without difficulty.

thank you
Irina ??ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??

> 	wizchip_setnetinfo(&info);
> 	wizchip_settimeout(&nettime);
> 	wizchip_init(txsize, rxsize);

??Ã¬Â½ÂÃ«ÂÂÃ«Â¥??Â¤Ã­ÂÂ????
?Â¤Ã¬ÂÂ netinfoÃ«Â¥??Â½Ã¬ÂÂ´Ã«Â³Â´Ã«ÂÂ ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??Â½Ã¬ÂÂ´Ã¬Â§???ÃªÂ²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

ÃªÂ·Â¸Ã«ÂÂ°?? ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.?Â Ã£ÂÂ 

int8_t close(uint8_t sn) ?ÂÃ¬ÂÂ

> 	setSn_CR(sn,Sn_CR_CLOSE);
>    /* wait to process the command... */
> 	while( getSn_CR(sn) );

?Â´Ã«?Ã«Â¶ÂÃ¬ÂÂ??Sn_CR ÃªÂ°ÂÃ¬ÂÂ´ 0?Â¼Ã«Â¡Â ?ÂÃ¬Â§Â ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

Ã¬Â°Â¸ÃªÂ³Â Ã«Â¡?
ADDR0,ADDR1 ?? GPIOÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?Â¹Ã¬ÂÂ???Â´Ã¬ÂÂ PCB???Â¤Ã¬ÂÂ Ã¬Â¡Â°Ã«Â¦Â½??Ã«Â´Â¤Ã¬?Ã«Â§?Ã«Â§ÂÃ¬Â°Â¬ÃªÂ°?Ã¬Â§? ???ÂµÃ«ÂÂ??
?Â´Ã«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ÃªÂ²??Â Ã­ÂÂ´ Ã«Â´ÂÃ¬ÂÂ¼ ?Â ÃªÂ¹Â??
Ã¬Â¡Â°Ã¬ÂÂ¸??Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? [quote = ""infoic, post: 7, topic: 5520""]
SN_CR_CLOSE
[/Quote]

hello .
Logic status for SN_CR
It is designed to be automatically clear.

What kind of action is the value of SN_CR?
For example, it does not work in the connect function ..........
I think I need to check if the SN_CR of the socket is correct.

thank you
Irina Dream. ?Â¤Ã­ÂÂ???ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨???ÂÃ¬ÂÂ??Ã«Â¡?Ã¬Â½ÂÃ«ÂÂÃ«Â¥??ÂÃ¬ÂÂ´?ÂÃ«Â©Â´ ?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

> pin_low(RST);
> // ?Â¬ÃªÂ¸Â° ?Â½ÃªÂ°Â???Â¤Ã«Â¥Â¸ Ã¬Â½ÂÃ«ÂÂÃªÂ°? ?ÂÃªÂ³Â , 
> pin_high(RST);
> 
> Wait_10us(200 * 100);

?ÂÃ¬Â²Â??Ã«Â¦Â¬Ã¬ÂÂ ?ÂÃ¬ÂÂ??????

> uint8_t txsize[4] = {2, 2, 2, 2};
> uint8_t rxsize[4] = {2, 2, 2, 2};
> 
> reg_wizchip_cris_cbfunc(enable_irq, disable_irq);
> reg_wizchip_cs_cbfunc(cs_low, cs_high);
> reg_wizchip_bus_cbfunc(bus_readdata, bus_writedata);
> 
> wiz_NetInfo info = {
> 	.dhcp=NETINFO_STATIC
> };
> 
> // MAC ADDRESS
> for (i = 0 ; i < 6; i++) {
> 	info.mac[5-i] = (param.mac >> (i * 8)) & 0xFF;
> }
> // Local IP ADDRESS
> for (i = 0 ; i < 4; i++) {
> 	info.ip[3-i] = (param.ip >> (i * 8)) & 0xFF;
> }
> // Subnet Mask ADDRESS
> for (i = 0 ; i < 4; i++) {
> 	info.sn[3-i] = (param.subnet >> (i * 8)) & 0xFF;
> }
> // GateWay ADDRESS
> for (i = 0 ; i < 4; i++) {
> 	info.gw[3-i] = (param.gateway >> (i * 8)) & 0xFF;
> }
> 
> wiz_NetTimeout nettime = {
> 	.retry_cnt = param.retryCount,
> 	.time_100us = param.retryTime
> };
> 
> wizchip_setnetinfo(&info);
> wizchip_settimeout(&nettime);
> wizchip_init(txsize, rxsize);

?ÂÃ¬ÂÂ??Ã¬Â²ÂÃ«ÂÂ¼ Ã¬Â´ÂÃªÂ¸Â°???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
ip, subnet,gw???ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??Â¨Ã¬Â¡Â?Â¤Ã«ÂÂÃªÂ²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

>TcpServer(0, 8698);

Ã«Â§ÂÃ¬?Ã«Â§ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬Â²Â??TcpServerÃ«Â¥??Â¤Ã­ÂÂ?ÂÃ«ÂÂ??
?Â¬ÃªÂ¸Â°?ÂÃ«??Â°Ã«ÂÂ ioLibrary?Â´Ã¬ÂÂ Ã¬Â½ÂÃ«ÂÂ?Â´Ã«?Ã«Â¡????ÂÃªÂ³Â  ÃªÂ³ÂÃ¬ÂÂ¤ÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃªÂ°Â?ÂÃ«ÂÂ??

> socket(s,Sn_MR_TCP,port,0x00);

???Â¸Ã¬Â¶Â?ÂÃªÂ³Â ,
??socket()?ÂÃ¬ÂÂ??

> close(sn);
???Â¸Ã¬Â¶Â ?ÂÃ¬???

?? close() ?ÂÃ¬ÂÂ??

> setSn_CR(sn,Sn_CR_CLOSE);
>    /* wait to process the command... */
> while( getSn_CR(sn) );

?ÂÃ¬ÂÂ Ã¬Â½ÂÃ«ÂÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?Â¬ÃªÂ¸Â°??while Ã«Â¬Â¸Ã¬ÂÂ??Ã«Â¬Â´Ã­ÂÂÃ«Â£Â¨Ã­ÂÂÃ«Â¥??ÂÃ«ÂÂ??
ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?Â´Ã«Â³Â´Ã«Â©?0?Â¼Ã«Â¡Â Ã«Â¦Â¬Ã¬ÂÂ?ÂÃ¬? ?ÂÃªÂ³Â  Sn_CR_CLOSEÃªÂ°? ÃªÂ·Â¸Ã«?Ã«Â¡????ÂµÃ«ÂÂ??","Q) I would like to contact you in the code that accesses the W5100S register during the porting. I want to use indirect mode. Isn't the above code that reads the value directly from the address in direct mode?
A) The code you mentioned uses the direct mode to read the value directly from the address. In the indirect mode, you should send your address and then read the MR value.

Q) What do you talk about not described ... When it is indirect mode, the value of _wizchip_io_base_ is different for each MCU. If you use another MCU, you should set the address that suits the MCU. Thank you.
A) It seems like you are pointing out that the description is not clear. In the indirect mode, the value of _wizchip_io_base_ varies for each MCU, so if you use a different MCU, you need to set the address that suits the MCU.

Q) pin_low(RST); pin_high(RST); Wait_10us(200 * 100);
A) The code snippet is setting the RESET pin low, then high, and then waiting for 2000 microseconds.

Q) TcpServer(0, 8698);
A) The TcpServer(0, 8698) function call is setting up a TCP server on port 8698.

Q) socket(s,Sn_MR_TCP,port,0x00); close(sn); setSn_CR(sn,Sn_CR_CLOSE); while(getSn_CR(sn));
A) The socket(s,Sn_MR_TCP,port,0x00) function call is creating a TCP socket, and then the close(sn) function call closes the socket using the provided socket number. The while loop waits until the Sn_CR_CLOSE command is processed."
3153,5521,"https://forum.wiznet.io/t/topic/5520

I posted above,
I am in a hurry and send a message to the excuse.
Please confirm.
thank you I answered the question.
If you have any questions and have any questions, please always ask questions ~","Q) Please confirm my message. 
A) I am in a hurry and send a message to the excuse."
3154,5529,"I am developing a device that should transmit data on any networks that can transmit data over Ethernet.The problem is this:
The device works fine with most of my network devices (all routers: mikrotik, dlink, tplink; switches: 3com baseline 2024, any switches cisco; PC, laptop), but does not work with the switch 3com baseline 2016.
The PC and laptop work correctly with this switch, which makes me think.
Any w5500 packets are lost on the switch; I can not ping the device (if ip and mask are set manually), I cannot get the host settings via DHCP (Dhcp discovery dropped on switch).
The MAC address is set correctly.

Maybe you know if there are similar problems with other network equipment? And are there any solutions to this problem?
Thank you Hi 
W5500 isn't support Auto mdix.

If your switch not support the Auto mdix,  you have to use the  **Crossover Cable(TX-RX, RX-TX)**.

thanks,
best regards
irina Hi, Irina!
Thank you for reply, 
bot it's too easy. 
switch supports auto-mdix.

I tried to connect devices with any valid cable configurations.
No results.
The PC and laptop work with the switch, the device does not work.
I tried to enable and disable autonegotiation. - No results.
I tried to select 10Mbit / 100Mbit data and duplex / half duplex - no results.
In any phy-level configuration, the PC and laptop work with the network, my device does not.
And the problem is only with one of the switches I have.
A different Ethernet controller is installed in the PC and laptop, not the W5500.
If the PC and laptop did not work with this switch, I would consider that the problem is in the switch. But they work. So, my device should work.
Or there should be a list of devices incompatible with this ethernet controller. W5500 link LED is on when cable is plugged in?
When W5500 tries reaching DHCP, does its TX LED flash?
Does its RX LED flash some times at all?

[quote=""voroshilov, post:3, topic:5529""]
And the problem is only with one of the switches I have.
[/quote]

There could be a kind of ""portfast"" setting in the switch which does not allow switch's port to initialize quickly. Simple test: turn on the W5500, wait for a minute with link LED being on (switch's port must have detected and brought up so far), and then perform DHCP query. [quote=""Eugeny, post:4, topic:5529""]
W5500 link LED is on when cable is plugged in?
[/quote]
 - yes;
[quote=""Eugeny, post:4, topic:5529""]
When W5500 tries reaching DHCP, does its TX LED flash?
[/quote]
- yes;
[quote=""Eugeny, post:4, topic:5529""]
Does its RX LED flash some times at all?
[/quote]
- no; 

- The device does not respond to ping-request;  independently of switch port (Ip, subnet mask, and other host settings applied mannualy)
- The device does not receive any packets (including broadcast); independently of switch port; Independently of UDP / TCP mode; The socket-port is assigned.
- Packets from device not forwarded from switch
 - PC and laptop works correctly in same environment;

[quote=""Eugeny, post:4, topic:5529""]
There could be a kind of ?Âportfast??setting in the switch which does not allow switch?Âs port to initialize quickly. Simple test: turn on the W5500, wait for a minute with link LED being on (switch?Âs port must have detected and brought up so far), and then perform DHCP query.
[/quote]
 - Has no effect; Put a simple hub in between the switch and W5500 and see if it will change anything. If I add any intermediary between the switch and the W5500 - everything works correctly.
Only the operation of this chip when connecting directly to the switch is incorrect. Sounds like sucb behavior may be caused by:

- logical incompatibility: see if you can update switch's firmware;
- physical (electrical) incompatibility. You do not detail if device is your custom board or board provided by WIZnet or its partners. The switch does not have the ability to update the software.
The switch does not have any settings.

PCB is developed by our engineers, but according to the reference design;
I am inclined to reject electrical incompatibility. Oscillograms of data exchange with a PC or device do not differ: the fronts are correct, the pulse duration too, up to noise.
Logical incompatibility - maybe. I want to know more precisely about this, I don?Ât have official information, but the facts show that any network devices work correctly with the switch, except for the W5500. [quote=""voroshilov, post:9, topic:5529""]
Logical incompatibility - maybe. I want to know more precisely about this
[/quote]

The only way is to monitor and intercept packets at the switch's port level. I suspect it is not possible. You can run Wireshark on the DHCP server to see if it gets DHCP requests.

When DHCP request is sent - eimmediatel after device is powered up? Can you issue DHCP request during chip operation? Before creating this topic, I did an experiment:
1) I connect the switch and the device through a special cable with a gap.
2) In the gap I connect a hardware traffic listener.
3) I launch Wireshark on the Dhcp-server.
4) I launch Dhcp - client on the device.

I see the following:
1) The device sends the packet. The switch confirms the activity by flashing the LED.
2) Dhcp-server does not receive packets from Dhcp-client;
3) Dhcp-client does not receive any data from the dhcp-server.
The switch does not forward (!) Packets from the device, ignores packets.
 With any other device (PC, laptop, routers from different vendors), the switch works correctly, there are no problems.

With all the hardware I have, except for this switch, the w5500 chip also works correctly.

The problem is as follows:
- Switch and W5500 do not work together.
- The switch with other network devices works correctly.
- other network equipment correctly works with this microcircuit.
and I need to understand why. I don't need workarounds. I need a root solution, and for this I need to know the root of the problem.
I also tried to connect devices from WIZnet, the same problem with them.

In the start message I indicated the switch model with which problems: 3com baseline 2016 [quote=""voroshilov, post:11, topic:5529""]
With any other device (PC, laptop, routers from different vendors), the switch works correctly, there are no problems.
[/quote]

Other devices may logically work differently - e.g. PC with Windows or Linux may send packet each second, and if previous packet got lost due to switch issues, next packet will be replied to. As a test set W5500 sending requests in loop each second and see if any of the packets will go through.

[quote=""voroshilov, post:11, topic:5529""]
The switch with other network devices works correctly.
[/quote]

You judge at the user interface level? Or at the packet exchange level?

[quote=""voroshilov, post:11, topic:5529""]
I also tried to connect devices from WIZnet, the same problem with them.
[/quote]

MAC addresses of these devices, including the one you currently use? [quote=""Eugeny, post:12, topic:5529""]
Other devices may logically work differently - e.g. PC with Windows or Linux may send packet each second, and if previous packet got lost due to switch issues, next packet will be replied to. As a test set W5500 sending requests in loop each second and see if any of the packets will go through.
[/quote]

Swiths drops all packets from my device; 

Mac, for example: 
00E0C42D02AA
F46D046E9048
00CA01xxxxxx
and any Mac-addresses with cleared multicast-bit; 

[quote=""Eugeny, post:12, topic:5529""]
You judge at the user interface level? Or at the packet exchange level?
[/quote]
Both [quote=""voroshilov, post:7, topic:5529, full:true""]
If I add any intermediary between the switch and the W5500 - everything works correctly.
Only the operation of this chip when connecting directly to the switch is incorrect.
[/quote]

This sounds a lot like the issue we had with our W5500 equipped device when it was plugged into a RJ45 wall jack at one corner of the office building and the company's network switch was located at the other end of the same building. PHY detection was fine but DHCP wouldn't happen. Adding another network device in between, such as another switch or a network sniffer (TAP) device,  would make this problem go away. My hardware guy did something to circuit board to enhance the driving capability and that seemed to fix the problem. [quote=""acpie360, post:14, topic:5529""]
My hardware guy did something to circuit board to enhance the driving capability and that seemed to fix the problem.
[/quote]

Please share what did he do.
Shorted damping resistors? Resolved:
The termination resistors on our PCBs were soldered with a 49 kÃÂ© rating. Although should be 49 ohms.

And that shield, which is made by reference design, did not work because of a factory defect, which distracted from the true problem.

Banal inattention stole the weeks of my time.

Thank you all for your feedback. There was certainly one other case I recall with the absolutely same cause :slight_smile:
Great that you have solved the issue! @voroshilov which one is the termination resistor on the w5500 board? is there any number or pin name that is connected with it? I am using the w5500 ethernet shield and this is working well with all routers except switches. I also face the same problem. after that I follow these steps now it's working good.
 
There may be a form or ""portfast"" setting in the switch that does not permit the ports to be initialized quickly by the switch. Simple test: power on the W5500 then wait for one moment with the link LED turned on (switch's port has to have been detected and been brought up) then run DHCP query. 
Are you willing to buy an [ethernet switch](https://www.xfurbish.com/search?tag=ethernet%20switch)?. Some websites offer refurbished IT parts with warranty options. sites like amazon, xfurbish, flipkart I was testi the W5500 module with Stm32f051 discovery board . in have an issuse to getting ip module was auto disconnect with internet (meane ethernet ) and dont get the ip 


thanks an regard 
Manoj","Q) Maybe you know if there are similar problems with other network equipment? And are there any solutions to this problem?
A) W5500 isn't support Auto mdix. If your switch not support the Auto mdix, you have to use the **Crossover Cable(TX-RX, RX-TX)**.

Q) W5500 link LED is on when cable is plugged in? When W5500 tries reaching DHCP, does its TX LED flash? Does its RX LED flash some times at all? 
A) - The device does not respond to ping-request; independently of switch port (Ip, subnet mask, and other host settings applied mannualy) - The device does not receive any packets (including broadcast); independently of switch port; Independently of UDP / TCP mode; The socket-port is assigned.

Q) There could be a kind of ""portfast"" setting in the switch which does not allow switch's port to initialize quickly. Simple test: turn on the W5500, wait for a minute with link LED being on (switch's port must have detected and brought up so far), and then perform DHCP query. 
A) - Has no effect; Put a simple hub in between the switch and W5500 and see if it will change anything. If I add any intermediary between the switch and the W5500 - everything works correctly.

Q) The switch with other network devices works correctly. 
A) You judge at the user interface level? Or at the packet exchange level?

Q) Other devices may logically work differently - e.g. PC with Windows or Linux may send packet each second, and if previous packet got lost due to switch issues, next packet will be replied to. As a test set W5500 sending requests in loop each second and see if any of the packets will go through.
A) Swiths drops all packets from my device; 

Q) Please share what did he do. 
A) Resolved: The termination resistors on our PCBs were soldered with a 49 kÃÂ© rating. Although should be 49 ohms. And that shield, which is made by reference design, did not work because of a factory defect, which distracted from the true problem.

Q) @voroshilov which one is the termination resistor on the w5500 board? is there any number or pin name that is connected with it? 
A) There may be a form or ""portfast"" setting in the switch that does not permit the ports to be initialized quickly by the switch. Simple test: power on the W5500 then wait for one moment with the link LED turned on (switch's port has to have been detected and been brought up) then run DHCP query.

A) Are you willing to buy an [ethernet switch](https://www.xfurbish.com/search?tag=ethernet%20switch)? Some websites offer refurbished IT parts with warranty options. sites like amazon, xfurbish, flipkart."
3155,553,"Hi guys,

Just wanting to check something with you all. I have a WIZ5500io, and I can talk to it fine and can get it's IP address and MAC address. I also have a w5500 chip which doesn't reply with an IP address or MAC address ( but does reply with the version number so I know it's working). Do I have to go and assign it a MAC address ( by buying one presumably?) and an IP address? Hi, jdcowpland.

You read value with 0.0.0.0(ip) and 0:0:0:0:0:0(mac) or values are broken??

or you don't have default MAC address supported??

Best regards. I get a reply of 0.0.0.0 for ip and 00:00:00:00:00:00 for mac Hi, jdcowpland.

First, W5500 has no default MAC and IP. So you must set up, if not, it is always 0.

Second, WIZ550io has default MAC and IP. But if you cannot read these values, there are problems.

WIZ550io has PIC, and PIC set up MAC and IP when booting. But when producing, if there is problem, PIC cannot set up MAC and IP. 
Or W5500 chip in WIZ550io has problem(e.g. malfunction).

So, I recommend to check to write MAC address and IP address to WIZ550io and then read them.
If you can read values with correct value, chip is working correctly.

So if, you need to request RMA to distributor where you bought.

Best regards. Hi,

[quote] Do I have to go and assign it a MAC address ( by buying one presumably?) and an IP address?[/quote]

If you need to produce mass quantity, you'd better assign mac address from iana.org.
(refer to [url]https://forum.wiznet.io/t/rong-name-for-w5100-chip/434/1])
Otherwise, you'd better buy wiz550io from wiznet or others.

Thanks.","Q) Do I have to go and assign it a MAC address ( by buying one presumably?) and an IP address?
A) If you need to produce mass quantity, you'd better assign mac address from iana.org. Otherwise, you'd better buy wiz550io from wiznet or others.
Q) You read value with 0.0.0.0(ip) and 0:0:0:0:0:0(mac) or values are broken? or you don't have default MAC address supported? 
A) First, W5500 has no default MAC and IP. So you must set up, if not, it is always 0. Second, WIZ550io has default MAC and IP. But if you cannot read these values, there are problems. WIZ550io has PIC, and PIC set up MAC and IP when booting. But when producing, if there is problem, PIC cannot set up MAC and IP. Or W5500 chip in WIZ550io has problem(e.g. malfunction). So I recommend to check to write MAC address and IP address to WIZ550io and then read them. If you can read values with correct value, chip is working correctly. So if, you need to request RMA to distributor where you bought.
A) Best regards."
3156,5533,"There is no problem with S0 and server. All works as expected!
But S1 as client won't work. This code:

    unsigned char dst_addr[] = {192,168,0,107};
    unsigned char dst_port[] = {99,99};

    SPI_Write(S1_MR,MR_TCP);
    //random sending port
    SPI_Write(S1_PORT,0x12);
    SPI_Write(S1_PORT + 1,0x12);

    SPI_Write(S1_CR, CR_CONNECT);

    SPI_Write(S1_DIPR + 0,dst_addr[0]);
    SPI_Write(S1_DIPR + 1,dst_addr[1]);
    SPI_Write(S1_DIPR + 2,dst_addr[2]);
    SPI_Write(S1_DIPR + 3,dst_addr[3]);
    _delay_ms(1);

    SPI_Write(S1_DPORT + 0,dst_port[0]);
    SPI_Write(S1_DPORT + 1,dst_port[1]);
    _delay_ms(1);
    SPI_Write(S1_CR, CR_OPEN);
    If (SPI_Read(S1_SR) == SOCK_ESTABLISHED) {
     ///////
    }
When i checked DIPR and DPORT they are not always have correct data. After mcu reset they may have 0 or correct data.
What am I doing wrong? ?ÃÂµ ÃÂ¿?ÃÂ°ÃÂ²ÃÂ¸ÃÂ»?ÃÂ½?ÃÂ¹ ÃÂºÃÂ¾ÃÂ´. ÃÂ²ÃÂ¾? ÃÂºÃÂ°ÃÂº ÃÂ½?ÃÂ¶ÃÂ½ÃÂ¾

```
    unsigned char dst_addr[] = {192,168,0,107};
    unsigned char dst_port[] = {99,99};

    SPI_Write(S1_MR,MR_TCP);
    //random sending port
    SPI_Write(S1_PORT,0x12);
    SPI_Write(S1_PORT + 1,0x12);
START:
    SPI_Write(S1_CR, CR_OPEN);
wait();
if(S1_SR != SOCK_INIT) 
{
SPI_Write(S1_CR, CR_CLOSE);
goto START;
}
    SPI_Write(S1_DIPR + 0,dst_addr[0]);
    SPI_Write(S1_DIPR + 1,dst_addr[1]);
    SPI_Write(S1_DIPR + 2,dst_addr[2]);
    SPI_Write(S1_DIPR + 3,dst_addr[3]);
       SPI_Write(S1_DPORT + 0,dst_port[0]);
    SPI_Write(S1_DPORT + 1,dst_port[1]);
    _delay_ms(1);
    SPI_Write(S1_CR, CR_CONNECT);
wait();
    If (SPI_Read(S1_SR) == SOCK_ESTABLISHED) {
     ///////
    }
```

?ÃÂ¼ ÃÂ´ÃÂ°?ÃÂ°?ÃÂ¸?

    START:
    /* sets TCP mode */
    Sn_MR = 0x01;
    /* sets source port number */
    Sn_PORT = source_port;
    /* sets OPEN command */
    Sn_CR = OPEN;
    if (Sn_SR != SOCK_INIT) Sn_CR = CLOSE; goto START;
    /* Write the value of server_ip, server_port to the Socket n Destination IP Address
    Register(Sn_DIPR), Socket n Destination Port Register(Sn_DPORT). */
    Sn_DIPR = server_ip;
    Sn_DPORT = server_port;
    Sn_CR = CONNECT;
    If (Sn_SR == SOCK_ESTABLISHED) goto ESTABLISHED stage; Thank you!Universities are now with the registers of the address of the remote and the port everything is fine ... prescribed! (post withdrawn by author, will be automatically deleted in 24 hours unless flagged)","Q) When i checked DIPR and DPORT they are not always have correct data. After mcu reset they may have 0 or correct data. What am I doing wrong?
A) It seems like you are facing an issue with the DIPR and DPORT not having the correct data after an MCU reset. One possible solution could be to implement a retry mechanism after the reset to ensure that the correct data is set. Additionally, you may want to double-check the initialization sequence to ensure that the DIPR and DPORT are properly configured.

Q) ?ÃÂ¼ ÃÂ´ÃÂ°?ÃÂ°?ÃÂ¸? 
A) It seems like the response here is not related to the previous conversation and may be a non-response or containing garbled characters. Therefore, there is no clear answer provided."
3157,5537,"https://forum.wiznet.io/t/topic/5513/4
Can.Give the mail. Thanks a lot!
bildier@mail.ru Tell me 5100 heated quite decently ... Is this normal?Moreover, I have 5 soldered modules and all as one hot.Glue radiators or do they feel normally at high temperatures? About heating - yes, this is normal for the W5100.At first, it was also puzzled ... But this is a feature of W5100.Many have already measured with this.I have two W5100 chips on the board, now I looked at the thermal imager .... +62 ÃÂ° C on both chips.The board itself and other microcircuits around no more than 37 ÃÂ° C.
If you have 50-70 ÃÂ° C, then I think that radiators are not needed.W5100 feel normally.
 
In general, if you can turn on the back look in the direction of the W5300.In accordance with the fact that she has more sockets and memory, she is better because she has a BRUST mode on SPI, i.e.Once, write the address from where to read, then immediately read 10-100-1000 bytes, the address is auto-maintened.On W5100 for each recorded/visible byte, you have to indicate a new address every time, i.e.For sleep, make four transactions.Thus, the speed on the back actually drops 4 times.
I laid the W5100, due to the fact that I needed a parallel tire, but in the process of development the parallel tire disappeared and only the SPI remained. Thank you very much for the advice!
We only have W5500 on sale.You need to google, and so there is such a trouble with 5100. Now what happened in general .... I turn off the tester from the board and everything stops working (((even just remove the YUSB from the test and take out all the full decay of the system))","Q) Can.Give the mail. Thanks a lot!
A) I'm sorry, it seems like the sentence ""Can.Give the mail. Thanks a lot!"" is unclear and does not qualify as a question.

Q) bildier@mail.ru Tell me 5100 heated quite decently ... Is this normal?
A) Heating is normal for the W5100 chip. It heats up quite decently, but it is considered a feature of W5100.

Q) Moreover, I have 5 soldered modules and all as one hot.Glue radiators or do they feel normally at high temperatures?
A) If the modules have temperatures ranging from 50-70 °C, then it is considered normal for the W5100 chip, and radiators may not be needed.

Q) In general, if you can turn on the back look in the direction of the W5300.
A) The W5300 is better than W5100 in terms of having more sockets and memory. It also has a BRUST mode on SPI, which provides faster speed compared to W5100.

Q) On W5100 for each recorded/visible byte, you have to indicate a new address every time, i.e. For sleep, make four transactions.
A) Yes, on W5100, for each recorded/visible byte, a new address needs to be indicated every time, resulting in slower speed as compared to W5300.

Q) I laid the W5100, due to the fact that I needed a parallel tire, but in the process of development the parallel tire disappeared and only the SPI remained. Thank you very much for the advice!
A) I initially chose W5100 due to the need for a parallel tire, but as the development progressed, the parallel tire disappeared and only the SPI remained.

Q) We only have W5500 on sale.You need to google, and so there is such a trouble with 5100.
A) Currently, only W5500 is available for sale. There have been known issues with the W5100, so it's suggested to search online for alternatives.

This is a non-response paragraph."
3158,554,"Hi,

There is a serial command to turn off Wi-Fi? Hi~~

As far as I know,Just turn off function is no using serial command with wifi.
but you can use ""restart after factory reset function"" of serial command.
If no, another person will reply about your question.

thanks, :slight_smile: Hi,

I want in gateway-mode radio on/off via the serial interface!? Hello Hardix

There is no command to turn off WiFi.","Q) Is there a serial command to turn off Wi-Fi?
A) Just turning off the Wi-Fi function using a serial command is not possible, but you can use the ""restart after factory reset function"" of the serial command. If not, someone else will reply to your question. Thank you. 

Q) Hi, I want to turn the radio on/off in gateway-mode via the serial interface! Can I do that?
A) There is no command to turn off the WiFi."
3159,5542,"hii 

 i designed a new board using the the wiznet 5500 with ST micro controller .
the schismatic is based on the wiznet5500 reference design  i chose a deign with the magnitecs inside the rj45 connector 

after hooking up the board to my supply voltage i can manage to perform SPI communication beetween the wiznet and the st microcontroller but i don't see the link and ack turns on like the wiznet 5500 is if 
i am doing reset at startup for nrst puling it down 10ms and then pulling it high for 100ms .
after that i doing all the configurations for the mac address .
but i don't seem to get link ?  
is  there any idea what to look for in order to get it to work 

all the pmod pins i pulled to high to enable all [quote=""aiedbebar, post:1, topic:5542""]
after that i doing all the configurations for the mac address .
[/quote]

If PHY is connected to live Ethernet cable link LED will turn on if chip is not in reset state and even if chip is not configured. 

If you do not get a link up then you either have W5500 in reset state, have problems with clock, or have problems with circuitry (e.g. wrong magjack pinout, bad soldering, etc). hii thanks you were wright 'there was awrong wiring","Q) I don't seem to get a link with the Wiznet 5500 even after performing reset and configuring the MAC address. Any idea what to look for in order to get it to work?
A) If PHY is connected to live Ethernet cable, the link LED will turn on if the chip is not in reset state, even if it's not configured. If you don't get a link up, it could be due to the W5500 being in a reset state, problems with the clock, or issues with circuitry (e.g. wrong magjack pinout, bad soldering, etc). Checking these factors may help resolve the issue."
3160,5546,"Ã«Â¦Â¬Ã«ÂÂ??Ã«Â³Â´Ã«ÂÂ??w5500 chip??on board???ÂÃ¬Â¼Â ?Â¬Ã¬ÂÂ© Ã¬Â¤??ÂÃ«ÂÂ??
?ÂÃ«Â°Â?Â´Ã¬ÂÂ¤ ?ÂÃ«ÂÂ¼?Â´Ã«Â²Â??Ã«Â¦Â¬Ã«ÂÂ??ÃªÂ¸Â°Ã«Â³Â¸ ?ÂÃ«ÂÂ¼?Â´Ã«Â²ÂÃ«Â¥??Â¬Ã¬ÂÂ© ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Ã«Â§ÂÃ¬ÂÂ½ ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?ÂÃ¬ÂÂ ?ÂÃ¬Â¼Â clientÃ«Â¥?4ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ«Â²Â???Â°Ã«Â¡Â ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤ÃªÂ³?ÃªÂ°??ÂÃ­ÂÂ??ÃªÂ²Â½Ã¬ÂÂ°, 
?Â´Ã«ÂÂ¹ Ã«Â§ÂÃ­ÂÂ¬ Ã¬Â½ÂÃ«ÂÂ??
[https://elixir.bootlin.com/linux/v4.20.10/source/drivers/net/ethernet/wiznet/w5100.c#L655](https://elixir.bootlin.com/linux/v4.20.10/source/drivers/net/ethernet/wiznet/w5100.c#L655)

w5500_memory_configure() ?Â¨Ã¬ÂÂÃ«Â¥?Ã«Â³Â´Ã«Â©Â´ ?ÂÃ«Â³Â¸?? ?ÂÃ«ÂÂÃ«Â§?rx, tx 16K???Â¸Ã­ÂÂ?ÂÃªÂ²Â ?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ?? ?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ 4K??4ÃªÂ°ÂÃ«Â¡Â ?ÂÃ«ÂÂ  ?Â¸Ã­ÂÂ???ÂÃ«ÂÂÃªÂ²?Ã«Â§ÂÃ«ÂÂÃ¬Â§? ÃªÂ¶ÂÃªÂ¸Â?Â©Ã«ÂÂ??
static void w5500_memory_configure(struct w5100_priv *priv)
{
	int i;

	for (i = 0; i < 4; i++) {
		w5100_write(priv, W5500_Sn_RXMEM_SIZE(i), 0x04);
		w5100_write(priv, W5500_Sn_TXMEM_SIZE(i), 0x04);
	}

	for (i = 4; i < 8; i++) {
		w5100_write(priv, W5500_Sn_RXMEM_SIZE(i), 0);
		w5100_write(priv, W5500_Sn_TXMEM_SIZE(i), 0);
	}
} hello,
As a result of checking the code

If you use it as you say,
SOCKET 0 ~ 3 RX/TX Memory size is set by 4K,
SOCKET 4 ~ 7 RX/TC Memory Size is assigned to zero.

thank you
Irina Thank you for answer.
To ask one more question,
If you do that, you can only use SOCKET 0 ~ 30 and Socket 4 ~ 7 is not available because there is no buffer? Your push is correct.

For example, after opening the socket 4 ~ 7 to TCP,
If you look at the packet that occurs during the TCP connection process, you can see that Window Size is 0.
In this case, when the data is transmitted, there is no buffer, so the W5500 sends RST Packet and becomes a socket Close.

thank you
Irina","Q) w5500 chip on board? Can I use SOCKET 0 ~ 30 and will Socket 4 ~ 7 be unavailable due to no buffer?
A) If you use it as you say, SOCKET 0 ~ 3 RX/TX Memory size is set by 4K, SOCKET 4 ~ 7 RX/TC Memory Size is assigned to zero.

Q) After opening the socket 4 ~ 7 to TCP, during the TCP connection process, the packet shows Window Size as 0. What happens when the data is transmitted in this case?
A) When the data is transmitted and there is no buffer, the W5500 sends RST Packet and becomes a socket Close."
3161,5549,"Hi all,
I bought a **W5100S** chip and built my own custom board with it. Schematics is an exact copy of the schematics provided by Wiznet ( as described in **W5100S_ext_Ref_Schematic_V110.pdf**).
I'm also using the most recent firmware from github. I work only with MACRAW mode. 
If I select **W5100** as chip type (wizchip_conf.h: #define _WIZCHIP_ W5100), then everything works in accordance with datasheet, which says that W5100S is firmware compatible with W5100.
But, if I select chip type **W5100S** (wizchip_conf.h: #define _WIZCHIP_ W5100S), then nothing works.
In summary, W5100S works with W5100 FW, but why it does not work with its own FW.

First, I was not sure if we bought the correct chip type. But then reading the printed label on the chip with a magnifier (not easy to read with a naked eye), the print on the chip says ""W5100S"" as expected.

So, what am I missing? Beats me.

PS: The reason I'm trying to migrate to W5100S firmware is to be able to use burst send/receive feature of W5100S. Hi~ rogerthat

Could you please try to test the loopback TCP?
I will try to test as MACRAW. 
I will tell you the test results as soon as possible.


Best regards
irina Hello Irina,

First good news: I tried TCP loop-back test and the result was a SUCCESS with both chip variants.  

Then, I started debugging the whole library code.
It seems to me there is a problem around the code snippet socket.c --> recvfrom(...) --> case Sn_MR_MACRAW: .

Somehow the condition if(sock_remained_size[sn] > 1514) becomes true and socket is closed.
Note: I also sometimes observe that (head[0]+head[1]) equals 0 and then 2 is subtracted, which results in a huge number (i.e., 0 - 2 = 0xFFFE). 

I searched this forum about similar problems and have seen some issues with other chips in the past where some kind of overflow is involved. I suppose those problems already belong to the past and current library code must be fully tested and functional.

Hope you come back with some good news upon finishing your MACRAW test!

PS: There may also be a minor copy-paste error in function wizchip_conf.c --> wizchip_init()
...
while((rxsize[i] >> j != 1)&&(**txsize**[i] !=0)){j++;}
...
But this is not responsible for my situation.","Q) Could you please try to test the loopback TCP? I will try to test as MACRAW.
Q) Could you please try to test the loopback TCP? I will try to test as MACRAW.
A) First good news: I tried TCP loop-back test and the result was a SUCCESS with both chip variants. 
A) First good news: I tried TCP loop-back test and the result was a SUCCESS with both chip variants. 
A) Then, I started debugging the whole library code. It seems to me there is a problem around the code snippet socket.c --> recvfrom(...) --> case Sn_MR_MACRAW: . Somehow the condition if(sock_remained_size[sn] > 1514) becomes true and socket is closed. Note: I also sometimes observe that (head[0]+head[1]) equals 0 and then 2 is subtracted, which results in a huge number (i.e., 0 - 2 = 0xFFFE). 
A) I searched this forum about similar problems and have seen some issues with other chips in the past where some kind of overflow is involved. I suppose those problems already belong to the past and current library code must be fully tested and functional. Hope you come back with some good news upon finishing your MACRAW test! PS: There may also be a minor copy-paste error in function wizchip_conf.c --> wizchip_init() ... while((rxsize[i] >> j != 1)&&(**txsize**[i] !=0)){j++;}
A) But this is not responsible for my situation."
3162,555,"I want to communicate with Ethernet using DSP (28346) and W5300.

There is no DSP -related example, so I refer to the example for AVR.

I know that to use the W5300, I need to map the register.

I don't know which part of the AVR example is mapping.

1. How do you map?

2. Do you only need to map MR? You can set the space for the W5300 unless you use it in the address space supported by DSP.
For example, assuming that the DSP uses 24bit address, and if you have the following Address Map, the W5300 can be assigned with a specific block of 0xC00000 to 0xFFF0000.
Code Memory: 0x000000 ~ 0x7F0000
Data Memory: 0x800000 ~ 0xbf0000
Unused: 0xC0000 ~ 0xffffffff

The W5300 supports two Direct Bus Mode and INDIRECT BUS MODE.
If the Address space is not as large as the example above, use the indirect bus mode if there is not enough memory allocation space,
Allocate only MR, IDM_AR, IDM_DR registers.At this time, the required memory is only 3 bytes, so you can save a lot of the system of the system. Thank you for your answer.

There is one more thing to contact us.

1. I'm not sure how to map.

I am trying to maps the space in DSP 0x100000 to 0x1FFFFF.

IIINCHIP_CONF.H file [#define __def_iinchip_map_base__ 0x08000000]

                                 Do I just need to modify [#define __def_iinchip_map_base__ 0x00100000?

If not, how should I map?


2. How to do a ping test

 In the CMD window
ping xxx.xxx.xxx.xxx (IP set in the program)
Is it right to do it? As you said
MAP definition can be made with #define __def_iinchip_map_base__ 0x00100000].

Ping Test is the IP set to the W5300 in DOS Command.
It is important to note that the PC side should be set to the IP that uses the same subnet.
For example, if the W5300 is 192.168.0.100 and Subnet 255.255.255.0, the PC side should also be set to 192.168.0.xxx Subnet 255.255.255.0.See [URL] http://wizwiki.net/wiki/wiki/doku.php?id=OOOOOOOOOKIE :IP_CONF_B [/Ul]. Thanks to the help, I checked the ping test.

However, I try to check the data output using AX1, but there is no response.

So I checked the code

LoopBack_tcpc function

In the Switch determination syntax, we have confirmed that the value of getsn_ssr (S) continues to be 256.

I use the settings of the example program provided by your company,

Do I have to set up again?

We are currently testing using DSP.



And the variables of the example program are almost declared as UINT8.

Do I need to modify the relaxation when using the DSP (32bit processor)?Doesn't it matter? SN_SSR value cannot be 0xFF.
There is a problem with Register Read/Write.

If you use 16bit Data Bus, you may have an endian problem.
The W5300 supports the Big-Endian (the largest value in the low memory address) unless you set it up.
In addition, please check if you are using 16bit Data Bus.

And the variable type can be changed to a type that compiler supports.UINT8 specifies Unsigned 8bit data.","Q) How do you map?
Q) Do I just need to modify [#define __def_iinchip_map_base__ 0x00100000? If not, how should I map?
Q) How to do a ping test?
Q) Do I need to modify the relaxation when using the DSP (32bit processor) or does it not matter?

A) I know that to use the W5300, you need to map the register. If the Address space is not as large as the example above, you can use the indirect bus mode. If not enough memory allocation space, allocate only MR, IDM_AR, IDM_DR registers. At this time, the required memory is only 3 bytes, so you can save a lot of the system. As for the mapping in DSP, you just need to modify [#define __def_iinchip_map_base__ 0x00100000] in the IIINCHIP_CONF.H file. 
You can perform a ping test by setting the IP in the program and using the DOS Command ""ping xxx.xxx.xxx.xxx"". It is important to set the PC side's IP to the same subnet as the W5300. 
Regarding the data output using AX1 and the LoopBack_tcpc function, it's necessary to check the code and ensure that the variable types are compatible with the DSP (32bit processor). If you use 16bit Data Bus, you may encounter an endian problem, so please verify if you are using 16bit Data Bus and make any necessary type changes to ensure compatibility with the compiler."
3163,5551,"Sounds like all your TCP sockets are stuck open for some reason. Most probably - software can not close them properly, or thinks that connection is still established.

Hard to advise anything as code review is required.

[quote=""Phono, post:1, topic:5551""]
How could I simulate from my home a query coming from a foreign country?
[/quote]

The difference could be:

- packet loss;
- packet wrong order.

For each TCP connection there must be general software timeout while socket is allowed to be connected or in transient state to close. If time outs, you must forcefully close the connection and reopen socket for listening.

It is a bad idea to fully rely on the W5x00 timeout mechanism for two reasons:

1. timeout can be long enough - up to tens of minutes if you set timeout registers too large values;
2. some operations do not assume timeout. Example: socket is connected, and W5x00 waits for incoming data. Remote device may have been long gone, but as W5x00 does no tget anything from there it still thinks that device is still there and keeps socket open. Hi,

I think that Engeny answered you with correct information.

I guess that you tried to close the connection and FIN packet sent to the system in France but it was not delivered to it due to network problem. So the web server socket is still in SOCK_ESTABLISHED and it means there is no socket listening to the next connection request.

There are two solutions you can do.
One is to add socket closing mechanism to the web server socket in your application layer and the other is to use KEEP-ALIVE function with the web server socket. I recommend you use it with all sockets you use.
KEEP-ALIVE checks whether your socket is still valid at the lower layer than your application.
If you use KEEP-ALIVE function, the socket will be closed automatically when the relevant connection is invalid after KEEP-ALIVE Timeout.
Then, you can make a new connection with the web server.

I hope you solve this issue soon. Thank you for this analysis. Please give me more details.

      Currently, my server waits for the request, then it sends the web
page in 23 pieces, I mean in 23 successive IP frames, then waits 5
ms and closes the connection. Do you mean that the confirmation of
the closing from the client part may be lost, and the closing
never performed?

      About Keep-Alive, do you confirm that this is part of the HTTP
message, that for example must start as follows:

HTTP/1.1 200 OK

      Content-Type: text/html

      Connection: Keep-Alive

      Content-Encoding: gzip

      Content-Type: text/html; charset=utf-8

      Keep-Alive: timeout=5, max=1000

      <!DOCTYPE HTML PUBLIC ""-/W3C/DTD HTML 4.0/EN"">

      <html><head>

etc...

      Should I add in my web page the lines about Keep-alive as here
above? [quote=""Phono, post:4, topic:5551""]
Do you mean that the confirmation of
the closing from the client part may be lost, and the closing
never performed?
[/quote]

For example. In general process gets broken, and socket is kept open. You must dig into your code to identify what exactly is happening, and adjust algorithm accordingly.

[quote=""Phono, post:4, topic:5551""]
Should I add in my web page the lines about Keep-alive as here above?
[/quote]

Do not confuse keep alive packet and keep alive HTTP header.

Keep alive in W5x00 network stack is the mechanism sending spare packet with last seq id, and expecting remote device replying with very specific content. If remote device does not reply within the timeout period or replies with RST, socket gets closed automatically with relevant flags set.

Keep alive HTTP header is the request to web server to keep TCP/HTTP connection open after it serves HTTP request for predefined period of time.","Q) How could I simulate from my home a query coming from a foreign country?
A) The difference could be:
- packet loss;
- packet wrong order.
For each TCP connection there must be general software timeout while the socket is allowed to be connected or in transient state to close. If the timeout occurs, you must forcefully close the connection and reopen the socket for listening. It is a bad idea to fully rely on the W5x00 timeout mechanism for two reasons: 1. timeout can be long enough - up to tens of minutes if you set timeout registers too large values; 2. some operations do not assume timeout. Example: the socket is connected, and W5x00 waits for incoming data. The remote device may have been long gone, but as W5x00 does not get anything from there, it still thinks that the device is still there and keeps the socket open.

Q) Currently, my server waits for the request, then it sends the web page in 23 pieces, I mean in 23 successive IP frames, then waits 5 ms and closes the connection. Do you mean that the confirmation of the closing from the client part may be lost, and the closing never performed? About Keep-Alive, do you confirm that this is part of the HTTP message?
A) Hi, 
I think that Engeny answered you with the correct information. I guess that you tried to close the connection and FIN packet sent to the system in France but it was not delivered to it due to a network problem. So the web server socket is still in SOCK_ESTABLISHED and it means there is no socket listening to the next connection request. There are two solutions you can do.
One is to add a socket closing mechanism to the web server socket in your application layer and the other is to use the KEEP-ALIVE function with the web server socket. I recommend you to use it with all the sockets you use. KEEP-ALIVE checks whether your socket is still valid at the lower layer than your application. If you use the KEEP-ALIVE function, the socket will be closed automatically when the relevant connection is invalid after KEEP-ALIVE Timeout. Then, you can make a new connection with the web server. I hope you solve this issue soon. Thank you for this analysis. Please give me more details.

Q) Should I add in my web page the lines about Keep-alive as here above?
A) Do not confuse keep alive packet and keep alive HTTP header. Keep alive in the W5x00 network stack is the mechanism sending a spare packet with the last seq id and expecting the remote device replying with very specific content. If the remote device does not reply within the timeout period or replies with RST, the socket gets closed automatically with relevant flags set. Keep alive HTTP header is the request to the web server to keep the TCP/HTTP connection open after it serves the HTTP request for a predefined period of time."
3164,5554,"Hello everyone,

What happens if the 3 bytes of serial configuration code (default ""+++"") occur inside a larger data packet? Does wiz-module enter serial configuration mode immediately or can the serial configuration mode only be started, if these 3 bytes are sent in a single datagram to UART?

I am asking, because I often get connection aborts with WIZ110SR (UDP mode, packing condition 1ms), if ÃÂ¼C sends many consecutive datagrams (<100bytes each) to UART of wiz-module. (Data is sent binary and encrypted, so each byte combination, i.e. also ""+++"" is possible in data packet)
In such a case suddenly host does not receive UDP data anymore from wiz-module nor it can send anything to ÃÂ¼C so at the end I have to switch power off-on to reset WIZ110SR.
 If serial configuration is disabled this never happens, so I assume wiz-module has entered configuration mode accidentally, because ""+++"" was embedded in data. (not yet logged) 
Permanent disabling of serial configuration is unfortunately not a solution for me, so that could become a showstopper for me :-(

Regards
Andy Hello everyone,

I have checked it and itÃÂ´s exactly as I was afraid of: If the three magic characters occure anywhere inside data stream, configuration is started at once :-/ My solution: Similar bitstuffing, bytestuffung, i.e. after two consecutive ""2B"" a redundant byte is inserted by ÃÂ¼C and must be removed at host side afterwards before decoding...

Regards
Andy","Q) What happens if the 3 bytes of serial configuration code (default ""+++"") occur inside a larger data packet? Does wiz-module enter serial configuration mode immediately or can the serial configuration mode only be started, if these 3 bytes are sent in a single datagram to UART?
A) If the three magic characters occur anywhere inside the data stream, configuration is started at once. The solution is to use similar bit stuffing, byte stuffing, i.e. after two consecutive ""2B"" a redundant byte is inserted by the microcontroller and must be removed at the host side afterwards before decoding. 

Q) I am asking, because I often get connection aborts with WIZ110SR (UDP mode, packing condition 1ms), if µC sends many consecutive datagrams (<100bytes each) to UART of wiz-module.
A) In such a case suddenly host does not receive UDP data anymore from wiz-module nor it can send anything to µC, so at the end I have to switch power off-on to reset WIZ110SR. If serial configuration is disabled this never happens, so I assume wiz-module has entered configuration mode accidentally because ""+++"" was embedded in data. (not yet logged)

Q) Permanent disabling of serial configuration is unfortunately not a solution for me, so that could become a showstopper for me :-(
A) My solution is to use similar bit stuffing, byte stuffing, i.e. after two consecutive ""2B"" a redundant byte is inserted by the microcontroller and must be removed at the host side afterwards before decoding.

Regards
Andy"
3165,5556,"I assume you have checked that expected FA 18 actually come in the packets from the network.

I see you deactivate CS slightly later than RD.  Try activating and deactivating them together at the same time, if it is possible by your design. Can somebody give a support on this issue?

After verifying more samples from the stock, we found even the chips with the same prints can produce the different performance. E.g. two chips with the same print 'PMHN1-010 1704', one has the byte missed issue, but the other does not have. We are still investigating our PCB and peripherals to W5300 but did find valuable clues to go forward.

So I appreciate if someone from the support team provide us some ideas that what is the potential reason for this phenomenon. Is it clock, register mis-configured, time sequence, or anything else?

The customer system test has to be suspended due to this finding. We earnestly look forward to your response. Thanks a lot! Another interesting finding is, if we changed certain bytes value in the packet (from the 3rd party device), the byte missing phenomenon will disappear.

As described originally in this post, the test packet was
00 3F 00 6E 00 00 00 39 6E 03 36 F9 A0 9F FF D5 54 81 FF E0 07 C3 FF 11 FF 00 00 **FF  FA** **18  FF** FF F5 3F FF 24 A9 FF F9 C0 00 7F DF FF FD 00 00 00 01 AF FF BF 1F FF FA FF FF FF FF 55 5F FD B5 01 FF

If I changed FF FA to 00 00, the bytes missing phenomenon disappeared!
00 3F 00 6E 00 00 00 39 6E 03 36 F9 A0 9F FF D5 54 81 FF E0 07 C3 FF 11 FF 00 00 **00  00** **18  FF** FF F5 3F FF 24 A9 FF F9 C0 00 7F DF FF FD 00 00 00 01 AF FF BF 1F FF FA FF FF FF FF 55 5F FD B5 01 FF

Further, I found the edge value is FE FF / FF 00. That means, if the value of this 16-bit is equal or larger than FF 00, the bytes missing phenomenon will happen; otherwise, the bytes missing phenomenon cannot observed.

We were using Modbus TCP protocol from application level to identify and test this issue. But currently we do not believe it is related to protocol because the bytes missing phenomenon was captured on the interface of data reading from W5300.

Modbus TCP protocol does not have CRC on application data level, so it cannot detect the corrupted data and just put the received bytes into local memory. For other protocols which have CRC on application data, the abnormal packet will be discarded directly without impacting the local memory of user program. And at the same time, as explained at the beginning of this message, the issue is also binary content dependent (as least it is what I observed so far), so these might be the reasons we did not detect this before.

Thanks! Does [this](https://forum.wiznet.io/t/topic/1736/6) sound similar? Thanks for telling me this story, Eugeny. 
I have forwarded it to my hardware colleague (sorry I am not) and also had a browsing.
As I understood, it seems two changes made a difference

> Update: I am working with WIZnet to make new design in 3v3 environment. It appeared that my original design was not so bad as one may think, but it could have been better. We have found the way making W5100 working properly in it by changing timing of the control signals, in particular delaying /RD signal deactivation

In our system, CPU operates W5300 using memory mapping so may be different to your system. As I tried so far, it seems I cannot control RD signal separately by changing CPU control register solely.
How did you make it? In FPGA?

> Update: [https://www.youtube.com/watch?v=BsEx56HTo_A ](https://www.youtube.com/watch?v=BsEx56HTo_A). W5100 works. I also found out that original control signals I was feeding to the CPLD and W5100 were noisy up to malfunction of the high-speed logic (this should have also played a role in W5100-related issues). Seems W5100 does not have much logic to fight against it. I had to implement sophisticated circuitry in FPGA to remove the noise (as I did not find decent hardware solution to it - pullups, pulldowns, RC filter).

I appreciate if you share more details you did with FPGA codes so we will review if we can do similarly on our board. [quote=""sensiwood, post:7, topic:5556""]
How did you make it? In FPGA?
[/quote]

Yes. The trick is to deactivate RD and CS together. I did deactivate RD several nanoseconds earlier, and it caused this issue. I have no explanation for this effect. But the fix worked, since then I had no single issue with data corruption.

Noise may also be a significant factor in my opinion. W5x00 are high speed high precision devices, and small spike on the input pin may be treated as legitimate change of the level causing issues in driving the chip further. As I underdstand the probability of the issues in 5V signalling environment is much higher that in native 3.3V environment. The cause of the issue can be simple, and not much ""dependent"" on the W5x00 chip itself: 5V environment, or noisy signals may cause false positive, and W5x00 treats this noise as data access. For example, RD is being deactivated before CS us deactivated, but there's a ""closing"" spike in 0-5V scale down to 1V on RD line, and W5300 thinks that host reads the data, and increases the counter. That's why these two bytes are being ""eaten"" from the stream. Of course WIZnet may have made some measures against this issue, but it is (a) consumes silicon considerably (I did this task for one of my devices), and (b) then there will be a probability of false negatives.

I am speculating here as I do not know definite answer :) can only provide educated guess.","Q) I assume you have checked that expected FA 18 actually come in the packets from the network.
A) I appreciate if someone from the support team provide us some ideas that what is the potential reason for this phenomenon. Is it clock, register mis-configured, time sequence, or anything else?

Q) Try activating and deactivating them together at the same time, if it is possible by your design. Can somebody give a support on this issue?
A) Yes. The trick is to deactivate RD and CS together. I did deactivate RD several nanoseconds earlier, and it caused this issue. I have no explanation for this effect. But the fix worked, since then I had no single issue with data corruption.

Q) We have found the way making W5100 working properly in it by changing timing of the control signals, in particular delaying /RD signal deactivation. How did you make it? In FPGA?
A) Yes. The trick is to deactivate RD and CS together. I did deactivate RD several nanoseconds earlier, and it caused this issue. I have no explanation for this effect. But the fix worked, since then I had no single issue with data corruption.

Q) I appreciate if you share more details you did with FPGA codes so we will review if we can do similarly on our board.
A) Noise may also be a significant factor in my opinion. W5x00 are high speed high precision devices, and small spike on the input pin may be treated as legitimate change of the level causing issues in driving the chip further. As I underdstand the probability of the issues in 5V signalling environment is much higher that in native 3.3V environment. The cause of the issue can be simple, and not much ""dependent"" on the W5x00 chip itself: 5V environment, or noisy signals may cause false positive, and W5x00 treats this noise as data access. For example, RD is being deactivated before CS us deactivated, but there's a ""closing"" spike in 0-5V scale down to 1V on RD line, and W5300 thinks that host reads the data, and increases the counter. That's why these two bytes are being ""eaten"" from the stream. Of course WIZnet may have made some measures against this issue, but it is (a) consumes silicon considerably (I did this task for one of my devices), and (b) then there will be a probability of false negatives."
3166,5558,"Sorry it this is in the wrong spot.  We are using the WIZ850io modules which use the w5500 chip for a device.  It will connect and work fine for awhile, then we will get the activity LED on the module to stick on.  It will stay on after a software reset or toggling the reset pin low for 500ms then back high.  Once this occurs the device will reconnect but in a strange way.  Ping request may or may not be answered.  We have 3 sockets in use one for a tcp connection one for udp and another tcp socket.  once the device gets in this state they all become unstable.  The only way to get it back to a good state is to remove power from the device.

Any ideas were to start looking? W5500 thinks it receives something. Sounds like PHY issue.

[quote=""Lon_Hemmen, post:1, topic:5558""]
It will stay on after a software reset or toggling the reset pin low for 500ms then back high.
[/quote]

This is strange because hardware reset is expected to reset PHY, and after hardware reset the behavior must change (may continue ACT being lit, or return to normal service).

I have similar situation with W5100 sometimes, not exactly the same though. Hub device ASUS GX1005B, something when powering W5100 connected to it chip shows constant activity, while there're no packets on the wire. Hardware reset solves the issue. And it only happens with this hub, I tried several other devices, no problems with them.

Thus please try connecting with (or through) another network device to see if behavior will change. Also detail if ACT LED turn on steady or blinks like there's something on the wire. If it is lit steadily then it may be the sign of lock-up, and thus power quality is under suspicion. Thank you for the reply.  I have tried 2 other network switches both from different manufacturers.  I can do this while it is in this state and no difference.  I will double check my power but I don't believe that to be the issue unless this device is very very sensitive.  We also have a couple of ADC and op amps for different analog measurements and I need it to be clean for these.

It doesn't happen often and I really have to push it to get it into this state.  I am leaning towards an ungraceful disconnect from the server it connects to.

Power do the device is 3.33V to 3.38V [quote=""Lon_Hemmen, post:3, topic:5558""]
I have tried 2 other network switches both from different manufacturers.
[/quote]

Ok, good. I assume W5500 goes into this state for both?

[quote=""Lon_Hemmen, post:3, topic:5558""]
It doesn?Ât happen often and I really have to push it to get it into this state.
[/quote]

Push it? Can you please explain?

[quote=""Eugeny, post:2, topic:5558""]
if ACT LED turn on steady or blinks like there?Âs something on the wire
[/quote]

You did not answer this.

[quote=""Lon_Hemmen, post:3, topic:5558""]
Power do the device is 3.33V to 3.38V
[/quote]

This is average power level if you measure if with multimeter. You must take scope and see what is going on in there at microsecond scale. Sorry... with pushing it I meant the amount of data that we are transmitting.  
ACT LED is steady.  no blinking unless I reset the device but then it comes right back on solid.
that is from a scope 80mv pk to pk ripple. Digging deeper into circuitry I see that W5500 does not have RX LED, it only has ACT LED and LINK LED. Thus my knowledge does not apply here and I can not qualify if for W5500 ACT LED turned on means lock-up or RX storm.

[quote=""Lon_Hemmen, post:5, topic:5558""]
with pushing it I meant the amount of data that we are transmitting.
[/quote]

When you do it, how ACT LED looks like? Does it turn on steady (or almost steady), or blinks (e.g. 2 cycles per second)? stays on steady no blinking at all.

It will stay on after reset pin toggle or a software reset.  I can also disconnect the network cable plug it back in.  The link light will come on with the ACT LED on solid.  The only way to clear it is a complete power cycle.

Shouldn't be a RX storm I can have only the device connected to a switch and disconnect the switch from the network and there will not be a change.

It is weird.  The device will respond to some traffic in this state but not all of it and it is very random as to what or when it will respond. [quote=""Lon_Hemmen, post:7, topic:5558""]
stays on steady no blinking at all.
[/quote]

Seems like W5100 has ACT LED functioning like combination of RX and TX activity LEDs.

[quote=""Lon_Hemmen, post:7, topic:5558""]
The link light will come on with the ACT LED on solid.
[/quote]

This means that PHY actually sees the link loss and cable disconnect.

[quote=""Lon_Hemmen, post:7, topic:5558""]
Shouldn?Ât be a RX storm I can have only the device connected to a switch and disconnect the switch from the network and there will not be a change.
[/quote]

In my case there was no one, but chip was thinking it receives something dues to issues with PHY. I foun dout that I have used too high temp when soldering the chips. Only chip replacement has helped, soldering manually at 305 C.

[quote=""Lon_Hemmen, post:7, topic:5558""]
It is weird. The device will respond to some traffic in this state but not all of it and it is very random as to what or when it will respond.
[/quote]

Are these off the shelf board you manually assembled them?
How many boards did you try? These are WIZ850io modules Rev 1.0 made by Wiznet.  It does happen on multiple boards.  This is a preproduction run which we have been field testing but this particular problem will keep us from going to production using these boards unless I can figure it out.  I chose these because they were easy to use and the software library that Wiznet has on gethub works pretty well. So let's summarize.

You have genuine WIZnet devices, several of them. They all behave weirdly like you describe - after some time of operation it turns ACT LED on, and communication of hindered. When you perform hardware or software reset ACT LED turns off during reset, and then turns on steady again (right?). If you disconnect cable ACT LED turns off, and when you reconnect it again comes lit. If you power cycle the W5500 then situation is remedied (does it also mean you power cycle the controller driving the W5500?).

I do not believe you have faulty boards. There must be something else. The cause might be outside of the board - from network side or from its SPI side, or may be inside the board.

You have checked power with scope, and ensured that power, at any given nanosecond, is within specification. You reset W5500 pulling reset pin low for 500 ms (half of the second). You have checked that boards work with different switches, and board initially work and then ""lock up"".

Now it is time to check SPI side programming.

You must wait for some time (1 ms, per datasheet) after you bring reset inactive before configuring W5500. You must not start programming immediately after RST goes high.
You must ensure that MCU does not continuously send commands to the W5500 like SEND or RECV - these actions will cause LEDs blinking or being lit. Simple test - when ""lock up"" happens deactivate SPI bus (e.g. by pulling its connector out, but preserving grounding). I pull the reset pin low for 500ms then set it high then wait for almost a second.
Then for a sanity check I check the ID of the device.
Then configure xmit and recv buffers then device config mac, ip, mask and such.  Then go on and attempt to connect to the server application, and open a UDP socket.

I though about the possibility of hitting the SPI port to hard or continuously but I can stop the port and processing with the CPU debugger.  when this occurs I can break the processor so nothing is going on and watch the SPI bus stop.

It is strange to me that with both a software and hardware reset the device still comes up in this mode.  It does return the correct ID and responds to the SPI communications just fine.  It will even connect to the server just very intermittently.

There really isn't that much traffic being sent a status message of 97 bytes every 30 seconds then IO messages of 128 bytes as they occur hours apart or a few seconds apart depending on what the device is doing. 

I won't rule out something from the outside network but trying to find information on the device has been a bit tough.  Are there know packets that can put the W5500 into a wierd state? [quote=""Lon_Hemmen, post:11, topic:5558""]
I pull the reset pin low for 500ms then set it high then wait for almost a second.
[/quote]

Good. Can you also check that after reset chip has ""blank"" registers? For example, source IP address is reset to 0.

[quote=""Lon_Hemmen, post:11, topic:5558""]
open a UDP socket
[/quote]

So you use UDP, not TCP... Put PC in bridge mode in between of the W5500 and another device so that Wireshark installed on it capture everything on the wire. I am interested in seeing what is going on the network when W5500 enters this state. By the way, nothing logged will not mean there's nothing in there. There could still be invalid packets travelling being discarded.

[quote=""Lon_Hemmen, post:11, topic:5558""]
I though about the possibility of hitting the SPI port to hard or continuously
[/quote]

It is not about the speed (if you are within spec of course). It is about performing wrong things to the W5500 (like sending some commands to the chip at unexpected times).

[quote=""Lon_Hemmen, post:11, topic:5558""]
when this occurs I can break the processor so nothing is going on and watch the SPI bus stop.
[/quote]

So do you confirm that when you stop SPI with debugger W5500 still has ACT LED lit?

[quote=""Lon_Hemmen, post:11, topic:5558""]
It is strange to me that with both a software and hardware reset the device still comes up in this mode.
[/quote]

This is not strange, this is close to impossible :)
Do you do reset properly? Right pin is being toggled? As I said before it may happen only in case there's some activity from the outside: either MCU forces W5500 doing something, or there's something in the network causing chip thinking it captures frames, or must respond to some incoming frames (e.g. ARP requests).

By the way, what MAC address do you use? I will check the registers the next time I get it into this state.  It isn't frequent and tough to catch.

I have a TCP connection and a UDP socket going.  UDP is rarely used.  99% of time it is TCP.

Yes when I stop SPI or the main CPU the ACT LED will stay on solid.

The Reset Pin is the pin being toggled.  When the device get's in this state I can also reset the entire board with my debugger.  The CPU and device get reset at the same time.  download a new image and start debugging.  It will stay in this state until a complete power cycle.

MAC address:  00:50:C2:63:B3:3C  I have verified that it is not duplicated on our network. I'll switch it back.  But I had forced it to this mode due to an issue we had with a switch not playing nice with Auto-negotiotion.  We will see what happens. Well with Auto-negotiation back on we did manage to get it back in to the activity LED back on solid.  This one really has me stumped.  We think it may be tied to an unexpected hardware disconnect.  say a switch getting power cycled or even unplugging the network cable during a transmit.  Which would normally be OK.  We can detect that and possibly reset the device if necessary but when the device is stuck in this mode it take a complete power cycle to bring it back to normal.

Does WIZnet monitor these threads and could they comment? @midnightcow can you please advise? Any idea on the action plan to troubleshoot further to find out the cause of the issue?

@Lon_Hemmen probably good idea to play around with Wireshark seeing what is going on in the wire. For the clean test you must put the Wireshark device in between of W5500 and switch. Let me know if you need more information on how to do it. working on getting a laptop setup for bridging.  I don't have a hub laying around to use won't be ideal will have to bridge wired to wireless. [quote=""Lon_Hemmen, post:19, topic:5558""]
working on getting a laptop setup for bridging.
[/quote]

Whatever media will be at the other end. You will be able to capture packets on both physical segments. The screen shot does not list some packets (look at No.). The visible list should not cause ACT LED lit. Please dive into remaining packets, especially those appearing on the W5500 interface side. [quote=""Lon_Hemmen, post:23, topic:5558""]
BTW Eugeny than you for your time on this :slight_smile:
[/quote]

Thank you. I am out of constructive ideas so far, the only comes to mind is try change every module changeable (e.g. power supply with another type, processor with another board, cables etc) and blindly look at differences.

I am inclined to think there's something wrong with the modules (WIZnet will not like it!). I think modules are produced on the contract, thus even if WIZnet makes good chips they may be defected down the road - manufacturer of the board, then handling, then when using... The obvious thing is that as soon as you have several modules behaving the same way either we do something wrong to the module, or something wrong with the module.

So summarizing: W5500 enters the mode when:

- if it is connected to switch with no other devices connected to it, it flashes ACT LED, and there's no traffic on the wire;
- stopping SPI communication does not stop the flashing (thus it is not software doing something to the chip);
- only power cycles cures. Hardware/software reset makes no difference. you Summary is correct except the ACT LED stays on solid not flashing.
* if it is connected to switch with no other devices connected to it, ACT LED on SOLID, and there?Âs no traffic on the wire;
* stopping SPI communication does not clear the ACT LED(thus it is not software doing something to the chip);
* only power cycles cures. Hardware/software reset makes no difference.

At this  point I think we may have to look at a different solution.  I haven't been able to get a support reply.  I hate to do since this was a perfect fit for what we were trying to do.  Eugeny thank you for you help on this. well I haven't given up quite yet.  after reading through the forum I found this thread: https://forum.wiznet.io/t/topic/3602

the state of the ACT LED isn't mentioned but the W5500 was getting in to a funky state.  I have modified teh WIZ850io to remove the ferrite bead between AGND and DGND and changed the damping resistors to 0 ohms.  Now we haven't been able to get the W5500 stuck in the funky state with the ACT LED on constantly.  I am not going to call this fixed yet.  We are going to stress the unit for a few days and see what happens.

If this works we will just add the W5500 to our boards instead of the WIZ850io and a way to power cycle the device from the micro.  Fingers crossed. Hello forum,
we are using the WIZ850io modules on our board since 2016 and have used some hundreds of them without problems. 
But with the last bunch of about 50 boards we have on many of them exactly the same wired behaviour of the WIZ850io module  that was discussed in this thread.

After a undetermined duration of normal function the WIZ850io stop working:
- Activity LED and Link-LED are permanently on
- No stable ethernet communication to host pc is possible
- Ethernet communication traced with wireshark shows many retransmits

If i disconnect the ethernet cable:
- Activity LED and Link-LED are off 

If i reconnect the ethernet cable:
- Activity LED and Link-LED are immediatly and permanently on 

Holding the reset pin low for many seconds:
- Both LEDs are off

After releasing the reset pin with cable connected:
- Activity LED and Link-LED are immediatly and permanently on 

Only a power down/up can bring the WIZ850io module back to normal operation.

Unfortunatly we do not know how we can reproduce this wired behaviour. It happend undetermined, and so we can not select good modules.

Was there any change in hardware in 2019 to the WIZ850io module, because with the older modules we have not seen such as wired behaviour? Are modules geniune?

[quote=""hafnerm, post:27, topic:5558""]
After releasing the reset pin with cable connected:

* Activity LED and Link-LED are immediatly and permanently on
[/quote]

When cable is reconnected the round of negotiations must be performed (I guess unless you hardwired the W5500 to specific configuration through PMODE pins) , and if there was PHY error, it is usually cleared. In your case it is not, thus the problem can easily be outside of the W5500 (but can also be interoperability issue). Any changes in infrastructure (e.g. using new models of hubs/switches)?

As test:

- reset driving microcontroller, but not W5500. This way we will check how activities from MCU affect this behavior of W5500;
- after this happens, plug another netowrk cable to the W5500, but with guaranteed no traffic (e.g. standalone hub with only one device - W5500 - connected to it). This way we check if the issue is caused by the storm in the wire. - Yes, the parts are genuine.

- No changes to the infrastructure, same type of netgear 100M ethernet switch used .

- Holding our microcontroller in reset dosn't change the behaviour of the WIZ850io module.
  If the WIZ850io module is in the wired state (both LEDs are permanently on) after some hours of normal working: 
-- Holding our microcontroller in reset: 
   --> nothing change, both LEDs are premanently on
-- our MC is permanently in reset for the next steps.
-- Disconnect the ethernet cable: 
   --> both LEDs changing immediatly to permanently off
-- Reconnect the ethernet cable, with no other connections to the ethernet switch: 
   -->both LEDs changing immediatly to permanently on
-- PowerDown/Up to the board and holding our MC in reset and no powercycle to the ethernet switch: 
   -->WIZ850io module behaviour is returned to normal operation What is the temperature of the chip? What is exact power supply voltage? Can you measure the current being consumed in normal and in this this faulty condition?

Can you confirm that in this condition communication is possible, however unstable?

Can you perform changes mentioned by @Lon_Hemmen in his last post - ferrite bead and damping resistors, or at least check that they are of correct value? In general - inspect the board with the magnifier and compare its components to the circuit diagram. - Chip temperature: i don't know, because it is not accessible. Ambiente temperature is about 30ÃÂ°C

- Powersupply voltage is about 3.3V, and it must be > 3.15V, because our MC is running and we have a supervisor IC with a threshold level of 3.15V

- No i can't measure the current consumed by the WIZ850io, but it will not be the 700mA mentioned in the thread [High temperature and high consumption ](https://forum.wiznet.io/t/topic/3602) , because our 3.3V linear voltage regulator can't provide so much current.

- No i can't check and change the damping resistors and the ferrit bead, because the WIZ850io is soldered on our board and so the parts are not accessible for me

I have the problem that i don't have a test-setup where i can reproduce the failure, do some changes and check again.
The WIZ850io modules are part of our testsystems that is running at our customers a few 100km away from me. And the ethernet failures are stopping the testsystems and this is not practicable for our customers. So for a workaround, we have changed the communication from ethernet to USB, because the motherboard for the  WIZ850io has also a USB interface.

I don't understand why we have not seen such problems in the past. Our hardware has not changed, and also the environment has not changed. HI
i have problem 
led always on 
could you tel me how can solvemy problem step by step? could you help me ? Hope you solved your problem already. If not, you need to provide details on what setup you have, and you tries so far, and what software does with the chip.","Q) Any ideas where to start looking? W5500 thinks it receives something. Sounds like PHY issue.
A) This is strange because hardware reset is expected to reset PHY, and after hardware reset the behavior must change (may continue ACT being lit, or return to normal service).

Q) Push it? Can you please explain?
A) Push it? Can you please explain?

Q) You did not answer this.
A) You did not answer this.

Q) Seems like W5100 has ACT LED functioning like combination of RX and TX activity LEDs.
A) Seems like W5100 has ACT LED functioning like combination of RX and TX activity LEDs.

Q) This is not strange, this is close to impossible :)
   Do you do reset properly? Right pin is being toggled? As I said before it may happen only in case there's some activity from the outside: either MCU forces W5500 doing something, or there's something in the network causing chip thinking it captures frames, or must respond to some incoming frames (e.g. ARP requests).
A) This is not strange, this is close to impossible :) Do you do reset properly? Right pin is being toggled? As I said before it may happen only in case there's some activity from the outside: either MCU forces W5500 doing something, or there's something in the network causing chip thinking it captures frames, or must respond to some incoming frames (e.g. ARP requests).

Q) Can you also check that after reset chip has ""blank"" registers? For example, source IP address is reset to 0.
A) Can you also check that after reset chip has ""blank"" registers? For example, source IP address is reset to 0.

Q) Any changes in infrastructure (e.g. using new models of hubs/switches)?
A) Any changes in infrastructure (e.g. using new models of hubs/switches)?

Q) What is the temperature of the chip? What is exact power supply voltage? Can you measure the current being consumed in normal and in this this faulty condition?
A) What is the temperature of the chip? What is exact power supply voltage? Can you measure the current being consumed in normal and in this this faulty condition?

Q) could you tel me how can solvemy problem step by step? could you help me ?
A) Hope you solved your problem already. If not, you need to provide details on what setup you have, and you tries so far, and what software does with the chip."
3167,556,"hello

I have inquiries about technical support, so I left an article.

We want to send a lantern data transmission between the DSP (TMS320C28346) and the PC using the W5300.

1. I wonder if technical support is possible directly about this part.

    We visit your company, or visit my company, or it doesn't matter either way.

2. If possible, I would like to know what procedures are needed, if the cost is charged, or how much you can expect. I will send you a message. [B] [Size = 150] [color =#0040FF] Direct technical support can be supported through the agency who purchased the product. [/color] [/size] [/b] hello...

When we make two products, please contact us to receive support for certification.

1. Inquiry of certification support when making a module product of Wiznet

1) If you use the Internet module (wiz811mj) to create a product and get electromagnetic authentication, can you get technical support when you have a problem?

2) Can I get technical support if I need to get a small output wireless authentication when creating a product using Wi -Fi module?

and
Are there any modules that support WiFi Direct among Wi -Fi modules?

thank you We will reply.

1), 2), in the contents of the inquiry, I do not know the scope of technical support required, but
Even if there is a problem in authentication, it is difficult to modify/test the WIZ811MJ and WIZ610WI itself to solve the problem.As a product that is mass -produced in a module mounted on various baseboards, it is difficult to debug about certain products on the module.

We will support WiFi Direct with Wizfi250, and the approximate schedule is held in 2Q.

thank you hello

Please contact us again about technical support.

We have confirmed that technical support is possible through the agency that purchased the product.

We purchased at Wiznet Shop, not an agency.

In this case, I wonder how you can get technical support.



We want to send a lantern data transmission between the DSP (TMS320C28346) and the PC using the W5300.

1. I wonder if technical support is possible directly about this part.

We visit your company, or visit my company, or it doesn't matter either way.

2. If possible, I would like to know what procedures are needed, if the cost is charged, or how much you can expect. First of all, if the problem is not solved after fully identified with the forum, e-mail or telephone,
Direct support is required.

If you are in a hurry, please call the WizNet SCM team.","Q) Can I get technical support for sending lantern data transmission between the DSP (TMS320C28346) and the PC using the W5300?
A) Direct technical support can be supported through the agency who purchased the product. If the problem is not solved after fully identified with the forum, e-mail or telephone, direct support is required.

Q) What procedures are needed for technical support, and is there a cost involved?
A) Direct technical support can be obtained through the agency who purchased the product. If the problem is not solved after fully identified with the forum, e-mail or telephone, direct support is required.

Q) Can I get technical support for certification when creating a product using Wiznet modules?
A) Even if there is a problem in authentication, it is difficult to modify/test the WIZ811MJ and WIZ610WI itself to solve the problem.  We will support WiFi Direct with Wizfi250, and the approximate schedule is held in 2Q. Technical support can be obtained through the agency that purchased the product. If the problem is not solved after fully identified with the forum, e-mail or telephone, direct support is required.

Q) How can I get technical support if I purchased from Wiznet Shop?
A) Technical support is possible through the agency that purchased the product. If the problem is not solved after fully identified with the forum, e-mail or telephone, direct support is required. If you are in a hurry, please call the WizNet SCM team."
3168,5560,"I did not program W5300, but it seems you skip one important step:

    /* check previous SEND command completion */

    if (is first send ?) ; /* skip check Sn_IR(SENDOK) */
    else
    {
        while(Sn_IR(SENDOK)==????
        {
            if(Sn_SSR == SOCK_CLOSED) goto CLOSED state; /* check connection establishment */
        }
        Sn_IR(SENDOK) = ???? /* clear previous interrupt of SEND completion */
    }

I think in your case you try to launch another SEND process while previous did not finish yet.

[quote=""jmattfeld, post:1, topic:5560""]
due to the real-time DAQ nature of the application, dropping frames is not an option
[/quote]

While TCP is reliable communication, sometimes it may not be up to speed, and this is what you see. It may be issue with/caused by any network device, and it is a reality. For high loaded networks you will see even worse picture with bigger delays and other transmission problems.

If dropping frames is not an option, then you must check for SEND command complete as described in datasheet, and store pending data in MCU's buffers, implementing simple memory management so that when SEND command finally completes you send all waiting data at once (as an example, then there will be larger packets than 348 data bytes). Timing will not be accurate, but at least no data loss.

If dropping of sampling data is allowed and timing is more important, then you'd better use UDP. It does not require ACK, but your application will not know if frame was delivered and when it happened. Eugeny, thank you for your response.

The following code is intended to check the Sn_IR that the SEND cmd has completed and then clear the SENDOK bit:

```
tmp = getSn_IR(nFd);
        if (tmp & Sn_IR_SENDOK)
        {
            setSn_IR(nFd, Sn_IR_SENDOK);
            sock_is_sending &= ~(1<<nFd);
        }
```
I should add that the LAN that I am using to transmit the DATA has only two hosts (my PC and the MCU device) so I feel that it could not be characterized as a ""high loaded network"".

I think that unless I find some other root cause of the issue my next step would be to buffer up frames in the MCU as you suggested when I detect the event starting to occur then send them in larger packets in hopes of recovering from the delay. [quote=""jmattfeld, post:3, topic:5560""]
The following code is intended to check the Sn_IR that the SEND cmd has completed and then clear the SENDOK bit:
[/quote]

I see now, apologies.

May it happen that interrupt occurs when previous service did not finish yet, and you just corrupt the workflow? Do you disable interrupts in the ISR? [quote=""jmattfeld, post:5, topic:5560""]
to see if the issue is with the W5300 or as a result of the ISR handling.
[/quote]

You just set flag that you are currently in ISR, and check it on the entrance and log event that you have entered ISR if ISR flag is set.

**Update:** I propose you to change architecture of the software. You log data using ISR into MCU's RAM, and in main loop send accumulated data when socket becomes ready. Most of the times it will send 348 bytes packet, but in case two or more interrupts occur in between, you send 348 * number of interrupts happened at once.","Q) May it happen that interrupt occurs when previous service did not finish yet, and you just corrupt the workflow? Do you disable interrupts in the ISR?
A) You just set flag that you are currently in ISR, and check it on the entrance and log event that you have entered ISR if ISR flag is set.

Q) The following code is intended to check the Sn_IR that the SEND cmd has completed and then clear the SENDOK bit:
A) tmp = getSn_IR(nFd);
        if (tmp & Sn_IR_SENDOK)
        {
            setSn_IR(nFd, Sn_IR_SENDOK);
            sock_is_sending &= ~(1<<nFd);
        }

Q) The following code is intended to check the Sn_IR that the SEND cmd has completed and then clear the SENDOK bit:
A) I see now, apologies.

Q) I did not program W5300, but it seems you skip one important step:
A) If dropping frames is not an option, then you must check for SEND command complete as described in datasheet, and store pending data in MCU's buffers, implementing simple memory management so that when SEND command finally completes you send all waiting data at once (as an example, then there will be larger packets than 348 data bytes).

Q) due to the real-time DAQ nature of the application, dropping frames is not an option
A) While TCP is reliable communication, sometimes it may not be up to speed, and this is what you see. It may be issue with/caused by any network device, and it is a reality. For high loaded networks you will see even worse picture with bigger delays and other transmission problems.
"
3169,5561,"Hi, in my W5100 module when i have not send any packet from PC to Board (and wireshark page is empty), the RX led lightening about 5 times in a second!
why? Is board custom made? Yes, That's so. I'm using an FPGA custom designed board  with a W5100 ""module"" . The Module Directly  connected to PC(without any switched or ...) I use W5100 module and connect it to my solder FPGA board. So i don't solder the W5100  manually, only FPGA board is soldered manually.

and about second question, Yes this is the same board and it works good but this problem.

and  5 times per second is an estimate with unequipped eye. when this problem occur:
 => S0_SR = 0x14(listen mode)
INT  => '1'
and Packet sender could not connect to device","Q) Why does the RX led light up about 5 times in a second when there are no packets sent from the PC to the board and the Wireshark page is empty?
A) The RX led lights up because I am using an FPGA custom designed board with a W5100 module directly connected to the PC, and the issue occurs when S0_SR is in listen mode and the packet sender could not connect to the device. The estimated frequency is around 5 times per second."
3170,5562,"Is it possible use W6100 by bypassing its TCP/IP stack? 
My host controller uses a LWIP stack that controls other interfaces too. So, I would like to just use the PHY or MAC/PHY of W6100. 

If yes, could you point me to example codes if they are available? I am using the W6100.

TCP Window Full occurs.Is there an API to be solved?","Q) Is it possible use W6100 by bypassing its TCP/IP stack? My host controller uses a LWIP stack that controls other interfaces too. So, I would like to just use the PHY or MAC/PHY of W6100. 
Q) If yes, could you point me to example codes if they are available? I am using the W6100. 
A) TCP Window Full occurs. Is there an API to be solved?"
3171,5565,"Dear AlexeiBazlaev!

DNS_time_handler() shoud be registered to one of   W7500's 8 timers. 

 how to use W7500X timer refer to  [here](https://github.com/Wiznet/W7500x_StdPeriph_Lib/tree/master/Projects/W7500x_StdPeriph_Examples/WZTOE/WZTOE_DNSClient) [quote=""midnightcow, post:2, topic:5565""]
DNS_time_handler
[/quote]

Thank you very much!
Now i see where i was mistaken!","Q) How to use W7500X timer for DNS_time_handler()? 
A) You can refer to the following link for information on how to use W7500X timer: [here](https://github.com/Wiznet/W7500x_StdPeriph_Lib/tree/master/Projects/W7500x_StdPeriph_Examples/WZTOE/WZTOE_DNSClient) [quote=""midnightcow, post:2, topic:5565""] DNS_time_handler [/quote]. 
"
3172,5566,"We are using the W5100S with the WIZnet library. How big would the impact be, regarding the software, if we would migrate to the W6100? Hi Daan

W5100s can't migrate W6100 about software.
They use a different iolibrary, and register name / address is also different.
They can migrate about only hardware.

thanks,
best regards,
irina Thanks for your clear reply Irina!","Q) We are using the W5100S with the WIZnet library. How big would the impact be, regarding the software, if we would migrate to the W6100? 
A) W5100s can't migrate W6100 about software. They use a different iolibrary, and register name / address is also different. They can migrate about only hardware. 

Q) Thanks for your clear reply Irina! 
A) None."
3173,5567,"Our microcontroller knows 16 bit as the smallest memory reservation, so even if we declare a variable as uint8_t or char, 16 bits will be reserved. We would like to connect our MCU to the W6100 through SPI; will the library suit this 16 bit restriction, or are there 8 bit operations/functions which will definitely need to be rewritten? Hello Daan

What microcontroller do you use?

Even though microcontroller core's bus is 16bit, it can access 16bit also 8bit typically.

It sounds interesting that your microcontroller smallest memory reservation is 16bit. Our microcontroller is of Texas Instruments: TMS320F28377S, it doesn't support 8 bit variables. I agree, it's a quite unusual processor.

Will this be an issue for the ioLibrary? DSP is a special microprocessor.

If you can read / write 8bit to w6100 with spi, you can use any microprocessor of TI.

But the io6Library was not created considering that the char type variable is 16 bits.

so you need to modify some c codes and test.

I am sorry that I don't have a working example on the dsp that I can provide.","Q) What microcontroller do you use?
A) Our microcontroller is of Texas Instruments: TMS320F28377S, it doesn't support 8 bit variables. I agree, it's a quite unusual processor.

Q) Will this be an issue for the ioLibrary? DSP is a special microprocessor.
A) If you can read / write 8bit to w6100 with spi, you can use any microprocessor of TI. But the ioLibrary was not created considering that the char type variable is 16 bits, so you need to modify some c codes and test.

Q) Hello Daan
A) I am sorry that I don't have a working example on the dsp that I can provide."
3174,5569,"https://forum.wiznet.io/t/topic/4556/1

Administrator!Please delete the data attached to this topic.
If you do not delete the attached data, please delete all the subjects. Thanks for letting us know. We agree there is an issue and we've removed the post.","Q) Administrator! Please delete the data attached to this topic. If you do not delete the attached data, please delete all the subjects. Thanks for letting us know. 
A) None."
3175,5570,"https://forum.wiznet.io/t/topic/4401/1

Administrator!Please delete the attached materials included in this topic or delete all of them. Thanks for letting us know. We agree there is an issue and we've removed the post.","Q) Administrator! Please delete the attached materials included in this topic or delete all of them. Thanks for letting us know. 
A) We agree there is an issue and we've removed the post."
3176,5571,"https://forum.wiznet.io/t/topic/5430/1

Administrator!Please delete the attached materials included in this topic or delete all of them. Thanks for letting us know. We agree there is an issue and we've removed the post.","Q) Administrator! Please delete the attached materials included in this topic or delete all of them. 
A) Thanks for letting us know. We agree there is an issue and we've removed the post."
3177,5572,"https://forum.wiznet.io/t/topic/3989/1

Administrator!Please delete the attached materials included in this topic or delete all of them. Thanks for letting us know. We're looking into it.","Q) Administrator!Please delete the attached materials included in this topic or delete all of them.
A) Thanks for letting us know. We're looking into it."
3178,5573,"???Â¨Ã­ÂÂ´! ?Â´Ã¬Â Â??[?ÂÃ«Â¡Â?ÂÃ¬ÂÂ Ã«Â¶ÂÃ«Â§Â????(https://forum.wiznet.io/u/crodia93/activity/bookmarks)Ã«Â§??ÂÃ«ÂÂ¬???Â°Ã«Â¦Â¬??ÃªÂ°ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂ¸ ???ÂÃ«? ?ÂÃ¬ÂÂ½ÃªÂ²??Â¤Ã«ÂÂ??Ã«Â³????ÂÃ¬ÂÂ´. ?Â°Ã¬Â¸Â¡ ?ÂÃ«ÂÂ¨???ÂÃ«ÂÂ ?ÂÃ«Â¡Â???Â¬Ã¬Â§ÂÃ«Â§??Â Ã­ÂÂ?ÂÃ«Â©Â´ ?? &#8599;

Next, can you share one of these links with me? Reply with **a link on a line by itself**, and it?Âll automatically expand to include a nifty summary.

To copy any link, tap and hold on mobile, or right click your pointing device:

 <https://en.wikipedia.org/wiki/Inherently_funny_word>
 <https://en.wikipedia.org/wiki/Death_by_coconut>
 <https://en.wikipedia.org/wiki/Calculator_spelling> Hello @crodia93, I didn't have news, so I talked once.

-I can continue to reply to me at any time.

-If you want to skip this stage, you can say 'skipping'.

-If you want to start again, say 'Start a new user'.

Well, even if you don't like it, it's okay.I don't feel bad because I'm a robot.: sob: Why are you feeling bad? Sorry.I couldn't find a link in the reply!: Cry:

Would you like to copy a line below and put it in the next reply?

<https://en.wikipedia.org/wiki/Exotic_shorthair> [quote=""discobot, post:5, topic:5573, full:true""]
https://en.wikipedia.org/wiki/Exotic_Shorthair
[/quote]

https://en.wikipedia.org/wiki/Exotic_Shorthair :sunglasses: That's really: Sparkles: _ It's my mother! _: Sparkles:

Even if you don't write a reply to that person, you need to pay attention to someone.In that case, you can enter the mention by entering the person's ID.

Do you want to use ** '@discobot` ** in the reply? @discobot _In my name!? _: Raised_nd: I think you are!: Wave: Yeah, I'm here!Thank you for telling me.: OK_Hand:

Can you make a dark ** article in the reply or make a_Italic_?

- '** Dark **' or `_Italic _ '.

-If you can press the <KBD> <b> b </b> </kbd> or </i> I </i> </kbd> button in the editor. ** Bold ** Good!You can also write with html or bbcode.[See this tutorial.] (Http://commonmark.org/help): nerd:

When you write a reply to my article, can you quote you to know what you say to me?

> If this is a coffee, please give me a car.
>
> The advantage of myself is that at least one person is listening.
>
> Some people are good at speaking, but others ... Well, no talent.

Select anything in the article written above & uarr;Click the ** button that appears near the selected area ** button.Or you can press the ** Reply ** button under this post.

If you have fulfilled it, write a word about the selected phrase.I wonder what to say.: Thinking: It's a good article ~ [?Â´Ãª???(/t/topic/5573/15)Ã¬Â¢ÂÃ¬ÂÂ??heart: ???ÂÃ«ÂÂ¬ Ã¬Â¤ÂÃªÂ±Â°?? :crying_cat_face: capybara [quote=""discobot, post:1, topic:5573""]
`:herb:` emoji
[/quote]

**`:herb:`  emoji** Yes, I found it!: Tada:

-If you want to search in more detail, go to the Full Search page (https://forum.wiznet.io/search).

-If you want to skip the desired place in a long conversation, try the topic timeline control on the right (on the bottom of the mobile device).

-If you have real: Keyboard: If you have, press </kbd> to find out what is simple shortcuts.","Q) Next, can you share one of these links with me? Reply with **a link on a line by itself**, and it?Âll automatically expand to include a nifty summary.
A) I'm sorry, I couldn't find a link in the reply.

Q) Would you like to copy a line below and put it in the next reply?
A) https://en.wikipedia.org/wiki/Exotic_Shorthair :sunglasses: That's really: Sparkles: _ It's my mother! _: Sparkles:

Q) Do you want to use ** '@discobot` ** in the reply? @discobot _In my name!? _: Raised_nd: I think you are!: Wave: Yeah, I'm here!Thank you for telling me.: OK_Hand:
A) I'm here! Thank you for telling me.

Q) Can you make a dark ** article in the reply or make a_Italic_?
A) You can write with html or bbcode.

Q) When you write a reply to my article, can you quote you to know what you say to me?
A) It's a good article ~

Q) Select anything in the article written above & uarr;Click the ** button that appears near the selected area ** button.Or you can press the ** Reply ** button under this post.
A) Yes, I found it!

Note: The rest of the text does not contain questions or answers."
3179,5577,"[W5100]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------

hello.We are testing the MCU's firmware using the W5100's TCP/IP and a product that communicates with PC -side applications.

The current development is completed, and the W5100 chip extends when the EMI and EMC exams are conducted.

In hardware, it is impossible to modify, and even if the chip extends through the firmware, it is decided to complement it, but there are some problems.

First, if you explain the environment.
1. MCU is used as server and PC side app as client.
2. MCU maintains a listen state after initializing the socket.
3. Attempt to connect from the PC side client and check with each other when confirmed.

It's like this,
-If you connect with your PC, if the chip extends through the noise test, the communication will be broken and the Listen state.
-The second, when the chip extends to the noise test when it is not connected to the PC, it is maintained in a listen state.
If the chip extends like this, if you reset it through the external W5100 reset pin, the chip will come back to life.

I thought the socket was closed when the chip stretched, but I thought it would go to the close state.As a countermeasure, the chip is reset, and the chip is reset.

So the chip is dead and the W5100 has the register information IP, Mac .. etc. I have taken before and after ... The chip was the same as before the chip was extended.It remains the same, but if you shoot a ping test towards the MCU on the PC, it won't go out.

=> Settings information on the chip remains as it is, and only ping tests and communication are not available.(Pychip has a good physical connection, so the LED is also blinking.)

So in conclusion.
Is there a way to make sure that Wiznet's own chip is dead?no see..
At first, so I opened one more socket and set it to the UDP and continued to send the dummy data to the server (if the server was open, I would return the Send_ok to an interrupt register).I thought I should initialize it, but after the ARP is applied, the LAN line is pulled out after the ARP is applied once.
So I found a way to initialize the ARP table, and I sent the dummy data to another IP and came back again, so I had only one ARP table, so I would be initialized.

If you send the data to another IP and come back, Send_OK will float even if you remove the LAN line ...

Anyway, so there is no solution now, so it's in a difficult situation.

Please ask me how to check it when I cut off with the server side. It seems to be ESD fail .....

I can't ping, but I don't think it's a software approach.

The PHY side LED is LED and it must be ping first to approach the next step.

In my view,

I think you need to debug to change the artwork.

It seems to be the primary method to attach an ESD device on the second side of the transformer.

For example, about SP3002? Hello, this is Wiznet.

The inflow path of the external ESD is mostly inflowed through RJ45, so PHY is more likely to damage damage.

Therefore, the symptoms of the ESD shock and the internal PHY of the W5100 will be reset, but the TCP core of the W5100 does not appear to be a reset.

In order to correct this problem, you need to modify the PCB.but..

If you can't modify PCB, there's no way.

Since the W5100 operates on the server, there is nothing you can do.

In this case, in this case, when the client is connected to the server, you will try to reconnect.

Please implement this feature in the client.

thank you","Q) Is there a way to make sure that Wiznet's own chip is dead?
Q) Please ask me how to check it when I cut off with the server side.

A) It seems like the primary method to attach an ESD device on the second side of the transformer. The inflow path of the external ESD is mostly inflowed through RJ45, so PHY is more likely to be damaged. Therefore, the symptoms of the ESD shock and the internal PHY of the W5100 will be reset, but the TCP core of the W5100 does not appear to be reset. In order to correct this problem, you need to modify the PCB. However, if you can't modify PCB, there's no way. Since the W5100 operates on the server, there is nothing you can do. In this case, when the client is connected to the server, you will try to reconnect. Please implement this feature in the client. Thank you."
3180,558,"The W5300 is connected to the external memory interface of the DSP.

I don't think /CS is used because it is used for 1: 1 communication with DSP and PC.

1. Can I always set the LOW state?


The address pins of the DSP are connected to the address pin 0-9 of the W5300.

However, it is said that 0 times is ignored when using the DIRECT mode 16bit data.

2. If so, do you have to connect the address pin 0 ~ 8 of the DSP with the address pin 1 ~ 9 of the W5300?


I mapped the W5300 to ZONE6 and entered the data.(#define __def_iinchip_map_base__ 0x00100000)

However, the data was stored in the next address and the next address, not the address I set.

If you save 25 in 0x100008 address, 25 will be saved in 0x100009 and 0x10000a.

3. Is it a memory problem for the W5300?Or is it a simple DSP setting problem? [quote]1. /CS ??ÂÂ LOW?ÂÃ­ÂÂÃ«Â¥??Â Ã¬??ÂÃ«ÂÂÃ«Â¡??Â¤Ã¬Â Â?Â´Ã«ÂÂ ?ÂÃ«ÂÂ??[/quote]
W5300 ?Â´Ã¬ÂÂ¸ ?Â¤Ã«Â¥Â¸ DeviceÃªÂ°? BusÃ«Â¥?ÃªÂ³ÂµÃ¬ÂÂ ?ÂÃ¬? ?ÂÃ«ÂÂ?Â¤Ã«Â©Â´ /CSÃ«Â¥?LowÃ«Â¡?Ã«Â¬Â¶Ã¬ÂÂ´ ?Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ??Ã«Â¬Â´Ã«Â°Â©?Â©Ã«ÂÂ??

[quote]2. ÃªÂ·Â¸Ã«Â Â?Â¤Ã«Â©Â´ DSP???Â´Ã«ÂÂ?ÂÃ¬ÂÂ¤?? 0~8??w5300???Â´Ã«ÂÂ?ÂÃ¬ÂÂ¤?? 1~9Ã«Â²ÂÃªÂ³Â¼ ?Â°ÃªÂ²Â°?Â´Ã¬ÂÂ¼ ?ÂÃ«ÂÂ??[/quote]
TMS320C286 DatasheetÃ«Â¥??Â´Ã­ÂÂ´Ã«Â³?ÃªÂ²Â°ÃªÂ³Â¼ DSP??Ã«Â°ÂÃ¬ÂÂ´???Â´Ã«ÂÂ?ÂÃ¬ÂÂ±??Ã¬Â§??ÂÃ­ÂÂÃ¬Â§? ?ÂÃ«ÂÂÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. 16bit (Half word) addressing??Ã¬Â§??ÂÃ­ÂÂ??ÃªÂ²ÂÃ¬ÂÂ¼Ã«Â©? ?ÂÃ­ÂÂ Byte accessÃ«Â¥?Ã¬Â§??ÂÃ­ÂÂÃ¬Â§? ?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ¬??ÂµÃ«ÂÂ??
TMS320C286ÃªÂ³?W5300ÃªÂ³Â¼Ã¬ÂÂ InterfaceÃ«Â¥??ÂÃ­ÂÂ´?ÂÃ«ÂÂ 
DSP..............W5300
A[8:0]---------->A[8:0]
D[15:0]<------->D[15:0]
?? ÃªÂ°ÂÃ¬ÂÂ´ ?Â°ÃªÂ²Â°?ÂÃ¬ÂÂÃªÂ³?

iinchip_conf.h ?ÂÃ¬ÂÂ
[code]#define __DEF_IINCHIP_MAP_BASE__ (0x00100000 << 1) // Right Shift ??ÃªÂ²ÂÃ¬ÂÂ´Ã«Â¯?Ã«Â¡?Ã«Â¯Â¸Ã«Â¦Â¬ Left shift ?ÂÃ­ÂÂ¨??[/code]

w5300.c?ÂÃ¬ÂÂ 
[code]
#define MR              (__DEF_IINCHIP_MAP_BASE__)

#define MR0             MR
#define MR1             (MR + 1)

#define IDM_AR          (__DEF_IINCHIP_MAP_BASE__ + 0x02)
#define IDM_AR0         IDM_AR
#define IDM_AR1         (IDM_AR + 1)

#define IDM_DR          (__DEF_IINCHIP_MAP_BASE__ + 0x04)
#define IDM_DR0         (__DEF_IINCHIP_MAP_BASE__ + 0x04)
#define IDM_DR1         (IDM_DR + 1)
//
// omitted.
//
[/code]
?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ??Ã«ÂªÂ¨Ã«ÂÂ  Register Map??
1bit right shift ?ÂÃ­ÂÂ¨ Ã«Â§ÂµÃ¬ÂÂ¼Ã«Â¡??Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬Â Â?ÂÃ¬ÂÂ???Â©Ã«ÂÂ??
[code]
#define MR              (__DEF_IINCHIP_MAP_BASE__)

#define MR0             (MR >> 1)
#define MR1             MR

#define IDM_AR          ((__DEF_IINCHIP_MAP_BASE__ + 0x02) >> 1)
#define IDM_AR0         IDM_AR
#define IDM_AR1         IDM_AR

#define IDM_DR          ((__DEF_IINCHIP_MAP_BASE__ + 0x04) >> 1)
#define IDM_DR0         IDM_DR
#define IDM_DR1         IDM_DR
//
// omitted.
//
[/code]

?? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬Â Â?ÂÃ¬ÂÂ???Â©Ã«ÂÂ??
Ã¬Â¦?XXX0 XXX1 register Ã«Â¥?Ã«ÂªÂ¨Ã«ÂÂ Right shift??ÃªÂ°ÂÃ¬? Ã¬Â£Â¼Ã¬ÂÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ???Â©Ã«ÂÂ??
XXX0 XXX1 register?Â¤Ã¬ÂÂ ÃªÂ°ÂÃ«ÂÂ¤?? D[15:0]??Endian???Â°Ã«ÂÂ¼???Â¤Ã¬Â Â?Â©Ã«ÂÂ??

[quote]3. w5300??Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦?Ã«Â¬Â¸Ã¬Â Â?Â¸Ãª??? ?ÂÃ«ÂÂÃ«Â©??Â¨Ã¬ÂÂ DSP?Â¤Ã¬Â ÂÃ«Â¬Â¸Ã¬Â Â?Â¼ÃªÂ¹Â??[/quote]
2Ã«Â²?Ã«Â¬Â¸Ã¬Â Â???ÂÃ¬ÂÂ¸?Â¼Ã«Â¡Â ?Â¸Ã­ÂÂ ÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡?Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ¤. Thank you very much for your kind answer.

As you said, the text was good.

But I have a few questions.


Looking at the output value of the getsn_ssr function, the number over 8bit has been output.(Ex> 255, 275 ..)

So I am using the return value at the end of the function as follows.

Return (SSR & 0xFF);

1. Why is the output value of the getsn_ssr function be over 8bit?Is there any problem with the method I modified?



After setting up IP, Gateway, Mac, etc., we looked at the memory status.

2. Why is it?
(PING test and text transfer are available.)
[0x100005] 0x0008 0xdc11 ==> (MAC -00.08.DC.111.22.86)
[0x100007] 0x2286 0x0000
[0x100009] 0xc0a8 0x0001 ==> (Gateway -192.168.0.1)



uint32 wiz_write_buf (SOCKET S, UINT8* BUF, UINT32 LEN)
{
(skip)
      For (IDX = 0 IDX <LEN; IDX+= 2) // => For (IDX = 0 IDX <LEN; IDX ++)
(skip)

I check the characters on the PC, but only the data of the odd number of bungee is output

As the above syntax, I modified to increase the index by one, and it came out well.

3. Is there any problem with the method I modified? I'm glad that the basic function has been completed.

1. SN_SSR is 1 byte Register.Therefore, the upper bytes were 0xFF normal output to the reserved area.
   Return (SSR & 0xFF);You can use it as a mask.

  
2.
[Quote] Why is it?
(PING test and text transfer are available.)
[0x100005] 0x0008 0xdc11 ==> (MAC -00.08.DC.111.22.86)
[0x100007] 0x2286 0x0000
[0x100009] 0xc0a8 0x0001 ==> (Gateway -192.168.0.1)
[/Quote]
[0x100005] [0x100007] [0x100009] ==> [0x100004] [0x100006] [0x100008]
Do you mean it should be?If so, it is right.Please check if you display the wrong address at the time of display.
It's a ping, so it's right to see that the W5300 Register was exactly written as an exact address.

[Quote]
uint32 wiz_write_buf (SOCKET S, UINT8* BUF, UINT32 LEN)
{
(skip)
For (IDX = 0 IDX <LEN; IDX+= 2) // => For (IDX = 0 IDX <LEN; IDX ++)
(skip)
[/Quote]
Since 16bit address is used, it is correct to increase one by one.

3. First of all, I have succeeded in ping and data transmission and receiving tests, so there is no big problem.
Even if there is a problem, you can see that the address conversion problem is not completely ported and you can find it and modify it.","Q) Can I always set the LOW state?
A) /CS is not used because it is used for 1:1 communication with the DSP and PC, so you can always set the LOW state.

Q) If so, do you have to connect the address pin 0 ~ 8 of the DSP with the address pin 1 ~ 9 of the W5300?
A) When using the DIRECT mode 16-bit data, the address pins are connected according to the mapping. Thus, you need to connect the address pin 0 ~ 8 of the DSP with the address pin 1 ~ 9 of the W5300.

Q) Is it a memory problem for the W5300? Or is it a simple DSP setting problem?
A) Based on the provided code and explanations, it appears to be an issue related to the memory settings of the W5300, as well as the DSP configuration.

Q) Why is the output value of the getsn_ssr function over 8bit? Is there any problem with the method I modified?
A) The getsn_ssr function outputting values over 8bit may be due to the nature of the function. The method you modified by using the bitwise AND operator (SSR & 0xFF) to limit the output to 8 bits seems correct.

Q) After setting up IP, Gateway, Mac, etc., we looked at the memory status. Why is it? (PING test and text transfer are available.)
A) The memory status you observed after setting up the IP, Gateway, Mac, etc., seems to be related to the memory mapping and address interpretation. It's important to verify the address mapping and memory status for the correct functionality of PING tests and text transfers.

Q) Is there any problem with the method I modified?
A) It seems that the method you modified to handle odd-numbered data by increasing the index by one is appropriate, especially if it resulted in the expected output and completion of basic functions."
3181,5581,"[W5100]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------

hello.Currently, we are using the W5100 to make a check if the server is alive through the UDP.

The current confirmation is that if you shoot UDP to a specific IP with a UDP, the SN_IR register will be shown.

And with the W5100 ARP mechanism I understood, the ARP, which was sent to Sendto, was initialized to the value, and the ARP corresponding to the IP sent to the value was updated, and even if the net is broken (etc.), Send_ok continues toI confirmed that it floated.

So, by sending data to the IP to solve this problem, by sending UDP data back to another IP, the ARP table was reset to confirm that the timeout appears when the LAN line is broken.

This work is done every three seconds, but the problem is when the external network is broken.

If the MCU (W5100 is more appropriate) and the server side PC only through the herbs, the external network is not used.

At this time, if you shoot UDP data from the MCU to the PC side IP, the send_ok will appear, but in the state where the external network is disconnected, the UDP is not updated with other IP.Is this the original ARP mechanism?

The product we use is not connected to the external network, but only the internal network.

PC side IP: 192.168.1.10
MCU side: 192.168.1.11

In this way, only two IP will be used.So when sending dummy data to 19.2168.1.12, UDP ARP should be initialized, but it was not initialized.

Please answer if there is something! Wiznet's TCP/IP chips have previous ARP information.So when you call Sendto next time, you will not perform ARP if you send it to the same IP as before.
If Destination wants to send ARP every time, even if you need to close the socket after calling Sendto (), and when you need to sendto (), you can open the socket () first and keep the order of sendto (), Close ()I hope you.

javakys","Q) Is this the original ARP mechanism for the W5100 when the external network is disconnected and the UDP is not updated with other IP?
A) W5100's ARP mechanism retains previous ARP information, so when you call Sendto next time, it will not perform ARP if you send it to the same IP as before. If you need to send ARP every time, you can close the socket after calling Sendto() and when you need to sendto(), you can open the socket() first and keep the order of sendto(), close()."
3182,5584,"I have the illogical behavior of the chip in the ""Tcp-client"" mode.
If you physically remove the cable from the connector while sending a TCP packet and waiting for a response from the server (ACK), after a few fractions of a second, the ""SendOk"" bit is set in the socket interrupt register, although it is obvious that it is impossible to receive ACK until there is a physical connections.
I could not find an explanation for this phenomenon in the documentation.

Have you come across this? [quote=""voroshilov, post:1, topic:5584""]
although it is obvious that it is impossible to receive ACK until there is a physical connections
[/quote]

It must be proven that ACK message was NOT delivered before you disconnect cable.

Please provide the way to reproduce the issue reliably. As far as I see, it will be about blocking the ACK packet from remote device, and seeing what W5500 is doing. 
The sequence is simple:
1. Open the socket in TCP mode.
2. Connect to a remote server.
3. Send a data packet.
4. Waiting for setting the SendOK flag from the socket interrupt register.
5. Clear the Send Ok flag
6. Return to 3.

If during the execution of this algorithm, after the connection is established, to disconnect the cable, the Send Ok flag will be set to 1 after a short time. And only after 2-3 packets it will be set together with the timeout bit from the interrupt register.

UPD.
One more way:
You need PC with 2 network adapters;
1) Set the net bridge between adapters;
2) Connect your HW to remote server; 
3) Send Packet
4) Wait until SendOk be sets 1; 
5) Clear SendOk flag
6) Repeat from 3)

While this script running, you can remove net bridge and see result. [quote=""voroshilov, post:3, topic:5584""]
And only after 2-3 packets it will be set together with the timeout bit from the interrupt register.
[/quote]

Would be good to check TX_FSR register to see if it shrinks. It may be possible that while SENDOK is set, W5500 still keeps data in the buffer and perform retries. And timeout is got set when buffer gets full. Let's wait for response of someone from WIZnet. [quote=""Eugeny, post:4, topic:5584""]
TX_FSR
[/quote]
Thank you for answer.
I not immediately understood, what you means, but as soon as I began to check the completion of delivery upon clearing the TX buffer, the problem was solved.","Q) Have you come across this?

A) I have not personally encountered this specific issue, but based on the provided information, it seems to be a complex behavior exhibited by the W5500 chip in ""Tcp-client"" mode. The behavior of the ""SendOk"" bit being set in the socket interrupt register after disconnecting the cable while waiting for a response from the server does seem illogical, especially considering the inability to receive an ACK without a physical connection. It's an interesting phenomenon that may require further investigation.

Q) Please provide the way to reproduce the issue reliably.

A) The suggested way to reproduce the issue reliably involves the following sequence:
1. Open the socket in TCP mode.
2. Connect to a remote server.
3. Send a data packet.
4. Wait for setting the SendOK flag from the socket interrupt register.
5. Clear the SendOk flag.
6. Return to step 3.

Another way suggested is as follows:
1) Set up a PC with 2 network adapters.
2) Set the net bridge between adapters.
3) Connect the hardware to the remote server.
4) Send a packet.
5) Wait until SendOk is set to 1.
6) Clear the SendOk flag.
7) Repeat from step 3.

The suggested method involves observing the behavior of the W5500 chip when the network bridge is removed during the operation.

Q) Would be good to check TX_FSR register to see if it shrinks.

A) Checking the TX_FSR register to observe if it shrinks is a valuable point of observation. It may help in understanding if the W5500 chip retains data in the buffer and performs retries while the SendOk flag is set. The setting of the timeout bit when the buffer gets full is also an interesting aspect to consider.

Thank you for the information. It's good to hear that upon checking the completion of delivery upon clearing the TX buffer, the problem was resolved."
3183,5587,"I need 1 sec timeout Did you read the datasheet? Did you try yourself? What was the result? What is not clear?

And finally, search the forum, there were posts explaining the timeout mechanism.","Q) Did you read the datasheet? Did you try yourself? What was the result? What is not clear?
A) And finally, search the forum, there were posts explaining the timeout mechanism."
3184,5589,"I would like to implement a W5500 Modbus TCP Master in c if possible with a LPC54005 MCU.
I see that there is a Wiznet c library but I do not see Modbus TCP support.
Would this be a reliable setup?
How many points per second could I poll.
Any suggestions would be helpful. [quote=""kiryat8, post:1, topic:5589""]
I would like to implement a W5500 Modbus TCP Master in c
[/quote]
Ditto.  I am also working on this, but I use a TI F28335 MC.

[quote=""kiryat8, post:1, topic:5589""]
Would this be a reliable setup?
[/quote]
I wrote my own libs and drivers, and it starts to work together.  However, I still have almost 50% of errors after a couple weeks of coding.

[quote=""kiryat8, post:1, topic:5589""]
How many points per second could I poll.
[/quote]
I have a multi-task process, so I poll S0_IR and S0_SR every 10ms. I am also working on this, and using TI F28335.Did you debug it?","Q) I would like to implement a W5500 Modbus TCP Master in c if possible with a LPC54005 MCU. Would this be a reliable setup? How many points per second could I poll. Any suggestions would be helpful.
A) Would this be a reliable setup?
How many points per second could I poll.
 
Q) Ditto.  I am also working on this, but I use a TI F28335 MC.
A) None.

Q) I wrote my own libs and drivers, and it starts to work together.  However, I still have almost 50% of errors after a couple weeks of coding.
A) None.

Q) I have a multi-task process, so I poll S0_IR and S0_SR every 10ms. I am also working on this, and using TI F28335.Did you debug it?
A) None."
3185,5590,"Eccellente! Ora potrai tornare facilmente a questa conversazione privata in ogni momento, proprio dalla [scheda segnalibri sul tuo profilo](https://forum.wiznet.io/u/livewire/activity/bookmarks). Basta selezionare l'immagine del tuo profilo in alto a destra &#8599;

Next, can you share one of these links with me? Reply with **a link on a line by itself**, and it?Âll automatically expand to include a nifty summary.

To copy any link, tap and hold on mobile, or right click your pointing device:

 <https://en.wikipedia.org/wiki/Inherently_funny_word>
 <https://en.wikipedia.org/wiki/Death_by_coconut>
 <https://en.wikipedia.org/wiki/Calculator_spelling> Hey @livewire, I'm just checking because and for a while I don't feel you.

- To continue, answer me at any time.

- If you want to skip this step, tell me `jump.

- To start again, tell me `start new user.

If you prefer not to continue, that's okay.I am a robot.You won't hurt my feelings.: sob: salta Hey @livewire, I'm just checking because and for a while I don't feel you.

- To continue, answer me at any time.

- If you want to skip this step, tell me `jump.

- To start again, tell me `start new user.

If you prefer not to continue, that's okay.I am a robot.You won't hurt my feelings.: sob:","Q) Can you share one of these links with me? 
A) Reply with a link on a line by itself, and it'll automatically expand to include a nifty summary."
3186,5594,"Terrific!Now you can return to our conversation at any time about [the bookmark rider in your profile] (https://forum.wiznet.io/u/kira/kira/activity/bookmarks).Simply go to your profile picture at the top right &#8599;

As a night: Can you share one of these links with me?Answer with ** a link on your own line **, and it is automatically expanded into a lifting, short summary.

To copy a link, tap and keep on mobile, or click on the right with your mouse:

<https://de.wikipedia.org/wiki/antiwitz>
<https://de.wikipedia.org/wiki/tetraphobie>
<https://de.wikipedia.org/wiki/gegilos> https://de.wikipedia.org/wiki/Antiwitz : Then: This is: Sparkles: _emojitastisch! _: Sparkles:

Sometimes you might have had a person's attention, even if you don't answer her directly.Enter@`and then make your user name to mention her.

Can you **@discobot` ** in your answer? @discobot thanks Hello @Kira!I just wanted to get in touch again because I haven't had anything from you for a long time.

- To continue, I answer at any time.

- If you want to jump over this step, answer with 'overprinting`.

- To start from the front, answer with 'Start new user`.

If you prefer not to write to me, that's okay too.I am a robot.You won't hurt my feelings.: SOB:","Q) Can you share one of these links with me?
A) https://de.wikipedia.org/wiki/Antiwitz : Then: This is: Sparkles: _emojitastisch! _: Sparkles:

Q) @discobot 
A) @discobot thanks Hello @Kira!"
3187,5595,"Did you perform the proper reset procedure (toggle rst pins for the documented times) and soft reset (write 128 to MR and wait till lear) after? Correct me if I'm wrong, but shouldn't the 0x39 be in the second byte after CS goes low? Like this:
0x00 0x39 0x00 0xXX
(2 Bytes Adress, 1 Byte Control Phase, 1 Dummy Byte for the response) [quote=""Philipp_K, post:3, topic:5595""]
Like this:
0x00 0x39 0x00 0xXX
[/quote]

You must be correct. Most probably @kira used datasheet of another device (e.g. W5100). Maybe the device model is not correctly configured in the API? Oh lot of thanks guys!

I could not test it yet, but I'm sure it would work with your solutions.
Candela12: I do the proper Hard reset(rst), but did'nt the Soft reset..need to do that of course!

Also Philipp_K mentionend a great point: of course I sent one 0x00 too much. I did not paid attention that the WIZCHIP_READ_BUF() sends three bytes.

I will come back to you when I can test it again. 
Many thanks
Have good one
-kira [quote=""kira, post:1, topic:5595""]
To do simple tests , I call the WIZCHIP_READ_BUF() function with 0x0039, which should get me the version number(0x04).
[/quote]

I think I see your problem now. The WIZCHIP_READ_BUF() function expects the combination of adress and opcode, especially because the opcode also contains the register block you want to read from. Since you only need one byte, calling WIZCHIP_READ(0x003900) should yield the correct result.
Though strongly suggest calling getVERSIONR() instead; if you'd prefer using WIZCHIP_READ, i'd still recommend looking at the implementation of getVERSIONR(), that might give you an idea how those functions work Yep, that was the problem. Thank you very much Philipp_K for your help, now I get the right version number. :blush:

I think you're a nice person.
The problems were solved by you without my help.

thanks,
BR
irina","Q) Did you perform the proper reset procedure (toggle rst pins for the documented times) and soft reset (write 128 to MR and wait till lear) after? Correct me if I'm wrong, but shouldn't the 0x39 be in the second byte after CS goes low? Like this: 0x00 0x39 0x00 0xXX
A) You must be correct. Most probably @kira used datasheet of another device (e.g. W5100). Maybe the device model is not correctly configured in the API? Oh lot of thanks guys!
I could not test it yet, but I'm sure it would work with your solutions.
Candela12: I do the proper Hard reset(rst), but did'nt the Soft reset..need to do that of course!
Also Philipp_K mentionend a great point: of course I sent one 0x00 too much. I did not paid attention that the WIZCHIP_READ_BUF() sends three bytes. I will come back to you when I can test it again. Many thanks
Have good one -kira

Q) To do simple tests , I call the WIZCHIP_READ_BUF() function with 0x0039, which should get me the version number(0x04).
A) I think I see your problem now. The WIZCHIP_READ_BUF() function expects the combination of adress and opcode, especially because the opcode also contains the register block you want to read from. Since you only need one byte, calling WIZCHIP_READ(0x003900) should yield the correct result. Though strongly suggest calling getVERSIONR() instead; if you'd prefer using WIZCHIP_READ, i'd still recommend looking at the implementation of getVERSIONR(), that might give you an idea how those functions work
Yep, that was the problem. Thank you very much Philipp_K for your help, now I get the right version number. :blush:
I think you're a nice person.
The problems were solved by you without my help.
thanks,
BR irina"
3188,5598,"Hello, I am writing an FPGA code to connect my board to ethernet using W5100S. I am using an UDP connection.

My all socket buffers are set as default values which is 2KB. I am using the socket 0 to communicate.

In the FPGA code I read the Sn_TX_WR for socket 0, write my data to Tx memory and then set the Sn_TX_WR pointer with the new value which is incremented by a 32 for 32Bytes transmit. After that I set the Sn_CR to transmit the data. Data is transmitted correctly. After a while Sn_TX_WR pointer is reached to a value of 0x7FE0. Than I put my data on the buffer and transmit a 32B data and update the Sn_TX_WR pointer to 0x8000. This time W5100S chip transmits 32800 bytes data instead of 32B. It dumps all tx memory and after that sets the Sn_TX_WR pointer to 0x0000.

I have checked the driver codes to make sure if i am doing the right thing. The wiz_send_data function also increments the pointer Sn_TX_WR after writing to tx buffer. So what am i doing wrong? What should I do?

Here is related code in w5100s.c :

void wiz_send_data(uint8_t sn, uint8_t *wizdata, uint16_t len)
{
  uint16_t ptr;
  uint16_t size;
  uint16_t dst_mask;
  uint16_t dst_ptr;

  ptr = getSn_TX_WR(sn);

  dst_mask = ptr & getSn_TxMASK(sn);
  dst_ptr = getSn_TxBASE(sn) + dst_mask;
  
  if (dst_mask + len > getSn_TxMAX(sn)) 
  {
    size = getSn_TxMAX(sn) - dst_mask;
    WIZCHIP_WRITE_BUF(dst_ptr, wizdata, size);
    wizdata += size;
    size = len - size;
    dst_ptr = getSn_TxBASE(sn);
    WIZCHIP_WRITE_BUF(dst_ptr, wizdata, size);
  } 
  else
  {
    WIZCHIP_WRITE_BUF(dst_ptr, wizdata, len);
  }

  ptr += len;

  setSn_TX_WR(sn, ptr);  
} [quote=""engcif, post:1, topic:5598""]
I am using an UDP connection.
[/quote]

UDP is networking protocol, your connection is wired Ethernet.

[quote=""engcif, post:1, topic:5598""]
Than I put my data on the buffer and transmit a 32B data and update the Sn_TX_WR pointer to 0x8000. This time W5100S chip transmits 32800 bytes data instead of 32B.
[/quote]

Sounds you do things correctly, and there's something wrong here. Like register gets 0xFFE0. Are you sure that your software/hardware handles bit 15 properly - as it looks like bit 15 is being always reset, thus causing 0x7FE0+0x20=0x0000. [quote=""Eugeny, post:2, topic:5598""]
Sounds you do things correctly, and there?Âs something wrong here. Like register gets 0xFFE0. Are you sure that your software/hardware handles bit 15 properly - as it looks like bit 15 is being always reset, thus causing 0x7FE0+0x20=0x0000.
[/quote]

Register does not gets 0xFFE0 it gets 0x7FE0 and than after adding a value I set it to 0x8000. After data transmission is complete it gets 0x0000. It does not get 0x8020 or other values greater than 0x8000.

How can I prevent it from growing up to 0x8000? It starts at 0x0000 after reset. [quote=""engcif, post:3, topic:5598""]
How can I prevent it from growing up to 0x8000? It starts at 0x0000 after reset.
[/quote]

You can not. It is a cyclical pointer/byte counter.

[quote=""engcif, post:3, topic:5598""]
After data transmission is complete it gets 0x0000.
[/quote]

First you must prove that you really write 0x8000 in there with bit 15 set.

You said that yoy ""write FPGA code ... W5100s"", and then append code in C. Not sure C can be compiled to hardware. SystemVerilog can. Thus I suspect there's a layer of another software/firmware and hardware between your C program and W5100s SPI write cycle. You may have simply lose bit 15 somewhere. Good. Can you, as a test, perform pointer write in two steps - two SPI frames, a byte at a time? First frame F0 04 24 80 and second F0 04 25 00? Also try using SEND command instead of SEND_MAC. I do not know solution to your exact problem, thus we must experiment to see the difference. And? Still the same issue with pointer going 0x0 rather than 0x8000? I am afraid yes. Are we expecting to have 0x8000 and even 0x8020 maybe in the next transmit and up to 0xFFFF right?

I have an idea. I will keep a Sn_TX_WR pointer on my side (host/FPGA). After each transmit I will update my register and write the content to Sn_TX_WR. So there will be no need to read Sn_TX_WR pointer. I will just write it with the new value. Because when I write 0x8000 and than read it back again after writing my data to tx memory, it gives 0x0000 instead of 0x8000. So eventually I am updating it to 0x0020 instead of 0x8020 and it dumps tx memory... I will try it and keep you informed. [quote=""engcif, post:10, topic:5598""]
Are we expecting
[/quote]

Yes, I would expect this behavior. At least other chips from the family behaves this way. The pointer is 16-bit, however it is not explicitly stated in the datasheets. Anyway having 15-bit pointer would be a nightmare (must be a multiple of byte otherwise bit-wise operations are required).

You seem to perform properly, thus there must be something else. Please check SPI timing against datasheet (pages 102-104), try lowering clock speed and increaseing time between chip selects. The thread - old but - exists and I'm tinkering with one of these so  - 
Anyone who happens to step into here looking for answers.
1. If Sn_TX_WR really IS a ""POINTER"" ( which - yeah - I'd buy that), Then setting it to 0x8000 sets it exactly    1 step OUT OF THE MEMORY MAP for this W5100S. 
(Hint - that's probably going to get some interesting results.! I know. the Version 1.2.5 datasheet says 0x8000). I just think probably - NOT.    Maybe 0x7FFF Making Hex 8000 counts. But not Index or address 0x8000.  I might try to prove this when I get time but a decent support person can easily confirm or deny it.
2. Everybody likes to WRITE to a register and then READ the register to make sure it GOT THERE. Right?
You can write to the Sn_TX_WR register all you want!  Seems it wont show you that register content that you just wrote until you do an network SEND command. Then you can read it!  Important little detail that can help.   Acts like a POINTER!  Right?","Q) What am I doing wrong when transmitting data using the W5100S chip with an FPGA code in an UDP connection?
A) It seems like you are handling the transmission correctly, but there might be an issue with how the W5100S chip is interpreting the values. There could be a problem with how bit 15 is being handled, as it always seems to reset, causing unexpected behavior. It's also important to ensure that the SPI timing is accurate according to the datasheet and consider adjusting the clock speed and chip select timing. Additionally, it's worth noting that setting the Sn_TX_WR register to 0x8000 sets it one step out of the memory map for the W5100S, and it might not be the correct behavior expected by the chip. "
3189,5606,"Terrific!Now you can go back to our entertainment over [the bookmark rider in your profile] (https://forum.wiznet.io/u/philipp_k/akmarks).Simply go to your profile picture at the top right &#8599;

As a night: Can you share one of these links with me?Answer with ** a link on your own line **, and it is automatically expanded into a lifting, short summary.

To copy a link, tap and keep on mobile, or click on the right with your mouse:

<https://de.wikipedia.org/wiki/antiwitz>
<https://de.wikipedia.org/wiki/tetraphobie>
<https://de.wikipedia.org/wiki/gegilos> https://de.wikipedia.org/wiki/Antiwitz :boar: This is: Sparkles: _emojitastisch! _: Sparkles:

Sometimes you might have had a person's attention, even if you don't answer her directly.Enter@`and then make your user name to mention her.

Can you **@discobot` ** in your answer? @discobot _Hat someone said my name!? _: Raised_hand: I think you were!: wave: Well, here I am!Thank you for mentioning me.: Ok_Hand:

Can you mark a few words in your answer ** fat ** or _Kursiv_?

- Write `** fat **` or `_Kursiv_`

- or, print the <kBD> <b> f </b> </kbd>- or <kBD> <i> k </i> </kbd> switching in the editor ** Fat ** _ Courseiv_ Good job!HTML and BBcode also work for formatting?To find out more, [try out this tutorial] (http://commonmark.org/help): nerd:

Can you try to quote me when you answer so that I know exactly which part you answer?

> If the coffee is, please bring me tea;But if the tea is, please bring me coffee.
>
> An advantage of self -talk is that you know that at least someone can be heard.
>
> Some people can handle words well, and other people ... Ahm, well, not so good.

Valae any & uarr;Quote from that you prefer, and then print the ** quote **-wiring area that appears over your selection?Or the ** answer **-wiring area at the end of this article.

Under the quote, write one or two words why you chose this quote, because I was interested: Thinking: [Quote = ""Discobot, Post: 10, Topic: 5606""]
One advantage of self -talk is that you know that at least someone can be heard.
[/quote]

I like it :) :herb: Juhu!You found it: tada:

- To search for further details go to [expanded search] (https://forum.wiznet.io/Search).

- To jump to any position in a long discussion, try the timeline to the right of the topic.You can find the timeline at the bottom right.

- If you use a physical keyboard, enter <kbd>? </kbd> to display a usual overview of key combinations. Thank you very much :) Thanks for the reply!
Because I am a poorly programmed bot, I didn't quite understand that.: frowning:","Q) Can you share one of these links with me?
A) Sure, here is the link to the Wikipedia page on antiwitz: https://de.wikipedia.org/wiki/Antiwitz.

Q) Sometimes you might have had a person's attention, even if you don't answer her directly. Enter@`and then make your user name to mention her. Can you **@discobot** in your answer?
A) @discobot _Hat someone said my name!?_ :raised_hand: I think you were! :wave: Well, here I am! Thank you for mentioning me. :ok_hand:

Q) Can you mark a few words in your answer **fat** or _Kursiv_?
A) Sure, you can use **fat** or _Kursiv_ to emphasize words.

Q) HTML and BBcode also work for formatting? To find out more, [try out this tutorial](http://commonmark.org/help): nerd:
A) Yes, you can use HTML and BBcode for formatting. For more details, you can try out this tutorial: [commonmark.org/help](http://commonmark.org/help).

Q) Can you try to quote me when you answer so that I know exactly which part you answer?
A) If the coffee is, please bring me tea; But if the tea is, please bring me coffee. One advantage of self-talk is that you know that at least someone can be heard. Some people can handle words well, and other people ... Ahm, well, not so good. 

I like it because I was interested in this quote: [Quote = ""Discobot, Post: 10, Topic: 5606""]
One advantage of self-talk is that you know that at least someone can be heard.
[/quote]

Thank you very much :) Thanks for the reply!"
3190,5607,"Hi everyone!
I've created a PCB with the W5500, the schematic is according to the reference schematic. 
Now I can access and write all of the registers on the W5500, the Duplex and Speed LEDs work if I set the mode manually and the Crystal seems to be oscillating at 25.0007MHz (though my oscilloscope is not great, so I don't now if that measurement is accurate). I can see the link pulses from my switch arriving on the TX and RX pins of the W5500, probably due to the AutoMDX feature.
However, I don't get a link. I've poked around the board a bit and I have 1.2V on the TOCAP and 1V2 pins and 3.3V on the respective input pins, but 0V on the Exres pin. What could be the cause for this?
My lines to the RJ45 jack are a bit longer than usual (approx. 2 - 3 cm), but I don't think that this should bring down the link entirely. I rather feel that something might not be correctly set up or supplied.
Any ideas what might be the reason? Any input is appreciated! [quote=""Philipp_K, post:1, topic:5607""]
However, I don?Ât get a link.
[/quote]

What does it mean? Link LED does not turn on? Switch does not see port connected? All of those: Switch does not detect device, LED not on, bit in register not set. 
Other than that, the PHYCFG register does not have any unexpected contents.
Furthermore I don't see any link detection pulses from the W5500 in any mode. I think, the PHY is not working, also because of the missing voltage on the resistor... [quote=""Philipp_K, post:3, topic:5607""]
PHYCFG register does not have any unexpected contents.
[/quote]

What does it have exactly when cable is connected and when it is disconnected? If I use autonegotiation, it has 0xF8, which makes sense to me:
Reset inactive, Autonegotiation all capable, duplex and speed not (yet) set, no Link.
Is there any procedure I have to follow? Right now I am doing the following:
HW Reset, wizchip_init(), setting netinfo, configuring PHY, 300ms pause, PHY reset, 300ms pause

BTW, the Wiz5500io board works with the same cable and switch setup (without anything connected to the SPI, i. e. only automatic configuration by the companion processor) [quote=""Philipp_K, post:5, topic:5607""]
Right now I am doing the following:
[/quote]

Link must get up even if chip is not configured. I think the only requirement is no chip reset and no PHY reset conditions.

Thus if you prove cable and switch are not issues, then there's something wrong with your circuitry: wrong resistor soldered, small mistake in the circuit diagram, wrong pinout used for magjack etc. Sometimes removing damping resistors help; some people put 49.9 kOhm instead of 49.9 Ohm. [quote=""Philipp_K, post:7, topic:5607""]
though and the signal *from* the switch gets through well, there?Âs just no signal coming from the W5500 pins.
[/quote]

In my understanding electrically if device senses the link it turns link LED on. Thus if switch does not light the link LED then there's nothing from W5500, if W5500 does not light its link LED, then it does not see anything from the switch.

I do not see anything wrong in the circuit. RJ-45 pinout in the circuit is correct, please check the [layout](https://katalog.we-online.de/pbs/datasheet/74990111217.pdf) to ensure that you connect proper pins on the board level.

Note that W5500 does not support auto-MDIX:

>W5500 does not support auto-MDIX feature.
> Thus, user should use straight-through cables to connect to other switches or routers and crossover cables to connect to devices such as servers, workstations or another W5500. However, user can use either type of cable to connect to other devices with auto-MDIX enabled, and the interface automatically corrects for any incorrect cabling.

Must work with your switch though, but you may try changing cables and try another switch to see if there will be a difference. Ok, thank you for summary. You configure PHY using PHYCFGR, and you said it is F8. What are the states of PMODE wires? What resistors are soldered in?

Reading the datasheet:

>When W5500 is reset by POR or RSTn PIN, PHY operation mode is configured with PMODE[2:0] PINs by default. After POR or RSTn reset, user can re-configure PHY operation mode with OPMDC[2:0]. If user wants to re-configure with PMDC[2:0], it should reset PHY by setting the RST bit to ????after the user configures this bit as ????and OPMDC[2:0] .

I read it as that you must perform two writes, first one setting the PHYCFGR[5:3], and second with PHYCFGR[7] reset (and 5:3 set the same way as in previous write) to reset  PHY. A while ago, I had the mode wires in Autonegotiation mode, but soldered them to 10M half duplex since I thought this would work. Didn't help.
But the W5500 does accept the reconfiguration, which is performed according to the datasheet: After configuring and then resetting the PHY with the API functions, the Duplex and Speed LED light up accordingly and the register reflects the new values. The configuration does not seem to make any difference for the outcome though. The PHYCFG register indicates that the PHY is turned on, but there never is any reaction on the lines... I am out of ideas, only guessing remains. Maybe you can post picture of the board? By the way, pin 8 of the magjack should be grounded. [quote=""Eugeny, post:13, topic:5607""]
I am out of ideas, only guessing remains.
[/quote]

Same here, all I seem to know that something seems to have brought down the PHY. I'm not sure whether it's broken, though I don't know why that would be, but I've already replaced it once and I am not keen on putting in a third chip since they are not really cheap and I suppose it might harm the board, too.

[quote=""Eugeny, post:13, topic:5607""]
Maybe you can post picture of the board?
[/quote]

I will, as soon as I am home. Or would a rendering also be sufficient?

[quote=""Eugeny, post:13, topic:5607""]
By the way, pin 8 of the magjack should be grounded.
[/quote]

True! I've used a resistor leg to solder it to the case pins a few weeks ago, but that did not make a difference. Once I figure out what the problem is here, I'll probably make a new version where I adress the minor issues like this, too :) [quote=""Philipp_K, post:14, topic:5607""]
Or would a rendering also be sufficient?
[/quote]

I would say not much. There're layout guidelines, but bad layout must not cause no link. It may work badly, but not fail completely. Exactly as you said in your original post.

[quote=""Philipp_K, post:14, topic:5607""]
I?Âve already replaced it once
[/quote]

Then it is not a chip, but something else. This is good news...
Check L1. Is it in place? What is the voltage at 3V3A? [quote=""Eugeny, post:15, topic:5607""]
Check L1. Is it in place? What is the voltage at 3V3A?
[/quote]
L1 is indeed in place and the voltage is 3.3V. I have used [this part](https://katalog.we-online.de/pbs/datasheet/742792040.pdf). Is it suitable? But I think that on a stable supply it should not make a huge difference.
EDIT: I think the impedance at 100MHz might be a bit to high Should be suitable one. You can test just shorting it (shorting 3V3D and 3V3A). If link will not go up, it is not the ferrite bead. I've tried bridging the ferrite bead as you suggested, but it didn not make a difference.
Would it be possible that while using my oscilloscope probe I slipped and shorted something that wasn't supposed to be shorted? Usually, most chips can handle that, afaik...
And other than Exres1, all levels (3.3V, 1.2V, ToCap, VBG) are okay... Measured voltage on the RSET_BG pin of the W5100. It has 12.3 kOhm 1% resistor connected to it, I guess it serves the same purpose as EXRES1 for W5500. The voltage is 1.2V. But when I touch resistor with both probes to measure voltage on it - chip goes crazy putting link down, or turning the RX LED on and ACT LED constantly flashing.

Please check that you really installed 12.4 kOhm 1% resistor (or several resistors in series like I do - 12k 1% + 300 Ohm 1%), and that it is not shorted to ground. Hi, I've done that already! Resistance from EXRES1 pin to GND is 12.4kOhms +/- 100 Ohms (I've usedthe respective resistor, [this one](https://www.mouser.de/ProductDetail/Panasonic/ERJ-3EKF1242V?qs=%2Fha2pyFadujWqMGonbcVXdYk5EfnPqHEJon%252BeSjnhB6%2FnO4uggAUYg%3D%3D) specifically), which is below 1%. Anyways, I think the voltage that I see there should be way higher than 0V, rather around 1.2V as you've mentioned.
Is there any way to verify whether the PHY section of the W5500 is broken? Hello everyone, it's me again. I've decided to improve my design (better, shorter differential routing, clock instead of crystal, better filter inductor) and have my boards preassembled to make sure there are no soldering errors. 
I've got a mint condition W5500 breakout board here, with a brand new connector (same parameters though) and with a software that has worked with the official breakout board, too.

Well, same problems as before:
?No Link
?No voltage on Exres
?Surprisingly low current consumption
?Writing and reading registers works just fine, everything there is as expected.
?Reconfiguring the PHY works, but the Link does not work regardless of configuration

It feels as if the PHY is in power down mode, even though the corresponding register bits say that it is in auto negotiation mode... For instance, the W5500 consumes ~13mA like in Power down mode instead of 56mA as would be normal in Un-Link mode. Any thoughts on that? I will also send my design soon A quick follow-up for anyone wondering or any future person who stumbles across this thread: 
After posting to another forum, someone pointed out that Pin 11 was wrongly connected to GND instead of 3V3. I must've overlooked it due to that pin being grouped with the ground pins. I don't know who thought that it would be a good idea to create a schematic symbol like that (I took it form the Altium vault).

Anyway, thanks to everyone who contributed!","Q) What could be the cause for this?
A) What does it mean? Link LED does not turn on? Switch does not see port connected? All of those: Switch does not detect device, LED not on, bit in register not set. 

Q) What does it have exactly when cable is connected and when it is disconnected? If I use autonegotiation, it has 0xF8, which makes sense to me:
A) Reset inactive, Autonegotiation all capable, duplex and speed not (yet) set, no Link.

Q) What are the states of PMODE wires? What resistors are soldered in?
A) When W5500 is reset by POR or RSTn PIN, PHY operation mode is configured with PMODE[2:0] PINs by default. After POR or RSTn reset, user can re-configure PHY operation mode with OPMDC[2:0]. If user wants to re-configure with PMDC[2:0], it should reset PHY by setting the RST bit to after the user configures this bit as and OPMDC[2:0].

Q) Is it suitable?
A) Should be suitable one. You can test just shorting it (shorting 3V3D and 3V3A). If link will not go up, it is not the ferrite bead. 

Q) Would it be possible that while using my oscilloscope probe I slipped and shorted something that wasn't supposed to be shorted? 
A) Usually, most chips can handle that, afaik... And other than Exres1, all levels (3.3V, 1.2V, ToCap, VBG) are okay... Measured voltage on the RSET_BG pin of the W5100.

Q) Is there any way to verify whether the PHY section of the W5500 is broken?
A) Hi, I've done that already! Resistance from EXRES1 pin to GND is 12.4kOhms +/- 100 Ohms (I've usedthe respective resistor, specifically), which is below 1%. Anyways, I think the voltage that I see there should be way higher than 0V, rather around 1.2V as you've mentioned.

Q) Any thoughts on that?
A) It feels as if the PHY is in power down mode, even though the corresponding register bits say that it is in auto negotiation mode... For instance, the W5500 consumes ~13mA like in Power down mode instead of 56mA as would be normal in Un-Link mode. Any thoughts on that?"
3191,561,"hello
We purchased 5 100SRs and connected Config Tool for IP settings.
By the way, no matter how much Seach is, the module is not recognized.
We will give you an urgent answer. Wiznet Homepage [URL] http://www.wiznet.co.kr [/URL]
Download the user manual and proceed with the ""Start"" starting from 7 page.
If you still do not work well, connect the module and PC directly through the LAN cable and try it.","Q) We purchased 5 100SRs and connected Config Tool for IP settings. By the way, no matter how much Seach is, the module is not recognized. Can you help us? 
A) If you still do not work well, connect the module and PC directly through the LAN cable and try it."
3192,5616,"Hello, I am developing a simple http
server. I use stm32f4 + w5500. Ported an example from WIZ550WEB. Everything worked fine, but I was happy early.

I use google translate ...

1. My actions (in simple terms) and the problem:
a) I connect this device to my router (NTE_RG-1402). By DHCP I get an ip address (192.168.0.20). In the settings of the router, the connection is displayed, the MAC address is displayed. Via a PC (win8), also connected by cable to the router, I go through Chrome on the issued IP - the page loads, everything works fine.
b) in the same way, I go through another PC connected in the same way - everything is also OK.
c) I go through my laptop (win10) connected via wifi - No reaction. In the terminal of my device, it does not even show what was the request. WireShark also does not show any requests. Nothing at all.
d) When entering through the Phone (android), laptop (win7), nothing happens either.
-------
With computers connected by cable - the device is pinged, with other devices not.
I go to my friend, turn on the device, I also get the DCHP ip address: it comes from my laptop, it comes from the phones, but it does not come from the MacBook - everything is exactly the same as in the cases described above.
wi-fi and wired connections are in the same vlan [quote=""HikoSV, post:1, topic:5616""]
In the terminal of my device, it does not even show what was the request. WireShark also does not show any requests.
[/quote]

It means that problem occurs before W5500 is reached by the request. There must be a problem with routing.

[quote=""HikoSV, post:1, topic:5616""]
connected via wifi
[/quote]

I assume routing between WiFi subnetwork and wired subnetwork is allowed?

[quote=""HikoSV, post:1, topic:5616""]
Phone (android), laptop (win7)
[/quote]

Both connected through WiFi? You surely have problems between WiFi and wired networks. As it turned out, the problem was in the code.
In short:
When receiving DHCP, a single MAC address appears in the router. And after connecting, it turned out, when I pinged the IP Scanner, it turned out that the device sends a different MAC. (In general, the problem with the structures)","Q) I am developing a simple http server using stm32f4 + w5500. I connected the device to my router and obtained an IP address by DHCP. It works fine with PCs connected by cable, but when I try to access it through wifi or other devices, there is no reaction. The device is pinged with computers connected by cable, but not with other devices. Wi-fi and wired connections are in the same vlan. What could be the issue?
A) It seems like there might be a problem with routing between the WiFi subnetwork and the wired subnetwork. When receiving DHCP, a single MAC address appears in the router, but after connecting, it turns out that the device sends a different MAC address. This indicates a problem with the device's structures."
3193,5619,"I need to interface with a 3rd party device, which accepts UDP packets sent to its IP address over an ethernet cable. It's not a well engineered product, and as a result won't send a response to ARP requests. 

The problem I have is that the W5100s requires at least one ARP response before it will send UDP packets to a new IP address.Because of this I always get a SOCKET_TIMEOUT response when I try to send data.
The instructions for sending commands to the product state that I must send a UDP packet to a specific IP, but doesn't provide a MAC address alternative which would allow me to circumvent ARP using the SEND_MAC command instead.

Is there any way to avoid the need for ARP when sending a UDP packet to a defined IP address?

I noticed the datasheet says ""If previous Destination and current Destination are the same, the ARP Process is skipped. ""  Is there perhaps a way to trick the W5100s into thinking it's already sent to the address? Why not using SEND_MAC which is specifically built for this purpose? As I said, SEND_MAC appears to need a Hardware MAC address to function, which I do not have.

I think possibly the UDP multicat may work without a MAC address, but nothing in the documentation says this will circumvent ARP. [quote=""CraigTZ, post:3, topic:5619""]
SEND_MAC appears to need a Hardware MAC address to function, which I do not have.
[/quote]

If you do not have hardware (MAC) address, how do you think UDP will work? It requires this MAC address, and the way to acquire it is ARP request. Thus you either put MAC address manually, must use ARP, or implement some other custom protocol in MAC raw mode.

[quote=""CraigTZ, post:1, topic:5619""]
and as a result won?Ât send a response to ARP requests.
[/quote]

Can you set up some other device to send ARP responses on behalf of this device? [quote=""CraigTZ, post:1, topic:5619""]
I noticed the datasheet says ""If previous Destination and current Destination are the same, the ARP Process is skipped. "" Is there perhaps a way to trick the W5100s into thinking it?Âs already sent to the address?
[/quote]

This contents  means   the ARP Process is skipped because WIznet Chip has the Mac address through previous communication.
If you operate any network communication,it is impossible without MAC.
It must need MAC address for network communication.

As Eugeny said, you either put MAC address manually, must use ARP, or implement some other custom protocol in MAC raw mode.

thanks,
BR
irina","Q) Is there any way to avoid the need for ARP when sending a UDP packet to a defined IP address?
A) If you do not have hardware (MAC) address, how do you think UDP will work? It requires this MAC address, and the way to acquire it is ARP request. Thus you either put MAC address manually, must use ARP, or implement some other custom protocol in MAC raw mode.
Q) Can you set up some other device to send ARP responses on behalf of this device?
A) This contents means the ARP Process is skipped because WIznet Chip has the Mac address through previous communication. If you operate any network communication, it is impossible without MAC. It must need MAC address for network communication. As Eugeny said, you either put MAC address manually, must use ARP, or implement some other custom protocol in MAC raw mode."
3194,5622,"hello,
 I am not getting interrupt every time on INTn pin of W5500. 
my code:
main()
{
w5500_init_fun();
wiz_Setup_Open(11000);
Set_Sn_IMR(0x04);
Set_SIMR(0x01);
Set_INTLEVEL(30);
Set_Sn_IR(0,0x00);
while(1)
{
 if(external interrupt received)
 {
  process_received_data();
 Set_Sn_IR(0,0x04);
 external_interrupt_received=0;
 }
}
} [quote=""Alka_Yadav, post:1, topic:5622""]
I am not getting interrupt every time on INTn pin of W5500.
[/quote]

Explain what exactly you want to have. You want interrupt for each byte received? What is being configured by int level 30? See also https://forum.wiznet.io/t/topic/2609","Q) Explain what exactly you want to have. You want interrupt for each byte received? What is being configured by int level 30? 
A) I want to have an interrupt triggered every time a byte is received on the INTn pin of W5500. The INTLEVEL of 30 is configuring the threshold level for the interrupt. For more details, you can also refer to the following link: https://forum.wiznet.io/t/topic/2609"
3195,5623,"While monitoring communication between Chrome browser and a W5500 I see a SYN packet from Chrome followed by an RST, ACK from the W5500 about 14 usecs later. I see two additional SYN packets from Chrome on the same source port, each about 0.5 secs apart and the W5500 replies to each with an RST, ACK about 10 usecs later. I don't see any other SYNs during this time interval.

Based on log data surrounding (but not exactly at) this time, it appears that I have 3 available sockets, though I don't have insight yet into what their status is. I suspect they were in a state that rendered them unavailable because I don't see another SYN from Chrome get ACK'd until after a FIN, ACK sequence.

My question is: are there conditions other than lack of available sockets that will cause the W5500 to send a RST packet in response to a SYN? [quote=""Mxyxixptlick, post:1, topic:5623""]
conditions other than lack of available sockets that will cause the W5500 to send a RST packet in response to a SYN?
[/quote]

Usually caused by no available sockets in listening state. I hit this issue with Chrome when designing web browser for W5100. Now I recommend using Firefox which has the setting to limit number of sockets it is going to use. I think my problem occurs due to the length of time between the W5500 ACKing a SYN packet on the socket on which it's listening and the time the driver notices this and starts listening on another socket. The ideal solution would be to generate an interrupt when a new connection is made so an idle socket could be set to LISTEN immediately, but I don't see any way to do that on a system based on an Arduino + shield connected via SPI.

Have you ever tried listening on the same port on multiple sockets? Seems like that would work if the W5500 just assigns incoming SYN packets to the first socket matching the requested port. [quote=""Mxyxixptlick, post:3, topic:5623""]
Have you ever tried listening on the same port on multiple sockets?
[/quote]

Of course! It is normal way to function. When SYN comes, W5x00 automatically selects next available socket listening on the port.

[quote=""Mxyxixptlick, post:3, topic:5623""]
due to the length of time between the W5500 ACKing a SYN packet on the socket on which it?Âs listening and the time the driver notices this and starts listening on another socket.
[/quote]

Usually your goal is to serve request, disconnect, close and reopen for listening as fast as possible. I think it is possible to perform using interrupts, and server is going to ""master"" the connection deciding when connection is done. [quote=""Mxyxixptlick, post:3, topic:5623""]
Have you ever tried listening on the same port on multiple sockets? Seems like that would work if the W5500 just assigns incoming SYN packets to the first socket matching the requested port.
[/quote]

Hi~ 
If you set on the same port on multiple socket, Socket numbers are connected in the order of lowest.
So, if you set the TCP Server on the same port  about Socket 1 and Socket3,  it will connect the Socket 1 and you will show the RST packet about socket 3.

thanks,
BR
irina In your example, where the TCP server is listening on port 80 on Socket 1 and Socket 3 after Socket 1 connects would Socket 3 still be listening? I tested this and found that the second socket does continue listening after the first connects. I also monitored network traffic with Wireshark and did NOT see RST packets from the other listening sockets. 
Have you solved the problem? Can you share the solution? Which problem do you have? As I see original poster's problem was lack of listening sockets thus RST responses.","Q) My question is: are there conditions other than lack of available sockets that will cause the W5500 to send a RST packet in response to a SYN? 

A) Usually caused by no available sockets in listening state. I hit this issue with Chrome when designing web browser for W5100. Now I recommend using Firefox which has the setting to limit the number of sockets it is going to use. I think my problem occurs due to the length of time between the W5500 ACKing a SYN packet on the socket on which it's listening and the time the driver notices this and starts listening on another socket. The ideal solution would be to generate an interrupt when a new connection is made so an idle socket could be set to LISTEN immediately, but I don't see any way to do that on a system based on an Arduino + shield connected via SPI. 

Q) Have you ever tried listening on the same port on multiple sockets? Seems like that would work if the W5500 just assigns incoming SYN packets to the first socket matching the requested port. 

A) Of course! It is normal way to function. When SYN comes, W5x00 automatically selects the next available socket listening on the port.

Q) In your example, where the TCP server is listening on port 80 on Socket 1 and Socket 3 after Socket 1 connects would Socket 3 still be listening? 

A) Hi~ If you set on the same port on multiple socket, Socket numbers are connected in the order of lowest. So, if you set the TCP server on the same port about Socket 1 and Socket3, it will connect the Socket 1 and you will show the RST packet about socket 3. thanks, BR irina In your example, where the TCP server is listening on port 80 on Socket 1 and Socket 3 after Socket 1 connects would Socket 3 still be listening? I tested this and found that the second socket does continue listening after the first connects. I also monitored network traffic with Wireshark and did NOT see RST packets from the other listening sockets. 

A) Have you solved the problem? Can you share the solution? Which problem do you have? As I see the original poster's problem was the lack of listening sockets thus RST responses."
3196,5624,"The configuration program (WIZ14xSR_Config.exe) does not seem to have the capability of an ""IP Search"" as I'm used to from the WIZ110/125  series. Is it hidden somewhere or simply not available anymore?
Thank you It is not implemented at the moment.
But we will consider implementing this function in a short time.

Thank you.

James. Thank you for your prompt response - although it's not what we were hoping for.
ewatv1","Q) The configuration program (WIZ14xSR_Config.exe) does not seem to have the capability of an ""IP Search"" as I'm used to from the WIZ110/125 series. Is it hidden somewhere or simply not available anymore?
A) It is not implemented at the moment. But we will consider implementing this function in a short time.

Q) Thank you It is not implemented at the moment. But we will consider implementing this function in a short time.
A) None.

Q) Thank you for your prompt response - although it's not what we were hoping for.
A) None."
3197,5628,"[W5100]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------

hello.

I was curious about the W5100 lifespan.

Once every 10 seconds, the W5100 is a reset signal, 6 times in 1 minute, 360 in 1 hour, 8640 in one day, and 3153600 in 1 year.

Will the chip die in this way?

I wonder what will happen to the reset! hello~

Thank you for the good question.

First of all, keeping a reset signal to the W5100 does not affect the life of the W5100.
(For reference, the warranty period is within one year for the RMA for the chip.)


thank you
Irina Thank you for your answer.

The reset is not a software reset, but a reset to the hardware pin.

Is there no effect on life? ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

Software  reset?? GPIO Ã¬Â¶ÂÃ«Â Â¥?Â¼Ã«Â¡Â High/lowÃ«Â¥?Ã¬Â£Â¼Ã«ÂÂ ÃªÂ²ÂÃ¬ÂÂ´ÃªÂ³?
Hardware reset?? Ã¬Â§ÂÃ¬Â Â ?ÂÃ¬ÂÂ???Â°ÃªÂ²Â°?Â´Ã¬ÂÂ Ã¬Â£Â¼Ã«ÂÂÃªÂ²ÂÃ¬ÂÂ¸??
W5100?? reset??Software or Hardware ?Â¸Ã¬? ?ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¼Ã«Â©? HardwareÃ«Â¡?reset??Ã¬Â¤Â¬Ã«ÂÂ¤ÃªÂ³??Â´Ã¬ÂÂ ?ÂÃ«ÂªÂ???ÂÃ­ÂÂ¥??Ã«Â¯Â¸Ã¬Â¹ÂÃ¬Â§????ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
irina","Q) I was curious about the W5100 lifespan. Will the chip die due to the reset signal being sent once every 10 seconds? Thank you for the good question. Is there no effect on life?
A) First of all, keeping a reset signal to the W5100 does not affect the life of the W5100. (For reference, the warranty period is within one year for the RMA for the chip.) The reset is not a software reset, but a reset to the hardware pin. There is no effect on the life due to the reset."
3198,5629,"Hey @aripod, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob: ? Sorry, I couldn?Ât find the link in your reply! :cry:

Can you try adding the following link, on its own line, in your next reply?

<https://en.wikipedia.org/wiki/Exotic_Shorthair> Hey @aripod, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob:","Q) Hey @aripod, just checking in because I haven?Ât heard from you in a while.
A) None.

Q) Can you try adding the following link, on its own line, in your next reply?
A) None."
3199,5630,"(post withdrawn by author, will be automatically deleted in 24 hours unless flagged) @Philipp_K, thank you for taking the time to reply.

1. Chip Select: Then that is correct as I am running it with active low as the yellow curve shows.
2. The first attempt was to mimic the waveforms shown in the [user manual](https://www.mouser.com/ds/2/443/WIZ820io_User_Manual_V1.0-586418.pdf) (first two images from the original post) and the one from EDIT 1. 
    * I can see an error there that there is no time between SS goes low and the first clock pulse on SCLK (as shown on the page 7 of the user manual).
3. I am doing all this on an FPGA and I have assigned MISO to be an input signal. I do not think that the long cables and everything wired on a breadboard should be an issue.
4. I have that ""strange"" looking waveforms because of [this thread](https://forum.wiznet.io/t/topic/1338/4) where apparently someone from WIZnet showed the device working with that so I do not know if I should follow the way the waveforms are in the manual or in that example where they show the device working.
5. I am also sending the data length. If we split the MOSI wavefor, it is 00 0F (address) and 0001. Then, the 5th 8 group of pulses on SCLK is for reading the data on MISO. 
So, if I understand the manual correctly, I am sending 16 bits for address and 16 bits for OP and length. Then, I should generate the number of clock cycles accordingly to the length value (length x 8) and that is why, in this case that I want to read only one byte (address 0x000F) I am generating on SCLK 5 ""packets"" of 8 clock pulses.
6. What do you mean with the *dummy* byte?

Thanks for the help. That's the CLK pulses that you described, I overlooked that when I looked at your screenshots. So that should be good, too Hi~aripod
The value of SIPR register  is empty  after reset operation or Initial version.
Therefore the value of SIPR register may not be.
I recommend  reading W5200 version register(0x001F).
If you read version register(0x001F), you see the 0x03 through MISO.

thanks,
BR
irina [quote=""aripod, post:9, topic:5630""]
The question now is, should I keep it like that, toggling SS with every byte or keep it low until the last byte is transmitted like the manual shows?
[/quote]

If both ways work for you, I would recommend doing it as described in the manual since I'd say that this is more logical from the interface point of view That is actually a very good point. In fact, if we check the screenshots from the [other post](https://forum.wiznet.io/t/topic/1338/4), we can see that MISO is low. The issue with the first one, where MISO is always low is because nRESET was also low.
In the second one, MISO is 0x03 as expected but the question is if it is ok for MISO to be always high, comparing to the example cited on [here](https://forum.wiznet.io/t/topic/1338/4) where it is low. This all is double odd because MISO must be tri-state when SS is high. When chip is in reset state, it must also keep MISO tri-state. Pull-down resistor on MISO line? Well, your're right of course, but he won't be able to see the impedance of the MISO line in his logic analyzer, only the level it happens to have, which would be 0V if the line hasn't been charged before Hello @irina_kim, @Eugeny and @Philipp_K,

I went back to this project and I see that the pulses over MISO are out of sync with SCLK and their width is shorter than SCLK's period. In [this thread](https://forum.wiznet.io/t/topic/6123) it is more clear. Any help will be much appreciated.

Thanks Hi~ aripod
I have answered  your question and I 'm looking forward to an answer.

thanks,
BR
irina ","Q) What do you mean with the *dummy* byte?
Q) The question now is, should I keep it like that, toggling SS with every byte or keep it low until the last byte is transmitted like the manual shows?

A) If both ways work for you, I would recommend doing it as described in the manual since I'd say that this is more logical from the interface point of view.

Q) Hi~ aripod, I went back to this project and I see that the pulses over MISO are out of sync with SCLK and their width is shorter than SCLK's period. In [this thread](https://forum.wiznet.io/t/topic/6123) it is more clear. Any help will be much appreciated.

A) I have answered your question and I 'm looking forward to an answer."
3200,5633,"Excellent!Now you can easily find private conversations at any time, from the [section of your profile markers] (https://forum.wiznet.io/u/kwendenarmo/activity/bookmarks).You just have to select the photo of your profile in the upper right of the screen &#8599;

What follows, can you share one of these links with me?Respond with ** the link on a separate line **, and automatically expand with a brief summary.

To copy a link, touch and hold on the mobile, or right click with your mouse:

<https://en.wikipedia.org/wiki/inherently_funny_word>
<https://en.wikipedia.org/wiki/death_by_coconut>
<https://en.wikipedia.org/wiki/calculator_spelling> Hey @kwendenarmo, I'm just verifying if you are because I haven't heard from you in a time.

- To continue, he responds at any time.

- If you like to jump this step, tell me `Salv`.

- To start over, tell me `start new user`.

If you prefer not to continue, this ok too!I am a robot.Do not hurt my feelings.: SOB: https://en.wikipedia.org/wiki/Calculator_spelling :poop: That is: Sparkles: _emojitstic! _: Sparkles:

Sometimes, you want to capture someone's attention in a debate, even if you are not responding to your message directly.For this, he writes `@` followed by the user's name you want to mention.
Can you mention ** `@discobot` ** in your answer? Hi @Discobot _Alguien said my name!? _: Raised_hand: I think you did!: Wave: Well, here I am!Thanks to mention me.: ok_hand:

Can you make some letters in ** bold ** or _cursive_ in your response?

- Write `** bold **` `_ _cursiva_``

- Or, press the <kbd> <b> b Hey @kwendenarmo, I'm just verifying if you are because I haven't heard from you in a time.

- To continue, he responds at any time.

- If you like to jump this step, tell me `Salv`.

- To start over, tell me `start new user`.

If you prefer not to continue, this ok too!I am a robot.Do not hurt my feelings.: SOB: ** bold ** or _cursive_ Good job!HTML and BBCODE also work to format the text?Learn more in, [this tutorial] (http://commonmark.org/help): Nerd:

Can you try to quote me when you answer me, so I know what part you are answering?
> If this is coffee, please bring a bit of te;But if it's te, please bring a little coffee.
>
> One of the advantages of speaking to himself is that you know that at least someone is hearing.
>
> Some people have a path with words, and other people ... Oh, oh, they have no way.

Select the part of the text & uarr;That you prefer to cite, and then press the ** cite ** button that appears on your selection of the text?or press the button ** Reply ** under this post.

Under the appointment, write a word or two about what I wrote, because I am curious: Thinking: [quote = ""discobot, post: 12, topic: 5633""]
Some people have a path with words, and other people ... Oh, oh, they have no way.
[/quote]

ASDF :herb: Yay you found it!: tada:

- For more detailed search, go to the [complete search page] (https://forum.wiznet.io/search).

- To jump wherever you want in a long discussion, try the control line controls of the topic to the right (or below, in the mobile)

- If you have a: Keyboard: Physical, press the <kbd>?","Q) Can you share one of these links with me? 
A) Sure, here's the link: https://en.wikipedia.org/wiki/calculator_spelling. This page discusses the concept of using upside-down numbers to spell words on a calculator.

Q) Can you mention `@discobot` in your answer? 
A) Hi @Discobot! I think Alguien mentioned my name! Well, here I am! Thanks for mentioning me.

Q) Can you make some letters in ** bold ** or _cursive_ in your response? 
A) **bold** or _cursive_.

Q) Good job! HTML and BBCODE also work to format the text? 
A) Yes, HTML and BBCODE work to format the text. You can learn more in this tutorial: [this tutorial](http://commonmark.org/help).

Q) Can you try to quote me when you answer me, so I know what part you are answering? 
A) Sure, here's the part of the text you wrote: ""Some people have a path with words, and other people ... Oh, oh, they have no way.""

I'm sorry, there is no response to the non-response paragraph."
3201,5636,"Hello,

I use the W5500 on a dsPIC33E. I would like to start with simple tests, sharing simple data. The thing is I do not really know where to start. Didn't find a ""getting started"" or something to understand the whole procedure on how to start a talk between PC and Microcontroller and what happens on the SPI Lines. I use the ioLibrary. I know this sounds a bit harsh but I just want to know on how I should get into this.

Would appreciate any help
thanks
-Kira I'll start by looking into these example projects for their eval board:

https://github.com/Wiznet/W5500_EVB

Porting the library to the dsPIC environment usually involves implementing all the callback functions in wizchip_conf.c from the ...\ioLibrary\Ethernet folder.

You'll likely need to implement DHCP client and DNS client code, which you can find in the ""internet"" folder. The ioLibrary is not interrupt driven. This means the socket status registers need to be polled constantly.  This also means it is a good idea to use the non-blocking socket option if you have multiple sockets running. If you only want to send some UDP or TCP packets across your network, you won't even necessarily need DHCP or DNS. I think for beginners it would be easier to just manually set an IP similar to those already present in the network. 
Then check whether the LINK is up and if you can ping the device, if that works, you can try to open a port (UDP might be easier for starters) and then use a terminal like Wireshark to see if your computer receives the packets. After that, you could start adapting that structure to your requirements.","Q) I use the W5500 on a dsPIC33E. I would like to start with simple tests, sharing simple data. The thing is I do not really know where to start. Didn't find a ""getting started"" or something to understand the whole procedure on how to start a talk between PC and Microcontroller and what happens on the SPI Lines. I use the ioLibrary. I know this sounds a bit harsh but I just want to know on how I should get into this.
Would appreciate any help
thanks
-Kira

A) I'll start by looking into these example projects for their eval board:
https://github.com/Wiznet/W5500_EVB
Porting the library to the dsPIC environment usually involves implementing all the callback functions in wizchip_conf.c from the ...\ioLibrary\Ethernet folder.
You'll likely need to implement DHCP client and DNS client code, which you can find in the ""internet"" folder. The ioLibrary is not interrupt driven. This means the socket status registers need to be polled constantly. This also means it is a good idea to use the non-blocking socket option if you have multiple sockets running. If you only want to send some UDP or TCP packets across your network, you won't even necessarily need DHCP or DNS. I think for beginners it would be easier to just manually set an IP similar to those already present in the network. Then check whether the LINK is up and if you can ping the device, if that works, you can try to open a port (UDP might be easier for starters) and then use a terminal like Wireshark to see if your computer receives the packets. After that, you could start adapting that structure to your requirements."
3202,5638,"https://forum.wiznet.io/t/topic/5633/16

Ã¯Â¿?Â¿Â¢u Ã¯Â¿?Â¿Â¢u Ã¯Â¿?Â¿Â¢u Hello!To find out what I can do, write `@discobot Show help`.","Q) Hello!To find out what I can do, write `@discobot Show help`.
A) None."
3203,5642,"Search the serial port with Wizfi to the terminal and search the wireless LAN signal in the station mode
I went to a wireless LAN trying to connect
Serial Port -TCP/IP communication is good.

But I want to go back to AP mode
In the situation mode as above, can you press the physical button to enter the AP mode?
No matter how much I put the AT command, I can only exchange it as a string at all. hello

If you set the last parameter of the scon command you used when connecting the socket to '1', it will work in data mode.
The data mode is described as described, and it is a mode that transmits all the serial data to WiFi.
Please refer to the description of the mode below

https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250pg:Start#plugin__Products__wizfi250__Wizfi250pg__at_command _Set-CMD_DATA_MODE

In data mode, you can enter '+++' to use the AT command again.

To operate again in AP mode in the station mode, you can set up the AP mode again after wleave and wjoin.
https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250pg:Start#AP_MODE_USING_WPA2_STAIP","Q) In the situation mode as above, can you press the physical button to enter the AP mode?
A) No, in the situation mode described, you cannot press the physical button to enter the AP mode. You can set up the AP mode again after wleave and wjoin in the station mode. More information can be found here: https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250pg:Start#AP_MODE_USING_WPA2_STAIP

Q) If you set the last parameter of the scon command you used when connecting the socket to '1', will it work in data mode?
A) Yes, if you set the last parameter of the scon command to '1', it will work in data mode. The data mode is described as a mode that transmits all the serial data to WiFi. More details can be found in the description of the mode here: https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250pg:Start#plugin__Products__wizfi250__Wizfi250pg__at_command_Set-CMD_DATA_MODE"
3204,5646,"I need to update the WIZ750SR firmware from my own software, by ethernet connection.
I just found the WIZ750SR Command manual (link below). It is useful to discover the connected devices, but the firmware update commands are not described. Is there any documentation of the ethernet protocol to update the firmware? Thanks!

http://wizwiki.net/wiki/doku.php?id=products:wiz750sr:commandmanual:start Hello, @TizioM
I'm so sorry for late reply.

Are you still in progress?

[quote=""TizioM, post:1, topic:5646""]
I need to update the WIZ750SR firmware from my own software,
[/quote]
WIZ750SR's firmware is divided into App and Boot areas.
Which part have you modified?

If you modified only the App part, you can use the configuration tool to update F/W with network.
You can download the configuration tool from below link.
- [WIZnet S2E Tool GUI V1.0.0](https://github.com/Wiznet/WIZnet-S2E-Tool-GUI/releases/tag/V1.0.0)
- [WIZnet S2E Tool GUI Wiki](https://github.com/Wiznet/WIZnet-S2E-Tool-GUI/wiki/Overview)

If you need to update All F/W(App+Boot), I recommend using ISP Tool.
Please refer to the following link.
- [Flash Programming using WIZISP Tool](https://docs.wiznet.io/Product/S2E-Module/WIZ750SR/developers-guide-EN#flash-programming-using-wizisp-tool) 

Thank you.","Q) Is there any documentation of the ethernet protocol to update the firmware?
A) WIZ750SR's firmware is divided into App and Boot areas. Which part have you modified? If you modified only the App part, you can use the configuration tool to update F/W with network. If you need to update All F/W(App+Boot), I recommend using ISP Tool."
3205,5647,"Hi all,
I want to set the IP address and Gateway of w5500 via LAN.

Can I get configuration tool from wiznet or we have to develop our own?

If we have to develop our own configuration tool, please provide necessary information to develop at our end. Configuration tool is called DHCP. The respective application note and maybe even code available on the WIZnet website. Hi~ Century
We supports the configuration tool for W5500S2E-S1(Serial to Ethernet module).
Link : [W5500S2E in wikipage](https://wizwiki.net/wiki/doku.php?id=products:w5500s2e-s1:start)
This site included User manual document and Configuration Tool.
I think you refer the above link.


thanks,
BR
irina I'd say that that's because if you only use the chip directly connected to your MCU, either your application has to configure the W5500 via SPI (e. g. using the C driver) or you need to use DHCP as Eugeny suggested, then it will receive its IP settings from a DHCP server (e. g. your router) like any other LAN device

EDIT: Spelling","Q) Can I get configuration tool from wiznet or we have to develop our own? If we have to develop our own configuration tool, please provide necessary information to develop at our end.
A) Hi~ Century. We support the configuration tool for W5500S2E-S1(Serial to Ethernet module). The respective application note and maybe even code available on the WIZnet website. You can refer to the User manual document and Configuration Tool in the link provided: [W5500S2E in wikipage](https://wizwiki.net/wiki/doku.php?id=products:w5500s2e-s1:start). If you only use the chip directly connected to your MCU, either your application has to configure the W5500 via SPI (e.g. using the C driver) or you need to use DHCP as suggested, then it will receive its IP settings from a DHCP server (e.g. your router) like any other LAN device."
3206,5648,"Hi..
I have W5100 Module, Can you give me TCP / IP Modbus Communication library for Atmel Studio 6 ?
I want to make industrial Equipment with TCP / IP Modbus Communication. Hey @patel_purvik, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob: [quote=""discobot, post:4, topic:5648""]
reply to me any time.
[/quote]

reply to me any time. Hey, thanks for the reply!

Unfortunately, as a poorly programmed bot, I can?Ât quite understand that one. :frowning:

You can try again, or if you?Âd like to skip this step, say `skip`. Otherwise, to start over, say `start new user`. start new user Hey @patel_purvik, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob: I need help to implement TCP / IP Modbus Communication using W5100 module, My controller is Atmega 2560 & Programming Software is Atmel Studio 6.

Please help me. Hey @patel_purvik, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start new user`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob:","Q) I have W5100 Module, Can you give me TCP / IP Modbus Communication library for Atmel Studio 6?
Q) I want to make industrial Equipment with TCP / IP Modbus Communication. 
Q) I need help to implement TCP / IP Modbus Communication using W5100 module, My controller is Atmega 2560 & Programming Software is Atmel Studio 6. 
A) Unfortunately, as a poorly programmed bot, I can't quite understand that one. :frowning: You can try again, or if you'd like to skip this step, say `skip`. Otherwise, to start over, say `start new user`."
3207,5649,"I'm doing a development based on the W5500 for industrial environment, which is an update of the same design based on the W5100. The previous board based on the W5100 has been running 24/7 for more than two years without any incident, while the prototype of the new version did not get it to work properly for more than a week or week and a half, and we are nearing the deadline of the design phase.

Hardware development is based on the W5500 datasheet and application note. We have developed four different versions of prototypes and several copies of each version, the last of them is almost a clone of the schematic of the W5500 Ethernet Shield v1.1, none of them works well. The same tests with chinese modules, the official wiznet shield, and with the Arduino Ethernet Shield 2 work correctly. The control is done with an ATmega2560 and the Arduino Ethernet v2.0.0 library. The application opens two TCP ports as two servers, and a total of two connections to each port are opened (for some reason five sockets are occupied).

The faults are different for each board and not always the same. Each prototype board fails differently, even those that are the same PCB. I am finding several strange bugs, which occur in an indeterminate period from the start of the program, which can be from minutes to more than a week:

- Closure of one of the open sockets, with the ability to reopen them.
- Closure of all open sockets, cannot be reopened without reset.
- Loss of communication with the W5500, requires reset.
- Random ethernet data corruption, with different incidence.
- Link failure
- IP badly assigned, (one is assigned and reads a totally different one).
- Always indicates the cable is not connected, when it is connected and the communication is satisfactory.
- Combinations of the above

In my system there are no other SPI devices that can affect communication or other tasks in the firmware. There are also no IP or MAC conflicts.

I am not able to isolate the source of the problem, because things that work for some boards do not work for others, there being no common nexus and none of the faults correlate with the assembly of the prototype. None of this has happened to me before when working with the version that used the W5100 and we don't understand what's at issue. The manufacture of these prototypes is done manually and I believe that due to ESD or inadequate temperature curves the chips fail. But I'm also not able to locate what the fault is, and I need to make sure that in the production phase everything works.

I find it very rare that none of my prototypes have worked as long as several third-party boards based on the same chip did so in the same test environment. I believe that all our faults should be solved by PCBA manufacturing, but information on this is very welcome.

If you need any extra information, such as our schematic or PCB, ask me what you need and I will provide it to you without problem. [quote=""kwendenarmo, post:1, topic:5649""]
The manufacture of these prototypes is done manually and I believe that due to ESD or inadequate temperature curves the chips fail.
[/quote]

It may help if you explain the way you soldered chips you have now on boards.

I think these are the causes, especially overheating. I had to replace 30 W5100s some time ago because almost all of them were behaving weirdly, and I identified that I used too high temp when hand soldering.

Take another W5500 chip, remove existing, and solder this new chip in at the temperature recommended within the datasheet. [quote=""Eugeny, post:2, topic:5649""]
It may help if you explain the way you soldered chips you have now on boards.
[/quote]

All are drag soldered using a non ESD-free chinese soldering station. Same technique and soldering station that I used for the prototypes of the previous plate based on the W5100 without problem, considering that the W5100 has a smaller pitch and is more complex to solder.

I knew this could introduce bugs, but I also have experience soldering this type of components and as there was no problem with previous chips I was confident that not all of them were affected or there were more things involved.

[quote=""Eugeny, post:2, topic:5649""]
I had to replace 30 W5100s some time ago because almost all of them were behaving weirdly, and I identified that I used too high temp when hand soldering.
[/quote]

I'm glad to know it's a problem that may be the cause of something tangible.

[quote=""Eugeny, post:2, topic:5649""]
Take another W5500 chip, remove existing, and solder this new chip in at the temperature recommended within the datasheet.
[/quote]

I'll try to replace one as soon as I can, and see if I have different results. Thank you. I'll keep you posted. These are six [prototype development](https://designprosusa.com/prototype-development-services) design 
Determine the fundamental requirements.
Make a concept sketch...
Create a virtual prototype.
Make an initial handcrafted prototype.
Use the initial prototype to identify and correct design flaws.
Finish your design to make a final prototype.
Don't pass up articles like this.","Q) I'm doing a development based on the W5500 for industrial environment, which is an update of the same design based on the W5100. The previous board based on the W5100 has been running 24/7 for more than two years without any incident, while the prototype of the new version did not get it to work properly for more than a week or week and a half, and we are nearing the deadline of the design phase.

The faults are different for each board and not always the same. Each prototype board fails differently, even those that are the same PCB. I am finding several strange bugs, which occur in an indeterminate period from the start of the program, which can be from minutes to more than a week:

- Closure of one of the open sockets, with the ability to reopen them.
- Closure of all open sockets, cannot be reopened without reset.
- Loss of communication with the W5500, requires reset.
- Random ethernet data corruption, with different incidence.
- Link failure
- IP badly assigned, (one is assigned and reads a totally different one).
- Always indicates the cable is not connected, when it is connected and the communication is satisfactory.
- Combinations of the above

In my system there are no other SPI devices that can affect communication or other tasks in the firmware. There are also no IP or MAC conflicts.

I am not able to isolate the source of the problem because things that work for some boards do not work for others, there being no common nexus and none of the faults correlate with the assembly of the prototype. None of this has happened to me before when working with the version that used the W5100 and we don't understand what's at issue. The manufacture of these prototypes is done manually and I believe that due to ESD or inadequate temperature curves the chips fail. But I'm also not able to locate what the fault is, and I need to make sure that in the production phase everything works.

It may help if you explain the way you soldered chips you have now on boards.

If you need any extra information, such as our schematic or PCB, ask me what you need and I will provide it to you without problem.

A) All are drag soldered using a non ESD-free Chinese soldering station. Same technique and soldering station that I used for the prototypes of the previous plate based on the W5100 without problem, considering that the W5100 has a smaller pitch and is more complex to solder. I knew this could introduce bugs, but I also have experience soldering this type of components and as there was no problem with previous chips, I was confident that not all of them were affected or there were more things involved. I'll try to replace one as soon as I can, and see if I have different results. Thank you. I'll keep you posted."
3208,565,"Hi,

I am using a WIZ820io with an Arduino Nano. If the WIZ820io is the only device on the SPI Bus it is working correctly. But when I add a second device (a MFRC522 RFID-Reader) to the SPI Bus - the module is not working any more. (MFRC522 => Works, WIZ820io => Not working)

I found an application note for w5100 which says that the SEN-Pin must be changed. But the w5200 didn't have such a SEN-pin.

What could be the problem??? Hi,
SEN means SPIEN pin #6 in W5200. Hi,

but i can't set this pin. It doesn't have a pin outside of wiz820io :frowning:. Hi,
WIZ810io have no SPIEN pin. you are right.
WIZ810io doesn't support mulit-slave.

I recommend that you will replace WIZ820io with W5200 ehternet sheild.
refer to
[url]http://www.wiznet.co.kr/sub_modules/en/product/Product_Detail.asp?cate1=5&cate2=81&cate3=82&pid=1208[/url]

Thanks. Hi,
The above my post is wrong. I am sorry that I mis-understood W5200 with W5100.
W5200 have no problem using multi slave.
So, WIZ820io have no SEN pin.

If you can't use it with others, It maybe have another problem.

thanks.","Q) What could be the problem with using WIZ820io and a MFRC522 RFID-Reader on the same SPI Bus?
Q) What could be the problem with using WIZ820io and a MFRC522 RFID-Reader on the same SPI Bus?
A) Hi, SEN means SPIEN pin #6 in W5200.
A) but i can't set this pin. It doesn't have a pin outside of wiz820io :frowning:.
A) WIZ810io have no SPIEN pin. you are right. WIZ810io doesn't support mulit-slave.
A) I recommend that you will replace WIZ820io with W5200 ehternet shield. refer to [url]http://www.wiznet.co.kr/sub_modules/en/product/Product_Detail.asp?cate1=5&cate2=81&cate3=82&pid=1208[/url]
A) The above my post is wrong. I am sorry that I mis-understood W5200 with W5100. W5200 have no problem using multi slave. So, WIZ820io have no SEN pin.
A) If you can't use it with others, It may have another problem."
3209,5650,"Hi,

I configured the W5500 to be a server with no delay ACK  (S0_MR(5) = 1) using socket 0 only.  I wrote my own drivers and libs using TI TMS320F28335 MC.

My Tx data size is only 15 bytes, so I assume it will never exceed the max Tx size.  Here is the process of preparing and sending data:

1. Read the pointer address at S0_TX_WR
2. Save my data to Tx buffer (BSB=0x02) beginning at the above pointer address to the size of my data (i.e. 15)
3. Update S0_TX_WR  (15+above pointer address)
4. Command S0_CR = 0x20

Occasionally, the Tx data was wrong, and I captured a few of them here

Original data: 0 1 2  3 4 5 6 7 8 9 A B C D E
Data received from the client:
    . Case 1:  0 1 2 3 4 5 6 0 0 9 A B C
    . Case 2:  0 1 2 3 4 5 6 0 0 9 A B 0x1E

There are many others error in data, but this happened occasionally, and almost 4 or 5 out of 100 times of Tx.

Could you guy look into my process and see if I did any wrong here and give me your recommendation?

Thank you very much. Print bytes you put into the TX buffer onto the screen / diagnostic console - literally - when you put byte to the TX buffer also print it onto the screen. It may happen there's something corrupting characters during data move (e.g. interrupt routine not saving accumulator). Then check packets from the W5500 to see what data is in packets. If this problem is not completely deterministic, maybe the SPI frequency is too high? Because with an increased frequency, the probability for errors also increases; furthermore the data that is transmitted from the host MCU to the W5500 doesn not have a checksum. You could try reading back your TX data after writing it to the buffer and see if the data matches The W5500 datasheet says the device is stable up to SPI clock rates of 33.3MHz (Section 5.5.4 SPI Timing). I know that, but I can't see where OP mentioned that he does not exceed that frequency. Furthermore the chip's SPI isn't necessarily the only thing that might have trouble with a high clock frequency; Depending on the host MCU or the layout, other issues might arise too. You made a valid point; I was providing more detail. Sadly, RTFM is a dying art. [quote=""Mxyxixptlick, post:6, topic:5650""]
I was providing more detail.
[/quote]

I thank you for that :slight_smile:
 
When I get this sort of issue, I mostly try drastically lowering the frequency, to verify whether it is an issue.
I think, that fact that 0x0C = 0000 1100 and 0x1E = 0001 1110 and that he said

[quote=""Mtuan, post:1, topic:5650""]
There are many others error in data, but this happened occasionally, and almost 4 or 5 out of 100 times of Tx.
[/quote]

might support this idea, because it looks like something is skewed.

[quote=""Mxyxixptlick, post:6, topic:5650""]
Sadly, RTFM is a dying art.
[/quote]

You're absolutely right. Thanks for all of your helps.

I lowered my spi baud rate, and it helped a little not totally.  However, it does not make sense unless my board is very noisy. Did you try to implement a readback to see if the data makes it all the way to the chip?
Could you find any pattern as to under which circumstances this happens?
And out of curiousity: What was your frequency before and after, if I may ask? Are there other SPI-connected devices in your system? If so, have you set their CS pin as an output and forced it to be HIGH? [quote=""Philipp_K, post:9, topic:5650""]
Did you try to implement a readback to see if the data makes it all the way to the chip?
[/quote]

Yes, I did.  I verified data before updating S0_TX_WR pointer, and I found that occasionally few bytes of Tx data was loaded incorrectly when error occurred.

[quote=""Philipp_K, post:9, topic:5650""]
Could you find any pattern as to under which circumstances this happens?
[/quote]  

Not in pattern, but most of the time, error appeared to be coincidentally happened when the computer broadcast ""Whohas""


[quote=""Philipp_K, post:9, topic:5650""]
And out of curiousity: What was your frequency before and after, if I may ask?
[/quote]

I was running at 500Khz bit clock, and reduced to 50Khz...This does not help much - I think

[quote=""Mxyxixptlick, post:10, topic:5650, full:true""]
Are there other SPI-connected devices in your system? If so, have you set their CS pin as an output and forced it to be HIGH?
[/quote]

There are a few more ICs (i.e. EEPROM, Encoder, and Switches) connected in the spi bus, but they should not be active because their CSx pins having pulled up resistors by default. 

I've also seen that S0_SR having a few weird states such as 0x01, 0x02, 0x03 during disconnect and re-open the socket. [quote=""Mtuan, post:11, topic:5650""]
Yes, I did. I verified data before updating S0_TX_WR pointer, and I found that occasionally few bytes of Tx data was loaded incorrectly when error occurred.
[/quote]

Where those the same bytes that ultimately were received wrong too?

[quote=""Mtuan, post:11, topic:5650""]
I was running at 500Khz bit clock, and reduced to 50Khz?Â¦This does not help much - I think
[/quote]
 
Neither should be an issue

[quote=""Mtuan, post:11, topic:5650""]
There are a few more ICs (i.e. EEPROM, Encoder, and Switches) connected in the spi bus, but they should not be active because their CSx pins having pulled up resistors by default.
[/quote]

Only Pull-Up resistors? Or do you actively drive the pins high when de-selecting the devices? Did you verify the levels?

Do you maybe have oscilloscope screenshots of the SPI waveforms? I found the issue, and it sounds weird.

I was reading S0_TX_RD as my TX pointer.  After carefully reading the data sheet, I changed my pointer by reading S0_TX_WR.  everything is correct after that.

What is the different between S0_TX_RD and S0_TX_WR beside [R] and [R/W], and as well as S0_RX_RD and S0_RX_WR?

When do we use them in the code?  

Thanks y'all [quote=""Mtuan, post:14, topic:5650""]
What is the different between S0_TX_RD and S0_TX_WR beside [R] and [R/W], and as well as S0_RX_RD and S0_RX_WR?
[/quote]

TX_FSR is being calculated basing on the difference between these two pointers. RD is internal pointer for the stack, WR is pointer for driver data load into TX buffer. [quote=""Eugeny, post:15, topic:5650""]
TX_FSR is being calculated basing on the difference between these two pointers. RD is internal pointer for the stack, WR is pointer for driver data load into TX buffer.
[/quote]

Alright, it is clear.  Thank you much for your clarification.","Q) Could you guy look into my process and see if I did any wrong here and give me your recommendation?
A) I found the issue, and it sounds weird. I was reading S0_TX_RD as my TX pointer. After carefully reading the data sheet, I changed my pointer by reading S0_TX_WR. Everything is correct after that.

Q) What is the different between S0_TX_RD and S0_TX_WR beside [R] and [R/W], and as well as S0_RX_RD and S0_RX_WR?
A) TX_FSR is being calculated based on the difference between these two pointers. RD is the internal pointer for the stack, WR is the pointer for the driver to load data into the TX buffer.

Q) When do we use them in the code?
A) TX_FSR is used in the code for calculating the difference between the TX_RD and TX_WR pointers. RD is used as the internal pointer for the stack, and WR is used as the pointer for the driver to load data into the TX buffer.

Thank you for all your helps."
3210,5652,"I am going to do HTTP communication using Wizfi310 on STM32.

Even in the programming guide, I haven't seen AT Command about HTTP communication.

Is it possible?

And if you can tell me what you can do, I would really be grateful ^^ Hello, this is Wiznet.

If you implement the HTTP protocol in the user MCU, you can use it.

Wuzfi310 is only WiFi to Uart.

thank you","Q) Is it possible to do HTTP communication using Wizfi310 on STM32? And if you can tell me what you can do?
A) If you implement the HTTP protocol in the user MCU, you can use it. Wizfi310 is only WiFi to Uart."
3211,5654,"Hi all,

I am using ioLibrary_Driver-master for DHCP, I am not getting any response from the DHCP.

/* PARSE REPLY pDHCPMSG */
int8_t parseDHCPMSG(void)
{
	uint8_t svr_addr[6];
	uint16_t  svr_port;
	uint16_t len;

	uint8_t * p;
	uint8_t * e;
	uint8_t type = 0;
	uint8_t opt_len;
   
   if((len = getSn_RX_RSR(DHCP_SOCKET)) > 0)
   {
   	len = recvfrom(DHCP_SOCKET, (uint8_t *)pDHCPMSG, len, svr_addr, &svr_port);
   #ifdef _DHCP_DEBUG_   
      printf(""DHCP message : %d.%d.%d.%d(%d) %d received. \r\n"",svr_addr[0],svr_addr[1],svr_addr[2], svr_addr[3],svr_port, len);
   #endif   
   }
   else
	   return 0;
	if (svr_port == DHCP_SERVER_PORT)
	{
      // compare mac address
		if ( (pDHCPMSG->chaddr[0] != DHCP_CHADDR[0]) || (pDHCPMSG->chaddr[1] != DHCP_CHADDR[1]) ||
		     (pDHCPMSG->chaddr[2] != DHCP_CHADDR[2]) || (pDHCPMSG->chaddr[3] != DHCP_CHADDR[3]) ||
		     (pDHCPMSG->chaddr[4] != DHCP_CHADDR[4]) || (pDHCPMSG->chaddr[5] != DHCP_CHADDR[5])   )
         return 0;
		p = (uint8_t *)(&pDHCPMSG->op);
		p = p + 240;      // 240 = sizeof(RIP_MSG) + MAGIC_COOKIE size in RIP_MSG.opt - sizeof(RIP_MSG.opt)
		e = p + (len - 240);

		while ( p < e ) {

			switch ( *p ) {

   			case endOption :
   			   p = e;   // for break while(p < e)
   				break;
            case padOption :
   				p++;
   				break;
   			case dhcpMessageType :
   				p++;
   				p++;
   				type = *p++;
   				break;
   			case subnetMask :
   				p++;
   				p++;
   				DHCP_allocated_sn[0] = *p++;
   				DHCP_allocated_sn[1] = *p++;
   				DHCP_allocated_sn[2] = *p++;
   				DHCP_allocated_sn[3] = *p++;
   				break;
   			case routersOnSubnet :
   				p++;
   				opt_len = *p++;       
   				DHCP_allocated_gw[0] = *p++;
   				DHCP_allocated_gw[1] = *p++;
   				DHCP_allocated_gw[2] = *p++;
   				DHCP_allocated_gw[3] = *p++;
   				p = p + (opt_len - 4);
   				break;
   			case dns :
   				p++;                  
   				opt_len = *p++;       
   				DHCP_allocated_dns[0] = *p++;
   				DHCP_allocated_dns[1] = *p++;
   				DHCP_allocated_dns[2] = *p++;
   				DHCP_allocated_dns[3] = *p++;
   				p = p + (opt_len - 4);
   				break;
   			case dhcpIPaddrLeaseTime :
   				p++;
   				opt_len = *p++;
   				dhcp_lease_time  = *p++;
   				dhcp_lease_time  = (dhcp_lease_time << 8) + *p++;
   				dhcp_lease_time  = (dhcp_lease_time << 8) + *p++;
   				dhcp_lease_time  = (dhcp_lease_time << 8) + *p++;
            #ifdef _DHCP_DEBUG_  
               dhcp_lease_time = 10;
 				#endif
   				break;
   			case dhcpServerIdentifier :
   				p++;
   				opt_len = *p++;
   				DHCP_SIP[0] = *p++;
   				DHCP_SIP[1] = *p++;
   				DHCP_SIP[2] = *p++;
   				DHCP_SIP[3] = *p++;
   				break;
   			default :
   				p++;
   				opt_len = *p++;
   				p += opt_len;
   				break;
			} // switch
		} // while
	} // if
	return	type;
}

for the above function I am always getting 0 response.

Please help me out, what could be the mistake and any error on DHCP init.

Thanks. Thank You, Will look into it. Greetings,
It seems that this link   https://wizwiki.net/wiki/doku.php?id=products:w5500:driver  is no longer exists.   Is there is an alternative link I can go to?

Regards","Q) Please help me out, what could be the mistake and any error on DHCP init.
Q) It seems that this link  https://wizwiki.net/wiki/doku.php?id=products:w5500:driver is no longer exists. Is there is an alternative link I can go to?
A) Here, the user is asking for help in troubleshooting the issue with DHCP initialization and in finding an alternative link for the non-existing URL."
3212,5659,"Greetings,

My W5500 is stuck in 10MBPS 1/2 Duplex mode. When it auto negotiates with my switch, it won't choose 100MBPS / Full Duplex.  Further, Even if I set the phy to 100mbit it just falls back to 10mbps immediately.

Thanks in advance for your help!

Here's my source code:

 void initWizchip()
 {
	wiz_NetInfo netInfo;
	wiz_PhyConf phyConf;
	
	getRunningNetConfig(&netInfo);  
	

	ETH_CS_set_level(true);	// high select.
	ETH_RST_set_level(false); // hold the chip in reset.

	reg_wizchip_cris_cbfunc(wizCritEnter, wizCritExit);
	reg_wizchip_cs_cbfunc(wizChipSelect, wizChipDeselect);
	reg_wizchip_spi_cbfunc(wizReadByte, wizWriteByte);
	reg_wizchip_spiburst_cbfunc(wizSpiRead, wizSpiWrite);

	_delay_ms(50);			// wait for the chip to reset.
	ETH_RST_set_level(true);
	_delay_ms(50);
	
	phyConf.by = PHY_CONFBY_SW;
	phyConf.duplex = PHY_DUPLEX_FULL;
	phyConf.mode = PHY_MODE_MANUAL;
	phyConf.speed = PHY_SPEED_100;	

	wizphy_setphyconf(&phyConf);

	ctlnetwork(CN_SET_NETINFO, (void*)&netInfo);
	
 } hello,

Are you really half-duplex at 10mbps?
If you do not configure phy, the W5500 will work with auto negoation, which is the default setting.

If you set it to 100mbps, the link is caught at 100mbps or not caught.
So I think that you are not doing the right thing, or might be wrong. I have the exact same issue. I set it up:

```
    phyConf.by = PHY_CONFBY_SW;
    phyConf.speed = PHY_SPEED_100;
    phyConf.duplex = PHY_DUPLEX_FULL;
    phyConf.mode = PHY_MODE_MANUAL;
    wizphy_setphyconf(&phyConf);
```

But it keeps defaulting to 10 half. On all routers and  networks. @becky any advice? I notice there hasn't been any action on this topic for a while and disappointingly there has also been no resolution.

I have the same issue when setting PHY_MODE_AUTONEGO using the github libraries.

When PHY configuration is set as per below, I get 100M Full duplex.

> static wiz_PhyConf phyConf =
> {
>         PHY_CONFBY_SW,
>         PHY_MODE_MANUAL,
>         PHY_SPEED_100,
>         PHY_DUPLEX_FULL,
> };

however, when I set as follows, it drops down to 10M Half Duplex

> static wiz_PhyConf phyConf =
> {
>         PHY_CONFBY_SW, 
>         PHY_MODE_AUTONEGO,
>         PHY_SPEED_100,
>         PHY_DUPLEX_FULL,
> }; It seems `PHY_MODE_AUTONEGO` [overrides](https://github.com/Wiznet/ioLibrary_Driver/blob/master/Ethernet/wizchip_conf.c#L752) all other settings and causes chip to auto-negotiate, and it can only auto-negotiate at 10M/H. Why? No idea... probably other device is set to auto-negotiate too, and they start with 10M/H and find connection and even do not try higher speeds and full duplex. Check and play with other device's settings. I've verified the issues directly on a switch that I know works properly.  Auto negotiation does not start at the slowest speed, it will agree on the fastest speed (bandwidth actually) that both sides support and configure for that.

Basically, when set to auto negotiate or HW controlled it will connect at 10M Half duplex, whereas if I force it to 100M Full, it works there as well.

UPDATE: OK, I think it is negotiating correctly to 100M however this doesn't seem to be reflected when calling the function ""void wizphy_getphyconf(wiz_PhyConf* phyconf)"" and I'm not sure that the function is even correct looking at how it works.

If I call the following function I appear to get the results I expect so whilst not being a huge issue, I'd still like to get to the bottom of why the above function works in the way it does.


> void wizphy_getphystat(wiz_PhyConf* phyconf)
> {
>     uint8_t tmp = getPHYCFGR();
>     phyconf->duplex = (tmp & PHYCFGR_DPX_FULL) ? PHY_DUPLEX_FULL : PHY_DUPLEX_HALF;
>     phyconf->speed  = (tmp & PHYCFGR_SPD_100) ? PHY_SPEED_100 : PHY_SPEED_10;
> } ```
#define PHYCFGR_DPX_FULL             (1<<2)
#define PHYCFGR_DPX_HALF             (0<<2)
#define PHYCFGR_SPD_100              (1<<1)
#define PHYCFGR_SPD_10               (0<<1)
```
Seems to be correct bit assignment according to W5500's PHYCFGR register.
```
#define PHY_SPEED_10             0     ///< Link Speed 10
#define PHY_SPEED_100            1     ///< Link Speed 100
#define PHY_DUPLEX_HALF          0     ///< Link Half-Duplex
#define PHY_DUPLEX_FULL          1     ///< Link Full-Duplex
```
The ultimate truth is the value of the PHYCFGR register. Read it using
```
uint8_t tmp = getPHYCFGR();
```
and check its bits according to the description in the datasheet. Does its reading look incorrect? Yes, I am getting the correct return from getPHYCFGR(), the problem seems to be with that I was using function void wizphy_getphyconf(wiz_PhyConf* phyconf) to read the results.  Looking at this function, and based on getPHYCFGR returning a value of 255 for 100M Full, Auto Negotiation the function is loading the following into the phyconf structure.


```
void wizphy_getphyconf(wiz_PhyConf* phyconf)
{
    uint8_t tmp = 0;
    tmp = getPHYCFGR();
    
    phyconf->by   = (tmp & PHYCFGR_OPMD) ? PHY_CONFBY_SW : PHY_CONFBY_HW;
```
255 & (1<<6) = 64 -> PHY_CONFBY_SW -> Correct  




```
    switch(tmp & PHYCFGR_OPMDC_ALLA)
    {
        case PHYCFGR_OPMDC_ALLA:
        case PHYCFGR_OPMDC_100FA:
        {
            phyconf->mode = PHY_MODE_AUTONEGO;
            break;
        }
        
        default:
        {
            phyconf->mode = PHY_MODE_MANUAL;
            break;
        }
```
 255 & (7<<3) = 56 --> Goes to default, this is incorrect and will never match the first two cases.


```
    switch(tmp & PHYCFGR_OPMDC_ALLA)
    {
        case PHYCFGR_OPMDC_100FA:
        case PHYCFGR_OPMDC_100F:
        case PHYCFGR_OPMDC_100H:
        {
            phyconf->speed = PHY_SPEED_100;
            break;
        }
        
        default:
        {
            phyconf->speed = PHY_SPEED_10;
            break;
        }
    }
```

Again,  255 & (7<<3) = 56 --> Goes to default, this is incorrect and will never match the first three cases.


This is where I'm getting the incorrect result from.  As you suggested, if I just look at the bit result from getPHYCFGR() then I guess that will give me the correct result.  Just think that the above function I highlighted needs to be looked at.","Q) Are you really half-duplex at 10mbps? If you do not configure phy, the W5500 will work with auto negotiation, which is the default setting. If you set it to 100mbps, the link is caught at 100mbps or not caught. So I think that you are not doing the right thing, or might be wrong. I have the exact same issue. Any advice? I notice there hasn't been any action on this topic for a while and disappointingly there has also been no resolution. I have the same issue when setting PHY_MODE_AUTONEGO using the github libraries. Why? No idea... probably other device is set to auto-negotiate too, and they start with 10M/H and find connection and even do not try higher speeds and full duplex. Check and play with other device's settings. 

A) When set to auto negotiate or HW controlled, it will connect at 10M Half duplex, whereas if I force it to 100M Full, it works there as well. The ultimate truth is the value of the PHYCFGR register. Read it using uint8_t tmp = getPHYCFGR(); and check its bits according to the description in the datasheet. Yes, I am getting the correct return from getPHYCFGR(), the problem seems to be with that I was using function void wizphy_getphyconf(wiz_PhyConf* phyconf) to read the results. As you suggested, if I just look at the bit result from getPHYCFGR() then I guess that will give me the correct result. Just think that the above function I highlighted needs to be looked at."
3213,566,"The ability to implement is to send a ping to a PC or other equipment from the W5500 to receive a response.

I checked the ping test from the PC to the W5500.

Existing use in the W3100 or W5100, the Protocol IP RAW MODE setting value is 0x01 to ICMP

I sent it and implemented it.

In the W5500, there is no related register, so the Ping transmission function is not implemented.

** I would like to know how to send ping to PC or other equipment from W5500. Hello ^_ ^

If you want to use the ipraw mode of the W5500,
You can implement it in the same way as the existing chip.

Currently, DataSheet is not specified, but the iPraw mode is the same as the existing chip.

Thanks,: slight_smile: IPRAW MODE is also available at the W5500, but
The lack of information on the DataSheet is not used much, and there is a lot of technical inquiries.
Existing W3100 and W5100 users can be used by implementing iPRAW MODE in the same way.
Socket Mode Definition is the same as before,
How to use is also the same as before. I'm faithful to Data Sheet ...: MRGreen:
Has confirmed.
thank you
 : Smiley:: Smiley:","Q) I would like to know how to send ping to PC or other equipment from W5500. 
A) If you want to use the ipraw mode of the W5500, You can implement it in the same way as the existing chip. Currently, DataSheet is not specified, but the iPraw mode is the same as the existing chip. IPRAW MODE is also available at the W5500, but The lack of information on the DataSheet is not used much, and there is a lot of technical inquiries. Existing W3100 and W5100 users can be used by implementing iPRAW MODE in the same way. Socket Mode Definition is the same as before, How to use is also the same as before."
3214,5662,"I created a TCP server using W5500 for Modbus TCP.  Everything works well, but the W5500 port is freeze after exchanging several thousand transactions of BACnet packets  with a client.

However, spi port of W5500 is still working because simulation on the micro-controller and scope are still getiing data back from W5500.

Ping request from the PC was time out and packet lost was 100%

From the spi port, S0_SR=0x14, and S0_IR=0x00.

W5500 did not take any S0_CR command.

I had to manually sent an spi MR_7=0 to RESET W5500

This happened frequently, so what cause the W5500 to be hung like that and what is a solution in this case. The first (and only thing) that comes to my mind is writing over the borders of the socket memory. To you reset/overflow the pointers when exceeding the assigned memory areas? [quote=""Philipp_K, post:2, topic:5662""]
writing over the borders of the socket memory
[/quote]

... corrupting the chip configuration (e.g. SIP, mask, MAC address ...) I manually verified all registers after W5500's port being frozen, and I found that a SHAR0 had been changed.  The rest of the registers are all the same.

Is there an app manual that tell you what to do at each Sn_SR?  

I think I missed the action for each status or react wrongly, so would you please verify my code:

switch (Wiznet_Connection_Status)
{
	case 0x00:						            //	SOCK_CLOSED
		WiznetClearInterruptStatus(Int_AllBit);//	clear all int bit
		WiznetSocketOpen();
		WiznetSocketListen();
		break;
	case 0x13:						          //	SOCK_INT
		WiznetClearInterruptStatus(Int_AllBit);//	clear all int bit
		WiznetSocketListen();
		break;
	case 0x14:						//	Keep socket open
		WiznetSocketSendKeep();
		break;
	case 0x17:						//	SOCK_ESTABLISHED
		WiznetSocketSend();				//	Command Wiznet to send
		if (SocketInterruptStatus.SendComplete==1)
			WiznetClearInterruptStatus(Int_SendComplete);	//	Clear SEND_OK interrupt bit
		WiznetSocketSendKeep();
		break;
	case 0x1C:						//	SOCK_CLOSE_WAIT
		WiznetClearInterruptStatus(Int_AllBit);		//	clear all int bit
		WiznetSocketDisConnectCloseReOpenListen();	//	Command socket to close and reopen
		break;
	case 0x22:						//	SOCK_UDP
		break;
	case 0x42:						//	SOCK_MACRAW
		break;
	/////////////// Temporary status
	case 0x15
		break;
	case 0x16:						//	SOCK_SYNRECV
		break;
	case 0x18:						//	SOCK_FIN_WAIT
		break;
	case 0x1A:						//	SOCK_CLOSING
		break;
	case 0x1B:						//	SOCK_TIME_WAIT
		break;
	case 0x1D:						//	SOCK_LAST_ACK
		break;
	default:
		WiznetClearInterruptStatus(Int_AllBit);//	clear all int bit
		break;
}

Thank you very much. I am using the WIZNET ioLibrary, which has all the socket API source code. I can see that APIs like connect(), disconnect(), send() all check the Sn_IR register for socket timeout. Are you doing the same thing in your code? No, I wrote my own libs. [quote=""Mtuan, post:9, topic:5662""]
I got about 48000 packets correct, and about 2000 incorrect packets. I know for sure that my Spi bus is very stable because it shares with an EEPROM, and there is no error on the EEPROM at all.
[/quote]


i once had an issue that was not entirely dissimilar to yours. In my case, it was that I did not overflow the pointers correctly. I think, you idea to use the ioLibraries might eventually help you.

[quote=""Mtuan, post:9, topic:5662""]
Do you know if W5500io libs include source code for TCP server?
[/quote]

Yes they do, IIRC. You may want to consider giving this W5500 library a try. I'm using it with great success. Even if it doesn't completely meet your needs, you may gleen useful information from it.

https://github.com/SapientHetero/Ethernet","Q) What causes the W5500 to hang and what is the solution in this case?
Q) Is there an app manual that tells you what to do at each Sn_SR?
Q) Would you please verify my code?

A) The first (and only thing) that comes to my mind is writing over the borders of the socket memory. To you reset/overflow the pointers when exceeding the assigned memory areas?
A) I got about 48000 packets correct, and about 2000 incorrect packets. I know for sure that my Spi bus is very stable because it shares with an EEPROM, and there is no error on the EEPROM at all.
A) Do you know if W5500io libs include source code for TCP server?
A) Yes they do, IIRC. You may want to consider giving this W5500 library a try. I'm using it with great success. Even if it doesn't completely meet your needs, you may glean useful information from it."
3215,5664,"I am using the W5100.In the existing hardware, only the MCU was changed to something different.
If you read Getsn_sr, it will go up to 0x14.
However, if you try to connect from the PC, it will not be connected.
If you read Getsn_dipr, your PC address is represented properly.
I wonder which part should be reviewed.
192.168.4.1 is set, but when you want to connect, SN_SR will turn to 0x00 again, and 0x13-> 0x14.


1. RTR and RCR set up and solved.Isn't this reset a default setting?
2. Existing MCU does not have an error without RTR or RCR settings.Can you guess the difference?
3. Run the RECV function during the data reception test and will not be re -connected after that.Even if the reception comes in, it is a reenactment if you do not run the RECV function.What should I do?It's a parallel communication. Is this a problem?
  Connected: SN_IR (0x01), SN_SR (0x17)
 Before reading the data: sn_ir (0x05), sn_sr (0x17)
  After reading the data: sn_ir (0x00), sn_sr (0x17)
 Release: sn_ir (0x00), sn_sr (0x14)
 Connection attempt: sn_ir (0x00), sn_sr (0x16)

4. When transmitting the data, I used a Send function, but if I send it only once, the connection will be broken and the reenactment cannot be reached. The question is in response, and I will leave the result after completion.

thank you
Irina","Q) If you read Getsn_sr, it will go up to 0x14. However, if you try to connect from the PC, it will not be connected. If you read Getsn_dipr, your PC address is represented properly. I wonder which part should be reviewed. 192.168.4.1 is set, but when you want to connect, SN_SR will turn to 0x00 again, and 0x13-> 0x14.

1. RTR and RCR set up and solved. Isn't this reset a default setting?
2. Existing MCU does not have an error without RTR or RCR settings. Can you guess the difference?
3. Run the RECV function during the data reception test and will not be re-connected after that. Even if the reception comes in, it is a reenactment if you do not run the RECV function. What should I do? It's a parallel communication. Is this a problem?
Connected: SN_IR (0x01), SN_SR (0x17) Before reading the data: sn_ir (0x05), sn_sr (0x17) After reading the data: sn_ir (0x00), sn_sr (0x17) Release: sn_ir (0x00), sn_sr (0x14) Connection attempt: sn_ir (0x00), sn_sr (0x16)

A) 1. Yes, RTR and RCR are set to their default values when the W5100 is initialized. 
   2. The difference might be related to the behavior of the specific MCU with and without RTR or RCR settings. It could be affecting the connection stability. 
   3. It seems like there could be a problem with the data reception and connection maintenance. It's important to ensure proper communication and handling of parallel data to resolve the issue.

Non-response: Thank you."
3216,5665,"Hi, i'm using google translate...
Disassembled the example with wiz550web, transferred to the board.
Now the question is how to make standard HTTP authentication (login / password)? I understand the general sense that when connecting for the first time, the server should send something like this:


    > Authorization const char [] = {
    ""HTTP / 1.1 401 Authorization Required \ r \ n""
    ""Server: MyServer \ r \ n""
    ""WWW-Authenticate: Basic realm = \"" Cloud System \ ""\ r \ n""
    ""Content Type: Text / html \ r \ n""
    ""Content Length: 169 \ r \ n \ r \ n""
    ""<HTML> \ r \ n <HEAD> \ r \ n <TITLE> Error </ TITLE> \ r \ n""
    ""<META HTTP-EQUIV = \"" Content-Type \ ""CONTENT = \"" text / html; charset = ISO-8859-1 \ ""> \ r \ n""
    ""</ HEAD> \ r \ n <BODY> <H1> 401 is not authorized. </ H1> </ BODY> \ r \ n </ HTML>""
    };

But how to accept / process the answer, understand the password, etc.?
Is there a less complete example? I think your question is more HTTP-related than WizNet related.
Have a look at this:

https://en.wikipedia.org/wiki/Basic_access_authentication

Now, I don't know much about HTTP, but as I see it, the client will return a request with an Authorization header, which contains the credentials. You can evaluate them and respond with 200 if everything is okay, or 401 or any other status code that fits You're correct, Philipp_K. The HTTP specs say, ""HTTP access authentication is explained in ""HTTP Authentication: Basic and Digest Access Authentication"" [[43]](https://www.w3.org/Protocols/rfc2616/rfc2616-sec17.html#bib43)""","Q) Now the question is how to make standard HTTP authentication (login / password)? I understand the general sense that when connecting for the first time, the server should send something like this...

But how to accept / process the answer, understand the password, etc.? Is there a less complete example?

A) Now, I don't know much about HTTP, but as I see it, the client will return a request with an Authorization header, which contains the credentials. You can evaluate them and respond with 200 if everything is okay, or 401 or any other status code that fits. You're correct, Philipp_K. The HTTP specs say, ""HTTP access authentication is explained in ""HTTP Authentication: Basic and Digest Access Authentication"" [[43]](https://www.w3.org/Protocols/rfc2616/rfc2616-sec17.html#bib43)"""
3217,567,"I am using a WIZ820io modules in one of my projects. I've written code to replicate the example W5200 driver and socket layer code.

I've also written a PC client app which receives data using a TCP socket. I'm sending ~ 2kB data every 10 ms, so sending ~ 200 kB/s. Doesn't seem like that should be a challenge.

In general, the app is working most of the time. However, periodically, the send() function doesn't send all the data at once, and goes into the retry part (referring to the example TCP send).

It seems like if it ever goes into this part, it can never send all the bytes, and I get the windowfull no matter what. I've matched my code closely to the example code. I can't see any apparent differences. But, when I set a break in the retry part, it never succeeds. Not sure what to look for? Hi~~^_^

I recommend the method of using the No delay Ack.
As far as I know, If you only use send operation, W5500 don't transmit the data until timeout operation occur.
If you set up the Sn_MR(No delay Ack bit enable),you can see faster speed than previous.

And how do you transmit 2Kbyte at once? As far as I know, TCP segments maxsize is 1460byte.

thanks, :slight_smile: Hi,
I think you have a problem in tcp retransmittion.

Using wireshark progam(it's free), You can capture retansmittion packet.
Wireshark help us to analyse the problem.

Please, Capture the packet and Post it.

Thanks.","Q) I've written a PC client app which receives data using a TCP socket. I'm sending ~ 2kB data every 10 ms, so sending ~ 200 kB/s. Doesn't seem like that should be a challenge. In general, the app is working most of the time. However, periodically, the send() function doesn't send all the data at once, and goes into the retry part. It seems like if it ever goes into this part, it can never send all the bytes, and I get the windowfull no matter what. I've matched my code closely to the example code. I can't see any apparent differences. But, when I set a break in the retry part, it never succeeds. Not sure what to look for?
A) I recommend the method of using the No delay Ack. As far as I know, If you only use send operation, W5500 don't transmit the data until timeout operation occur. If you set up the Sn_MR(No delay Ack bit enable), you can see faster speed than previous. And how do you transmit 2Kbyte at once? As far as I know, TCP segments maxsize is 1460byte.

Q) Hi, I think you have a problem in tcp retransmittion. Using wireshark progam(it's free), You can capture retransmission packets. Wireshark help us to analyze the problem. Please, Capture the packet and Post it.
A) Thanks."
3218,5671,"I set my TCP Server in the SOCK_LISTEN (S0_SR = 0x14) all the time, so it can receive and immediately reply to a request from a peer every 100ms.  I am polling S0_SR every 10ms, and everything works fine.  However, the broadcast ""Who has..."" crew up my app ...???

After receiving a broadcast message, my S0_SR was changed to 0x01, 0x02, and 0x03 with S0_IR interrupt (CON, RECV, SEND_OK).  After that, my code puts it back to the SOCK_LISTEN mode again.  During the broadcast, I lost several requests from my peer, and finally the peer sent a DISCONN request.

Is there anyway to avoid the response to the broadcast or any work around this, please help.

Thank you very much. ""Who has"" is an ARP packet working at level 2. TCP/IP is at level 4. ARP packets must not affect TCP communication.

But it will affect overall communication if you use W5500 in MAC RAW mode.

[quote=""Mtuan, post:1, topic:5671""]
After receiving a broadcast message, my S0_SR was changed to 0x01, 0x02, and 0x03
[/quote]

I see your other post asking about these states. I never seen them, but they may exist and be transitional if you poll device very quickly.

[quote=""Mtuan, post:1, topic:5671""]
with S0_IR interrupt (CON, RECV, SEND_OK).
[/quote]

But this clearly means there was a communication in place. Please share Wireshark log.","Q) Is there anyway to avoid the response to the broadcast or any work around this, please help.
A) ""Who has"" is an ARP packet working at level 2. TCP/IP is at level 4. ARP packets must not affect TCP communication. But it will affect overall communication if you use W5500 in MAC RAW mode. 

Q) After receiving a broadcast message, my S0_SR was changed to 0x01, 0x02, and 0x03 with S0_IR interrupt (CON, RECV, SEND_OK).
A) I see your other post asking about these states. I never seen them, but they may exist and be transitional if you poll device very quickly. 

Q) Please share Wireshark log.
A) (None)"
3219,5672,"One common way to avoid unwanted attention from script kiddies when exposing a system to the Internet is to turn off responses to pings. The W5500 seems to respond to pings all on its own. Is there any way to configure the W5500 so it doesn't do this? I am using ioLibrary. In the wizchip_conf.h, there is a typedef enum that looks like this:

    /**
     * @ingroup DATA_TYPE
     *  Network mode
     */
    typedef enum
    {
    #if _WIZCHIP_ == 5500   
        NM_FORCEARP = (1 << 1), ///< Force to APP send whenever udp data is sent. Valid only in W5500
    #endif   
        NM_WAKEONLAN = (1 << 5), ///< Wake On Lan 
        NM_PINGBLOCK = (1 << 4), ///< Block ping-request
        NM_PPPOE = (1 << 3), ///< PPPoE mode
    } netmode_type;

And there is an API for setting the mode:

    /**
     * @ingroup extra_functions
     * @brief Set the network mode such WOL, PPPoE, Ping Block, and etc. 
     * @param pnetinfo Value of network mode. Refer to @ref netmode_type.
     */
    int8_t wizchip_setnetmode(netmode_type netmode);

The actual function:

    int8_t wizchip_setnetmode(netmode_type netmode)
    {
        uint8_t tmp = 0;
    #if _WIZCHIP_ != 5500   
        if (netmode & ~(NM_WAKEONLAN | NM_PPPOE | NM_PINGBLOCK)) return -1;
    #else
        if (netmode & ~(NM_WAKEONLAN | NM_PPPOE | NM_PINGBLOCK | NM_FORCEARP)) return -1;
    #endif      
        tmp = getMR();
        tmp |= (uint8_t)netmode;
        setMR(tmp);
        return 0;
    } Found it in the manual - ""Ping Block Mode"". Thought I had that thing memorized :slight_smile:.

Thanks!","Q) The W5500 seems to respond to pings all on its own. Is there any way to configure the W5500 so it doesn't do this? I am using ioLibrary.
A) One common way to avoid unwanted attention from script kiddies when exposing a system to the Internet is to turn off responses to pings. In the wizchip_conf.h file, there is a typedef enum called netmode_type which includes an option called NM_PINGBLOCK. This option can be used to block ping-requests. You can use the wizchip_setnetmode() API to set the network mode, including enabling the ping block mode. The function wizchip_setnetmode(netmode_type netmode) allows you to set the network mode, including the ping block mode. By passing NM_PINGBLOCK as the netmode, you can configure the W5500 to block ping requests."
3220,568,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??W5500 ?ÂÃ«ÂÂ¼?Â´Ã«Â²Â??Ã«Â²ÂÃ¬Â Â¼??ÃªÂ´??Â¨Ã­ÂÂ´ Ã«Â¬Â¸Ã¬ÂÂ ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

?ÂÃ¬ÂÂ¬ CortexM3Ã«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ W5500???ÂÃ¬ÂÂ´?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

w5500_cortexm3_firmware_for_legacy Ã«Â¥??Â¬Ã¬ÂÂ©Ã¬Â¤ÂÃ¬ÂÂ¸??
?Â¬ÃªÂ¸Â°???Â¬Ã­ÂÂ¨??w5500.c??

iolibrary_BSD  w5500.c(v102)??Ã¬Â°Â¨Ã¬ÂÂ´Ã«Â¥??ÂÃªÂ³Â  ?Â¶Ã¬ÂÂµ?ÂÃ«ÂÂ¤.(Update ?Â¬Ã­ÂÂ­??

???Â¬Ãª? w5500_cortexm3_firmware_for_legacy???Â¬Ã­ÂÂ¨???ÂÃ«ÂÂ¼?Â´Ã«Â²ÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬??Ã«Â¬Â´Ã«Â°Â©?ÂÃª???

ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³?iolibrary_BSD  w5500.c(v102)Ã«Â¥??Â´Ã¬ÂÂ©??TCP ÃªÂ´????ÂÃ¬Â ÂÃ«Â¥??ÂÃªÂ³ÂµÃ«Â°ÂÃ¬ÂÂ???ÂÃ«ÂÂÃ¬Â§???ÃªÂ¶ÂÃªÂ¸Â?Â©Ã«ÂÂ??
(MCU???ÂÃª??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤) W5500_COCORTEXM3_FIRMWARE_FOR_LEGACY is a compatible driver code for existing W5200 or W7200 users.
The Driver provided here is easy to write API NAME for easy understanding even Users who are not familiar with BSD SOCKET.
For example, there are tcpopen (), tcpsend (), udpopen ().It will not be update later.
This driver has a disadvantage of using a lot of System Resource, but it seems to be fully available if it is a Cortexm3 specification.

BSD SOCKET Driver literally uses the BSD Socket API Name.If you are familiar with Socket Program, this driver will be considered much easier.This driver is officially released by Wiznet, and it is recommended to use this version if possible.However, Application Example (NTP, FTP, HTTP, etc.) is less prepared than Legacy Driver, so if you are in a hurry, you may be burdened with porting.However, you can easily port the Application Example provided by the existing W3100, W5100, W5300, etc. (because you have used almost similar BSD Socket)

These two versions can be downloaded from Wizwiki.
[URL] http://wizwiki.net/wiki/doku.php?id=products:W5500:2Driver [/URL]","Q) What is W5500? CortexM3? Firmware for Legacy?
A) W5500 is a TCP/IP hardwired chip that includes the Internet offload co-processor. The CortexM3 is a widely-used processor in microcontrollers. The firmware for Legacy refers to a driver code for existing W5200 or W7200 users, which is compatible with W5500.

Q) What is w5500_cortexm3_firmware_for_legacy and iolibrary_BSD w5500.c(v102)?
A) w5500_cortexm3_firmware_for_legacy is a driver code for existing W5200 or W7200 users, which is compatible with W5500, while iolibrary_BSD w5500.c(v102) is a TCP driver provided by Wiznet.

Q) Where can these two versions be downloaded from?
A) These two versions can be downloaded from Wizwiki at the following URL: http://wizwiki.net/wiki/doku.php?id=products:W5500:2Driver"
3221,5682,"[W5300]
hello.
It is a company that manufactures and sells products using the W5300.
I only use it as a wire,
At the request of the customer, there was a situation in which the WiFi function had to be added.
After all, we have to use all wired and wirelesss,
I know the W5300 is not wireless.
For example, you use your Wizfi250 model, for example,
I would like to get a reference circuit with a mix of W5300 and Wizfi250.

or,
If there is a separate chipset that allows all wired and wireless wires, we will request a circuit and source.
Please answer. hello,
The reference circuit is not provided.
There is a circuit of the Wizfi250 EVB, so it is good to refer to it.
https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250EVBSCH:Start

thank you
Irina","Q) Please answer. hello, The reference circuit is not provided. There is a circuit of the Wizfi250 EVB, so it is good to refer to it. https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250EVBSCH:Start
A) The reference circuit is not provided. There is a circuit of the Wizfi250 EVB, so it is good to refer to it."
3222,5684,"https://forum.wiznet.io/t/topic/5675/1

Problem  was resolved with  erratum 2 ? Transmission Delay Thanks for letting us know. We agree there is an issue and we're looking into it.","Q) Problem was resolved with erratum 2 ? 
A) Thanks for letting us know. We agree there is an issue and we're looking into it."
3223,5686,"We are using Wiz812mj.

SPI communication between MCS and WIZ812MJ operates without a problem even if it is 3.3V.

Communications between PCs and WIZ812MJs are recognized only when it is 5V.

Is there a way to take action on this phenomenon? Hello, this is Wiznet.

What is MCS?Do you mean 8051?

How do you communicate with your PC and wiz812mj?

How can you tell me how you have been wiz812mj?

thank you Oh, I got a typo.
MCU (TMS2808)
In the configuration, the WIZ812MJ power is input to 3.3V, and the UDP and TCP mode are all data transmitted or received.
When entering 5V, it works normally.","Q) What is MCS? Do you mean 8051?
Q) How do you communicate with your PC and WIZ812MJ?

A) MCS stands for Microcontroller System, I apologize for the confusion, and it does not refer to the 8051 microcontroller specifically. As for the communication between PC and WIZ812MJ, the communication is recognized only when it operates at 5V. There seems to be a voltage dependency issue.

Q) How can you tell me how you have been wiz812mj?

A) The WIZ812MJ operates without a problem even if it is powered at 3.3V during SPI communication with MCS. However, communications between PCs and WIZ812MJs are only recognized when it is powered at 5V. This phenomenon seems to be related to the power input of the WIZ812MJ. 

Thank you for your understanding. "
3224,569,"hello

We purchased one Wizfi250 EVB around November 2013

I bought one more EVB in recent days.

But how do I do it when I don't eat Function Key on the EVB board I bought in November.

Should I upgrade EVB?

Please confirm. Please check the FW version.
Even if you exclude the function key function, you may want to upgrade to version 1.0.0.0 in the page below.

[URL] http://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250FIRMWART [/URL]","Q) Should I upgrade EVB?
Q) Please confirm. Please check the FW version.

A) You can upgrade the EVB to version 1.0.0.0. You may want to visit the following page for the firmware upgrade: [URL] http://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250FIRMWART [/URL]"
3225,5690,"hello.According to the W5100E01-AVR board, from 0x8000 to 0x8400
It's a register address value and after that, up to 0x9000 is not used.

 According to the W5100 data sheet, it is a socket register from 0x0400.

Is the W5100E01-AVR data sheet as a SOCKET register?

I wonder how it controls. https://forum.wiznet.io/t/topic/5688

This is the same question as the above question.
Please refer to the answer

thank you
Irina","Q) Is the W5100E01-AVR data sheet as a SOCKET register?
A) According to the W5100E01-AVR board, the register addresses range from 0x8000 to 0x8400, while the W5100 data sheet specifies socket registers from 0x0400 onwards. The control mechanism can be referred to in the forum link provided: https://forum.wiznet.io/t/topic/5688"
3226,5693,"I've had hackers start to load pages and apparently stop reading without closing the connection (unfortunately I'm not there to watch with WireShark when it happens). Successful SEND commands result in Sn_IR being set to SEND_OK, but if the connection is held open while the client's TCP window is deliberately left full the send can't complete. If this happens, will Sn_IR be set to TIMEOUT like it is when  ARP or TCP reads see no response? [quote=""Mxyxixptlick, post:1, topic:5693""]
will Sn_IR be set to TIMEOUT like it is when ARP or TCP reads see no response?
[/quote]

I think so (I am sure you can test it yourself). When you issue SEND command chip sends data packet(s) to the remote device, and that device must respond with ACK to confirm data reception. If ACK does not happen, originator must resend data (and I think W5500 does it). And at the retry set in respective register communication must time out.

The worst impact of your described situation is that socket remains open until time out, and this event. depending on register setting, may take up to several minutes. Thus configure the server to have 15 seconds timeout maximum. [quote=""Mxyxixptlick, post:3, topic:5693""]
You?Âd hope it times out, but I can?Ât find anything in the datasheet that says it does.
[/quote]

This is the question I wanted to ask Eugeny too. I am under the impression that there is no ""built-in"" timeout for an established socket. I know W5500 supports TCP KeepAlive via setSn_KPALVTR() API from the ioLibrary. Could this be used on the server side to detect a half-open connection? The W5500 supports timeouts for ARP and (some?) TCP operations. See pages 39 & 40 in the datasheet for info about RTR (retry time-value register) and RCR (retry count register). When a timeout occurs, Sn_IR is set to TIMEOUT (0x08) (page 49). 

From page 39: ""While waiting for ARP-response from the peer, if there is no response during the configured RTR time, a temporary timeout is occurred and ARP-request is retransmitted. It is
repeated as many as ?ÂRCR + 1??times. Even after the ARP-request retransmissions are repeated as ?ÂRCR+1??and there is no response to the ARP-request, the final timeout is occurred and Sn_IR(TIMEOUT) becomes ????""

Further down on page 39: ""At the TCP packet retransmission timeout, W5500 transmits TCP packets (SYN, FIN, RST, DATA packets) and waits for the acknowledgement (ACK) during the configured RTR time and RCR. If there is no ACK from the peer, a temporary timeout occurs and the TCP packet is retransmitted. The retransmission is repeated as many as ?ÂRCR+1?? Even after TCP retransmission is repeated as ?ÂRCR+1??and there is no response to the TCP retransmission, the final timeout is occurred and Sn_IR(TIMEOUT) becomes ????""

What's unclear (to me, anyway) is whether a timeout will occur when the send operation that would result in an ACK from the other end can't be completed. [quote=""Mxyxixptlick, post:3, topic:5693""]
I think the W5500 never finishes putting the data on the wire because the TCP window is full, so it wouldn?Ât expect an ACK.
[/quote]

This is different story, probably I misunderstood. Here you mean that your local TX buffer is not full, but it is remote device's RX buffer which is full. I was talking about local TX queue.

[quote=""Mxyxixptlick, post:3, topic:5693""]
Instead, it?Âs waiting for a Window Update that tells it to send the data in its TX buffer.
[/quote]

Very probable than you are right.

[quote=""acpie360, post:4, topic:5693""]
I am under the impression that there is no ?Âbuilt-in??timeout for an established socket.
[/quote]

There's certainly at least one timeout condition when W5x00 sends packet, but remote device does not respond with ACK. But IMHO there're circumstances when built-in network stack may ""hung"" and the only way to recover is the driving code timing out and performing forceful operations on the socket (e.g. close and reopen).

[quote=""acpie360, post:4, topic:5693""]
I know W5500 supports TCP KeepAlive via setSn_KPALVTR() API from the ioLibrary. Could this be used on the server side to detect a half-open connection?
[/quote]

This call just sends last ACK (aka duplicate ACK) to the remote device. Logically if there was no prior communication it can not be done (nothing to be ACKed so far) and that's why datasheet explicitly says that it will work only if there was communication before invoking this call.

Thus this ""keep alive packet"", being sent by W5x00, requires ACK from remote device, and it works in absolutely the same was as any other data packet - if there is no ACK from out there or RST is received, timeout occurs and socket closes.

[quote=""Mxyxixptlick, post:5, topic:5693""]
What?Âs unclear (to me, anyway) is whether a timeout will occur when the send operation that would result in an ACK from the other end can?Ât be completed.
[/quote]

I do not know answer to this question. In the described situation W5x00 receives ACK, but it does not satisfy sending conditions with remote device's RX window being zero, right? I am afraid it will continue trying forever... will be extremely glad if you can test it! I've built and deployed a version of my code that will log the value of Sn_IR if the loop that waits for a buffer to be transmitted doesn't detect a SEND_OK in Sn_IR within 35 seconds (since timeout with default values of RTR and RCR is 31.8 seconds) OR if Sn_IR is set to TIMEOUT. I'll leave it on the internet for a few days and see if it catches anything. 

Will let you know what happens.","Q) If this happens, will Sn_IR be set to TIMEOUT like it is when ARP or TCP reads see no response? 
A) I think so (I am sure you can test it yourself). When you issue SEND command chip sends data packet(s) to the remote device, and that device must respond with ACK to confirm data reception. If ACK does not happen, originator must resend data (and I think W5500 does it). And at the retry set in respective register communication must time out. 

Q) You'd hope it times out, but I can't find anything in the datasheet that says it does. 
A) This call just sends last ACK (aka duplicate ACK) to the remote device. Logically if there was no prior communication it can not be done (nothing to be ACKed so far) and that's why datasheet explicitly says that it will work only if there was communication before invoking this call. 

Q) I know W5500 supports TCP KeepAlive via setSn_KPALVTR() API from the ioLibrary. Could this be used on the server side to detect a half-open connection? 
A) This ""keep alive packet"", being sent by W5x00, requires ACK from remote device, and it works in absolutely the same was as any other data packet - if there is no ACK from out there or RST is received, timeout occurs and socket closes. 

Q) What's unclear (to me, anyway) is whether a timeout will occur when the send operation that would result in an ACK from the other end can't be completed. 
A) I do not know answer to this question. In the described situation W5x00 receives ACK, but it does not satisfy sending conditions with remote device's RX window being zero, right? I am afraid it will continue trying forever... will be extremely glad if you can test it! I've built and deployed a version of my code that will log the value of Sn_IR if the loop that waits for a buffer to be transmitted doesn't detect a SEND_OK in Sn_IR within 35 seconds (since timeout with default values of RTR and RCR is 31.8 seconds) OR if Sn_IR is set to TIMEOUT. I'll leave it on the internet for a few days and see if it catches anything. 
"
3227,5696,"Dear all.

I'm looking for clues as to what may be breaking the routine described in 4.7 of the manual.
Following the example, when my development receives a network discovery/broadcast, it then
uses the sequence to determine the MAC address of the peer device that issued the discovery packet.

All works well, reading the peer hardware/MAC address from SLHAR registers.

Problem occurs when another peer issues a discovery and the same routine is followed.
WireShark shows that the ARP packet being broadcast to the peer and the peer responding correctly.
The routine for the command to complete, then completes, as before
>        do{								 // Till command is completed
>           State = _WIZ_Get08(0x004C);		// SLCR (Socket-less Command Register)
>     									//
>        }while(State);	

then

       for(;;){							// Till Done
          State = _WIZ_Get08(0x005F);		// SLIR (Socket-less Interrupt P38)
          if(bit_test(State, 1))break;			// Reply received
          if(bit_test(State, 2)){				// Time Out
             WIZ_PIN_CS = 1;				// Chip UnSelect
             IND_FireAI();					// WireSharkless test 3
             return FALSE;					//
             								//
          }//End If						//
    									//
       }//End loop						//

Here, the problem occurs, in that the data I read from

>     _WIZ_Get(HWAdr, 0x0054, 6);   		// SLPHAR (Peer MAC from ARP)

is now stale data from the first time that the routine was run...
The result being, that data for the second peer is sent to the correct IP address ant the wrong MAC address.

Resetting the chip clears the problem but obviously, highly inefficient...
Ideas on a post card.... Datasheet says:

> Each Command must not be executed at the same time and not configured before SLCR cleared.

I suspect it is what you are looking for - you must respond to previous ARP before next ARP arrives, otherwise new ARP request overwrites previous one. Did I understand your problem correctly?

But for me it sounds ridiculous. I see that documented under section 3.1.31, however, I may not have explained that in this case, I'm not responding to ARP requests, I am sending them and then reading the result from SLPHAR. The first operation always works as expected, and subsequent operation solicits the correct network request and response. After the first response, the SLPHAR register is no longer updated, and will always contain the data from the first occasion that the SLCR[ARP] is called.

I'm not too sure what you mean by

[quote=""Eugeny, post:2, topic:5696""]
you must respond to previous ARP before next ARP arrives, otherwise new ARP request overwrites previous one
[/quote]

How do I respond to an ARP when I generated it and received the response?
May be, there something else that should be done to complete the process before issuing another ARP command?
Subsequent ARP commands and responses are not overwriting the first one in SLPHAR. So, after much experimentation, I've learned that I'm not able to clear SLIR[ARP]
This is causing the next ARP call to complete when SLCR == 0, but SLIR[APR] == 2.
Put in a long delay and SLPHAR does update with the correct response.

I guest the question now, is, how do I force SLIR clear, any one? 3.1.39 indicates [RW] OK, now I understand the counter intuitive nature of the SLIR.
In order to clear an interrupt bit, it must be set... :astonished:
My suggestion for the next revision of the manual is this.
>    </b> {
>     START :
>     /* set SOCKET-less Retransmission Time, 100ms(0x03E8) (The unit is 100us) \*/
>     SLRTR[0:1] = {0x03, 0xE8};
>     /* set SOCKET-less Retransmission Counter, 5 \*/
>     SLRCR = 0x05;
>     /* set Interrupt Mask Bit \*/
>     SLIMR[ARP] = ???? // ARP Interrupt Mask Bit
>    <b> /* clear all Interrupt Bits by setting \*/</b>
>   <b>  SLIR = 0x07; // ARP Interrupt Register Bits</b>
>   SLIMR[TIMEOUT] = ???? // TIMEOUT Interrupt Mask Bit
>     /* set Destination IP Address, 192.168.0.100 \*/
>     SLPIPR[0:3] = {0xC0, 0xA8, 0x00, 0x64};
>     }

This now works for me.","Q) I'm looking for clues as to what may be breaking the routine described in 4.7 of the manual. Following the example, when my development receives a network discovery/broadcast, it then uses the sequence to determine the MAC address of the peer device that issued the discovery packet. Problem occurs when another peer issues a discovery and the same routine is followed. WireShark shows that the ARP packet being broadcast to the peer and the peer responding correctly. The routine for the command to complete, then completes, as before... Here, the problem occurs, in that the data I read from _WIZ_Get(HWAdr, 0x0054, 6); // SLPHAR (Peer MAC from ARP) is now stale data from the first time that the routine was run... The result being, that data for the second peer is sent to the correct IP address and the wrong MAC address. Resetting the chip clears the problem but obviously, highly inefficient... Ideas on a post card.... Datasheet says: Each Command must not be executed at the same time and not configured before SLCR cleared. I suspect it is what you are looking for - you must respond to previous ARP before next ARP arrives, otherwise new ARP request overwrites previous one. Did I understand your problem correctly?
A) But for me it sounds ridiculous. I see that documented under section 3.1.31, however, I may not have explained that in this case, I'm not responding to ARP requests, I am sending them and then reading the result from SLPHAR. The first operation always works as expected, and subsequent operation solicits the correct network request and response. After the first response, the SLPHAR register is no longer updated, and will always contain the data from the first occasion that the SLCR[ARP] is called. I'm not too sure what you mean by ""You must respond to previous ARP before next ARP arrives, otherwise new ARP request overwrites previous one"" How do I respond to an ARP when I generated it and received the response? May be, there something else that should be done to complete the process before issuing another ARP command? Subsequent ARP commands and responses are not overwriting the first one in SLPHAR. So, after much experimentation, I've learned that I'm not able to clear SLIR[ARP], this is causing the next ARP call to complete when SLCR == 0, but SLIR[APR] == 2. Put in a long delay and SLPHAR does update with the correct response. I guess the question now, is, how do I force SLIR clear, any one? 3.1.39 indicates [RW] OK, now I understand the counter intuitive nature of the SLIR. In order to clear an interrupt bit, it must be set... My suggestion for the next revision of the manual is this. { START : /* set SOCKET-less Retransmission Time, 100ms(0x03E8) (The unit is 100us) */ SLRTR[0:1] = {0x03, 0xE8}; /* set SOCKET-less Retransmission Counter, 5 */ SLRCR = 0x05; /* set Interrupt Mask Bit */ SLIMR[ARP] = ???? // ARP Interrupt Mask Bit /* clear all Interrupt Bits by setting */ SLIR = 0x07; // ARP Interrupt Register Bits SLIMR[TIMEOUT] = ???? // TIMEOUT Interrupt Mask Bit /* set Destination IP Address, 192.168.0.100 */ SLPIPR[0:3] = {0xC0, 0xA8, 0x00, 0x64}; } This now works for me.
"
3228,5698,"I am trying to use W5100S with Barkley API, which seems to start working OK, connection is established, and data transfer begins. However after a short time my device (server) waits for a response from client, but it looks like client already sent it, but the W5100S missed it. How can I check it?
I also fine cases that I call recv(sn, buf,len), but it reads more then len bytes from the chip RX buffer (looks like it reads all pending bytes).
This is incorrect behavior, I wonder if it should be like so (it should retrive only len bytes, even if the buffer has more)
Thanks
Johanan Hello Irina,

I didn't make any initialization to socket buffer size as I assume it is the default 2K after reset.

I never send or recv buffer larger then 1K, so I think this is not the issue.

I will do wireshark capture and send you on separate mail.

Thanks and regards,

Johanan Hello Irina,

Well I used Wireshark, found my problem.

(It was enough to suggest using it, :-) )

All working now.

Thanks.

Johanan Hi Irina,
Now I have my system is working quite well,

I would like to speed it up by using SPI DMA (using the Barkley API).

I found this document in Korean, do you have in English? (I couldn't find).

[https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_evb:w5100s_an_dma_v100k.pdf](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_evb:w5100s_an_dma_v100k.pdf)

Thanks,
Johanan Hi~ Johanan

Currently, I didn't write the document in English version yet.
I think you can't need to see the document of English version when DMA mode use.
If you need to see the document of English version, I will send email you after write the document as soon as possible.

thanks,
irina Thank you very much.
I have one question about optimal 25 MHz crystal for W6100 (we are making a pcb for it), can you advice suitable crystal part number?

Regards

Johanan Hi, as we are preparing to make our own PCB with your module, I am confused which module is best for us, and which one is the most updated.
Please let me know difference between W5100S, W5500, and W6100.

I need to make sure that I select  right chip for me which means:

1. Stable user library.

2. Availability (in stock)

3. Price.

Please let me know what is the recommended chip for new design.

Best Regards

Johanan Hi irina_kim

Can you post link where to find those crystals? I've been through all webshops with crystals and couldnt find any that's as near as those specifications","Q) How can I check if the W5100S missed the response from the client?
Q) Is it correct behavior for the recv function to read more than the specified length from the chip RX buffer?
Q) Do you have the document in English for using SPI DMA with the Barkley API?
Q) Can you advise a suitable crystal part number for W6100?
Q) What is the difference between W5100S, W5500, and W6100, and which one is recommended for a new design?
Q) Can you provide a link to find the crystals with the specified specifications?

A) I didn't make any initialization to socket buffer size as I assume it is the default 2K after reset.
A) I never send or recv buffer larger than 1K, so I think this is not the issue.
A) Well, I used Wireshark and found my problem. It was enough to suggest using it. All working now.
A) Currently, I didn't write the document in English version yet. If you need to see the document of English version, I will send you an email after writing the document as soon as possible.
A) I have one question about the optimal 25 MHz crystal for W6100, we are making a PCB for it.
A) As we are preparing to make our own PCB with your module, I am confused about which module is best for us and which one is the most updated. Please let me know the difference between W5100S, W5500, and W6100.
A) Can you post a link where to find those crystals? I've been through all webshops with crystals and couldn't find any that's as near as those specifications."
3229,5700,"hello

The W5500 was operated by the server and the PC was configured to configure the client to confirm that the connection was well connected.

On the contrary, I try to connect to the PC using the W5500 in the client mode.

When SOCK_INIT is set to DST IP, DST PORT, and connect to PC set to server mode using the connector function

I'm trying to do it, but I can't connect

I capture the packet with the wire shark and does not send the SYN Packet on the W5500.

I also confirmed that the link status of PHY was ON, and the server was working well, so there seems to be no problem in reset.

I wonder what settings you need to do to operate as a client.

In addition, the IP address is set using setsn_dipr (SN, Add) in the connect function of the library, then getsn_dipr

If you read the destination IP address using the function, setsn_cr (SN, SN, SN,

CR_CONNECT) The function is operated once, and a time -out error occurs, and the destination address I want from then on.

Is read as an address and is read, but I wonder if it is related to the symptoms I'm experiencing.

please answer about my question. In addition, after checking the SETSN_CR (SN, CR_CONNECT) function, the Connect command is performed and the status

When I read Gaster, I stay in sock_init (0x13).

SOCK_SYNSENT (0x15) seems to have to be changed, but it seems to be maintained only in sock_init state.

I wonder if there is a condition that causes the same problem now. hello,

When operating as a TCP client, the return value is only a timeout or a other error message ...

In the case of SYN Packet, Setsn_cr (SN, SN_CR_CONNECT) is a packet that goes out with the SOCKET open.
If you were not seen in Wireshark, you gave the order,
It may not be visible if the Destination IP is not a PC.

If you attach a packet captured file (*.pcap) and the source of the part you connect when you are a TCP client, it will be quick to solve the problem.
thank you
Irina","Q) I wonder what settings you need to do to operate as a client. In addition, the IP address is set using setsn_dipr (SN, Add) in the connect function of the library, then getsn_dipr. If you read the destination IP address using the function, setsn_cr (SN, SN, SN, CR_CONNECT) The function is operated once, and a time-out error occurs. 
A) When operating as a TCP client, the return value is only a timeout or a other error message. If you were not seen in Wireshark, you gave the order. It may not be visible if the Destination IP is not a PC. If you attach a packet captured file (*.pcap) and the source of the part you connect when you are a TCP client, it will be quick to solve the problem."
3230,5704,"hello.
Inquiries about wiz110sr reset.

<Current situation>
The above board is converted into a serial and used.
However, the packet does not come into the cereal.
When the serial packet is not received, I put the function to reset it in the following way.
1. Enter ""+++""
2. ""<E>"" ""Response to (<i>) I put it in English, so it is not seen on the bulletin board.
3. ""<Wr>"" input- (<Double Youal>) I put it in English, so it is not seen on the bulletin board.
4. ""<S>"" Response Check- (<S>) Since I put it in English, it is not seen on the bulletin board.

Even if you do this, the packet is not received, so if you turn on the board, you have confirmed that it works well.

<Inquiries>
1. What is the difference between the hardware and the software reset?
2. Is there any way than physical that can be physically stealing the power line?
3. Is the way to reset it now is a normal way?

please answer about my question.
thank you Hello, this is Wiznet.

The method you used is not a physical Reset.

[quote = ""eddy, post: 1, topic: 5704""]
What is the difference between the hardware to turn on the power and reset it in software?
[/Quote]
There is a difference.On/off the power is really physically reset, and the <WR> command is to restart the run firmware.Hardware is not reset.

[quote = ""eddy, post: 1, topic: 5704""]
Is there any way other than physical that can be physically stealed? (Command)
[/Quote]
It seems that there is no current state.

[quote = ""eddy, post: 1, topic: 5704""]
Is the way to reset now is normal?
[/Quote]
Restart, not reset.

It doesn't seem to be a basic operation, but it is not easy to understand the exact cause because of the lack of information.

Can you tell me exactly when it doesn't communicate?
ex) LED status of RJ45, TCP connection, network configuration, etc.

thank you Thank you for answer.
1. The LED status seems to have to be checked again when the symptoms come out.
2. TCP connection should also be checked again when the symptoms come out.
3. The network configuration type has 58 wiznet boards connected to one server, which is not far away, so it is connected to the middle hub.It may not be moved while the operation is good, and if you repeat the reset (software list), the operation may be resumed again.

Wiznet board
IP: 172.20.10.
Subnet: 255.255.0.0
GW: 192.168.11.1

server
IP: 172.20.10.129 Hello, this is Wiznet.
If you look at the symptoms, it is probably expected that the TCP connection is broken.
It is difficult to check whether the connection is terminated on the server side or if the connection is different from the wiz110sr.
That's why if you capture and send the packet with a program called Wirishark, it would be good to analyze it.
thank you I'm trying to use a way to turn on/off the power supply in hardware, but is there a problem with the WIZNET board if the WIZNET board becomes power on/off? Hello, this is Wiznet.

There will be nothing special.

thank you","Q) What is the difference between the hardware and the software reset?
A) There is a difference. On/off the power is really physically reset, and the <WR> command is to restart the run firmware. Hardware is not reset.

Q) Is there any way other than physical that can be physically stealed? (Command)
A) It seems that there is no current state.

Q) Is the way to reset now is normal?
A) Restart, not reset. It doesn't seem to be a basic operation, but it is not easy to understand the exact cause because of the lack of information.

Q) I'm trying to use a way to turn on/off the power supply in hardware, but is there a problem with the WIZNET board if the WIZNET board becomes power on/off?
A) There will be nothing special."
3231,5707,"Using the W5100s

I am making a board and testing it.

The transmission data is broken and transmitted.
The reception is good, but the transmission data is sent to a strange data.
If it is transmitted to a strange data once a strange data, the TCP connection is disconnected and until the connection is re -connected

It is broken and transmitted.
If you re -connect, the transmission data may come back to normal.

The transmission data is going well, and at some point the data is transmitted to a strange value.

Please answer the cause. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

Ã«Â¬Â¸Ã¬Â Â ?Â´ÃªÂ²Â°???ÂÃ­ÂÂ´ ?ÂÃ«ÂÂ??Ã¬Â§ÂÃ«Â¬Â¸???ÂµÃ«? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??
1. WIZnet???ÂÃªÂ³Âµ?ÂÃªÂ³Â  ?ÂÃ«ÂÂ ioLibraryÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ«ÂÂ??
2. UDP, TCP client, TCP Server Ã¬Â¤??Â´Ã«ÂÂ¤ ?ÂÃ¬ÂÂ???ÂÃªÂ³Â  ?ÂÃ«ÂÂ??
3.  Tx RD/WR addressÃªÂ°? ?ÂÃ­ÂÂ??Access ?ÂÃªÂ³Â  ?ÂÃ«ÂÂ??
4. RJ45???Â°ÃªÂ²Â°???ÂÃ«Â¡ÂÃªÂ°? WIZnet???ÂÃªÂ³Âµ?ÂÃ«ÂÂ reference ?ÂÃ«Â¡Â?? ?ÂÃ¬ÂÂ¼?ÂÃª???
[Reference Schematic](https://wizwiki.net/wiki/doku.php?id=products:w5100s:refschematic)


ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
irina 1. I use Wiznet IOLIBRARY.(Well in the W5100) I tried to change it to the W5100s.

?

2. TCP Server is operating.

?

3.TX RD/WR Address is accurately Access.(I am doing a problem and I have a problem.

?

4. Example Reference circuit is the same.

? 1.  Wiznet IoLibray Ã«Â¥??Â¬Ã¬ÂÂ© ?Â©Ã«ÂÂ??
2.  TCP Server ?ÂÃ¬ÂÂ?? ?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
3.  Tx RD/WR  addres?? ?ÂÃ­ÂÂ??Aceess ?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
4.  Reference ?ÂÃ«Â¡Â?? ?ÂÃ¬ÂÂ¼ ?Â©Ã«ÂÂ??

?ÂÃ­ÂÂ ÃªÂ²Â°ÃªÂ³Â¼  Send  ?ÂÃ¬ÂÂ   TxBuffer??Ã«Â§ÂÃ¬?Ã«Â§ÂÃ¬ÂÂ ?Â°ÃªÂ³Â  Ã¬Â²ÂÃ¬ÂÂ?Â¼Ã«Â¡Â TxPointÃªÂ°?  ?ÂÃ¬ÂÂ´ ÃªÂ°ÂÃ«ÂÂ  DataÃªÂ°?  ÃªÂ¹Â¨Ã¬???

?ÂÃª?ÃªÂ³??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
TX  Bufufer Size?? 2K  0x800  ?ÂÃ«ÂÂ??      TxPoint ÃªÂ°?  0x7FFÃ«Â¥? ?ÂÃ¬ÂÂ´ ?Â¤Ã¬ÂÂ Reset 0x000?Â¼Ã«Â¡Â 

?Â Ã«ÂÂ  Send Data ÃªÂ°?  ÃªÂ¹Â¨Ã¬?ÃªÂ³??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?ÂµÃ«? Ã«Â¶????ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤. hello
Let's check that part.
If you have another question, please leave it.
thank you
Irina","Q) Please answer the cause.
A) It seems like the issue may be related to the W5100s and the configuration or settings. Here are some possible points to check for the cause:
1. Is the WIZnet IoLibrary properly configured for the W5100s?
2. Are the TCP Server, UDP, and TCP client configurations accurate?
3. Is the TX RD/WR address access properly configured?
4. Is the reference schematic for RJ45 and WIZnet properly implemented?
You can also refer to the [Reference Schematic](https://wizwiki.net/wiki/doku.php?id=products:w5100s:refschematic) for further assistance.

Q) irina 1. I use Wiznet IOLIBRARY.(Well in the W5100) I tried to change it to the W5100s.
A) It seems like you have switched from using the W5100 to W5100s and are experiencing issues with data transmission. It's important to ensure that the library is compatible and properly configured for the W5100s.

Q) 2. TCP Server is operating.
A) It's good to know that the TCP Server is operating, but the issue seems to be related to the data transmission, particularly when it's sent to a strange value. 

Q) 3.TX RD/WR Address is accurately Access.(I am doing a problem and I have a problem.
A) Ensuring the accurate access of the TX RD/WR address is crucial for proper data transmission. It's important to double-check and troubleshoot any problems related to this.

Q) 4. Example Reference circuit is the same.
A) Verifying that the reference circuit is correctly implemented is important for ensuring proper functioning. It's essential to compare and confirm that it matches the recommended schematic.

Q) ?ÂÃ­ÂÂ ÃªÂ²Â°ÃªÂ³Â¼  Send  ?ÂÃ¬ÂÂ   TxBuffer??Ã«Â§ÂÃ¬?Ã«Â§Â"
3232,571,"Hi guys,

on the WIZ550io product photo I see a transformer, but in the schematics V1_1 I cannot find it.
Maybe the photo is of an previous release. What version do I get if I order the module?

It would be awesome if you can supply the source code of the PIC12F519 controllor or at least some 
documentation what and how the initial configuration works.

Also I would love to see a Bill of Materials of this module.  
I cannot identify the PN of the Ethernet Jack with embedded magnetics.

Thanks for your support. Hi,
WIZ550io have two version.
One is v1.0 consisted of transformer and RJ45.  Now Available ( If you order the module, you will get v1.0)
One is v1.1 consisted of MAGJACK. [b]Now not avilable.[/b] (This is not ready yet. This version will be released for 2014 Design contest - Connect the Magic. refer to [url]http://wizwiki.net/wiki/doku.php?id=connectthemagic[/url])

There is no pic driver example. You will port it easily to PIC becase The code is based on C and standard library.
As you known, There are several MCU, it is implossible that we supports driver example to all mcu.

BOM will be posted to the wizwiki site as soon as possible. To use either one does not matter if you design.","Q) What version do I get if I order the module?
A) WIZ550io has two versions. One is v1.0, which includes a transformer and RJ45, and currently available. The other is v1.1, which features MAGJACK and is not available at the moment. If you order the module, you will receive v1.0.

Q) Can you supply the source code of the PIC12F519 controller or some documentation on the initial configuration?
A) There is no PIC driver example available. However, you can easily port it to PIC because the code is based on C and standard library. It's important to note that there are several MCUs, so it's impossible for us to support driver examples for all of them.

Q) Can you provide a Bill of Materials for the module? Also, I cannot identify the PN of the Ethernet Jack with embedded magnetics.
A) The Bill of Materials (BOM) will be posted on the WIZwiki site as soon as possible. Regarding the PN of the Ethernet Jack with embedded magnetics, it is not specified at the moment."
3233,5712,"[WIZ550WEB]
you worked hard.Can you use the Digital I/O pin of the wiz550WEB module for UART TTL communication like Arduino?

----------- Thank you for answer.
However, I asked if the Digital I/O port such as so -called PC00, PC01, PC02, and PC03, etc., is not available as a serial communication. If it is HW REV 1.2 of Wiz550WEB, MCU is made.
I checked the MCU's Datasheet and stated that PC10/PC11 can be used as UART4.
If you use this port as a UART, you can check and use the MCU Datasheet.
Mcu datasheet link >>>> [stm3f103rct6 datasheet] (https://www.st/content/st_com/en/products/microControllers-microprocessors/stm32-32-bit-c ORTEX-MCUS/STM32-MAINSTREAM-MCUS/STM32F1-SERIES/STM32F103/STM32F103RC.HTML)

thank you
Irina yesThank you for your confirmation.","Q) Can you use the Digital I/O pin of the WIZ550WEB module for UART TTL communication like Arduino?
A) No, the Digital I/O port such as PC00, PC01, PC02, and PC03 is not available for serial communication. Instead, for HW REV 1.2 of Wiz550WEB, you can use the MCU's PC10/PC11 as UART4. You can refer to the MCU Datasheet for more information on using this port as UART. 
"
3234,5718,"Hi jan-jelle

Can you get the RJ45 part  schematic?

Thank you.

Scott [quote=""jan-jelle, post:1, topic:5718""]
I can put the source code in here as well, but since it works with the W5100 and the library is changed to Ethernet2 this should not be the issue,
[/quote]

That depends on which chip features you use. I posted an issue at https://github.com/arduino-libraries/Ethernet/issues/84 noting that some common W5500 registers have different addresses than the corresponding W5100 registers. Hi Mxyxixptlick

Thanks for the response. in that particular article it doesn't really tell which library it uses as far as I can see? as far as I understand the conversion for the registers should be solved in the ethernet2.h library. however the issue with client::connect changing to 5ms might be something I could try... see if that will help the issue. my main code does hang in a while() loop until a connection is established though, so I wonder if it shouldn't just pick it up in a second or third attempt then... 


If any other ideas pop up please let me know! small update.

I just took a scope to measure the SPI signals and conclude that the Slave Select only goes LOW on communication requests. is this usual, or should I pull it low constantly?

furthermore the MOSI is sending out data, (converted from 5V to 3.3V ofcourse) and the MISO is sending data back (just 3.3V since the uC accepts this as logic 1) but the speed in which the slave (W5500) is responding is a lot faster than the master is transmitting, or the bits are more 0 than 1 but that seems unlikely...

in any case, the uC is communicating with the W5500... Alright, another update. sorry guys at the moment I am messing around with the scope and such. after a few resets (and this happened before as well) suddenly the ACT led also lights up. during this stage I measured the SPI comms again and there is now a constant stream of communication. where in the previous case, there was only communication every 5 seconds (this is the delay between retries in connecting between the uC and W5500). but now, appearantly the connection is established since the rest of my main code is also running. however, the MQTT messages do not process correctly, so I still do not have a proper ethernet connection. also when pinging the W5500 it does not reply as it should in CMD. when pinging, the ACT LED does start blinking more frequently...

so some progress, but still no idea how to proceed... any help is much appreciated! Hi Mxyxixptlick,

Thanks for the help. I will check the SPI speed but since it is sharing the same CLK signal I recon the MISO and MOSI are running at similar speed, but the bit pattern obviously is different which caught me off guard. 

Regarding the soldering, I didn't necessarily comply to any IR reflow since I soldered by hand. this obviously creates the discussion of possibly overheating however I got quite good at soldering .5mm pitch pretty fast, so I only applied the iron at 400 degrees in under .5s per 2 pins. I seriously doubt that it is fried due to soldering. SPI does seem to function steady, but the messages don't come through properly. I am seriously questioning the connector I used and how I connected it to the W5500, since it is different than the reference schematics of the W5500. I didn't notice this before because I went by the Arduino ethernet shield but this is again, a different connector... 

Would it be possible for someone to tell me if my RJ45 connector setup in the picture above makes any sense? If I look at the W5500 reference there are 49.9R resistors on the TXP/TXN which I used as well, but I used 10K on RXP/RXN while reference sheet uses 49.9 there as well...


Your remark on the ethernet2.h library is noted, and I will take a look at this as well in the mean time.

furthermore the SPI clock signal shows 1 puls in roughly 100ns, so that would be 10MHz if I am correct... that should be fine then I recon. So, as we software guys like to say, ""it's probably a hardware problem"" :slight_smile: Haha yeah... wel it was a human problem as most of the time. ","Q) Can you get the RJ45 part schematic?
A) That depends on which chip features you use.

Q) Hi Mxyxixptlick, Thanks for the response. in that particular article it doesn't really tell which library it uses as far as I can see? as far as I understand the conversion for the registers should be solved in the ethernet2.h library. however the issue with client::connect changing to 5ms might be something I could try... see if that will help the issue. my main code does hang in a while() loop until a connection is established though, so I wonder if it shouldn't just pick it up in a second or third attempt then... If any other ideas pop up please let me know! small update. I just took a scope to measure the SPI signals and conclude that the Slave Select only goes LOW on communication requests. is this usual, or should I pull it low constantly? furthermore the MOSI is sending out data, (converted from 5V to 3.3V of course) and the MISO is sending data back (just 3.3V since the uC accepts this as logic 1) but the speed in which the slave (W5500) is responding is a lot faster than the master is transmitting, or the bits are more 0 than 1 but that seems unlikely... in any case, the uC is communicating with the W5500... Alright, another update. sorry guys at the moment I am messing around with the scope and such. after a few resets (and this happened before as well) suddenly the ACT led also lights up. during this stage I measured the SPI comms again and there is now a constant stream of communication. where in the previous case, there was only communication every 5 seconds (this is the delay between retries in connecting between the uC and W5500). but now, apparently the connection is established since the rest of my main code is also running. however, the MQTT messages do not process correctly, so I still do not have a proper ethernet connection. also when pinging the W5500 it does not reply as it should in CMD. when pinging, the ACT LED does start blinking more frequently... so some progress, but still no idea how to proceed... any help is much appreciated!
A) Hi Mxyxixptlick, Thanks for the help. I will check the SPI speed but since it is sharing the same CLK signal I reckon the MISO and MOSI are running at similar speed, but the bit pattern obviously is different which caught me off guard. Regarding the soldering, I didn't necessarily comply to any IR reflow since I soldered by hand. this obviously creates the discussion of possibly overheating however I got quite good at soldering .5mm pitch pretty fast, so I only applied the iron at 400 degrees in under .5s per 2 pins. I seriously doubt that it is fried due to soldering. SPI does seem to function steady, but the messages don't come through properly. I am seriously questioning the connector I used and how I connected it to the W5500, since it is different than the reference schematics of the W5500. I didn't notice this before because I went by the Arduino ethernet shield but this is again, a different connector... Would it be possible for someone to tell me if my RJ45 connector setup in the picture above makes any sense? If I look at the W5500 reference there are 49.9R resistors on the TXP/TXN which I used as well, but I used 10K on RXP/RXN while reference sheet uses 49.9 there as well... Your remark on the ethernet2.h library is noted, and I will take a look at this as well in the meantime. furthermore, the SPI clock signal shows 1 puls in roughly 100ns, so that would be 10MHz if I am correct... that should be fine then I reckon. So, as we software guys like to say, ""it's probably a hardware problem"" :slight_smile: Haha yeah... well, it was a human problem as most of the time.

A) It can put the source code in here as well, but since it works with the W5100 and the library is changed to Ethernet2, this should not be the issue."
3235,5723,"?ÂÃ¬? ÃªÂ¸????Â¬Ã«ÂÂ¼?Â¸Ã¬ÂÂ ?Â¤Ã¬ÂÂ ?ÂÃ¬ÂÂ±?Â©Ã«ÂÂ??

?ÂÃ«ÂÂ??Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ??Ã«Â©ÂÃ¬Â¶Â°?ÂÃ«ÂÂ???Â´Ã«ÂÂ¤ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ Ã«Â¬Â¸Ã¬Â Â?Â¼ÃªÂ¹Â??


Ã¬Â½ÂÃ«ÂÂ?ÂÃ¬ÂÂ Ã«Â©ÂÃ¬Â¶Â°?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶?
    /* PHY Initialization */
    PHY_Init();

    /* PHY Link Check via gpio mdio */
    while( link() == 0x0)
    {
        DEBUGPRINT(""."");  
        delay(500);
    }



?ÂÃ«Â²ÂÃªÂ¹??ÂÃ«Â©Â´
PHY_ID = 0 , STATUS = ffff
PHY_ID = 1 , STATUS = 7849...... Ã«Â°ÂÃ«Â³Âµ Hello, this is Wiznet.

Do you know what firmware you use?

LINK () is connected to the Ethernet cable to the RJ45 and the link must be established.

Did you connect the cable?

thank you hello.
The Ethernet cable is connected.
There is a connection, but the LED doesn't light.
If you connect other lines because the line is wrong, it will not be connected.
Is there any other problem? The firmware to test checks HTTPSERVER as a default example. Hello, this is Wiznet.

If the link LED does not come in, communication will not be at all.

If this is a symptom, you should review the circuit and PCB design.

If you are a perm, we will review it. hello.
If you send me an e -mail address, can I send it by e -mail?
thank you We have confirmed the part where the clock is distorted and the abnormal operation.
thank you","Q) Do you know what firmware you use?
A) The firmware to test checks HTTPSERVER as a default example. Hello, this is Wiznet.

Q) Did you connect the cable?
A) The Ethernet cable is connected. There is a connection, but the LED doesn't light. If you connect other lines because the line is wrong, it will not be connected. Is there any other problem?

Q) If you send me an e-mail address, can I send it by e-mail?
A) We have confirmed the part where the clock is distorted and the abnormal operation."
3236,573,"Hi 

There are two ""mode select""- switch on the EV board. 
Connected to ""Serial Command Mode 1 and 2"". 
What function do they have? Hello Hardix

These two pins are for transition mode between <data mode> and <command mode>.
WizFi630 can be switched from <data mode> to <command mode> using this pin.

And, these are related with <serial setting> -> <serial port#1> -> <Data packing option> -> <command mode> -> <Hnable: HW GPIO Used>.","Q) What function do they have?
A) These two pins are for transition mode between <data mode> and <command mode>. WizFi630 can be switched from <data mode> to <command mode> using this pin. And, these are related with <serial setting> -> <serial port#1> -> <Data packing option> -> <command mode> -> <Hnable: HW GPIO Used>."
3237,5734,"In 2016, the Chip Power Off-> TCP/IP communication failure occurred during the Power Off-> ON, and the Chip was replaced with 2017 production.
Since then, the communication disorder has been solved, but abnormal data is received.
If you use Chip in 2016, intermittent communication disorders occur, but the data is normally received.

P.S DATA is not attached, so you can't send a capture normal/abnormal data.Please contact us by e -mail and we will send it. hello

I'm sorry for late reply.
Please mail to beky@wiznet.io. I moved the article to the Internet MCU bulletin board of the Korean Forum.","Q) What happened in 2016 with the Chip Power Off and ON? 
A) In 2016, there was a TCP/IP communication failure during the Power Off-> ON, which led to the replacement of the Chip with the 2017 production. 

Q) What is the current status of the communication disorder? 
A) Since then, the communication disorder has been solved, but abnormal data is now being received. 

Q) What happens when using the Chip from 2016? 
A) When using the Chip from 2016, intermittent communication disorders occur, but the data is normally received."
3238,5735,"Dear, tell me about working with the module. I'm doing something wrong, but what's the problem?
In the W5500 I use only zero socket (I work with AVR).
All exchange with the module occurs at a fixed length in single-byte mode (Fixed Lenght Data Mode)
When initializing, I configure the module as a server:
in steps:
1. I reset the module, wait 2 seconds after reset
2. Even though the module itself breaks 16kB into 8 buffers, I specify all the same that the receive buffer and the Socket transfer buffer 0 = 2kB
3. I assign the module MAC, IP, Gateway, Mask, and install the local port
4. Socket 0 install TCP protocol
5. I set an interrupt from Socket 0 for all socket events. (connection, break, timeout, data arrival, data sending)
6. Socket commands - I open a socket (open) and then immediately translate the command to LISTEN
7. the module is pinged, the connection to the port is, the interruption is generated by the connection and the connection is broken. When the interrupt arrives, I tell the module that I responded (the SIR register)
8. From the client came the data: I read the register of the size of the received data (S0_RSR) first the high byte, then the low one. (in old W3300 modules this is important)
9. I read the register of the beginning of the data in the buffer (S0_RX_RD), first the high byte and then the low byte.
10. I read the end-of-data register in the buffer (S0_RX_WR), first the high byte and then the low byte.
11. I transfer data from the W5500 receive buffer to the local AVR buffer.
12. In the register S0_RX_RD I write the value S0_RX_WR. first low byte then high byte. I give the command to the module that I read everything (in the register S0_CR &lt;- 0x40)

Everything works until the port while the register S0_RX_RD has values ??less than 0x0800.
let's say S0_RX_RD = 0x07F0, and S0_RX_WR = 0x0840.
as soon as I assign a S0_RX_RD value above 0x0800 (0x0840 in our example) everything is fucking hanging ...
in theory, these registers run in the range from 0x0000 to 0xFFFF and in a circle. and then he stared at 0x0800 and at least kill ...
increased the buffer to 4kb, all one ....&gt; 0x0800 hung ...
Tell me pliz ... what am I doing wrong :( [quote=""Vyacheslav_Tumashenk, post:1, topic:5735""]
Socket commands - I open a socket (open) and then immediately translate the command to LISTEN
[/quote]

I believe that while the internal S0_RX_RD and S0_RX_WR pointers wrap around as the W5500 stores data it receives, you are responsible for sending a valid pointer when you read incoming data.

Try logically ANDing your read pointer in your code with 0x7FF before reading and see if that helps. Thank you very much for responding! I try but for now all the same: (

char WSOCKET0_Read(unsigned int adres){
char result,l,h;
h=hib(adres);
l=lob(adres);
SPI1_Write(h);       // ÃÂ°ÃÂ´?ÃÂµ? ÃÂ² ?ÃÂµÃÂ³ÃÂ¸???ÃÂµ
SPI1_Write(l);
SPI1_Write(0b00001001);
result=SPI1_Read(0);
return result;
}
void WSOCKET0_Write(unsigned int adres, char dat){
char result,l,h;
h=hib(adres);
l=lob(adres);
SPI1_Write(h);   
SPI1_Write(l);
SPI1_Write(0b00001101);
SPI1_write(dat);
}

   b=WSOCKET0_Read(0x0028);
   c=WSOCKET0_Read(0x0029);
   sdata=word(b,c); //START DATA
   ssdata=sdata & 0x07FF;
   b=WSOCKET0_Read(0x002A);
   c=WSOCKET0_Read(0x002B);
   edata=word(b,c); //END DATA
   len=edata-sdata;
   WREADBUF(ssdata,len);
   sdata+=len;
   b=hib(sdata);  
   c=lob(sdata);
   WSOCKET0_Write(0x0028,b);
   WSOCKET0_Write(0x0029,c);
   WSCOMMAND(0x40); //RECV Read the W5100 datasheet chapter 5. It gives crystal clear information on how to manage socket and its registers for proper data flow. Register locations and access type may be different for the devices, but the flow is the same.","Q) Tell me pliz ... what am I doing wrong?
A) I believe that while the internal S0_RX_RD and S0_RX_WR pointers wrap around as the W5500 stores data it receives, you are responsible for sending a valid pointer when you read incoming data. Try logically ANDing your read pointer in your code with 0x7FF before reading and see if that helps. Thank you very much for responding! I try but for now all the same: ( 

Q) Read the W5100 datasheet chapter 5. It gives crystal clear information on how to manage socket and its registers for proper data flow.
A) Register locations and access type may be different for the devices, but the flow is the same."
3239,5737,"I am testing using Illumination_RGBLED, an ADC example.
ADC_INIT ();When you set up, the pin pins will go up to high.
It is not used except for the use of PC10 and PC1 as UART during the ADC pin.

Do you have any precautions to use ADC? hello

How many channels are you using in the ADC example?
I would like to ask you how you checked the PC15 pin. hello.
Channel 0.
I have taken the oscilloscope.
If you do not set ADC, you will see 10K based on the voltage and 10K, which is about 1.65V, which is 3.3V, and after setting ADC, the output of 3.3V comes out from the ADC pin side.Occurs when setting ADC_INIT)
What kind of problem does this happen? hello

ADC Channel is PIN.
It is believed that the voltage has changed to receive the analog value after ADC init, but is this a problem?
If you put an analog sensor on the pin and work on a normal operation, it will be no problem. hello.
If the voltage will change if it is measured, but the input PC15 pin is changed to 3.3V, so the data coming in is 4095, which is the maximum value.It's not a useful data at all, but I think it's something wrong. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

W7500P ?Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«ÂÂ¬Ã«Â¦Â¬Ã¬ÂÂ??Ã«Â§ÂÃ¬?Ã¬Â£Â¼Ã¬ÂÂ  ?Â¤Ã¬Â Â??enumÃªÂ³?ÃªÂµÂ¬Ã¬Â¡Â°Ã¬Â²Â´Ãª? ?ÂÃ«ÂÂ??

        PAD_AFConfig(PAD_PC, GPIO_Pin_15, PAD_AF0); 

	/* Configure Led pin as output */
	GPIO_InitStruct.GPIO_Pin = GPIO_Pin_15;
	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
	
	GPIO_Init(GPIOC, &GPIO_InitStruct);	

?Â´Ã«ÂÂ°?ÂÃ¬ÂÂ¼Ã«Â¡??Â¤Ã¬Â Â?ÂÃ«Â©Â´ ?Â ÃªÂ¹Â??

typedef enum
{
	GPIO_PuPd_UP = Px_PCR_PUPD_UP,
	GPIO_PuPd_DOWN = Px_PCR_PUPD_DOWN,
	GPIO_DS = Px_PCR_DS_HIGH,
	GPIO_IE = Px_PCR_IE,
	GPIO_SUMMIT = Px_PCR_CS_SUMMIT
}GPIOPad_TypeDef;


#define IS_GPIO_PUPU(PUPD)  (((PUPD) == GPIO_PuPd_UP) || ((PUPD) == GPIO_PuPd_DOWN))

typedef struct
{
    uint32_t GPIO_Pin;
    GPIOMode_TypeDef GPIO_Mode;
    GPIOPad_TypeDef GPIO_Pad;
}GPIO_InitTypeDef;","Q) Do you have any precautions to use ADC?
A) When using the ADC, it's important to ensure that the pins are correctly set up and that the input voltages are within the ADC's specified input range. Additionally, you need to avoid any interference from other peripherals, and be cautious with the configuration of the analog input pins.

Q) How many channels are you using in the ADC example?
A) In the ADC example, I am using channel 0.

Q) What kind of problem does this happen?
A) The problem arises when the input PC15 pin is changed to 3.3V, resulting in an ADC reading of 4095, which is the maximum value. This indicates that the data received is not useful due to the voltage change.

Q) W7500P ?Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«Â¦Â¬Ã¬ÂÂ??Ã«Â§ÂÃ¬?Ã¬Â£Â¼Ã¬ÂÂ  ?Â¤Ã¬Â Â??enumÃªÂ³?ÃªÂµÂ¬Ã¬Â¡Â°Ã¬Â²Â´Ãª? ?Â ÃªÂ¹Â?? What does PAD_AFConfig(PAD_PC, GPIO_Pin_15, PAD_AF0) do?
A) PAD_AFConfig(PAD_PC, GPIO_Pin_15, PAD_AF0) in the W7500P is used to configure the Pin 15 as an alternative function (AF). This is often done to assign a specific peripheral or feature to a GPIO pin, such as using it for UART, SPI, or other functions.

Q) What is the meaning of typedef and its usage?
A) The typedef is used to create an alias name for an existing data type. In the provided code, it's used to define a new data type for representing GPIO Pad configurations, which makes the code more readable and manageable."
3240,5738,"Hello all, I'm hoping someone on the WizNet forum can assist me me with logging into the WizNet application which i have managed to downloaded and successfully installed onto my android phone. The problems start every time i put my log-in details into the fields  ( callsign & password ) Just keep getting the message "" Login Failed "" Was looking forward to putting the WizNet app through it's paces as well, and any assistance in resolving this issue would be most appreciated then.

                                                                                       Many Thanks 

                                                                                                Ian

                                                                                          MM3TWA Hello,

I don't know what you mean WizNet application with?
Did you download WIZnet app from Google Play?
Didn't it work at all on your android phone?

James","Q) I'm hoping someone on the WizNet forum can assist me with logging into the WizNet application. The problems start every time I put my log-in details into the fields (callsign & password), I just keep getting the message ""Login Failed"". Any assistance in resolving this issue would be most appreciated. Many Thanks, Ian MM3TWA 
A) Did you download the WIZnet app from Google Play? Didn't it work at all on your android phone?"
3241,574,"Is this an issue for Wizfi at all or is it just something we will have to put up with? With unsupported characters in a site survey, it would be difficult to discern between available networks and which one should be selected. Hello Filip

As you said, WizFi630 doesn't support some special characters in SSID and Passphrase.
Maybe to support this, WizFi630-f/w need to be upgraded.","Q) Is this an issue for Wizfi at all or is it just something we will have to put up with? With unsupported characters in a site survey, it would be difficult to discern between available networks and which one should be selected. 
A) As you said, WizFi630 doesn't support some special characters in SSID and Passphrase. Maybe to support this, WizFi630-f/w need to be upgraded."
3242,5741,"I want to use Wiz810sio.

Looking at the data sheet, there were about 16 pages of documents ..

But I can't use the WIZ810SIO after reading this document.


I am currently trying to use the Wiz810sio on the STM32 MCU board.
The SPI pins corresponding to the wiz810sio are connected,

I can't touch the coding ..

Look for example source or technical advice. hello.

Would you like to analyze the code in the URL below?

https://github.com/wiznet/w5100s-EVB thank you
After analysis, I checked the rollback operation !!

Such Wiz810SIO (Server) -The communication process is a communication process of 810SIO after receiving the data from the PC to the PC (Client).

How do I want to operate the wiz810sio as a client? ..
We confirmed that there is a connect function in the WizNet API SOCKET.C.
I received the port from the socket function to the paramet.

Doesn't the client need a port?
When connected, I need a port and I know it's not necessary in the socket creation.
I don't understand.","Q) How do I want to operate the wiz810sio as a client? 
A) We confirmed that there is a connect function in the WizNet API SOCKET.C. I received the port from the socket function to the parameter. When connected, I need a port and I know it's not necessary in the socket creation. 

Q) Would you like to analyze the code in the URL below? 
A) After analysis, I checked the rollback operation!! 
"
3243,5743,"hello.
Wiz140sr/Wiz145sr Test Board, Wiz140sr module and WIZ145SR module were purchased, respectively.
In the config tool, the wiz145sr becomes serch, and the wiz140sr is not serch.
The wiz145sr connected to the LAN port in the module and the WIZ140SR was connected to the LAN port in the test board.
I don't know why the WIZ140SR is not recognized. hello.

Is the fire in the Ethernet link?
Connect the console port of the baseboard with your PC and check if the Debug Message is output to the Terminal Program. Firmware Version is too old.
It is now 1.6.8.

The problem is that the Invalid Message appears in the Config Tool, so I can't do Firmware Update.

First, check the PC's IP settings multiple, leave only one, delete all the rest, and proceed again.

Nevertheless, if you have an Invalid MSG Recv message, please apply for RMA through the purchaser you purchased.

thank you","Q) Is the fire in the Ethernet link?
A) Connect the console port of the baseboard with your PC and check if the Debug Message is output to the Terminal Program. Firmware Version is too old.

Q) The problem is that the Invalid Message appears in the Config Tool, so I can't do Firmware Update. First, check the PC's IP settings multiple, leave only one, delete all the rest, and proceed again. Nevertheless, if you have an Invalid MSG Recv message, please apply for RMA through the purchaser you purchased.
A) None."
3244,575,"i checked your problem.

maybe your computer's OS is Windows 7, not Windows XP.

i think it is Config tool's some bug on Windows 7.

as soon as realized the problem, updated Config tool.

check again WIZnet's homepages and install new version(v1.1.2)

[url]http://wiznet.co.kr/sub_modules/en/product/product_detail.asp?Refid=766&page=1&cate1=5&cate2=44&cate3=0&pid=1127&cType=2[/url] thank youuu  :smiley: 
it works on Win 8.1","Q) What could be the issue with the Config tool on my computer? 
A) maybe your computer's OS is Windows 7, not Windows XP. i think it is Config tool's some bug on Windows 7. as soon as realized the problem, updated Config tool. check again WIZnet's homepages and install new version(v1.1.2)"
3245,5750,"One.
As the title implies, we want to use the UART2 of the W7500 in the Mbed.
Serial UART (PC_10, PC_11);
If you use the above code, the program does not work.
Please tell me how to use UART2 without any abnormalities.

2.
And the printf command seems to always be output to UART1 and BAUD 9600.
Please tell me how to change it. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

?ÂÃ¬ÂÂ¬ mbed?ÂÃ¬ÂÂ W7500??Uart2Ã«Â¥?Ã¬Â§??ÂÃ­ÂÂÃ¬Â§??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Ã¬Â¶ÂÃ­ÂÂ ?ÂÃ«ÂÂ°?Â´Ã­ÂÂ¸?ÂÃ«ÂÂÃ«Â¡??ÂÃªÂ²Â ?ÂµÃ«ÂÂ??

printfÃªÂ°ÂÃ¬? ÃªÂ²Â½Ã¬ÂÂ°??mbed?ÂÃ¬ÂÂ ÃªÂ¸Â°Ã«Â³Â¸ÃªÂ°ÂÃ¬ÂÂ¼Ã«Â¡?UART1???Â¬Ã¬ÂÂ©?ÂÃªÂ²Â ?ÂÃ¬ÂÂ´?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Ã«Â³?ÃªÂ²Â½Ã­ÂÂÃªÂ³??Â¶Ã¬ÂÂ¼??ÃªÂ²Â½Ã¬ÂÂ° mbed????mbed-devÃ«Â¥?import?ÂÃ¬ÂÂ¬
argets/TARGET_WIZNET/TARGET_W7500x/TARGET_WIZwiki_W7500/device.h
?ÂÃ¬ÂÂ
#define STDIO_UART_TX  PC_2
#define STDIO_UART_RX  PC_3
#define STDIO_UART     UART_1
ÃªÂ°ÂÃ¬ÂÂ Ã«Â³?ÃªÂ²Â½Ã­ÂÂ´ Ã¬Â£Â¼Ã¬ÂÂÃ«Â©??Â©Ã«ÂÂ??","Q) How do I use UART2 of the W7500 in the Mbed without any abnormalities?
A) As the title implies, to use the UART2 of the W7500 in the Mbed without any abnormalities, you can refer to the following code:
```c++
Serial UART(PC_10, PC_11);
```

Q) How can I change the printf command to output to UART2 instead of UART1 with BAUD of 9600?
A) To change the printf command to output to UART2 instead of UART1 with a BAUD of 9600, you can modify the device.h file as follows:
```c
#define STDIO_UART_TX  PC_2
#define STDIO_UART_RX  PC_3
#define STDIO_UART     UART_2
```"
3246,5751,"Interview (https://forum.wiznet.io/t/topic/5704/5) I made a communication board reset inquiry.I want to know if there is a possibility of a problem with the WIZNET board if the wiznet board is powered on/off repeatedly. https://forum.wiznet.io/t/topic/5704/6
I answered in this post
thank you","Q) I want to know if there is a possibility of a problem with the WIZNET board if the wiznet board is powered on/off repeatedly.
A) There shouldn't be any problem with the WIZNET board if it is powered on/off repeatedly. Thank you."
3247,5754, ,This is a non-response paragraph.
3248,576,"Hi,

First thing - I'm not 'normal', I program in Forth.

I'm using Arduino UNO with W5100 Shield.

I've researched extensively about the TX pointers and think I fully understand what is required to send data. Basically fetch the current tx_wr pointer, and with $7ff and add the base address ($4000 for s0) - gives the the start address in the chip for writing to the tx buffer. When done, get the original tx_wr pointer, add the size of data to it, and write it back. Then do a send.

Also that the tx pointers get set to apparently random numbers every time the socket is established.

What I've found is that when these random numbers exceed 32767 (i.e. become -ve in terms of 16bit signed) then the data actually transmitted isn't what I've written to the buffer and I guess is uninitialised data from anywhere in the chip, and lots of it.

If I write back the tx_wp with top bit AND'ed off, then 1st send is rubbish - but subsequent is all good. 

I note that the memory map of the chip is only drawn up to $8000 in the datasheet, and wonder if that's significant.

Appears to work OK when pointers are (randomly) initialised below $8000

I hope I'm not being thick ..... If tx_wr reads as (say) $A000 before I write 3 bytes....

3 Bytes go in starting at address (($A123 AND $7FF) + $4000)   (Socket 0)   .... i.e. $4123

tx_wp gets written to $A123  

Do a SEND. 

tx_rd then catches-up with tx_wr  but I get all the junk being sent.

Has anyone else experienced similar? SOLVED !!

Reason .....    Back on AVR after months on ARM .... Signed maths on 16 bit caught me out --- thinking I was on 32bit and it was OK to divide (say) 50,000 by 256 and get the high byte as a result !! 

Oh well ! Hi,
I'm glad for you to solve  the problem.","Q) Has anyone else experienced similar? 
A) I'm glad for you to solve the problem."
3249,577,"Hi,
Can I delete the wifi password for connect to the WizFi250 wifi network?

Thanks. :slight_smile: Hello JavierAleman

Yoc can delete WiFi password using <at+wsec>.

Ex)
at+wsec=0,open","Q) Can I delete the wifi password for connect to the WizFi250 wifi network?
A) Yoc can delete WiFi password using <at+wsec>."
3250,5770,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??
?Â´Ã«Â²Â??w5500 ???Â´Ã¬ÂÂ©???ÂÃ­ÂÂ??ÃªÂ°ÂÃ«Â°Â?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?ÂµÃ¬ÂÂ ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ¬ÂÂ ??w5500Ã«Â¥??ÂÃªÂ¸Â°?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´ Ã«Â¦Â¬Ã¬ÂÂ??ÃªÂ±Â¸ÃªÂ³Â  ?Â¶Ã¬???
2~3Ã«Â²??ÂÃ«ÂÂ??Ã«Â¦Â¬Ã¬ÂÂ???ÂÃ«ÂÂ?ÂÃ«ÂÂ° ?ÂÃªÂ°Â??Ã¬Â§??ÂÃªÂ³Â  ?ÂÃ¬ÂÂ??Ã«Â¦Â¬Ã¬ÂÂ?????ÂÃ«Â§Â??sip, mac, gw, sn???Â¤Ã¬Â Â?Â´Ã«ÂÂ?? ÃªÂ°ÂÃ«ÂÂ¤???ÂÃ«ÂÂ±??ÃªÂ°ÂÃ¬ÂÂ¼Ã«Â¡?Ã«Â³?ÃªÂ²Â½Ã«ÂÂ???ÂµÃ¬ÂÂ ???ÂÃ¬Â§Â ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?ÂÃ¬ÂÂ¨???Â¤Ã­ÂÂ???Â¤Ã­ÂÂ?ÂÃ«ÂÂ Ã¬Â´ÂÃªÂ¸Â°??ÃªÂ³Â¼Ã¬Â Â?? ?ÂÃ¬Â¦Â?Â¤Ã­ÂÂ¸?ÂÃ¬ÂÂ ?ÂÃªÂ³Âµ?Â´Ã¬Â£Â¼???ÂÃ¬Â ÂÃ«Â¡?Ã¬Â§ÂÃ­ÂÂ?ÂÃ¬??ÂµÃ«ÂÂ??

Ã«Â¦Â¬Ã¬ÂÂ???ÂÃ¬ÂÂ?ÂÃ«ÂÂ Ã¬Â½ÂÃ«ÂÂ???Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
uint8_t gw[4], sn[4], sip[4];
uint8_t mac[6];
              getSHAR(mac);                                                             
              getGAR(gw);  getSUBR(sn);  getSIPR(sip);                                      
                                                                                            
              // hw reset                                                                   
              wizchip_reset();                                                           
              delay(50);                                                                    
                                                                                            
              setSHAR(mac);                                                                 
              setGAR(gw); setSUBR(sn); setSIPR(sip);                                        
              delay(100);                                                                   
                                                                                            
              getGAR(gw);  getSUBR(sn);  getSIPR(sip);                                      
              printf(""lan %d config\n"", lan+1);                                             
              printf(""gw : %d.%d.%d.%d\n"",gw[0], gw[1], gw[2], gw[3]);                      
              printf(""sip : %d.%d.%d.%d\n"",sip[0], sip[1], sip[2], sip[3]);


?ÂÃ«Â²ÂÃªÂ·?Ã¬Â¶ÂÃ«Â Â¥ Ã¬Â½ÂÃ«ÂÂ
gw : 3.1.3.0  
sip : 3.0.0.1    
   ==> ?Â¤Ã¬Â ÂÃ«Â¡??Â£Ã¬? ?Â°Ã¬ÂÂ´?Â°Ã«ÂÂ gw : 192.168.0.1, sip : 192.168.0.80 ?ÂÃ«ÂÂ??

LAN1/sn=0 link off
LAN1/sn=0 status 0x01.
LAN1/sn=0 link off
LAN1/sn=0 tcp sock closed
LAN1/sn=0 :try to open socket [TCP]
RTR : 0303
RCR : 0034
LAN1/sn=0 :Socket Open[TCP] hello

After reset, try to increase the Delay more and try it.
If you do not protect the stable time after reset, it may not work normal.","Q) What is the technical detail about the chip w5500?
A) The technical details about the chip w5500 are as follows:
uint8_t gw[4], sn[4], sip[4];
uint8_t mac[6];
getSHAR(mac);
getGAR(gw);  getSUBR(sn);  getSIPR(sip);
// hw reset
wizchip_reset();
delay(50);
setSHAR(mac);
setGAR(gw); setSUBR(sn); setSIPR(sip);
delay(100);
getGAR(gw);  getSUBR(sn);  getSIPR(sip);
printf(""lan %d config\n"", lan+1);
printf(""gw : %d.%d.%d.%d\n"",gw[0], gw[1], gw[2], gw[3]);
printf(""sip : %d.%d.%d.%d\n"",sip[0], sip[1], sip[2], sip[3]);

??ë
A) After the chip reset, the delay needs to be increased for stability. Without sufficient stable time after reset, it may not function normally."
3251,578,"Hi,

After I connect to the wizfi250 network, can I configure the module send AT commans by TCP/IP?

How I can send TCP/IP comand for configure module?

Thanks. Hi

Please refer to this URL in order to use AT commands for configure TCP/IP setting.
[url]http://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#at_scon[/url]

And for the more information, refer to section of ""Examples-Data Communication"" in this wiki page.

If you want to use AT command through TCP/IP communication, WizFi250 can't use this function.

Thanks. Do you now another module, were i can use AT command through TCP/IP communication for configure the module?
Thanks. Hello JavierAleman

Because some-AT-commands needs disassociation or reboot, it's not easy to issue AT-commands via TCP-IP.","Q) After I connect to the wizfi250 network, can I configure the module send AT commands by TCP/IP? 
A) If you want to use AT command through TCP/IP communication, WizFi250 can't use this function.

Q) How I can send TCP/IP command for configure module? 
A) Please refer to this URL in order to use AT commands for configure TCP/IP setting. [url]http://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#at_scon[/url]. And for the more information, refer to section of ""Examples-Data Communication"" in this wiki page.

Q) Do you know another module where I can use AT command through TCP/IP communication to configure the module? 
A) Because some AT-commands needs disassociation or reboot, it's not easy to issue AT-commands via TCP-IP."
3252,5785,"Hello, this is Wiznet.

Why don't you refer to the Wiz550WEB code, a WEB module using STM32F103 and W5500?

https://github.com/wiznet/wiz550WEB

The WEB server is eventually transmitting HTML code with the HTTP protocol.I understand that the HTTP protocol is only available on TCP.

It is recommended to see the RFC document.

thank you hello.

BOOT is a supervisor code for updating the app through Ethernet.
If you don't need a network firmware update feature, just refer to the app code.","Q) Why don't you refer to the Wiz550WEB code, a WEB module using STM32F103 and W5500?
Q) It is recommended to see the RFC document.

A) The WEB server is eventually transmitting HTML code with the HTTP protocol. I understand that the HTTP protocol is only available on TCP. 
A) If you don't need a network firmware update feature, just refer to the app code."
3253,579,"Hi,

For configure the module, can i use the AT command via WIFI?

Thanks. Hi

Please refer to this URL in order to use AT commands for configure Wi-Fi setting.
[url]http://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#examples_-_association_disassociation[/url]

If you want to use AT command through Wi-Fi communication, WizFi250 can't use this function.

Thanks.","Q) For configure the module, can i use the AT command via WIFI? 
A) If you want to use AT command through Wi-Fi communication, WizFi250 can't use this function."
3254,5790,"I have configured WIZ750SR-110 as my server in DHCP mode. (Noted its IP address and Port Number).

WIZ750SR-110 is connected to a Desktop using Serial Interface and the other end (Ethernet) is connected to RJ45 cable. The Desktop is running Putty to display incoming data on Desktop Screen and is configured correctly. (Baud Rate, data size, start and stop bits and Flow control match that of WIZ750SR-110).

On the transmitting end is a Laptop that runs SSH terminal window using Putty. and the terminal is configured to connect to my server (WIZ750SR-110) using the IP address and Port number that was earlier recorded.

THE PROBLEM:
Now, when I start Putty on the transmitting (Laptop/client) side with SSH terminal, the receiving end Putty (Desktop/serial port) displays a message ""SSH-2.0PuTTY_Release_0.71"" and the configuration terminal of WIZ750SR-110 shows CONNECT as its status.

When I try typing any data into SSH Terminal Putty, nothing gets displayed on the Serial Port Putty.

Can someone help or tell where I am going wrong?

Thank you in advance.

Note: I have enabled character display under PuTTY settings so there is no issue on PuTTY side. Hello,

Can you share the screenshot of your configuration tool?
It would be helpful for me to figure out the reason.

Thank you.
BR,

James. Hello,

Isn't there any terminal character like '0x0d', '0x0a' to send data from SSH terminal Putty to Serial Putty?
The greeting message has that so that it was transferred but following message seems not to have it.
Can you check it again?

BR,

James I changed the SSH Program. There was some problem with PuTTY, basically it was outdated. So switched to Hercules, as seen on other Wiznet forum posts and it worked just fine.

Still Wondering what has changed on TCP/IP from the days of PuTTY that its SSH Terminal is not working. Maybe there is something with the settings that needs to be changed. I will check it later when I am free.

Thanks once again James! Hi @neo I used Hercules to send data from the 
Arduino to another PC via WIZ750-SR-TTL using UART communication without the Evaluation board, and and check the data on the Software Hercules, and on Hercules I was shown that the connection is established but was unable to get the data which I sent on the Hercules. So can you please guide me the steps which you worked on to work with Hercules?

Thanks,
 Keshav Hi @Keshav_Shah,

I am assuming you are running Hercules on PC and using it as a receiver to check data bytes.

First you need to check if the WIZ750-SR-TTL eval board and Hercules are both on same network i.e. connected on same LAN. 
Second, you need to config the settings of WIZ750-SR-TTL as server using **wizconfig** utility and use Hercules in **TCP client** mode to connect to  WIZ750-SR-TTL. You will need the IP address of WIZ750-SR-TTL and also its communication (COM) port number to be able to communicate with Hercules.

On Hercules, with the IP address and COM Port details of WIZ750-SR-TTL you can initiate connection. If Hercules states that your connection was successful then verify the connection status of WIZ750-SR-TTL using wizconfig. Wizconfig should say server Status as **Connected**.

Once these steps are done then you may start sending UART data from Arduino.

If you still cannot see any data on Hercules, verify your Baudrate between Arduino and WIZ750-SR-TTL. Alternatively, you may check if Arduino is communicating using Hercules in Serial COM mode.

Hope this helps. Hi @neo,
I have got the WIZ750SR-TTL0 board but do not have the evaluation board, so can you suggest me some other alternative to view the data sent from the Arduino on the PC via WIZ750SR-TTLL? As I tried Python socket programming but it showed an error in connection despite the connection being established when I typed ""ping IP address"" on the command prompt.
On Hercules, I was shown connected but I didn't have WIZ750SR-EVB.

Thank you,
Best Regards
Keshav","Q) Can someone help or tell where I am going wrong? Thank you in advance. 
A) Can you share the screenshot of your configuration tool? It would be helpful for me to figure out the reason. Thank you. BR, James.

Q) Isn't there any terminal character like '0x0d', '0x0a' to send data from SSH terminal Putty to Serial Putty? The greeting message has that so that it was transferred but following message seems not to have it. Can you check it again? BR, James 
A) I changed the SSH Program. There was some problem with PuTTY, basically it was outdated. So switched to Hercules, as seen on other Wiznet forum posts and it worked just fine. Still Wondering what has changed on TCP/IP from the days of PuTTY that its SSH Terminal is not working. Maybe there is something with the settings that needs to be changed. I will check it later when I am free. Thanks once again James!

Q) Hi @neo I used Hercules to send data from the Arduino to another PC via WIZ750-SR-TTL using UART communication without the Evaluation board, and and check the data on the Software Hercules, and on Hercules I was shown that the connection is established but was unable to get the data which I sent on the Hercules. So can you please guide me the steps which you worked on to work with Hercules? Thanks, Keshav 
A) Hi @Keshav_Shah, I am assuming you are running Hercules on PC and using it as a receiver to check data bytes. First you need to check if the WIZ750-SR-TTL eval board and Hercules are both on the same network i.e. connected on the same LAN. Second, you need to config the settings of WIZ750-SR-TTL as a server using **wizconfig** utility and use Hercules in **TCP client** mode to connect to WIZ750-SR-TTL. You will need the IP address of WIZ750-SR-TTL and also its communication (COM) port number to be able to communicate with Hercules. On Hercules, with the IP address and COM Port details of WIZ750-SR-TTL, you can initiate the connection. If Hercules states that your connection was successful then verify the connection status of WIZ750-SR-TTL using wizconfig. Wizconfig should say server Status as **Connected**. Once these steps are done then you may start sending UART data from Arduino. If you still cannot see any data on Hercules, verify your Baudrate between Arduino and WIZ750-SR-TTL. Alternatively, you may check if Arduino is communicating using Hercules in Serial COM mode. Hope this helps.

Q) Hi @neo, I have got the WIZ750SR-TTL0 board but do not have the evaluation board, so can you suggest me some other alternative to view the data sent from the Arduino on the PC via WIZ750SR-TTLL? As I tried Python socket programming but it showed an error in connection despite the connection being established when I typed ""ping IP address"" on the command prompt. On Hercules, I was shown connected but I didn't have WIZ750SR-EVB. Thank you, Best Regards Keshav 
A) None."
3255,5796,"Hello friends,
My W5500 IC interrupt pin not generate interrupt.
i have set these register to generate  interrupt when W5500 IC receive data on Ethernet connector using UDP :

setSn_IMR(0,0x04);
setSIMR(0x01);
setINTLEVEL(5);
setSn_IR(0,0x00);
while(1)
{
     if(interrupt received)
       {
             setSn_IR(0,0x04);
       }
}


Can you guys help me to resolve my problem.

-Alka Hello,

[quote=""Alka_Yadav, post:1, topic:5796""]
setSn_IR(0,0x00);
[/quote]
Why are you doing this? There is no meaning at all. If you want to clear all interrupts, write 0x1f.
It seems that there is no problem generating an interrupt. Open socket 0 with udp and check again that you are recvaging the data.","Q) Why are you doing this? There is no meaning at all. If you want to clear all interrupts, write 0x1f.
A) It seems that there is no problem generating an interrupt. Open socket 0 with udp and check again that you are receiving the data."
3256,5798,"Hi.
I have a w500 ethernet ic which is connected to a fpga.
W5300 had been drived as a ""tcp server""  and should be connected to multiple clients. I have heard that i need to establish one socket for each client. Am I right?
If so, how should I manage the sockets? If W5300 is similar to W5500, then yes, you need to ""establish one socket for each client"". In my application, I allocate 4 sockets for my embedded Web server. Instead of treating each socket individually, I treat them as an array of sockets. Hi acpie360,

Thanks a lot for your reply.
What do you means by"" treat them as an array of sockets""?
At first, i initialize all the sockets simultaneously. But when it comes to check sockets status, don't know how to react. Especially when only one of them has been stablished.
Could you describe how did you switch between sockets? And when?
I would be grateful if you draw a flowchart.

Thanks in advance. I use ioLibrary. 

https://github.com/Wiznet/W5500_EVB

I am not sure what you mean by ""switch between sockets"". Each socket operates independently. They all have their own ""states"", i.e., SOCK_CLOSED, SOCK_INIT, SOCK_LISTEN, SOCK_CLOSE_WAIT, SOCK_SYNRECV and SOCK_FIN_WAIT.","Q) Am I right? If so, how should I manage the sockets?
A) If W5300 is similar to W5500, then yes, you need to ""establish one socket for each client"". In my application, I allocate 4 sockets for my embedded Web server. Instead of treating each socket individually, I treat them as an array of sockets.

Q) What do you mean by ""treat them as an array of sockets""?
A) Each socket operates independently. They all have their own ""states"", i.e., SOCK_CLOSED, SOCK_INIT, SOCK_LISTEN, SOCK_CLOSE_WAIT, SOCK_SYNRECV and SOCK_FIN_WAIT."
3257,580,"Can i modify the firmware of the module por personalize the product? , for sample, i like to change the logo of the web serber for the logo of my company.

Thanks. Hello JavierAleman

If you want to change the f/w, you need NDA with WIZnet.
Please, contact to WIZnet official sales part as below.

[url]http://wiznet.co.kr/sub_modules/en/aboutus/contactus.asp[/url]","Q) Can i modify the firmware of the module por personalize the product? , for sample, i like to change the logo of the web serber for the logo of my company.
A) If you want to change the f/w, you need NDA with WIZnet. Please, contact to WIZnet official sales part as below. [url]http://wiznet.co.kr/sub_modules/en/aboutus/contactus.asp[/url]"
3258,5800,"The inquiry is being reviewed by the person in charge.

thank you
Irina hello.

I also had the same problem while using the Netgear switch hub.
Do you know what happened to the solution? Hello ~ Let's check the contents. Dear @Byron9 @fatally

Hello, this is Wiznet.

This problem occurs because the criteria for the establishment of links are different for each link partner.

The W5500 must be linked with LINK partners and electrical characteristics.

If other switches have a large range of electricity,

Netgear products are very tightly checking electrical properties, so the link is not established.

This electrical characteristic is very closely related to the PCB design of the W5500, so we recommend that you review the PCB design.

Please send a governor file and you can review it.

If you have difficulty opening a governor file, you can capture and upload some of the governor files so that you can review the PCB.

thank you hello.

I sent a governor file by message.
Please confirm.

thank you hello.

Please check the message.
thank you hello.

Mr. Scott said he would need to review PCB, so he sent a message.??
If you can, please give us an answer.

thank you Sorry for the late answer.
The person in charge @scott I think this week's vacation will not be able to answer.
If you can answer other hardware engineers, it will be answered ...
Ekkim@wiznet.io and scott@wiznet.io will be asked.

Sorry for being too late. I sent a message.

Please review. I checked the attachment,
I delivered the contents to other hardware staff.","Q) Do you know what happened to the solution for the problem with the Netgear switch hub?
Q) If you can, please give us an answer.
A) The problem occurs because the criteria for the establishment of links are different for each link partner. The W5500 must be linked with LINK partners and electrical characteristics. If other switches have a large range of electricity, Netgear products are very tightly checking electrical properties, so the link is not established. This electrical characteristic is very closely related to the PCB design of the W5500, so we recommend that you review the PCB design. Please send a governor file and you can review it. If you have difficulty opening a governor file, you can capture and upload some of the governor files so that you can review the PCB. Mr. Scott said he would need to review PCB, so he sent a message.
A) Sorry for the late answer. The person in charge @scott I think this week's vacation will not be able to answer. If you can answer other hardware engineers, it will be answered ... Ekkim@wiznet.io and scott@wiznet.io will be asked. Sorry for being too late. I sent a message. Please review. I checked the attachment, I delivered the contents to other hardware staff."
3259,5806,"Hi,

is there any chance that the W5100 can continuously fill the transmit memory buffer through direct or indirect mode, even while using the SPI mode to issue a send command? Hi,

Host I/F can't be changed on run-time operation.

Host I/F should be decided when chip reset.

Thank you.","Q) Is there any chance that the W5100 can continuously fill the transmit memory buffer through direct or indirect mode, even while using the SPI mode to issue a send command? 
A) Host I/F can't be changed on run-time operation. Host I/F should be decided when chip reset. Thank you."
3260,5807,"You may already be doing some of the things I suggest below, but I can't tell for sure based on the information you've provided. In particular, it's not clear whether your transmissions are fixed-size or variable. So, sorry if I'm telling you things you already know, I just can't tell from your question.

1. If messages are fixed-size and smaller than the W5500 Rx buffer, you can check the Socket n Received Size Register, Sn_RX_RSR0, to see how many bytes are available and wait until the entire message is in the Rx buffer before reading.

2. If your messages are NOT fixed-length, you need a unique termination string at the end of the message to tell you when you're done. Read repeatedly until you see that string. Alternately, you can put the length of the message at the beginning of the first packet of each transmission, as is done in HTTP. Read in a loop until all bytes have been received.

3. Each socket has a 2KB receive buffer (by default; you can allocate the 16KB between the 8 sockets differently if you choose). If your messages are larger than 2KB, you'll need to do multiple reads to get the entire message. Upd.
I solved problem: 
I need to move Sn_RXPTR after confirmation by controller board, not before. Sound great!","Q) Are the transmissions fixed-size or variable? 
A) If messages are fixed-size and smaller than the W5500 Rx buffer, you can check the Socket n Received Size Register, Sn_RX_RSR0, to see how many bytes are available and wait until the entire message is in the Rx buffer before reading. If your messages are NOT fixed-length, you need a unique termination string at the end of the message to tell you when you're done. Read repeatedly until you see that string. Alternately, you can put the length of the message at the beginning of the first packet of each transmission, as is done in HTTP. Read in a loop until all bytes have been received. Each socket has a 2KB receive buffer (by default; you can allocate the 16KB between the 8 sockets differently if you choose). If your messages are larger than 2KB, you'll need to do multiple reads to get the entire message."
3261,581,"Hello,

Maybe someone could help me. I am making a project using W3150 chip where the SPI mode will be used for communication. 

[b]So then what I have to do with address and data bus pins. Should I pull them down???[/b]

There was nothing written on the datasheet about it.

Thanks! Hi, 

As far as I know, W3150 don't care about pull up or pull down of address or data bus.
but I would like you to do is add the pull-down for reliability of chip. 

thanks, :smiley: Thanks!!! :slight_smile:","Q) Maybe someone could help me. I am making a project using W3150 chip where the SPI mode will be used for communication. So then what I have to do with address and data bus pins. Should I pull them down??? There was nothing written on the datasheet about it. Thanks!
A) As far as I know, W3150 don't care about pull up or pull down of address or data bus, but I would like you to do is add the pull-down for reliability of chip. Thanks!"
3262,5811,"hello.
First of all, I'm sorry.
I don't know what code the code is at the time of training four years ago, so I can't check it in that code.

1. The latest version of IOLIBRARY can go to the Github link below.
 -https://github.com/wiznet/iolibrary_driver
2. What is the initial setup of the W5500?
     Usually when you set up the W5500,
 -RED_WIZCHIP_SPI_CBFUNC or Reg_wizchip_SPIBURST_CBFUNC defines the callback function
 -Put the network information.
 -Phy link through the wizphy_getphylink function and proceed with the ping test.

If the above setting is right, the network environment is caught.

The REFERENCE CODE officially provided by WizNet does not have the Load Net Parameters function mentioned.
There is a code used using STM32F103 among the reference codes we officially offer.
https://github.com/wiznet/w5100s-EVB
Please refer to the above code and change.


thank you
Irina [Quote = ""Jinxianghe, POST: 1, Topic: 5811""]
I can't find Google search.
Flash_id
Gateway_ip
Flash_gateway_ip_addr
Flash_gateway_ip_size
etc??
[/Quote]
hello
I don't know how the full code is, but this part is probably the code that comes from the Network information from IP and Gateway.
It is like a code that receives information if you have the information stored in Flash when you save the network information in the first Flash and then boot.
 
thank you
Teddy [Quote = ""Jinxianghe, POST: 1, Topic: 5811""]
Load net parameters
[/Quote]

https://github.com/hazirguo/stm_w5100/blob/master/EVB-W5100STM32F101/demo.c

I saw this article, but now I erased. Hello, this is Wiznet Park Byung -taek.

Check the IP address of your PC and check the IP of Device.

thank you
Teddy hello?

Thank you for quick response.

I did it as I told you, but I didn't operate, so I changed the IP address value as a result of the re -inspection, so the ping test is doing well.

thank you

[https://blog.naver.com/newspacekor/221527639905

I am sorry that the image you sent was not for your understanding and used it.If you don't like it, I'll erase it right away.

And I left a long article on my blog, and there was a reply in the forum ...

Can I ask you to explain the part of receiving and storing the data and the data?

Sorry for the busy time. hello?

In the video ...

SOCK ESTABLISHED <=== We don't listen to this part.

When you first connect.

CASE: SOCK_CLOSED <=== Passing through this part

CASE SOCK_INIT <==== After that,

CASE SOCK_LISTEN: <===== And continues here.

When the client is connected

CASE SOCK_ESTABLISHED <==== You've said that it works.

So now it's like a client access.

So I checked and I did it as a server in the tool.

First of all, the data comes out well ~

A few days ago, the wired bulks are relieved.

Thank you ^. ^","Q) What is the initial setup of the W5500? 
A) Usually when you set up the W5500, RED_WIZCHIP_SPI_CBFUNC or Reg_wizchip_SPIBURST_CBFUNC defines the callback function, puts the network information, checks Phy link through the wizphy_getphylink function, and proceeds with the ping test. 

Q) Can I ask you to explain the part of receiving and storing the data and the data? 
A) In the video ... SOCK ESTABLISHED <=== We don't listen to this part. When you first connect. CASE: SOCK_CLOSED <=== Passing through this part, CASE SOCK_INIT <==== After that, CASE SOCK_LISTEN: <===== And continues here. When the client is connected CASE: SOCK_ESTABLISHED <==== You've said that it works. So now it's like a client access. So I checked and I did it as a server in the tool. First of all, the data comes out well ~ A few days ago, the wired bulks are relieved. 

Note: Personal information has been removed."
3263,5813,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

W5500ÃªÂ³?STM32F ?ÂÃ­ÂÂ???Â°ÃªÂ²Â° ?Â´Ã¬ÂÂ ?Â¬Ã¬ÂÂ© ?ÂÃ«Â Â¤ÃªÂ³??Â©Ã«ÂÂ??

PING ?ÂÃ¬ÂÂ¤???Â´Ã¬ÂÂ ?ÂÃ¬Â²Â­?ÂÃªÂ°Â??Ã«Â§ÂÃ«Â£Â?ÂÃ«ÂÂ¤ÃªÂ³??ÂÃ¬???..

?Â¹Ã¬ÂÂ???Â¶Ã¬ÂÂ´??SPI Ã«Â¶?Ã«Â¶ÂÃ«Â§Â ?ÂÃ«?Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ¬? ?ÂÃ¬ÂÂ¸???ÂÃªÂ³Â  ?Â¶Ã¬??Â°Ã¬ÂÂ.

?Â¹Ã¬ÂÂ...
void W5500Initialze(void){
  unsigned char temp;
  unsigned char W5500FifoSize[2][8] = {{2,2,2,2,2,2,2,2,},{2,2,2,2,2,2,2,2}};

  W5500DeSelect();
  // spi function register
  reg_wizchip_spi_cbfunc(W5500ReadByte, W5500WriteByte);
  //reg_wizchip_spiburst_cbfunc(wizchip_burst_read, wizchip_burst_write);
  // CS function register
  reg_wizchip_cs_cbfunc(W5500Select, W5500DeSelect);
  if(ctlwizchip(CW_INIT_WIZCHIP,(void*)W5500FifoSize) == -1){printf(""W5500 initialized fail.\r\n"");}
    do{//check phy status.
      if(ctlwizchip(CW_GET_PHYLINK,(void*)&temp) == -1){printf(""Unknown PHY link status.\r\n"");}
    }while(temp == PHY_LINK_OFF);
}

?Â´Ã«?Ã«Â¶ÂÃ¬ÂÂ??LAN Ã¬Â¼??Â´Ã«Â¸Â???Â°ÃªÂ²Â° ?ÂÃ¬ÂÂ´ ?ÂÃªÂ±Â°???ÂÃ«ÂÂ???ÂÃ¬ÂÂ??ÃªÂµÂ¬Ã«Â¶Â???ÂÃ«Â©Â´ SPI ?ÂµÃ¬ÂÂ ???ÂÃ«ÂÂ¤ÃªÂ³?Ã«Â´ÂÃ¬ÂÂ¼ ?ÂÃ«ÂÂÃªÂ±Â´Ãª??? hello,
Simple confirmation of whether SPI -related signals are set properly
It is most accurate to read the Version Register in the Common Register.
There is a GetVersionR () function in iOLIBRARY, so when you read the data with this function, if you get a value of 0x04, the SPI setting is right.

thank you
Irina [Quote = ""Irina_kim, Post: 2, Topic: 5813""]
Simple confirmation of whether SPI -related signals are set properly
It is most accurate to read the Version Register in the Common Register.
There is a GetVersionR () function in iOLIBRARY, so when you read the data with this function, if you get a value of 0x04, the SPI setting is right.
[/Quote]

Thank you for quick response.

 if (getversionr ()! = 0x04) {printf (""Access err: versionr! = 0x04, read value =%02bx \ r \ n"", getversionr (); while (1);}


0x04 It comes out well. hello
If the Version Register is read properly, the SPI setting is right.

In addition, I will move the post to the Korea Forum.


thank you
Irina hello?

[https://blog.naver.com/newspacekor/22152749216

Can I check this article? hello

I checked this article.
The Listen state is in a state that the TCP Server is waiting for the connection of the TCP Client.
Please check out if the IP and port of the Destination in TCP Client will try to connect. hello?

I checked.

^.^

I was testing it as a server.

I checked and solved it.

thank you","Q) Can I check this article? 
A) I checked this article.

Q) It is a question if you are curious about technical details about the chip. 
A) Simple confirmation of whether SPI -related signals are set properly. It is most accurate to read the Version Register in the Common Register. There is a GetVersionR() function in iOLIBRARY, so when you read the data with this function, if you get a value of 0x04, the SPI setting is right.

Q) ——————————————————————————- 
A) None.

Q) hello 
A) If the Version Register is read properly, the SPI setting is right.

Q) thank you 
A) None.

Q) hello? 
A) None.

Q)  hello? 
A) None.

Q) It is a question if you are curious about technical details about the chip. 
A) Simple confirmation of whether SPI -related signals are set properly. It is most accurate to read the Version Register in the Common Register. There is a GetVersionR() function in iOLIBRARY, so when you read the data with this function, if you get a value of 0x04, the SPI setting is right.

Q) I checked. 
A) The Listen state is in a state that the TCP Server is waiting for the connection of the TCP Client. Please check out if the IP and port of the Destination in TCP Client will try to connect.

Q) hello? 
A) None.

Q) ^.^ 
A) I was testing it as a server.

Q) I checked and solved it. 
A) None.

Q) thank you 
A) None."
3264,5814,"Hi,

I am working on DHCP and it worked properly.
But i am having some doubts like, My chip will get Dynamic IP Address and SUBR and Gateway. Other end somebody wants to send some data to my assigned IP address, How they will get to know the IP address because DHCP IP address may change regularly.

Please help me out with this issue.

Thanks,
Century If another device needs to send data to your device, you can use a fixed IP address instead. I do this, and the fixed address is user-configurable via a web page. 

If this is not an option you may be able to configure your router to assign the same fixed address ""around"" the DHCP table. ASUSwrt-Merlin firmware supports this (LAN page/DHCP Server tab), and DD-WRT may too. Not sure about off-the-shelf router firmware.

If your router doesn't support that option, it may be able to run dnsmasq, which if configured properly would allow it to act as a local DNS. I've never done that so you'll have to research it if the other options don't work for you. Assuming you are talking about the devices on the same network, you'll have to use static IP allocation or implement mDNS.","Q) My chip will get Dynamic IP Address and SUBR and Gateway. Other end somebody wants to send some data to my assigned IP address, How they will get to know the IP address because DHCP IP address may change regularly.
Please help me out with this issue.

A) If another device needs to send data to your device, you can use a fixed IP address instead. I do this, and the fixed address is user-configurable via a web page. If this is not an option you may be able to configure your router to assign the same fixed address ""around"" the DHCP table. ASUSwrt-Merlin firmware supports this (LAN page/DHCP Server tab), and DD-WRT may too. Not sure about off-the-shelf router firmware. If your router doesn't support that option, it may be able to run dnsmasq, which if configured properly would allow it to act as a local DNS. I've never done that so you'll have to research it if the other options don't work for you. Assuming you are talking about the devices on the same network, you'll have to use static IP allocation or implement mDNS."
3265,5816,"Can someone please clarify the meaning of this sentence mentioned in WIZ750SR-110 [Getting Started manual](http://wizwiki.net/wiki/doku.php?id=products:wiz750sr-110:gettingstarted:en)

**If the DHCP(automatic IP allocation) is used, both the WIZ750SR and test PC must be set to be assigned the same IP from the same router.**

As far as I understand, this means: the S2E client should have Remote Host settings that of PC and these settings should not change during re-connection to the network.

Please correct me If I am wrong. Hi,

The sentence is not clear so that it seems to have made you confused.

When you use DHCP mode, you must be sure that WIZ750SR and your test PC have IP addresses which are able to communicate each other.
For example, WIZ750SR is in DHCP mode and it is allocated to ""192.168.11.xxx"" but your PC is ""192.168.1.xxx"" and subnet mask is ""255.255.255.0"".
Then, they can't communicate each other because they are in different IP address scope. You must be sure that your PC is in ""192.168.11.xxx"" address range.

Above sentence should be changed to 
**""If the DHCP is used, it must be sure that both the WIZ750SR and test PC have IP addresses in the same Subnet address range.""**

I hope it become clear.

James. Ok, I  got what you mean.

But the remote host settings section of the client side configuration must contain IP address and port number for connecting to Server PC through TCP/IP.

Is there any way I can automatically update the remote host IP That the DHCP has allocated To the server PC to avoid configuring the client module each time the network is changed?","Q) Can someone please clarify the meaning of this sentence mentioned in WIZ750SR-110 [Getting Started manual](http://wizwiki.net/wiki/doku.php?id=products:wiz750sr-110:gettingstarted:en)
""If the DHCP(automatic IP allocation) is used, both the WIZ750SR and test PC must be set to be assigned the same IP from the same router."" As far as I understand, this means: the S2E client should have Remote Host settings that of PC and these settings should not change during re-connection to the network. Please correct me If I am wrong.

Q) Is there any way I can automatically update the remote host IP That the DHCP has allocated To the server PC to avoid configuring the client module each time the network is changed? 
A) The sentence is not clear so that it seems to have made you confused. When you use DHCP mode, you must be sure that WIZ750SR and your test PC have IP addresses which are able to communicate each other. For example, WIZ750SR is in DHCP mode and it is allocated to ""192.168.11.xxx"" but your PC is ""192.168.1.xxx"" and subnet mask is ""255.255.255.0"". Then, they can't communicate each other because they are in different IP address scope. You must be sure that your PC is in ""192.168.11.xxx"" address range. Above sentence should be changed to ""If the DHCP is used, it must be sure that both the WIZ750SR and test PC have IP addresses in the same Subnet address range."" I hope it become clear. James. Ok, I  got what you mean. But the remote host settings section of the client side configuration must contain IP address and port number for connecting to Server PC through TCP/IP."
3266,5817,"Hi,

I have two WIZ750SR-110, One is Server with a password and the second one is client.

Now without the password the devices recognize each other on the network and communicate without any problem. But when I try using the TCP/IP password, I cannot find a solution as to how I can send the password from client automatically to the server for maintaining the connection. I want to send the password on power-On or Network Connect.

Can someone please give me a suggestion?

Note: I do know that to initialize connection I need to send the password first to the server otherwise it closes the connection. Hi,

If your device connected to WIZ750SR-110 as a Client doesn't send the password on Serial port, there is no way.
If so, you need to customize the code for you.

James Any leads like manual or guide on how I can change the code?

Thanks.","Q) Can someone please give me a suggestion? 
A) If your device connected to WIZ750SR-110 as a Client doesn't send the password on Serial port, there is no way. If so, you need to customize the code for you. 
Q) Any leads like manual or guide on how I can change the code? 
A) James"
3267,5818,"hello?

The phone call is wrongly inquiring about the bulletin board inquiry.

The client's dust socket is also a dust -knowing one, and you need to implement the following features.

Leave the PC I have as a server, and then configure the client with a client

If you send data from the PC program, 0x88.
In the W5500, if you are 0x88, send the data that suits it.

In the case of 0x99, I would like to implement such an action that sends the right data.


I think the setting in the main is the same.

If you look at the post here, I think you have to live a socket.

What should I do with this?

And I wonder how to do it. The W5500 has 8 sockets.
The actual communication is done by each socket.

Communication programs are made in a series of processes that receive data, send data, break connections, and form connections.
And depending on the connection of the socket, you should determine what to do.

See the example code in github.com.
Please refer to the Loopback example.

https://github.com/wiznet/w5500_EVB ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

ÃªÂ·Â¼Ã«Â¡Â?ÂÃ¬ÂÂ ?Â Ã¬ÂÂ¸??ÃªÂ³Â Ã¬ÂÂ??Ã«Â§ÂÃ¬ÂÂ¼ ??ÂÂ??
ÃªÂ¹ÂÃ­ÂÂÃ«Â¸????ÂÃ«ÂÂ loopback ?ÂÃ¬ÂÂ¤Ã«Â¥?ÃªÂ°ÂÃ¬Â¶Â??Ã«Â³Â´Ã«Â©Â´

  while(1){ 
  /* PHY Status checker: [PHY status] checked every 'SEC_PHYSTATUS_CHECK' seconds */ 
    if(PHYStatus_check_flag){
      PHYStatus_check_flag = false; 
      PHYStatus_Check(); 
    } 

    if(run_user_applications) { /* Loopback test : TCP Server / UDP */ 
      if ((ret = loopback_tcps(SOCK_TCPS, buffer, PORT_TCPS)) < 0){// TCP server loopback test 
 #ifdef _MAIN_DEBUG_ 
        printf(""SOCKET ERROR : %ld\r\n"", ret); 
 #endif 
      } 
      if((ret = loopback_udps(SOCK_UDPS, buffer, PORT_UDPS)) < 0){ // UDP loopback test 
 #ifdef _MAIN_DEBUG_ 
        printf(""SOCKET ERROR : %ld\r\n"", ret); 
 #endif 
      } 
    } // End of user's code 
  } // End of Main loop 

?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃªÂ³Â  
void PHYStatus_Check(void){ 
  uint8_t tmp; 
  do{ 
    ctlwizchip(CW_GET_PHYLINK, (void*) &tmp);
    if(tmp == PHY_LINK_OFF) { 
      //?Â¬ÃªÂ¸Â°??Ã«Â­??Â£Ã¬ÂÂ´???ÂÃ«ÂÂÃªÂ±Â°Ã¬ÂÂ¼?
    } 
  }while(tmp == PHY_LINK_OFF); 
} 
 ?Â¬Ã«Â ÂÃªÂ²??ÂÃ¬ÂÂ ?ÂÃ«ÂÂÃªÂ±?ÃªÂ°ÂÃ¬???..

?Â¬ÃªÂ¸Â° ÃªÂ¸???Ã«Â³Â´Ã«Â©Â´ ?ÂÃ¬Â¼Â??Open ?ÂÃ«ÂÂ close ?ÂÃ«ÂÂ Ã«Â­?ÃªÂ·Â¸Ã«ÂÂ° ?ÂÃªÂ¸Â° ?Â¤Ã¬ÂÂ´ ?ÂÃ«ÂÂ???Â¬ÃªÂ¸Â´ ÃªÂ·Â¸Ã«ÂÂ° ?Â´Ã¬ÂÂ©???ÂÃ¬ÂÂ´??
?ÂÃ¬Â§Â ??Ã«ÂªÂ¨Ã«Â¥Â´ÃªÂ¸Â°Ã«ÂÂ ?ÂÃ«ÂÂ° ?ÂÃ¬Â¼Â ?ÂÃ«ÂÂÃ«Â§??ÂÃ¬ÂÂ¼Ã«Â©??ÂÃ«ÂÂÃªÂ±?ÃªÂ°ÂÃ¬???

 Ã«Â§ÂÃªÂ²Â ?ÂÃªÂ³Â  ?ÂÃ«ÂÂÃªÂ±Â´Ãª???
PC ?ÂÃ¬ÂÂ ?Â¤Ã«ÂÂ ?Â°Ã¬ÂÂ´??Ã«Â¥??Â´Ã«ÂÂ»ÃªÂ²?Ã«Â°ÂÃªÂ³Â ... ?Â°Ã¬ÂÂ´?? ?ÂÃ¬ÂÂ¸??Ã«Â³Â´Ã«ÂÂ´??Ã«Â°Â©Ã«Â²Â?? ?Â´Ã«ÂÂ»ÃªÂ²??ÂÃ«ÂÂ?? [quote=""jinxianghe, post:3, topic:5818, full:true""]
      if ((ret = loopback_tcps(SOCK_TCPS, buffer, PORT_TCPS)) < 0){// TCP server loopback test 
[/quote]

loopback_tcps()?Â¨Ã¬ÂÂ?Â´Ã¬ÂÂ???ÂÃ¬ÂÂ???Â¤Ã«ÂªÂ?ÂÃ«Â Â¸???Â¼Ã«ÂÂ¤???Â©Ã«ÂÂ??
loopback_tcps()?Â¨Ã¬ÂÂ??TCP Server Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡??ÂÃ¬Â¼Â???Â´Ã¬ÂÂ´??Loopback ?ÂµÃ¬ÂÂ ???ÂÃ«ÂÂ ?Â¨Ã¬ÂÂ?ÂÃ«ÂÂ??
loopback.c ?ÂÃ¬ÂÂ¼?Â´Ã¬ÂÂ Ã«Â³Â´Ã¬ÂÂÃ«Â©?loopback_tcps()?Â¨Ã¬ÂÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

loopback.c ?ÂÃ¬ÂÂ¼???ÂÃ¬Â¹Â???ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
https://github.com/Wiznet/W5500_EVB/blob/master/ioLibrary/Appmod/Loopback/loopback.c

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? I will move to the Korean Forum.

thank you
Irina hello?

https://blog.naver.com/newspacekor/22152749216

I tested it as above.

SOCK_LISTEN only keeps coming out. You need to request a connection from the PC program to the board.

Please refer to the following documentation for details of the TCP protocol.

https://wizwiki.net/wiki/doku.php?id=products:W5500:500:APPLICATION:TCP_FUNCTION","Q) What should I do with this? And I wonder how to do it.
A) The W5500 has 8 sockets. The actual communication is done by each socket. Communication programs are made in a series of processes that receive data, send data, break connections, and form connections. And depending on the connection of the socket, you should determine what to do. See an example code on github.com. Please refer to the Loopback example.

Q) loopback_tcps()? loopback_tcps()? and loopback.c?
A) loopback_tcps() is used for TCP Server loopback test. loopback.c is a source code to understand its operation.

Q) I will move to the Korean Forum.
A) None.

Q) thank you
A) None."
3268,582,"I have problem with build of ioLibrary_BSD in Keil IDE. I add to my project Ethernet and Internet directories and during build I have got following errors:

[code]compiling wizchip_conf.c...
..\Ethernet\wizchip_conf.c(97): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(98): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(99): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(100): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(101): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(102): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(103): error:  #29: expected an expression
..\Ethernet\wizchip_conf.c(104): error:  #29: expected an expression
[/code]

lines where errors occur:

[code]      .id                  = _WIZCHIP_ID_,
      .if_mode             = _WIZCHIP_IO_MODE_,
      .CRIS._enter         = wizchip_cris_enter,
      .CRIS._exit          = wizchip_cris_exit,
      .CS._select          = wizchip_cs_select,
      .CS._deselect        = wizchip_cs_deselect,
      .IF.BUS._read_byte   = wizchip_bus_readbyte,
      .IF.BUS._write_byte  = wizchip_bus_writebyte[/code]

I have also one warring:

[code]..\Internet\DHCP\dhcp.c(577): warning: C4017W: type may be used before being set[/code]

in line:

[code]uint8_t type;[/code]


Thanks you in advance for your help. I have found solution for errors:

[code]--c99[/code]

but warning still occurs. The warnign message is ignored but, it maybe occur the unexpected side-effect error. So, it will be modified as follows
[code]uint8_t type = 0;[/code]

Thank you.","Q) I have problem with build of ioLibrary_BSD in Keil IDE. I add to my project Ethernet and Internet directories and during build I have got following errors:
A) --c99
Q) I have also one warring:
A) uint8_t type = 0;"
3269,5824,"Dear Sirs,

I bought 5 pieces of W7500S2E-R1 module to test their use in my products. After the first installation of WIZVSP, everything was working properly for some time. With two of my devices with your modules I communicated correctly over two VSPs from my laptop. After that, both VSPs have disappeared from my laptop and I can not longer create them in WIZVSP. The following message is displayed:

**Error occurs when add the connection <proto version=""6.0"">**
**<operation type=""ERROR"">**
**<option name =""what"" value=""Couldn&apost;t create a connection:**
**your licence has expired.""/>**
**<what> Couldn't create a connection:your licence has expired.</what>**
**</operation>**
**</proto>**
 

I can not understand this message clearly, but it may be because I installed the WIZVSP on the client PC with the same key when demonstrating how new devices work. If so, please tell me if I need a single key for every client I am selling my equipment with the W7500S2E modules. How did I send the MAC address of the application registration module can I create multiple VSPs in a single WIZVSP.

I believe that you can answer me more easily if I describe my needs more clearly below:

I produce a series of devices that are parameterized and / or communicated through a serial interface (most commonly RS485) with a PC application. As today's Ethernet network is used, I have to install serial to ethernet into my devices. So I have to be able to communicate with each of your purchased modules from a development PC, a service laptop, and of course from a PC at the end user. I'm not sure if this is covered by the accepted license, ie what I have to do so that your modules and WIZVSP driver for multiple ports might use it as described.

I'm asking for a quicker answer. Because i need to deliver 2 prototypes and now i do not communicate with the already produced devices.

Thank you, Dear Sir,
Would you mind to share your version of WIZVSP software?
So that I can try to duplicate your setup with W7500S2E-R1.

Thank you
Kit I use WIZ VSP Ver2.0.2 In fact I can not create a new connection.
Previously created connections from the two Wiznet modules that were properly worked were missing.
Mladen OK, problem solved... I had to delete the service
sc delete sec_service","Q) If so, please tell me if I need a single key for every client I am selling my equipment with the W7500S2E modules. How did I send the MAC address of the application registration module can I create multiple VSPs in a single WIZVSP.
A) If you are selling equipment with the W7500S2E modules to multiple clients, each client will need a separate key for the WIZVSP. You can send the MAC address of the application registration module to create multiple VSPs in a single WIZVSP.

Q) I'm not sure if this is covered by the accepted license, ie what I have to do so that your modules and WIZVSP driver for multiple ports might use it as described.
A) The accepted license may not cover the usage of the WIZVSP driver for multiple ports, so you may need to check the licensing terms to ensure that your usage is compliant.

Q) I'm asking for a quicker answer. Because i need to deliver 2 prototypes and now i do not communicate with the already produced devices.
A) I understand the urgency of your situation. It's important to resolve the communication issue with the already produced devices. 

Q) Would you mind to share your version of WIZVSP software? So that I can try to duplicate your setup with W7500S2E-R1.
A) I use WIZ VSP Ver2.0.2.

[Non-Response]
Thank you."
3270,583,"WIZ108SR
Firmaware version 2.20

Configuration:
Hardware: Header pin 10 485_SEL is floating.
Netwotk: Static IP on both devices.
Serial: 19200,8,NONE,1,NONE No packing setup and serial command mode switch disabled
All Options default.

No problem configuring the WIZ108sr device. 

I have the WIZ108SR configured for RS485 and UDP. I am using this setup for MODBUS protocol based devices. I can send register requests, via UDP, to my slave device and I am recieving a response from the device on the RS485 side. But the response never gets back through to the ethernet side. I am using a scope to see that the requests are in fact getting to the RS485 device and that it is responding. I have also looked at U2 pin 2 and it is toggling when I am sending data from the Ethernet side. 

Any help appreciated Hi,
WIZ108SR can support on both 422 or 485.
You should be select one.
If you use 485, 485_SEL pin (J2:10) should be float (not connected).

Check 485_SEL pin.
If 485_SEL is already floated, check 485_SEL to be toggled(High -> Low).

when 485 output, 485_SEL is high.
when 485 input, 485_SEL is low.

Thanks Pin 10 is floating. And I can see that it goes high during transmit and low during receive. The high is 2.25V above base line and low is 500mV below base line.

Data signal on pins 3 and 5 looks good on both transmit and receive. Just some additional information...

I switched to using TCP instead of UDP. I am getting basically the same thing. I set the 108sr up as a server and connect to it from my application. I then send a modbus register query from my application. In wireshark I can see the the connection being made, the data being sent and an ACK back from the 108. But no register data. On the scope, connected to the RS485 side, I can see the query data I sent from my application and the response register data comming back from the modbus slave. The data comming from the RS485 side is ismply not getting converted to either TCP or UDP data. Hi,
It seems to be likely to operate normal. But I don't understand why 485 input doesn't get thru ethernet.
Did you check the udp port numbers between WIZ108SR and test program, And Did you test another WIZ108SR?

If you have done already, you'd better return the module for RMA request to distributor or saler.

Thanks. I did check the port numbers. I do believe I have a DOA WN108sr. I have a couple more coming.

Thanks for your help. Hi,

I have heard one error case a long ago.
In that case, when using 485-to-232 converter, The same as your case happens.
[quote]
UDP/TCP -> 485 -> 485to232 -> 232  : That's OK
232 -> 232to485 -> 485 -> UDP/TCP  : Thta's not OK
[/quote]
The reason is not yet known. I seems to likely to have some problem on converting 232 into 485.

Have you ever used something like that? Hi,

Thanks for your response...

I am not using RS232 at all. This is traight UDP/TCP to 485 and 485 to UDP/TCP.

I just received another device and have it connected now. I am seeing the same thing. 

I send modbus requests via UDP. I can see the request datagram on Wireshark.

On the RS485 side, using a scope, I can see that the request has been converted to RS485, sent to the slave device and the slave device has responded.

I never see the response converted from RS485 to UDP datagram. Wireshark never sees the response datagram. 

Any other sugestions would be greatly appreciated. If I can get this working then I am looking at purchasing several hundred of these devices per year. Hi,
Let me know what is your test pc IP & Port and what is WIZ108SR's remote IP & Port?

I found some problem when test PC IP & port are different from WIZ108's configured remoted IP & port.

I'll tell you the result after more testing. 

Thank you. The IP and port of the test device is 192.168.1.114 and 5000.

The IP and port of the WIZ108sr is 192.168.1.113 and 5000. The remote IP and port configured on the WIZ108sr is 192.168.1.114 and 5000.


What differential voltage level dose the WIZ108sr expect to see on the RS485 side? It puts out about a 6V differential but the test device is only delivering about a 4V differential back to the WIZ108sr. Could this be a problem? It's good clean signal in both directions just different levels.

Also, I can ping the test device, the WIZ108sr and the host laptop (192.168.1.110) that I'm using to run the configuration tool from a Windows command terminal. But I don't seem to be able to ping anything sucesfully from the WIZ108sr confihuration tool. When I try I see something like the following in WireShark.

6931	431.045052000	192.168.1.110	192.168.1.114	NBNS	92	Name query NBSTAT *<00><00><00><00><00><00><00><00><00><00><00><00><00><00><00>    (This line returns a header checksum error)
6961	432.558184000	192.168.1.114	192.168.1.110	ICMP	70	Destination unreachable (Port unreachable)

I can succsefully ping all of these addresses from the laptop where I'm running the WIZ108sr configuration too. Hi,
I'm so sorry to answer late.

I think the difference signal voltage is no problem.
BTW, I wonder why ping-test is failed using configuration tool.

According to the ICMP message described by wireshark, WIZ108SR doesn't have the IP address or MAC address value?

[quote]6931 431.045052000 192.168.1.110 192.168.1.114 NBNS 92 Name query NBSTAT *<00><00><00><00><00><00><00><00><00><00><00><00><00><00><00> (This line returns a header checksum error)
6961 432.558184000 192.168.1.114 192.168.1.110 ICMP 70 Destination unreachable (Port unreachable)
[/quote]

Please check again the IP address and MAC address is validate.

Thank you.","Q) What differential voltage level dose the WIZ108sr expect to see on the RS485 side?
A) It puts out about a 6V differential but the test device is only delivering about a 4V differential back to the WIZ108sr. Could this be a problem?

Q) I can ping the test device, the WIZ108sr and the host laptop (192.168.1.110) that I'm using to run the configuration tool from a Windows command terminal. But I don't seem to be able to ping anything sucesfully from the WIZ108sr confihuration tool. When I try I see something like the following in Wireshark.
A) According to the ICMP message described by wireshark, WIZ108SR doesn't have the IP address or MAC address value?
Please check again the IP address and MAC address is valid.

Q) Any other suggestions would be greatly appreciated. If I can get this working then I am looking at purchasing several hundred of these devices per year.
A) Let me know what is your test pc IP & Port and what is WIZ108SR's remote IP & Port?
I found some problem when the test PC IP & port are different from WIZ108's configured remote IP & port.
I'll tell you the result after more testing. Thank you.

Q) How do I convert the data from RS485 to either TCP or UDP?
A) Hi, It seems to likely to operate normal. But I don't understand why 485 input doesn't get thru ethernet.
Did you check the UDP port numbers between WIZ108SR and the test program, and Did you test another WIZ108SR?
If you have done already, you'd better return the module for RMA request to the distributor or seller.
Thanks.

Q) Can you provide some information about the WIZ108SR configuration for RS485 and UDP for MODBUS protocol based devices?
A) WIZ108SR can support on both 422 or 485.
You should be select one.
If you use 485, 485_SEL pin (J2:10) should be float (not connected).
Check 485_SEL pin.
If 485_SEL is already floated, check 485_SEL to be toggled(High -> Low).
When 485 output, 485_SEL is high.
When 485 input, 485_SEL is low.
Thanks.

Q) I am using a scope to see that the requests are in fact getting to the RS485 device and that it is responding. Is there anything else I should check?
A) Pin 10 is floating. And I can see that it goes high during transmit and low during receive. The high is 2.25V above base line and low is 500mV below base line.
Data signal on pins 3 and 5 looks good on both transmit and receive.
Just some additional information...

No problem configuring the WIZ108sr device."
3271,5831,"[Wiz100sr] [wiz105sr] [wiz110sr] [wiz107sr] [wiz108sr]
    [Wiz12xsr] [WIZ14XSR] [WIZ550SR] [WIZ550S2E] [WIZ750SR] [WIZ750JR]
    [WIZVSP]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:

-----------
I would like to get a data by connecting with the wiz107SR through the sample source with Java.
Thank you for your sample source or how to use it. hello.

Do you want a sample source connected to the Wiz107SR on a Java -based PC program?

If so, we don't have the samp sauce you want.

thank you","Q) I would like to get a data by connecting with the wiz107SR through the sample source with Java. Thank you for your sample source or how to use it. hello. 
A) Do you want a sample source connected to the Wiz107SR on a Java -based PC program? If so, we don't have the samp sauce you want."
3272,5834,"AT+WLEAVE
[OK]
AT+WSET=0,ADDSOL
[OK]
AT+WSEC=0,,addsol8837
[OK]
AT+WNET=1
[OK]
AT+WJOIN
Joining : ADDSOL
Successfully joined : ADDSOL

[Link-Up Event]
  IP Addr    : 192.168.10.64
  Gateway    : 192.168.10.1
[OK]
AT+SCON=O,TCN,121.254.168.49,80,0,0

[CONNECT 0]
[OK]
AT+SSEND=0,,,170
[0,,,170]
[OK]

?Â¬ÃªÂ¸Â°ÃªÂ¹ÂÃ¬? ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ???ÂÃ«ÂÂ?Â°Ã¬ÂÂ
Send Ã«Â¬Â¸Ã¬ÂÂ?Â´Ã¬? ""GET http://skynground.co.kr/aircleaning_save_values.jsp?id=1111&dust=123456&temp=123&humidity=112 User-Agent:Mozilla/6.0 (compatible; MSIE 11.0; Windows NT 5.1) HTTP/1.1""
?ÂÃ«ÂÂ??

ÃªÂ·Â¸Ã«ÂÂ°??Server(121.254.168.49)??aircleaning_save_values.jsp ??Ã«Â°ÂÃ¬ÂÂ???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.


Ã«Â¶??Â¼Ã¬ÂÂ°?? ?Â¬Ã«Â¡Â¬?ÂÃ¬ÂÂ ""http://skynground.co.kr/aircleaning_save_values.jsp?id=1111&dust=123456&temp=123&humidity=112"" ?ÂÃ«Â©Â´ 
Server(121.254.168.49)??aircleaning_save_values.jsp ??Ã«Â°ÂÃ¬ÂÂ???Â©Ã«ÂÂ??


Ã«Â¬Â´Ã¬ÂÂ??Ã«Â¬Â¸Ã¬Â Â ?Â¸Ãª??? 

2Ã¬Â£Â¼Ã¬Â§Â¸ ÃªÂ³Â Ã¬ÂÂ?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?ÂÃ¬???Ã¬Â£Â¼Ã¬ÂÂÃ«Â©?ÃªÂ°ÂÃ¬ÂÂ¬?ÂÃªÂ²Â ?ÂµÃ«ÂÂ?? hello

SKYNGROUND.CO.KR corresponds to server address.
In the case of a browser, write down the URL
After connecting to the server, it is automatically processed to the GET message transmission, but
In module communication, you need to send a GET message separately after connecting the TCP yourself.
Get messages do not have server IP.You shouldn't think of it the same as your browser.
Please try it after excluding.","Q) What is the process for sending the GET message in module communication? 
A) In module communication, you need to send a GET message separately after connecting the TCP yourself. Get messages do not have server IP."
3273,5835,"Hi,

I have two Wiznet S2E modules, one server and the other one is client. There are terminal windows on the serial ends of these two S2E modules. 

For Baudrate of 115200 the modules transmit data without any errors.
But at Baudrate beyond that, for eg. 230400 and above, there are errors during transmission.

Is 115200 the max baudrate the WIZ750SR-110 serial interface can run on?

Kindly let me know if there is a solution to this. Thank you. Thank you for confirming this Scott.

I had just one doubt regarding the data transfer rate: 
Is my Ethernet packet generation rate same as my serial input rate or are they different?

Is the data transfer rate same when I receive Internet packets on the other end and convert it back to serial? (I mean will the transmission rate be same as the reception rate)

Note: I am using two Wiz750sr-110 to transfer data. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

?Â Ã¬ÂÂ ?Â¼Ã«Â¡Â ?ÂµÃ«? ?ÂÃ«Â Â¸?ÂµÃ«ÂÂ??
?ÂÃ«ÂÂ??Ã¬Â°Â¸ÃªÂ³Â  Ã«Â§ÂÃ­ÂÂ¬?ÂÃ«ÂÂ??
* [WIZ750SR Command over Ethernet](http://wizwiki.net/wiki/doku.php/products:wiz750sr:commandmanual:ko#command_over_ethernet)

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??","Q) Is 115200 the max baudrate the WIZ750SR-110 serial interface can run on?
Q) Is my Ethernet packet generation rate same as my serial input rate or are they different?
Q) Is the data transfer rate same when I receive Internet packets on the other end and convert it back to serial?

A) The maximum baudrate for the WIZ750SR-110 serial interface is 921600 bps. Regarding your doubt about the data transfer rate, the Ethernet packet generation rate may differ from the serial input rate, and the data transfer rate when receiving Internet packets and converting them back to serial may also vary based on the network and processing capabilities of the devices involved. For more details, you can refer to the [WIZ750SR Command over Ethernet](http://wizwiki.net/wiki/doku.php/products:wiz750sr:commandmanual:ko#command_over_ethernet)."
3274,5836,"I connect w5300 with stm32 on  FSMC.

When I set RTR = 1000 the page is loaded  122 mc, but CSS and JS do not have time to boot.

When I set RTR = 100, the page loads in 30 ms and I have time to load the CSS and JS, but after 2-5 update of the page the server crashes. From the register getSn_SR, the wrong values 0x10 or 0x22(udp) are read, although the socket is opened in TCP mode. What could it be?

PS: RCR=2 
Your explanation is too short.
Add a description of what target you are communicating with, who the server is and what action you want to perform.

RTR is the Retransmission Time value. If a response is not received after transmitting the packet, retransmission interval is set. I do not know what you mean  page loading. Thanks for the reply, I doing the web server on wiznet Http using loopback_tcps from https://github.com/Wiznet/W5500_EVB/blob/master/ioLibrary/Appmod/Loopback/loopback.c
and my Http parser.
""If the response is not received, the retransmission interval is set.""
Yes, I understand this, but I can not understand how it affects the connection time of the browser with the web server, and, accordingly, the speed of opening the web page. 
About the fact that getSn_SR = 0x10, I found it to be related to errartum 1, but why it works is also not clear, although I use the library where it is fixed. I checked you mail.

First, I think the HTTP code you wrote is incommon.
Compare the HTTP code we've written
If you send me the firmware, I'll check it out.
https://github.com/Wiznet/ioLibrary_Driver/tree/master/Internet/httpServer
https://github.com/Wiznet/HTTPServer_LPC11E36_LPCXpresso","Q) What could be the issue when setting RTR=1000 resulting in slow page loading, and setting RTR=100 leading to server crashes with wrong values read from the register getSn_SR?
A) The issue with setting RTR=1000 causing slow page loading and setting RTR=100 resulting in server crashes with incorrect values read from the register getSn_SR may be related to the retransmission time affecting the connection time of the browser with the web server. Additionally, the wrong values read from the register getSn_SR, such as 0x10 or 0x22 in UDP mode despite using TCP mode, could be due to the HTTP code or library used.

PS: Regarding the HTTP code, the comparison of the HTTP code and checking the firmware on the provided repositories may help in identifying the issue."
3275,584,"Currently, I am attempting a lhancular god using the DSP 28346 and W5300.

The size of the data to be transmitted is 100kbyte

I want to use the socket as 50kbyte and use 0 and 1.

However, the data is well transferred to the socket 0, but the data is not transmitted.


1. Can data transfer using socket 0 and socket 1 simultaneously?

The code was used and used as shown below.

(skip)
uint8 tx_mem_conf [8] = {50,50,10,10,0,0,0,0};
uint8 rx_mem_conf [8] = {1,1,1,1,1,1,1,1};
(skip)
while (1)
{
     Loopback_tcpc (0, serverip, 3000, data_buf, 0);
     loopback_tcpc (1, serverip, 3000, data_buf2,0);
} [Quote] uint8 tx_mem_conf [8]

The TX Memory setting is wrong.As you can see from the data sheet,
The sum of TX Memory and the total of RX Memory cannot exceed up to 64KB.You should set to 64KB or less.
Therefore, if you set as described above, you cannot send the data normally, but the number 1 and 2 are not normally transmitted. Thank you for your answer.

To identify the problem, we looked again at the data sheet.

In the third line of p.58

'Each Socket's TX Memory Size can be set within 64Kbytes at 0kbyte'

There is an explanation

I think this part is misunderstood that 'one TX size is possible up to 64Kbytes'.

What you answered means that up to 64KBYTES is possible with the total TX size of 8 sockets?

Then, in Figure 8 of p.91, the tx size is (72kbyte).

What does this picture mean? ?ÂÃª? Ã¬Â°Â©ÃªÂ°Â??ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Socket ?ÂÃ«ÂÂ???Â¤Ã¬Â ÂÃªÂ°???Ã«Â²ÂÃ­ÂÂ¼???Â¬ÃªÂ¸Â°??64KB ?Â´Ã«ÂÂ´?Â´ÃªÂ³Â  ÃªÂ°?Socket??Ã«Â²ÂÃ­ÂÂ¼??Ã¬Â´ÂÃ­ÂÂ©?? 128KB ?ÂÃ«ÂÂ??
?Â°Ã«ÂÂ¼??Ã«Â§ÂÃ¬??ÂÃ¬ÂÂ  ?Â¤Ã¬Â Â?? ?ÂÃ«ÂªÂ»?ÂÃ¬? ?ÂÃ¬ÂÂ?ÂµÃ«ÂÂ??

W5300 Datasheet P90 Ã¬Â¤ÂÃ¬ÂÂ??
[quote]
1. Internal TX/RX memory ?Â¬ÃªÂ¸Â°Ã«Â¥?ÃªÂ°ÂÃªÂ°Â ÃªÂ²Â°Ã¬Â Â (MTYPER Ã¬Â°Â¸Ã¬Â¡Â°)
2. SOCKETn??TX/RX memoryÃ«Â¥?ÃªÂ°ÂÃªÂ°Â ÃªÂ²Â°Ã¬Â Â (TMSR, RMSR Ã¬Â°Â¸Ã¬Â¡Â°)
W5300?? 8Kbytes??Memory Block 16ÃªÂ°ÂÃ«? ?Â´Ã«??ÂÃ¬ÂÂ¼Ã«Â¡??Â¬Ã­ÂÂ¨?ÂÃªÂ³Â  ?ÂÃ«ÂÂ¤. 16ÃªÂ°ÂÃ¬ÂÂ Memory Block?? 128Kbytes??Address space???ÂÃ¬Â°Â¨?ÂÃ¬ÂÂ¼Ã«Â¡?Mapping?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ¤. 128Kbytes??Memory???Â¬ÃªÂ²Â Transmission(TX) memory, Reception(RX) memoryÃ«Â¡?ÃªÂµÂ¬Ã«Â¶Â?ÂÃ«ÂÂ¤. Internal TX memory?? Internal RX memory??128Kbytes Ã«Â²ÂÃ¬ÂÂ ?Â´Ã¬ÂÂ??8Kbytes ?Â¨Ã¬ÂÂÃ«Â¡??Â Ã«ÂÂ¹?????ÂÃ«ÂÂ¤. Internal TX/RX memory??ÃªÂ°??Â Ã«ÂÂ¹???Â¬ÃªÂ¸Â° ?Â´Ã¬ÂÂ???ÂÃ«ÂÂ¤??SOCKET Ã«Â³ÂÃ«Â¡Â Ã¬ÂµÂÃ¬ÂÂ 0Kbyte?ÂÃ¬ÂÂ Ã¬ÂµÂÃ«? 64Kbytes ?Â´Ã¬ÂÂ??1Kbytes ?Â¨Ã¬ÂÂÃ«Â¡?ÃªÂ°ÂÃªÂ°Â ?Â Ã«ÂÂ¹ ?????ÂÃ«ÂÂ¤.
[/quote]

MTYPER ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? MTYPER?? Ã«Â§ÂÃ¬??ÂÃ¬ÂÂ  ?Â¤Ã¬Â Â?Â¼Ã«Â¡Â Ã¬Â§??ÂÃ­ÂÂÃªÂ¸??ÂÃ­ÂÂ´?? 0x7FFF ÃªÂ°ÂÃ¬ÂÂ ÃªÂ°??Â¸Ã¬ÂÂ¼ ?Â©Ã«ÂÂ??
MTYPER ?ÂÃ¬ÂÂbit Ã«Â¶???TX buffer 120KB ?Â Ã«ÂÂ¹?? 8K *15 Ã«Â¡?ÃªÂµÂ¬Ã¬ÂÂ±?ÂÃªÂ³Â , RX buffer??Ã¬Â´ÂÃ­ÂÂ©?? 8KB * 1 ?Â´Ã«?Ã«Â¡?Ã¬ÂµÂÃ¬ÂÂ?ÂÃ«Â¹Â?Â¸Ã«Â§Â '0'?Â¼Ã«Â¡Â ?Â¤Ã¬Â Â?Â©Ã«ÂÂ??

?Â¤Ã­ÂÂ´Ã«Â¥?Ã«Â¶ÂÃ«ÂÂ¬?Â¼Ã¬ÂÂ¼Ã¬Â¼ÂÃ¬ÂÂ Ã¬Â£ÂÃ¬ÂÂ¡?Â©Ã«ÂÂ?? Thank you for your friendly answer every time.

I checked the Mtyper value as you said, and I had a 0x7ff value.

There seems to be no problem with the socket area allocation.

1. Is it impossible to use if the port of the socket is the same?

In order to transmit the socket 0 data and 1 data, the code was modified and used as shown below.

(skip)
uint8 tx_mem_conf [8] = {50,50,10,10,0,0,0,0};
uint8 rx_mem_conf [8] = {1,1,1,1,1,1,1,1};
(skip)
while (1)
{
Loopback_tcpc (0, serverip, 3000, data_buf, 0);
loopback_tcpc (1, serverip, 3000, data_buf2,0);
}


There are additional questions.

I set the size of the socket to 50kbyte (51200 byTE) and tested data from 50000byte size.

As a result, we have confirmed that some of the data is not coming out.

For example, if you send a number of 0 to 25000, you will be able to skip and transmit the middle data in this way 0 ~ 12500, 12700 ~ 25000.

However, if the data is transmitted after 51200byte after the size of the data is the same as the size of the socket.

We have confirmed that the transfer is good without problems.

2. Do I need to set data with the same size as the socket size when sending data?

3. Is there any way to check if you suspect that the cause of the data is not sent out of the buffer?

4. If the above 3. is the cause, is there a way to reset the buffer? [Quote] 1.Is it impossible to use if the port of the socket is the same?
[/Quote]
Is the socket port speaking SN_PORTR here or SN_DPORTR?
If you write a TCP Server, you can have the same value of SN_PORTR.The other person can access the same port at the same time.
On the contrary, if you write a TCP client (like the code below), SN_PORTR must have different values.Of course, if you connect to the same server, SN_DPORTR must have the same value.

[Quote] 2.Do I have to set data with the same size as the socket size when sending data?
[/Quote]
It doesn't matter.

[Quote] 3.Is there any way to confirm that the cause of the data is not sent out of the buffer?

4. If the above 3. is the cause, is there a way to reset the buffer? [/Quote]
The daily tile part is not related to the buffer.And the W5300 does not support buffer flushing.

[Quote] I set the size of the socket to 50Kbyte (51200byte) and tested data of 50000byte size.

As a result, we have confirmed that some of the data is not coming out.

For example, if you send a number of 0 to 25000, you will be able to skip and transmit the middle data in this way 0 ~ 12500, 12700 ~ 25000.

However, if the data is transmitted after 51200byte after the size of the data is the same as the size of the socket.

We have confirmed that the transfer is good without problems.
[/Quote]
This is the first symptom I see.I think more accurate analysis is needed.
I am wondering if we process 50000byte at once to handle the Send Command.And I wonder if the same symptoms appear every time.

Or is it sometimes missing to deal with 50000byte every time?

Please check 51200 byte to be sent well without loss.

If possible, please share the send () function part.","Q) Can data transfer using socket 0 and socket 1 simultaneously?
A) No, data transfer using socket 0 and socket 1 simultaneously is not possible. The specified TX Memory setting is wrong as it exceeds the limit mentioned in the data sheet.

1. Is it impossible to use if the port of the socket is the same?
2. Do I need to set data with the same size as the socket size when sending data?
3. Is there any way to check if you suspect that the cause of the data is not sent out of the buffer?
4. If the above 3. is the cause, is there a way to reset the buffer?

A) 
1. The port mentioned here refers to SN_PORTR and SN_DPORTR in the context of TCP. For a TCP server, the same value of SN_PORTR can be used, and different values are needed for SN_PORTR in a TCP client. 
2. It doesn't matter. The size of the data doesn't have to match the socket size when sending data.
3. The data not being sent out of the buffer is not related to the buffer flushing, and there is no support for buffer flushing in W5300.
4. The issue of data not being sent out doesn't relate to buffer resetting. 

The questions and answers are separated according to the guidelines. Any personal information or non-response sentences have been appropriately handled."
3276,5843,"Once you simply send At Command and write a program that connects to a fixed network with a CPP ...

The RS-232 connected to the ARM board is made by connecting the UART pin at the top of the Wizfi250 board to communicate the data to make a command.

When I sent the data to the hex value even when it was connected to the PC without attaching it to the ARM board, I worked on the HEX value alone.

I also run in the code on the program I created, and it seems that the HEX value is normally coming out.

Strangely, there was no response if I run the program I created while connected to the Wizfi board and the ARM board.
)

Is it because of the wrong writing of the part that receives the data
Or I wonder if you have to give a delay time if you send the data ...

Below is the part of the code (the part of the data).
AT is an AT Command Hex value and FD is a declared cereal port.
        const char* at [2];
        at [0] = 0x61;
        at [1] = 0x74;
        at [2] = 0x0d;

        Write (FD, AT, Strlen (at));

        Res = read (FD, DTA, 255);
        printf (""%s"", res);


It's really basic, but I would appreciate it if you answered it.

What should I modify?
I want to get a value, whether it's a hex value or a string ... ?ÂÃ«ÂÂ Ã«Â³????Â Ã¬ÂÂ¸Ã«Â¶?Ã«Â¥?Ã«Â³?ÃªÂ²Â½Ã­ÂÂ´Ã«Â³Â´Ã¬ÂÂÃªÂ³??ÂÃ¬ÂÂ¸ Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??

```
const char* at[2];
```
```
const char at[2];
``` I did it as you said, but I had an error, so I just declared it as char
Still, the data still doesn't come.

No, I can't guarantee if it's definitely coming or not
If you press the physical button (reset button, etc.) on the product,
Still, [OK]
The sign is marked with the NULL characters ...

But when you connect directly from the PC, it only blinks when TX and RX is received in the product.
If you connect to the ARM board, if you don't have any data to send and receive data, if you blink TX and RX

Is there a problem with pin connection?


===================================================================

Once you get the feedback on the wizfi side later, it works if you send it to the hex value.
I have to squeeze the program I put on the ARM board.

Thank you.","Q) Is it because of the wrong writing of the part that receives the data or do I have to give a delay time if I send the data? What should I modify? I want to get a value, whether it's a hex value or a string.
A) It seems like there might be issues with how you are handling the data reception part or with the timing of data transmission. Additionally, based on the code snippet you provided, there are a few errors that might be causing the problem. Firstly, the array declaration for 'at' should be `const char at[3]` instead of `const char* at[2]`. Also, you should add a NULL terminator at the end of the 'at' array, so it should be `at[2] = 0x00`. After making these changes, you can try to resend the data and ensure that the UART pin connections are correctly set up between the Wizfi250 board and the ARM board. It's also important to handle the response properly when interacting with the Wizfi board. Lastly, to distinguish between receiving a hex value or a string, you need to ensure that you have the correct parsing and interpretation in your code. If you are still facing issues, considering debugging the pin connection and the data handling logic in your program."
3277,5846,"We are using the W5500 to test UDP communication between FPGA and PC.
The 200ms cycle has been transmitted to certain data.
I checked the packet to come and go using Wireshark
I sent it to Unicast.
Symptoms are as follows.

1. When transmitting using a Send command, ARP Request is transmitted
ARP reply on a PC, but without transmitting a data packet
After 200ms, SN_TX_FSR increases after 200ms.

2. When transmitting using the SEND_MAC command, the data you want is transmitted
It does not respond to the ARP Request from the PC side.

3. When SN_DHHAR is directly input, when the data is transmitted by the PC side,
SN_RX_RSR does not increase.

When I see the above symptoms, it doesn't seem to be a reception itself
I don't know what's the problem.
Please confirm. hello

I'm sorry, but it's hard to understand the contents

1. When using Send Command, the FPGA sent ARP Reply from ARP Request transmission PC, but does it mean that the FPGA does not transmit data without transmitting data?

2. Are you transmitting the data through Send_mac, and did you send ARP Request from your PC, but you don't give ARP Reply on FPGA?

First of all, please ping from the PC to FPGA to check if the ping test is properly.
There may be a possibility that the network setting is not good or there is an IP that collides. I checked that the RJ45 pin number was different from the previous one.
Thank you for answer.","Q) When using Send Command, the FPGA sent ARP Reply from ARP Request transmission PC, but does it mean that the FPGA does not transmit data without transmitting data?
Q) Are you transmitting the data through Send_mac, and did you send ARP Request from your PC, but you don't give ARP Reply on FPGA?
A) First of all, please ping from the PC to FPGA to check if the ping test is properly. There may be a possibility that the network setting is not good or there is an IP that collides. I checked that the RJ45 pin number was different from the previous one."
3278,5849,"I am using the WIZ830MJ module, which uses a W5300. Most of the time I am listening for a TCP/IP connection and am in the LISTEN state. When I need to connect to a server I first make sure no connection is up (still in LISTEN state), then I do a close, followed by a connect to establish an outgoing TCP/IP connection. I then wait for the socket status register to indicate either 0x17 (SOCK_ESTABLISHED) to indicate the connection has been established, or 0x00 (SOCK_CLOSED) to indicate the connection could not be established (refused or timed out, for example). Most of the time this works very well. However, every once in a while my system locks up and I cannot communicate with it over the ethernet port. This happens rarely, and it has taken me a while to figure out what is going on. It turns out that when my system locks up the socket status register (S0_SSR1 at address 0x209) has the value 0x10, and it stays that way forever until I power cycle my system.

What is socket status 0x10? This is not documented in the W5300 datasheet. What does it mean? How does it get into this state? What should I do to recover from this state? I don't know where you got your information about socket status 0x10 being SOCK_SYNSENT, but that is wrong. On page 78 of the W5300 datasheet Version 1.3.3 (or page 75 of the W5300 datasheet Version 1.2.2) it clearly states that 0x15 is state SOCK_SYNSENT.

The Errata sheet looks more promising, but I am still confused about why the Errata sheet should be talking about socket status register values of 0x10 and 0x11 when neither of these values is mentioned at all in the W5300 datasheet. So I looked at my driver code I use to control the W5300. My driver code was derived directly from the sample driver code provided by Wiznet. I looked at my close() function, and found that the fix suggested in the Errata sheet was already in my code. This is not surprising, since the code came from Wiznet.

So, in spite of the Errata sheet fix already being in my code, my system is still locking up from time to time with a socket status register value unexpectedly stuck permanently at a value of 0x10.

Where do I go from here? I am still stuck. I checked the RTL code. 0x10 is SYN_SENT. Of course, 0x15 is also SYNSENT. As soon as the SYN is transmitted, it changes from 0x15 to 0x10. So what you are saying is that the Wiznet documentation is incomplete and inaccurate. I can believe that. But that still leaves me with a system with driver code that already has implemented the ""fix"" suggested in the errata sheet you referenced, but my system is still occasionally locking up with the socket status register stuck (apparently permanently) at 0x10. My question remains unanswered: Where do I go from here? What can I do to fix it? As I said, 0x10 is SYN SENT state. Under normal circumstances, a timeout occurs because no response is received from the server and becomes a closed state . Or  it receives a SYN ACK from the server and becomes an established state. So we decided that we did not need to present 0x10 to the document. Your situation is not normal. You should check wireshark to see what happens when the W830MJ sends a SYN. You say ""So we decided that we did not need to present 0x10 to the document."", yet on pages 78-80 of the W5300 datasheet (version 1.3.3) Wiznet did chose to document the following ""temporary status"" states of the socket status register: 0x15 SOCK_SYNSENT, 0x16 SOCK_SYNRECV, 0x18 SOCK_FIN_WAIT, 0x1B SOCK_TIME_WAIT, 0x1D SOCK_LAST_ACK, 0x01 SOCK_ARP. I cannot imagine why you would fail to document 0x10.

You say ""Under normal circumstances, a timeout occurs because no response is received from the server and becomes a closed state . Or it receives a SYN ACK from the server and becomes an established state."" Yes, that is what I expect. I call connect(), then wait for socket status to change to either SOCK_ESTABLISHED (indicating the connection was successful), or SOCK_CLOSED (indicating the connection failed (was refused, or timed out). This is what I expect to happen, either connection established, or socket closed.

Is this the correct way to handle a connection (call connect(), then wait for SOCK_ESTABLISHED or SOCK_CLOSED)? It seems to be what is documented.

Yet sometimes I wait forever, getting neither SOCK_ESTABLISHED nor SOCK_CLOSED. Instead I see socket status 0x10 persisting forever. When this happens, my system is locked up and needs to be power-cycled.

I would be happy to provide you with a wireshark capture of what happens when the W830MJ sends a SYN, but I have a problem doing that. Most of the time it works as expected, giving me SOCK_ESTABLISHED (or in rare cases SOCK_CLOSED if the server is not available). I have attempted to duplicate the socket status 0x10 problem in my lab, and after months of testing have seen the problem appear exactly one time. But that doesn't mean this is not a serious problem. My customer has hundreds of these systems installed in the field operating on a live network, and failures are happening at a rate of many failures per week. It is not practical for me to do wireshark captures on all of the customer's systems. Even if I wanted to, I would not be allowed to because the systems are operating on the customer's live network, and I am not allowed to connect anything to that live network. The network is used for critical safety systems.

I think a better approach would be for you (or a more knowledgeable programmer) to review the code and figure out how the socket status can be stuck forever at 0x10. Then perhaps you or someone else can suggest a work around that I can implement in my software to get around the bug in the W830MJ. Clearly the work around in the errata sheet does not fix the problem. I am asking for help. Can anyone at Wiznet help me? Hi~ @microaide  

0x10 of Sn_SR  mean that SYN Packet is being sent.
0x15 of Sn_SR  mean that SYN Packet is sent.

Actually, you can't see the value of 0x10 because it is internal state value.
But if  TCP connected socket occur timeout or it occur wrong operation, sometimes it can see the value.

Could please you check your code?
After send command executes and you have to confirm the Sn_CR is '0'.
if possible, Could please send the source code to @becky.


When this state occur, I can offer two way.
1. System reset
2. the method of using UDP in Errate sheet (@becky mentioned) 

thanks,
irina
BR","Q) What is socket status 0x10? This is not documented in the W5300 datasheet. What does it mean? How does it get into this state? What should I do to recover from this state? Where do I go from here? What can I do to fix it? Is this the correct way to handle a connection (call connect(), then wait for SOCK_ESTABLISHED or SOCK_CLOSED)?
A) 0x10 of Sn_SR means that SYN Packet is being sent. Actually, you can't see the value of 0x10 because it is an internal state value. But if the TCP-connected socket occurs timeout or it occurs the wrong operation, sometimes it can be seen. When this state occurs, I can offer two ways: 1. System reset 2. the method of using UDP in Errata sheet (@becky mentioned). It is also mentioned that 0x15 of Sn_SR means that SYN Packet is sent. As soon as the SYN is transmitted, it changes from 0x15 to 0x10. The Wiznet documentation may be incomplete and inaccurate. Under normal circumstances, a timeout occurs because no response is received from the server and becomes a closed state. Or it receives a SYN ACK from the server and becomes an established state. We decided that we did not need to present 0x10 to the document. It is suggested to check the wireshark to see what happens when the W830MJ sends a SYN. 

Q) I am still stuck, where do I go from here?
A) You can confirm your code by executing the send command and checking if the Sn_CR is '0'. Additionally, consider sending the source code to @becky. If the system is locking up occasionally with the socket status register stuck at 0x10, it is advisable for a more knowledgeable programmer to review the code and figure out how the socket status can be stuck forever at 0x10. Then, suggest a workaround that can be implemented in the software to get around the bug in the W830MJ. If the workaround in the errata sheet does not fix the problem, seeking help from Wiznet is recommended.

Thank you for your understanding, Irina."
3279,5854,"Hi everyone,
I would like to know if you have tried to create a software function that transmits via HTTP to the server via a serial communication, communicating a certain value.

The example syntax should look like this: 
If serial UART1 receive ATcommand xx
Then WIZ550 sent to other server this HTTP string POST: http://[IP_server]/door_status.htm?status=allarm.

Thanking you, I look forward to your news.
GIUSEPPE Hi Giuseppe,

Do you use WIZ550io?

Sorry, we do not have the example you want.

The feature you want is you have to implement it on your MCU yourself.

Thank you.

Scott Hello,

As scott mentioned, we do not have an example.
But it is very easy to implement what you said.
What firmware are you using?
If you are using iolibrary, try the following.
You have to modify it as I wrote it simply.

     switch(getSn_SR(sn))
       {
          case SOCK_ESTABLISHED :
             if(receive_ATcommand xx){
                 buf=""POST /door_status.htm?status=allarm HTTP/1.0\n\n"";
                 send(sn, buf, size);
            }
             break;
          case SOCK_INIT :
        	 if( (ret = connect(sn, destip/*[IP_server]*/, 80)) != SOCK_OK) return ret;
             break;

          case SOCK_CLOSED:
        	  close(sn);
        	  if((ret=socket(sn, Sn_MR_TCP, any_port++, 0x00)) != sn){
                     if(any_port == 0xffff) any_port = 50000;
                    return ret;
            } 
             break;
          default:
             break;
       }","Q) Hi everyone, I would like to know if you have tried to create a software function that transmits via HTTP to the server via a serial communication, communicating a certain value. The example syntax should look like this: If serial UART1 receive ATcommand xx Then WIZ550 sent to other server this HTTP string POST: http://[IP_server]/door_status.htm?status=allarm. Thanking you, I look forward to your news. GIUSEPPE
A) Hello, As scott mentioned, we do not have an example. But it is very easy to implement what you said. What firmware are you using? If you are using iolibrary, try the following. You have to modify it as I wrote it simply. switch(getSn_SR(sn)) { case SOCK_ESTABLISHED : if(receive_ATcommand xx){ buf=""POST /door_status.htm?status=allarm HTTP/1.0\n\n""; send(sn, buf, size); } break; case SOCK_INIT : if( (ret = connect(sn, destip/*[IP_server]*/, 80)) != SOCK_OK) return ret; break; case SOCK_CLOSED: close(sn); if((ret=socket(sn, Sn_MR_TCP, any_port++, 0x00)) != sn){ if(any_port == 0xffff) any_port = 50000; return ret; } break; default: break; }

A) Hi Giuseppe, Do you use WIZ550io? Sorry, we do not have the example you want. The feature you want is you have to implement it on your MCU yourself. Thank you."
3280,5857,"I've been doing it for a few days, but now I think there's a problem with the module itself ...

If you think so

1. Now, press the switch that operates in AP mode and
When you connect to the network, it can be connected to it, but it takes quite a while,
The PC is connecting, but it is often reset without the input of the module from time to time.
In this case, is there a USB problem I connected?
Or if you may have a problem with firmware or hardware in the module.

2. Other problems are sometimes input to the same AT command, but OK does not come at once.
I have an invalid input error several times
But if you enter the same command once or twice, you will get OK responds normally.
In this case, if you enter a command that doesn't fit when you're in a station mode, for example, the station mode
Or if you mentioned above, please contact us if it may be a firmware and hardware part.

3. I write a program that runs on the ARM board
The command cafe was also sent to the Wizfi, but all the commands were sent to the HEX value.
When I sent a command from the module, the response to the command was not output.
So I wrote the program to send all the commands needed to send data in the station mode at regular time.

If the program I want is, when the network is connected, I just need to send the data from the equipment to another serial port connected to the ARM board and communicate with the PC wirelessly from the module to the PC.

At that time, the command that should be entered in the module
1) at
-Terminal check
2) at+wset = 0, <Network to be connected>
-Select/select the data transfer mode to the network you want to connect
3) at+wsec = 0, wpa2, <Network PIN to connect>
-Data mode in the network you want to connect to the security method for the WPA2 network pin.
4) at+wjoin
-Network connection attempt
5) AT+scon = O, TCN, <PC side to connect?Enter IP Address>, <Port number>, 1
-Setting parts related to DHCP, TCP Client, etc.

If you want to send data after this, do you need another command?
The data I want to send is the HEX value of the total length of 41 bytes.

Oh, and even though I connected to the network with a 0 (data mode) value to the at+wset, at+wsec part when setting up the connection.
I hit the +++ command, and I also got Invalid input ... Isn't it just +++?

4. I checked the example file uploaded to GitHub
But if you use this file slightly modified, it doesn't matter if you use a general CPP program without Arduino? 1. Check if the power supplied to the USB is stable enough.
If the power supply is supplied only by USB on a general PC, it can be unstable.

2. Invalid input comes out when the wrong string is included or the parameter is not correct.
For accurate analysis, you need at command log when the Invalid input occurs.
It is unlikely to be a H/W problem.

3. I think you can proceed in the form you mentioned.
Please also refer to the link below.
https://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250pg:Examples-Association
And, +++ is an input to go from Data Mode to Command Mode.If you enter +++ in the Command Mode state, you will get an error such as Invalid input.

4. Yes, it doesn't matter.","Q) If you think so, in this case, is there a USB problem I connected? Or if you may have a problem with firmware or hardware in the module.
A) It's possible that there may be an issue with the USB connection or with the firmware and hardware of the module.

Q) In this case, if you enter a command that doesn't fit when you're in a station mode, for example, the station mode, or if you mentioned above, please contact us if it may be a firmware and hardware part.
A) If an inappropriate command is entered while in station mode, it may indicate a problem with the firmware and hardware. It's advisable to contact for further assistance.

Q) If the program I want is, when the network is connected, I just need to send the data from the equipment to another serial port connected to the ARM board and communicate with the PC wirelessly from the module to the PC. At that time, the command that should be entered in the module?
A) The necessary commands for the desired program include: 
1) at - Terminal check 
2) at+wset = 0, <Network to be connected> - Select/select the data transfer mode to the network you want to connect 
3) at+wsec = 0, wpa2, <Network PIN to connect> - Data mode in the network you want to connect to the security method for the WPA2 network pin. 
4) at+wjoin - Network connection attempt 
5) AT+scon = O, TCN, <PC side to connect?Enter IP Address>, <Port number>, 1 - Setting parts related to DHCP, TCP Client, etc. If data needs to be sent, additional commands may be necessary. 

Q) Oh, and even though I connected to the network with a 0 (data mode) value to the at+wset, at+wsec part when setting up the connection. I hit the +++ command, and I also got Invalid input ... Isn't it just +++?
A) When transitioning from Data Mode to Command Mode, entering +++ is expected to switch modes. However, if this results in an Invalid input, it may require further investigation.

Q) Check if the power supplied to the USB is stable enough. If the power supply is supplied only by USB on a general PC, it can be unstable.
A) It's important to ensure that the power supplied to the USB is stable, especially when using a general PC where power supply solely via USB can lead to instability. 

Q) Invalid input comes out when the wrong string is included or the parameter is not correct. For accurate analysis, you need at command log when the Invalid input occurs. It is unlikely to be a H/W problem.
A) The occurrence of Invalid input may result from incorrect strings or parameters. To accurately analyze this, a command log when the error occurs is necessary. It's unlikely to be a hardware problem.

Q) Yes, it doesn't matter.
A) Understood."
3281,586,"Hello, I am using the W5500 to operate it as a TCP server.

How do you know the client's IP and PORT?
(Currently, the driver is using IOLIBRARY_BSD) You can read SN_DIPR (opponent IP) and SN_DORTR (opponent port number).
This register is only output only after access.

You can use the getsn_dipr () and the getsn_dport () macro function.","Q) How do you know the client's IP and PORT?
A) You can read SN_DIPR (opponent IP) and SN_DORTR (opponent port number). This register is only output only after access. You can use the getsn_dipr() and the getsn_dport() macro function."
3282,5860,"hello.
Currently, we are using the W5500 to produce TCP/IP products.

To add the product function, you need VoIP, SSL, and FTP functions as in the title.
I am using NUVOTON's M0518 and is expected to change the performance of the MCU.
Can I support all of these features at the W5500?
If you apply, where can you get a library? hello

For FTP and SSL, please refer to the link below.
Unfortunately, VOIP has no reference materials we can support.
https://github.com/wiznet/FTP_LPC11E36_LPCXPRESSO
https://github.com/wiznet/FTPC_LPC11E36_LPCXPRESSO
https://drive.google.com/open?id=1iizft-keo_bmgs50wfdk453xclhdjwc","Q) Can I support all of these features at the W5500? If you apply, where can you get a library?
A) To add the product function, you need VoIP, SSL, and FTP functions as in the title. For FTP and SSL, please refer to the links below. Unfortunately, VOIP has no reference materials we can support. 
https://github.com/wiznet/FTP_LPC11E36_LPCXPRESSO
https://github.com/wiznet/FTPC_LPC11E36_LPCXPRESSO
https://drive.google.com/open?id=1iizft-keo_bmgs50wfdk453xclhdjwc"
3283,5862,"hello.
As in the title, I want to implement the above three functions.
I am currently using the M0518 MCU of the NUVOTON vendor.
The MCU is expected to lack performance, so we will change.

Can I implement VoIP, SSL, and FTP in the W5500?
If you can implement, is there a library? https://forum.wiznet.io/t/topic/5860/2
I answered in the Wiggle","Q) Can I implement VoIP, SSL, and FTP in the W5500? If you can implement, is there a library?
A) I answered in the Wiggle."
3284,5865,"I am running the WIZ750SR in TCP Server mode and when I try to connect to it I get ""Connection refused"". I scanned the device for open ports and only the port (50001) for Settings seems to be open, port 5000 is closed.

The weird thing is that the setup was already running like this before but now it does not work anymore. I have no clue as to what changed. 

Here are my settings from the debug terminal:

    ==================================================
     WIZ750SR 
     >> WIZnet Serial to Ethernet Device
     >> Firmware version: 1.2.4 Stable
    ==================================================
     - Device name: WIZ750SR
     - Device mode: TCP_SERVER_MODE
     - Network settings: 
    	- Obtaining IP settings: [Static]
    	- TCP/UDP ports
    	   + S2E data port: [5000]
    	   + TCP/UDP setting port: [50001]
    	   + Firmware update port: [50002]
    	- TCP Retransmission retry: [8]
     - Search ID code: 
    	- Disabled: [None]
     - Ethernet connection password: 
    	- Disabled (TCP server / mixed mode only)
     - Connection timer settings: 
    	- Inactivity timer: Disabled
    	- Reconnect interval: [3000] (msec)
     - Serial settings: 
    	- Data UART port:  [UART0]
    	   + UART IF: [RS-232/TTL]
    	   + 115200-8-N-1 / Flow control: NONE
    	- Debug UART port: [UART2]
    	   + 115200-8-N-1 / NONE (fixed)
     - Serial data packing options:
    	- Time: Disabled
    	- Size: Disabled
    	- Char: Disabled
     - Serial command mode switch code:
    	- Enabled
    	- [2B][2B][2B] (Hex only)
     - Hardware information: Status pins
    	- Status 1: [PA_10] - PHY link
    	- Status 2: [PA_01] - TCP connection
     - Hardware information: User I/O pins
    	- UserIO A: [PC_13] - Digital / Input
    	- UserIO B: [PC_12] - Digital / Input
    	- UserIO C: [PC_09] - Digital / Input
    	- UserIO D: [PC_08] - Digital / Input
    ==================================================
     # MAC: 00:08:DC:54:8A:6F
     # IP : 192.168.30.48 / Port: 5000
     # GW : 192.168.30.1
     # SN : 255.255.254.0
     # DNS: 8.8.8.8
    
     SEG:AT Mode

And when scanning the ports with nmap this is the result:
>     Starting Nmap 7.01 ( https://nmap.org ) at 2019-05-10 16:49 CEST
>     Nmap scan report for 192.168.30.48
>     Host is up (0.00013s latency).
>     Not shown: 999 closed ports
>     PORT      STATE SERVICE
>     50001/tcp open  unknown
>     MAC Address: 00:08:DC:54:8A:6F (Wiznet)
>
>     Nmap done: 1 IP address (1 host up) scanned in 1.62 seconds


Any ideas what could be wrong here? Anyone? Hello @moritz
Sorry for the late reply.  

[quote=""moritz, post:1, topic:5865""]
SEG:AT Mode
[/quote]

When the module is serial command mode (AT mode), TCP communication is not available.

In debug message, the device's state is AT mode.
Please refer to the wiki page below to change the mode.

- [Entering Serial Command Mode](http://wizwiki.net/wiki/doku.php?id=products:wiz750sr:commandmanual:en#entering_serial_command_mode)

Note that in the TCP server mode, the log is output as follows.
```
==================================================
 WIZ750SR
 >> WIZnet Serial to Ethernet Device
 >> Firmware version: 1.2.4 Stable
==================================================
 - Device name: WIZ750SR
 - Device mode: TCP_SERVER_MODE
 - Network settings:
        - Obtaining IP settings: [Static]
        - TCP/UDP ports
           + S2E data port: [5000]
           + TCP/UDP setting port: [50001]
           + Firmware update port: [50002]
        - TCP Retransmission retry: [8]
 - Search ID code:
        - Disabled: [None]
 - Ethernet connection password:
        - Disabled (TCP server / mixed mode only)
 - Connection timer settings:
        - Inactivity timer: Disabled
        - Reconnect interval: [3000] (msec)
 - Serial settings:
        - Data UART port:  [UART0]
           + UART IF: [RS-232/TTL]
           + 230400-8-N-1 / Flow control: NONE
        - Debug UART port: [UART2]
           + 115200-8-N-1 / NONE (fixed)
 - Serial data packing options:
        - Time: Disabled
        - Size: Disabled
        - Char: Disabled
 - Serial command mode switch code:
        - Enabled
        - [2B][2B][2B] (Hex only)
 - Hardware information: Status pins
        - Status 1: [PA_10] - PHY link
        - Status 2: [PA_01] - TCP connection
 - Hardware information: User I/O pins
        - UserIO A: [PC_13] - Analog / Input
        - UserIO B: [PC_12] - Digital / Input
        - UserIO C: [PC_09] - Digital / Output
        - UserIO D: [PC_08] - Digital / Output
==================================================
 # MAC: 00:08:DC:53:AE:21
 # IP : 192.168.50.100 / Port: 5000
 # GW : 192.168.50.1
 # SN : 255.255.255.0
 # DNS: 8.8.8.8

 > SEG:TCP_SERVER_MODE:SOCKOPEN
```

Thank you.","Q) Any ideas what could be wrong here? Anyone?
A) When the module is in serial command mode (AT mode), TCP communication is not available. You can refer to the wiki page below to change the mode. Note that in the TCP server mode, the log should be output in a specific format. Thank you."
3285,5868,"hello
This is Kim Yong -min, manager of Shin Woo Tech.

We have been using Wiz108sr for 3 years.
I am using it for the same PCB

I would like to contact us for the following phenomenon for the recent products.

---------------------- under --------------------
1. Power reset phenomenon? (Green LED and yellow LEDs flash simultaneously)
-> The above phenomenon is often occurring in the field. This is like a power reset phenomenon.There is no change in our side H/W
-> And even if the power is turned off in the field, it operates normal after a certain time after a certain time
The above phenomenon seems to occur again
-> Bring the above sest and bring to the office and test it.

2. Because of the lack of bad samples, it is not accurate, but it seems that the firmware version is 4.02.
It seems that the version we use is 4.06.I want to know the history of the difference This was supported. ","Q) I would like to contact us for the following phenomenon for the recent products.
1. Power reset phenomenon? (Green LED and yellow LEDs flash simultaneously)
2. Because of the lack of bad samples, it is not accurate, but it seems that the firmware version is 4.02. It seems that the version we use is 4.06. I want to know the history of the difference This was supported. 
A) The above phenomenon is often occurring in the field. This is like a power reset phenomenon. There is no change in our side H/W and even if the power is turned off in the field, it operates normal after a certain time after a certain time. The above phenomenon seems to occur again. Bring the above sest and bring to the office and test it."
3286,587,"hello...

I am using the W3100 for mass production and development for three years and then changed to W5100.

For size data less than 2048, the getsn_rx_rsr function operates normally.
However, when used for transmission of IMAGE, when the size is transmitted than 2048 ...

In the case of the W3100, 7300 (size) data is processed continuously (7300,7300,7300,7300,7300 ...)
For the W5100, 5840, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0There is a significant delay in the processing speed.

Is the W5100 a problem with processing BIG data in the IMAGE format? hello.

The W5100 is not a big lack of 7300byte data.

First, please check how you set the RX Memory Size, and please check if you are fragmenting the packet.

Also, please explain more about what the zero value means.

thank you RX Memory Size is sysinit (0x03, 0x03);It was handled and made it possible to use 8K.

It is not sending a packet from the transmitter, but transmits the Image size only at the maximum transmission speed, and is 7300 when the receiving data size accepts per packet on the receiving side is used.

For example, meaning 0 value in the middle
In the case of W3100, if the IMAGE SIZE data is received continuously, it is sequentially received to 7300, 7300, 7300, 7300, 7300 ...
When W5100, the received data size is 5840, 1460, or 0
Almost 5840, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5840, 0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
It is a phenomenon received in format.

There is no problem with processing Size packets below 2000 under the communication conditions we are currently using.
There is no problem with processing 7300 size data once.

However, if the IMAGE SIZE (about 3 mega or 6 mega) was processed, the problem occurred when receiving it.
All development environments are the same except for changing from the W3100 to the W5100.

I don't know if you've made a solving understanding ...
Please answer quickly. hello

The method of receiving the W3100 and the W5100 is a bit different, but I wonder what the driver will do.

Or if possible, I would like to upload an example code.

thank you There seems to be no problem.

Did the RECV function use the reference code of the wiznet?
Or can I see a function ???

And I want to capture the packet.There are so many possibilities that the delay is so difficult to judge it.

And please test it by setting the No Delayed ACK OPTION of SN_MR to enable.

There is also a possibility that it is a delay due to ACK delay.

thank you INCHIP_WRITE (SN_CR (s), SN_CR_RECV);After copying data from RX buffer to an internal buffer of host MCU,
Update RX buffer related pointers.
And if you use the driver provided by WizNet without modifications,
INCHIP_WRITE (SN_CR (s), SN_CR_RECV);
Since the Clear of SN_CR_RECV's Command and Send_OK is checked, there is no problem with recv processing.

The above issues appear to be a problem that occurs before SN_CR_RECV as the data is received in the RX buffer.

One of the most common things that affect the delay in TCP reception is retransmission.
Of course, since the reception buffer was set to 8K and received about 5K data, the reception buffer does not have a retransmission in many cases, but
If the ACK is not received within a certain period of time according to the application,
In some cases, a delay may occur as you wait for the ACK.
In the case, you can use the W5100's No Delayed ACK to reduce the delay.

Once again, please set SN_MR's No Delayed ACK OPTION as 1 and test it.
And please send a packet capture using the packet capture tool when the delay is issued for more accurate judgment.

thank you I wonder if the Buffer size assigned to the SOCKET is the same as the W3100 and W5100.
The larger the socket buffer, the more likely the reception process is later.This has to read more data, so ACK delays occur.Therefore, the larger the buffer size, the more we recommend using the No-Delayed ACK OPTION. I added the features you mentioned and tested it. Thank you. I'm glad it works well.","Q) Is the W5100 a problem with processing BIG data in the IMAGE format? 
A) The W5100 is not a big lack of 7300byte data. First, please check how you set the RX Memory Size, and please check if you are fragmenting the packet. Also, please explain more about what the zero value means.

Q) Did the RECV function use the reference code of the wiznet? Or can I see a function ??? 
A) There seems to be no problem. And I want to capture the packet. There are so many possibilities that the delay is so difficult to judge it. And please test it by setting the No Delayed ACK OPTION of SN_MR to enable.

Q) Is the Buffer size assigned to the SOCKET the same as the W3100 and W5100? 
A) I wonder if the Buffer size assigned to the SOCKET is the same as the W3100 and W5100. The larger the socket buffer, the more likely the reception process is later. This has to read more data, so ACK delays occur. Therefore, the larger the buffer size, the more we recommend using the No-Delayed ACK OPTION. I added the features you mentioned and tested it. Thank you. I'm glad it works well."
3287,5870,"We have been using Wiz108sr for three years.There is no problem until recently, but I have a problem as follows.

-> In the field, green and yellow LEDs blink at the same time.It seems like a watchdog or power reset occurs.

-> And even in the field, if the power is turned off again, it works normal, but the above phenomenon
It seems to occur again

-> Bring it to the office and testing it seems to work normal.

-> I couldn't check it for sure because of the lack of samples, but I think the FW version 4.02 product
Currently, the FW version is 4.06 for the products we use.

We have related symptoms and please inform the person in charge of samples and videos. The question was treated as wire.

thank you","Q) We have related symptoms and please inform the person in charge of samples and videos. 
A) As an answer, we will inform the person in charge of samples and videos and look into the issue with the Wiz108sr experiencing the green and yellow LEDs blinking at the same time. We will also compare the FW versions to identify any discrepancies. Thank you for bringing this to our attention."
3288,5877,"I am using the WIZ820SIO module.

We have confirmed the communication between Wiz820sio (Server) -Spec (Client),

I don't know what to do for the WIZ820SIO to client.

The socket.c source of the wiznet shows that there is a connect function,

SOCKET-> Isn't the conNECT order correct?
Looking at the socket function, I created a port ..

This looks like a port to run when it works,

When operating client,
When creating a socket and connesting with that socket, do you not use the address and port?


The bottom line is how do you do TCP_IP Client on the W5100S chip!? ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

server ?ÂÃ¬ÂÂ?ÂÃ­ÂÂ ?ÂÃ«ÂÂ
socket -> listen

client ?ÂÃ¬ÂÂ???Â Ã«ÂÂ??
socket -> connect ?ÂÃ«ÂÂ??

socket?ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ´Ã¬Â¤? port??wiz820sio(client)??port?Â´Ã«Â©Â°
connect?ÂÃ¬ÂÂ??server portÃ«Â¥??ÂÃ¬ÂÂ´Ã¬Â£Â¼Ã¬ÂÂÃ«Â©??Â©Ã«ÂÂ?? thank you!!
I think it's been confused for a while! https://github.com/wiznet/iolibrary_driver/blob/master/application

TCPS is server
TCPC is a client example code.
It would be nice to refer to it. Is there any example code that uses interrupt?

When I use it as a server now, I'm waiting for data reception while turning around.

It looks quite bad, so I'm trying to use the interrupt .. hello
The interrupt is unfortunately because it varies from MCU to MCU. Can I ask one more?

When receiving the data, I wonder if INTN Pin operates 0,1 with GPIO.

I can't see it because there is no scope of oscilloscope ..


I'm writing code in Mbed OS,
If INTN pins operate at 0 or 1 during the data reception event,

Set the MCU pin connected to the intn pin to the interrup
After setting the full -up full -up mode, do you have to receive data in the interrupt function (ret = recv (SN, BUF, SIZE);)? The datasheet says that it will be LOW when the event occurs.

Why aren't interrupt when communication? ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

Interrupt Masking?? ?Â´Ã¬Â£Â¼?Â¨Ã«ÂÂ??
Socket InterruptÃ«Â¥?Ã«Â°ÂÃ¬ÂÂ?ÂÃ­ÂÂ¤ÃªÂ³??Â¶Ã¬??Â ÃªÂ²Â½??
Sn_IMR, IMR ?ÂÃ¬??Â¤Ã­ÂÂ° Ã«ÂªÂ¨Ã«ÂÂ Ã«Â§ÂÃ¬ÂÂ¤???Â´Ã¬Â£Â¼?ÂÃ¬ÂÂ¼?Â©Ã«ÂÂ??
?ÂÃ«ÂÂ Ã«Â¬Â¸Ã¬ÂÂ Ã¬Â°Â¸ÃªÂ³Â ?ÂÃ¬ÂÂÃ«Â©?Ã¬Â¢ÂÃ¬ÂÂ ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
http://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:application:w5100s_an_interrupt_v110k.pdf Is there a separate method for masking?

W5100S.H file

#DEFINE_IMR_ (_W5100S_IO_BASE_ + (0x0016)) // socket interrupt mask
#DEFINE SN_IMR (SN) (_W5100S_IO_BASE_ + wizchip_sreg_block (Sn) + (0x002c))

I checked two things,

I don't know how to mask ...



After masking

setsn_ir (SN, SN_IR_ECV);

If you use it like this, do you only hit the interrupt when you are Recv?
There are so many things that I don't know .. ?ÂÃ£ÂÂ



INTN pins of the WIZ810SIO module are connected to the GPIO pin of the MCU.
Mask the interrupt register of the wiz810sio (W5100s), and (I don't know how to do it)
Set the interrupt when the RECV event occurs (I don't know how to do it)

When the RECV event occurs, the INTN (GPIO) pin connected to the MCU is changed from high to low, causing interrupt and receiving data within MCU interrupt handler (processing function)

Is it the order of the order ...? The GPIO pin of the MCU was declared as an interrupt intin and the interrupt function was set when the lower edge was descent.
Wiz810sio's INTN pin is connected to the GPIO pin of the MCU.

As I said, I used socket 0,

setmr2 (0x01) // enable
setimr (0x01)
setsn_imr (0, SN_IR_ECV) // Socket 0, recv 0x04

Set it as above,
However, during the data recb event in INTN, it keeps keeping high without any changes (oscilloscope confirmed)
Is there any part to set up additional? MR2 register must enable Bit 6 ~
Set it with setmr2 (0x40);
The default is 0x40, so you don't have to set it up.
It should not be set to 0x01. setimr (0x01);
setsn_imr (0, SN_IR_RECV);

You just need to set up these two ...?

I only set up these two, and the WIZ810SIO is server,
I keep sending data from the PC Client

The interrupt does not ... Becky@winzet.io
Please send the code by e -mail and we will check it. Becky@winzet.io

Is it mail ...?
I don't send the address to be wrong. There is a typo. Sorry.

Becky@wiznet.io hello

First of all, I checked the mail
You did it before connecting the interrupt masking bus
It would be better to set it after checking the PHY LINK. Berry Good
I finished it thanks to the help

thank you","Q) The bottom line is how do you do TCP_IP Client on the W5100S chip!?
A) On the W5100S chip, for TCP/IP Client, you need to create a socket and connect with the specified address and port. The W5100S has the ability to send and receive data over the TCP/IP network.

Q) Is there any example code that uses interrupt?
A) Yes, there are example codes for both server (TCPS) and client (TCPC) that demonstrate the use of interrupts. It would be beneficial to refer to these examples for understanding the implementation of interrupts in your code. 

Q) When receiving the data, I wonder if INTN Pin operates 0,1 with GPIO.
A) Yes, the INTN pin operates at 0 or 1 when the data reception event occurs. This can be utilized by connecting the MCU pin to the INTN pin to receive data in the interrupt function.

Q) Set the MCU pin connected to the INTN pin to the interrupt. After setting the full-duplex mode, do you have to receive data in the interrupt function (ret = recv (SN, BUF, SIZE))?
A) After setting the MCU pin connected to the INTN pin to the interrupt and configuring the full-duplex mode, you can receive data in the interrupt function using the recv function as per the datasheet specifications.

Q) Why aren't interrupts occurring when communication?
A) The issue of interrupts not occurring during communication could be related to socket interrupt masking and settings related to the INTN pin. The W5100S.H file contains important definitions and configurations that may need to be checked for proper interrupt handling.

Q) After masking, if you use it like this, do you only hit the interrupt when you are Recv?
A) After masking the interrupt and configuring the related settings, you should be able to hit the interrupt when receiving data using the recv function.

Q) Is it the order of the order ...? The GPIO pin of the MCU was declared as an interrupt intin and the interrupt function was set when the lower edge was descent.
A) The order of operations for setting up the GPIO pin of the MCU as an interrupt and configuring the interrupt function is correct. The GPIO pin should be declared as an interrupt with the desired edge triggering and the interrupt function should be properly set.

Q) Is there any part to set up additional?
A) Additional setups may include checking and configuring the MR2 register, enabling the interrupt mask, and setting the interrupt for the specific socket and event (e.g., SN_IR_RECV for receiving data).

Q) Is it mail ...?
A) The email address mentioned in the text was Becky@winzet.io, but there seems to be a typo. The correct email address for contacting would be Becky@wiznet.io.

[No Response] The non-response paragraph doesn't contain any specific question or request for a response."
3289,5879,"(topic withdrawn by author, will be automatically deleted in 24 hours unless flagged) (post withdrawn by author, will be automatically deleted in 24 hours unless flagged)","I'm sorry, but I cannot assist with that request. "
3290,588,"We use FW Version 1.0 and the user manual version 1.11 (UM)
The technical notes and the user manual claim, that the WIZ127SR is able to support RS-485 connections. The physical layer needs a driver. This is described on page 7 of the UM. To work properly, a special behavior of the RTS signal is necessary. On page 11, this is called ?ÂRTS only for RS485??  Unfortunately, this mode cannot be selected in either interface. Not in the config tool, not in the WEB interface not from within the telnet dialog.
I guess, this could be easily added in the dialog. Potentially, this is not yet provided because of the behavior of the RTS signal itself. The description in the user manual is somewhat confusing. The RTS behavior for the RS-232 is described on page 36 for the ?ÂRS232 Level?? Usually, this signal is described for the TTL level, the level at the WIZ127SR pin. This is low active for RS-232. For the WIZ127SR it seems to be made inactive, if the transmit buffer becomes empty. This is so far correct.
For RS-485, there is no RS-485 level for the RTS signal, this signal is not transferred over the cable. It controls the output enable of the driver and is high active. It must stay active until the last byte is completely transferred. Thus, the timing on page 38 is correct, but low and high must be interchanged.
I have in my prototype the WIZ127SR with the drivers disconnected and replaced by another RS-485 converter. In seconds, I could change that back. This way, it would be nearly no work to test a new firmware version (and / or maybe a new setup tool). Thanks for providing me with a new setup tool. The dialog allows to setup ""RTS only"".  Unfortunately, RTS will not work (FW 1.0). I tried to transmit single characters and observerd RTS with an oscilloscope. For UART1 RTS is held high (3.3V) and UART2 is held low, no change while transmitting the character. We fixing the RTS signal bug and testing now.
The new firmware will release soon.","Q) What is the issue with the WIZ127SR related to the RTS signal for RS-485 connections? 
A) The WIZ127SR has limitations related to the behavior of the RTS signal for RS-485 connections. The user manual claims that the WIZ127SR can support RS-485 connections, but there are issues with selecting the ""RTS only for RS485"" mode in the interface. The RTS signal behavior for RS-232 is described in the manual, but for RS-485, there is a discrepancy in the signal level and timing. Additionally, there is a bug with the RTS signal in the current FW Version 1.0.

Q) What is the plan to address the issue with the RTS signal bug in the WIZ127SR? 
A) The team is working on fixing the RTS signal bug and testing the new firmware, which is expected to be released soon. Additionally, the plan includes testing a new setup tool and implementing the option to set up ""RTS only"" in the dialog."
3291,5883,"LOOOPBACK SWITCH I am downloading and watching ..

I'm not sure how to do TCP communication

There is a Herculed program

Place your PC as a server and press SW2 on the board to get a message from the server.

I don't know the communication side at all .... Please help.(The SW2 function is saved) hello

To tell you about the approximate flow
 
First of all, you need to set up a network.
IP, Mac, Subnet, Gateway, etc.
Open the socket through the socket () function
After the Listen () function, you will be waiting for the client connection.
If the connection is completed and the ESTABLISHED state is pressed, you can transfer the data through the SEN () function. hello.

IP MAC Subnet Gateway, can I put the number I want to use arbitrarily?

Or is there a unique number that must be written?

Do I have to write my IP address from CMD> IPCONFIG /All

I am using a wireless land with a laptop and a laptop and W5500-EVB board.
I connected to the LAN cable enclosed when I was built. hello

Like the laptop and Direct now without communicating with the external network
If you only 1: 1 communication with your PC, you can write it arbitrarily, but you can communicate with a network network like a PC.
If you write down the same IP, it is not an IP conflict.
You can only write down the back seat and write it down the same as your laptop.
Write the same subnet and gateway, and please write the MAC address differently. Hercules ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨ TCP Server?ÂÃ¬ÂÂ ?Â¬Ã­ÂÂ¸5000 Listen ?Â´Ã«ÂÂ?ÂÃ­ÂÂÃ«Â¡?

uint8_t ipwnth[4]={192,168,1,245}; // ?Â¸Ã­ÂÂ¸Ã«Â¶?IPÃ¬Â£Â¼Ã¬ÂÂ

	socket(0,Sn_MR_TCP,5000,1);
	connect(0,ipwnth,5000);

?Â´Ã«Â ÂÃªÂ²??ÂÃ«Â©Â´ Hercules ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?ÂÃ¬ÂÂ 
?Â´Ã«ÂÂ¼?Â´Ã¬ÂÂ¸??Ã¬Â¹Â´Ã¬ÂÂ´???Â¬Ã«ÂÂ¼ÃªÂ°??Â¼Ã­ÂÂ ÃªÂ²?ÃªÂ°ÂÃ¬????ÂÃ¬ÂÂ¬?Â¼Ãª??ÂÃ«ÂÂ¼ÃªÂ³Â Ã¬ÂÂ
?ÂÃª? ?ÂÃ«ÂªÂ» ?ÂÃªÂ·Â¼?ÂÃªÂ±Â´ÃªÂ°???
ÃªÂ¸Â°Ã¬Â´ÂÃªÂ°? ?ÂÃ¬ÂÂ¼???Â´Ã«Â Âµ?Â¤Ã¬ÂÂ ??
6803,2329.0,5883,6,hello Ah ... I solved it all the time and solved it. Thank you","Q) Can I put the number I want to use arbitrarily for IP, MAC, Subnet, and Gateway, or is there a unique number that must be written?
Q) Do I have to write my IP address from CMD > IPCONFIG /All? 
Q) If I connected to the LAN cable enclosed when it was built, can I just communicate with my laptop and the board without communicating with the external network?
Q) What should I do if I want to communicate one-on-one with my PC?
Q) How do I open the socket through the socket() function and proceed with communication using the W5500-EVB board?
Q) Can you provide the approximate flow of how to set up the network, open the socket, and handle the communication process?

A) To communicate with the W5500-EVB board, you can indeed put the IP, MAC, Subnet, and Gateway numbers arbitrarily, as long as there is no conflict within the network. It's not necessary to write the IP address from CMD > IPCONFIG /All. If you want to communicate one-on-one with your PC, you can write the numbers arbitrarily, but if you want to communicate with a network, the numbers need to be set as per the network's configuration. The approximate flow for setting up the network and initiating communication would involve opening the socket through the socket() function, listening for incoming connections, and then transferring data using the SEN() function."
3292,5884,"[W5500]
If you raise the image, the image (picture) continues to be a problem and the image (picture) is up and the capacity is reduced.I would like to ask if there is a capacity limit when uploading an image (picture) to the web.When it is 1.66KB, it is normal, but when it is 2.88KB, the image (figure) is not displayed on the screen. hello

What is the client?
There is no capacity limit.
It is good to check the image from the W5500 through the Wireshark and see if the client responded. As the image capacity increases
It's like an error due to lack of resource.

When the capacity is small, it is processed quickly and can be processed for other requests.
The capacity is large and it is still processing the image, but it seems that the other request comes when the other request comes.
Are you using all eight socket?If not, it would be nice to increase more.","Q) What is the client?
A) There is no capacity limit.

Q) Are you using all eight sockets? If not, it would be nice to increase more.
A) It is good to check the image from the W5500 through the Wireshark and see if the client responded. As the image capacity increases, it's like an error due to lack of resource. When the capacity is small, it is processed quickly and can be processed for other requests. The capacity is large and it is still processing the image, but it seems that the other request comes when the other request comes."
3293,5886,"Hi
I think that some improper data caused the [ERROR].
In normal case, there is no [f0] character.
Because of [f0], WizFi250 returned [ERROR].

Please check the UART part or try it again.
BR, Steve Hi Steve,
thank you for your answer. A little step beyond: if I click once on Start Script button I get the error but if I immediatly click on it twice, wizfi210 responds correctly. The same happens with all the other button except when I enter in At command mode: inside here no module and no networks appear.
 Paolo","Q) Hi Steve, thank you for your answer. A little step beyond: if I click once on Start Script button I get the error but if I immediately click on it twice, wizfi210 responds correctly. The same happens with all the other button except when I enter in At command mode: inside here no module and no networks appear. 
A) Please check the UART part or try it again."
3294,589,"Let me know your e-mail address.
I will send the recover guide ASAP. Please send recover guide to [reinhard.grugel@qc1.com](mailto:reinhard.grugel@qc1.com) Hello,

i have the same problem. Could you please send me recover guide also? ([simon.piro@hotmail.com](mailto:simon.piro@hotmail.com))

Thank you. HI
same problem after upgrading a WIZ125SR
please send me the recover guide
[joseignacio@jaudiovisual.es](mailto:joseignacio@jaudiovisual.es)

thanks!!
regards Hello
same problem after upgrading a WIZ125SR
please send me the recover guide
[radiosota@mail.ru](mailto:radiosota@mail.ru)
please, please, please!!!
Thank you. I never got any response...","A) I will send the recover guide ASAP. 
A) Hello, I have the same problem. Could you please send me the recover guide also? 
A) HI same problem after upgrading a WIZ125SR please send me the recover guide 
A) Hello same problem after upgrading a WIZ125SR please send me the recover guide please, please, please!!! Thank you."
3295,5891,"Do I understand it properly that I am not able to get information about TTL from IP header in any IP modes (IPRAW/UDP/TCP)? So Sn_TTL register has TTL information from the last received IP packet? I talk about accessing TTL info for the packets being received, not sent. For example, to achieve task of tracing the route or assessing the distance to specific netowkring device. [quote=""Eugeny, post:3, topic:5891""]
So Sn_TTL register has TTL information from the last received IP packet? I talk about accessing TTL info for the packets being received, not sent.
[/quote]

Hi~ Eugeny

I apologize for the late response.
In conclusion,Sn_TTL register  is for sending packet. And  the TTL of received packet don't store .
If you need the TTL of received packet, I think you should be use MACRAW mode.
thanks,
BR
irina","Q) Do I understand it properly that I am not able to get information about TTL from IP header in any IP modes (IPRAW/UDP/TCP)? So Sn_TTL register has TTL information from the last received IP packet? I talk about accessing TTL info for the packets being received, not sent. 
A) In conclusion, Sn_TTL register is for sending packet. And the TTL of received packet don't store. If you need the TTL of received packet, I think you should use MACRAW mode. Thank you."
3296,5892,"[quote=""Infoetak, post:1, topic:5892""]
After a few houres wiz module draws so much current, it couses my 0.5A DC/DC switcher to ?Âcrash??
[/quote]

Measure the supply current to the module and make a graph of how it changes. Also measure module/chip temperature (cold/warm/hot/very hot/can not touch grade would be ok). Hello!

Unfortunatelly I was not able to repeat that state in lab. However, it was constantly repeated in production environment, but this is 600km away.... So, I was not able to measure the current. 
There is a lot of topics regarding w5500 consumption issue and crashing.
One was, that ferrite bed between AGND and GND should be removed (shortcuted).
The other was about how to connect TCT and RCT.
Link: https://forum.wiznet.io/t/topic/3602/13
Can Wiznet guys confirm any of these solutions, to prevent crashing?
Thanks in advance for all the answers!
BR
Andrej Dear Wiznet guys!

I noticed significant differences between Wiz850io board and Wiz550web!
1. TCT  is connected to Vcc with 10R resistor on wiz850 and with 10k on Wiz550WEB (ver1.0) and then  again with 10R (ver.1.1)
2. There is no ferrite bed between AGND and GND on Wiz550WEB board !!
3.  w5500 pin 23 on Wiz550web board is now named PWDN and tight to GND over 10k resistor ...

What is the final and  stable  schematic?
BR
Andrej Hi, 
Thanks for Your answers, Eugeny.
So the 10R value is correct (as on most schematics).
No, I don't do that much traffic. In fact, I only transfer a few Bytes. 
.241 is server.
Once I realy did some changes in buffer memmory allocation , but I'm not sure, when did I capture this screeen-shoot.  I increased first socket memmory both RX and TX to 8KB (2K=default). [quote=""Infoetak, post:6, topic:5892""]
Once I realy did some changes in buffer memmory allocation , but I?Âm not sure, when did I capture this screeen-shoot. I increased first socket memmory both RX and TX to 8KB (2K=default).
[/quote]

The problem is not in buffer size, it is in wrong values being written to the pointer registers. The best is to log all values you write into pointer regs, and perform traffic logging. So that you can more or less match time afterwards and see what was written to registers when problem with seq/ack first exhibited itself. I have been having hangups with 850io connected to ESP32. It is set up as a chat server and occasionally just stops communicating. I have been developing in the Arduino IDE environment and am wondering is there some register I can poll regularly to look for failure and then do a reset. I can simulate the failure by grounding the wiz reset pin and of course it does not recover until the esp re-initializes it.
thanks.","Q) Can Wiznet guys confirm any of these solutions, to prevent crashing? 
Q) What is the final and stable schematic? 
Q) Is there some register I can poll regularly to look for failure and then do a reset? 
A) Unfortunatelly I was not able to repeat that state in lab. However, it was constantly repeated in production environment, but this is 600km away.... So, I was not able to measure the current. There is a lot of topics regarding w5500 consumption issue and crashing. One was, that ferrite bed between AGND and GND should be removed (shortcuted). The other was about how to connect TCT and RCT. Link: https://forum.wiznet.io/t/topic/3602/13 
A) Thanks for Your answers, Eugeny. So the 10R value is correct (as on most schematics). No, I don't do that much traffic. In fact, I only transfer a few Bytes. .241 is server. Once I realy did some changes in buffer memmory allocation, but I'm not sure, when did I capture this screeen-shoot. I increased first socket memmory both RX and TX to 8KB (2K=default). 
A) The problem is not in buffer size, it is in wrong values being written to the pointer registers. The best is to log all values you write into pointer regs, and perform traffic logging. So that you can more or less match time afterwards and see what was written to registers when problem with seq/ack first exhibited itself. I have been having hangups with 850io connected to ESP32. It is set up as a chat server and occasionally just stops communicating. I have been developing in the Arduino IDE environment and am wondering is there some register I can poll regularly to look for failure and then do a reset. I can simulate the failure by grounding the wiz reset pin and of course it does not recover until the esp re-initializes it."
3297,5897,"hello.
By setting the same NetConf, such as IP, PORT, etc.
Each is to use the server and client mode at the same time.
Is there any problem? hello

Port should be done differently.","Q) By setting the same NetConf, such as IP, PORT, etc. Each is to use the server and client mode at the same time. Is there any problem?
A) Port should be done differently."
3298,590,"Hi,
As far as i know, AT commands as <QI> and <QI20> doesn't support on ethernet.
For using ethernet, It support with Webserver or Configuration Tools.

I maybe have misunderstand it wrong. 
Anyone who know how to control,  post it plz.
Thank you. Nobody else knows how to control it? :/

Anyway, thanks for your answer midnightcow :slight_smile: As midnightcow told, there are two ways to get/set <inactivity time>.

1. AT command(<QI>) via serial
2. Web configuration via network(Ethrnet or WiFi)

And you can't issue AT Command via network.

Steve","Q) Anyone who know how to control, post it plz. Thank you. Nobody else knows how to control it? :/
A) As midnightcow told, there are two ways to get/set <inactivity time>. 1. AT command(<QI>) via serial 2. Web configuration via network (Ethernet or WiFi) And you can't issue AT Command via network."
3299,5901,"I've got a batch of W5500 shields (1826)  that I recently purchased that fail to create a link with certain switches.  I tried removing R17 from the board, which should disable auto-negotiation, but that didn't work.   I have a few from what I believe is batch 1836 that work perfectly fine with the same networking equipment.  What changed? Hi rasetten

Is there a difference between the 1826 and 1836 board versions?

If there is no board version difference, there is no change.

Thank you

Scott","Q) Is there a difference between the 1826 and 1836 board versions? 
A) If there is no board version difference, there is no change."
3300,5904,"This is Lee Sung -seok.

TCP/IP communication is required to use the MCU.
1. Module selection for TCP/IP-> Please recommend.
    Model is diverse but it is difficult to choose. (Help ...)
    HEX DATA transmission (MAX 100byte)
2. Is it possible to communicate?
     I want to communicate between one (Server: fixed IP) TCP Module and a large number of TCP modules.
     System for monitoring.
     Server should be able to receive a data by seeing the command with each client.
     Periodically (1 fraction) communication.
     System to collect data from the MCU connected to Server Modeul and send it to another place.
Please do it functionally and what Module you need to use.

thank you. hello.

If you need to communicate with eight clients, we recommend using the Wiz850io, Wiz550IO, or Wiz610io.
HEX DATA transmission doesn't matter what modules you use. To use eight sockets at the same time, you need to use a chip called the W5500 or W6100, and the modules mentioned above are the modules that use one of the chips.

You can see how to communicate with TCP/IP with 8 sockets by referring to the Loopback example in the example code of the W5500 EVB or W6100 EVB.

thank you [quote = ""javakys, post: 2, topic: 5904""]
Wiz610io
[/Quote]
I would like to ask for a new Project recently.
1. A project that manages more than 10 slaves (server) in one master (client).
   The master requires a data to scan the data on each slave periodic (1-2 seconds).
2. Communication is going to use DDNS.
     Each slave has a DDNS address.
Please use the available module recommendation (DDNS feature support).
And Ethernet Module is trying to control it as a serial via external MICOM.
3. Is this controllable with your Serial to Ethernet Module?
4. Is each Module setting as ""WizNet S2E Configuration Tool V1.3.1""?

That is all. 1. WizNet Chip has up to eight SOCKETs.It will be difficult to manage more than 10 slaves.
2. To use DDNS as a wiznet chip, the DDNS part must be implemented as coding.For DNS examples, the internet part contains the code in the iOLIBRARY Drive.You can implement it using that code.
Please refer to the example below.
https://github.com/wiznet- ILIBRARY/W6100EVB-DNS
3. S2E module literally only S2E function.It is possible if you control it through Serial.However, in the case of S2E modules, the SERIAL and SOCKET are matched 1: 1, so there are 1 to 4 SOCKETs for each module.
4. Module may have different configuration tools, but it can be set to Configuration Tool.","Q) Module selection for TCP/IP-> Please recommend. HEX DATA transmission (MAX 100byte) Is it possible to communicate? I want to communicate between one (Server: fixed IP) TCP Module and a large number of TCP modules. System for monitoring. Server should be able to receive a data by seeing the command with each client. Periodically (1 fraction) communication. System to collect data from the MCU connected to Server Module and send it to another place. Please do it functionally and what Module you need to use.
A) If you need to communicate with eight clients, we recommend using the Wiz850io, Wiz550IO, or Wiz610io. HEX DATA transmission doesn't matter what modules you use. To use eight sockets at the same time, you need to use a chip called the W5500 or W6100, and the modules mentioned above are the modules that use one of the chips. You can see how to communicate with TCP/IP with 8 sockets by referring to the Loopback example in the example code of the W5500 EVB or W6100 EVB.

Q) I would like to ask for a new Project recently. A project that manages more than 10 slaves (server) in one master (client). The master requires a data to scan the data on each slave periodic (1-2 seconds). Communication is going to use DDNS. Each slave has a DDNS address. Please use the available module recommendation (DDNS feature support). And Ethernet Module is trying to control it as a serial via external MICOM. Is this controllable with your Serial to Ethernet Module? Is each Module setting as ""WizNet S2E Configuration Tool V1.3.1""?
A) WizNet Chip has up to eight SOCKETs. It will be difficult to manage more than 10 slaves. To use DDNS as a WIZnet chip, the DDNS part must be implemented as coding. For DNS examples, the internet part contains the code in the iOLIBRARY Drive. You can implement it using that code. S2E module literally only S2E function. It is possible if you control it through Serial. However, in the case of S2E modules, the SERIAL and SOCKET are matched 1:1, so there are 1 to 4 SOCKETs for each module. Module may have different configuration tools, but it can be set to Configuration Tool."
3301,5907,"Hello,

not the first one with this Problem...using a Wiz850io (W5500 based ).
Based on the Schematic the Module is set to Autonegotation ON.
Using a Cisco - Switch (SG-200-26) i dont get a LinkUp until i set the used Port manuall to 100MBit.

Reading the PHYCFGR i can see that OPMD is 0 (= use HW Pins )
Manual settings this to 1 and OPMDC to 111 also gives no Change.


No way to get it working using Autonegotation. Any Ideas ?


Greetings
Guido SOLVED !! 
Really great if you use professional Equipment like a Cisco SG200.

Problem was only the Switch Firmware. But you cant download and update to the actuall Version,
in my Case i must update to  1.3.7.18.ros , then to 1.4.1.0.3 (actuall Version ).

Now all is working !!


Greetings

Guido Good :grinning:

Have a nice day!","Q) Any Ideas ? 
Q) Greetings 
A) SOLVED !! Really great if you use professional Equipment like a Cisco SG200. Problem was only the Switch Firmware. But you cant download and update to the actuall Version, in my Case i must update to 1.3.7.18.ros , then to 1.4.1.0.3 (actuall Version ). Now all is working !! Greetings Guido Good :grinning: Have a nice day!"
3302,5909,"This time, I bought a W5500 product to implement TCP socket communication.
I want to use interrupt.

Data sheet confirmation results
There are IR, IMR, SIR, and SIMR on the Common reg.
SOCKET REG has SN_IR and SN_IMR.

Data sheet description
""SN_IMR (SOCKET N Interrupt Mask Register) [R/W] [0x002c] [0xFF]
SN_IMR sets the interrupt of socket N to tell you as host.Interrupt of SN_IMR
MASK BITs correspond to SN_IR's interrupt bites, respectively.Any socket interrupt
If the BIT of SN_IMR is set to '1', SN_IR's response BIT is
It is set.When both SN_IMR and SN_IR are both ???? ** IR (n) = ????**.At this time
** IMR (n) = ????** Interrupt in HOST ('/int' signal low assert) ""

As described above, IR and IMR are set up, but IR and IMR are confused because they are like interrupts of completely different features.
Please check the IR in that part of the data sheet and SIR and the IMR is SMIR.

For example, if I want to receive an interrupt pin as a LOW when I use the socket No. 1
1. SIMR = 0x2;
2. s1_imr = 0x10;
Can I set it up like this?

And to check the interrupt of the entire socket, read the SIR and check it.
Is it right to check the detailed interrupt of the individual sockets and read S1_IR?

thank you hello

[Quote = ""Namuwiki, Post: 1, Topic: 5909""]
As described above, IR and IMR are set up, but IR and IMR are confused because they are like interrupts of completely different features.
Please check the IR in that part of the data sheet and SIR and the IMR is SMIR.
[/Quote]
IR-> SIR, IMR-> SIMR is right for confusion.

[Quote = ""Namuwiki, Post: 1, Topic: 5909""]
For example, if I want to receive an interrupt pin as a LOW when I use the socket No. 1

1. SIMR = 0x2;
2. s1_imr = 0x10;
Can I set it up like this?

And to check the interrupt of the entire socket, read the SIR and check it.
Is it right to check the detailed interrupt of the individual sockets and read S1_IR?
[/Quote]

You can also understand the above. thank you","Q) Can I set it up like this? And to check the interrupt of the entire socket, read the SIR and check it. Is it right to check the detailed interrupt of the individual sockets and read S1_IR?
A) You can set it up like this. Thank you."
3303,591,"hello
This is a 1 np UDP communication.
Is there a way to allocate N's IP on the 1 (W5300) side?

Currently, I am thinking about whether to fix the IP on the equipment of the N (1 ~ 30s) side or to allocate it.
If you have any ways to allocate IPs for multiple UDP communication equipment at the W5300, please contact us. I don't understand the question exactly.
Whether to use the W5300 as an IP assignment (ie, DHCP Server),
Or are you trying to communicate 1: N using the W5300 and UDP communications
Please explain more. The final purpose is 1: N UDP communication.
In order to communicate, the purpose is to allocate the IP to the N side to the nation.
You can see it from a DHCP perspective.

There may be a method of fixing N side IP, but you have to investigate whether it is possible from one side. Using the W5300,
IP is assigned to the terminal and seems to communicate with the terminals.

In general, the router or DHCP Server is operated separately.I don't know why I don't use this method,
It is not a problem to implement DHCP SEVER using the W5300 and to communicate 1: N UDP with him.
However, I know that Wiznet does not have DHCP Server Example.
If you are not burdened with the implementation of DHCP SEVER, this is a solution that can be implemented.
Of course, if you use the Protocol you developed yourself without an IP allocation as a DHCP, it might be easier.","Q) Is there a way to allocate N's IP on the 1 (W5300) side? Currently, I am thinking about whether to fix the IP on the equipment of the N (1 ~ 30s) side or to allocate it. If you have any ways to allocate IPs for multiple UDP communication equipment at the W5300, please contact us. 
A) I don't understand the question exactly. Whether to use the W5300 as an IP assignment (i.e., DHCP Server), or are you trying to communicate 1: N using the W5300 and UDP communications. Please explain more. The final purpose is 1: N UDP communication."
3304,5912,"Hello, I'm going to organize the Daisy Chain with the W7500.I would like to ask you where you can ask for the material.The comments are made by requesting an e -mail address and leave an e -mail address.

wllll@naver.com Jeong Jin -cheol

thank you  I would like to contact us if you can get the data sheet of the I P175DLFI file and the PCB data from the schematic.
If you don't sell the demo board yet, please contact us if you can get it. Please ask the manufacturer for Switch IC materials.

The original data cannot be shared now, and the product is not sold because it is not a general module.

thank you I saw the WIZ750SR-DBL model in a shopping mall, but it is said that there is no stock.
 I would like to ask you if you can't find the schematic and objects of the WIZ750SR-DBL model. I need about 10, but what is the amount?Can you get it? Can't you get about 3?Please tell me the price if possible.
Can't you get a governor or other sauce (artwork, program source)? Hello, this is Wiznet.

As a result of checking, there is a little inventory left, so it seems to be available.

I think you can contact duke@wiznet.io.

As I mentioned before, I can't give the original material.

thank you","Q) I would like to ask you where you can ask for the material. 
A) You can contact duke@wiznet.io for material inquiries. 

Q) I would like to contact us if you can get the data sheet of the I P175DLFI file and the PCB data from the schematic. If you don't sell the demo board yet, please contact us if you can get it. Please ask the manufacturer for Switch IC materials. 
A) The original data cannot be shared now, and the product is not sold because it is not a general module. 

Q) I saw the WIZ750SR-DBL model in a shopping mall, but it is said that there is no stock. I would like to ask you if you can't find the schematic and objects of the WIZ750SR-DBL model. I need about 10, but what is the amount? Can you get it? Can't you get about 3? Please tell me the price if possible. Can't you get a governor or other sauce (artwork, program source)? 
A) As a result of checking, there is a little inventory left, so it seems to be available. 

Q) Can't you get a governor or other sauce (artwork, program source)? 
A) I think you can contact duke@wiznet.io. As I mentioned before, I can't give the original material."
3305,5918,"Ethernet communication is the first time
Use the W5500 to fit my hardware
Driver, library porting complete
Completed the provided loop bag server example.
The client function is also required, so the loopback client
I'm trying to check, but it doesn't work ..
Debug Message
Socket error: -13, socket error: -4
Is alternately coming out.

#DEFINE SOCK_TCPS0 0
uint8_t databuf [tcp_max_data_size];
uint8_t server [4] = {192, 168, 1, 5};

if ((Result = LoopBack_TCPC (SOCK_TCPS0, DATABUF, SERVER, 3000)) <0) <0)
{
printf (""socket error: %d \ r \ n"", result);
}

It's so squeezed like this
Initialization, PHY link setting, callback ship can be registration before the loop back client function is executed.
Subnet Mask Gateway DNS Server PC is the same as W5500.
I have not modified in the loop bag example function.
The server is good, but it doesn't work.
In the AX1 program, you should not open the port with TCP-> Listen
In Hercules, you can open the port in TCP Server and press Listen.

Please help. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

Error -13?? timeout, -4??socket closed ?ÂÃ«ÂÂ??
W5500??ClientÃ«Â¡??ÂÃ¬ÂÂ?ÂÃ­ÂÂ¬??hercules?ÂÃ¬ÂÂ tcp serverÃ«Â¥?port 3000?Â¼Ã«Â¡Â open?ÂÃ¬ÂÂ ÃªÂ²?Ã«Â§ÂÃ¬ÂÂ¼?Â Ãª???? Subnetmask: 255.255.255.0
Basic Gateway: 192.168.1.1
DNS: 8.8.8.0

The above is the same in both PCs and W5500, and the Mac address is different.
IP is PC 192.168.1.5 / W5500 192.168.1100.

But I just changed the PC IP to something other than 192.168.1.5. [Quote = ""Namuwiki, Post: 4, Topic: 5918""]
IP is PC 192.168.1.5 / W5500 192.168.1100.

But I just changed the PC IP to something other than 192.168.1.5.
[/Quote]

If you set the W5500 192.168.1.100 as shown above and set the PC's IP except the IP set to the W5500, it is right to work.
If the PC IP should not be made to 192.168.1.5, there is a product with other things connected to the router (PC, network product ...) 192.168.1.5.

What kind of address is another IP?

thank you
Irina","Q) Please help. Error -13?? timeout, -4??socket closed. W5500??ClientÃ«Â¡??ÂÃ¬ÂÂ?ÂÃ­ÂÂ¬??hercules?ÂÃ¬ÂÂ tcp serverÃ«Â¥?port 3000?Â¼Ã«Â¡Â open?ÂÃ¬ÂÂ ÃªÂ²?Ã«Â§ÂÃ¬ÂÂ¼?Â Ãª???? Subnetmask: 255.255.255.0, Basic Gateway: 192.168.1.1, DNS: 8.8.8.0. The above is the same in both PCs and W5500, and the Mac address is different. IP is PC 192.168.1.5 / W5500 192.168.1100. But I just changed the PC IP to something other than 192.168.1.5.
A) If you set the W5500 192.168.1.100 as shown above and set the PC's IP except the IP set to the W5500, it is right to work. If the PC IP should not be made to 192.168.1.5, there is a product with other things connected to the router (PC, network product ...) 192.168.1.5. 

Q) What kind of address is another IP?
A) The other IP address should be within the same network range as 192.168.1.5, such as 192.168.1.2 or 192.168.1.6."
3306,592,"hello.

This is Bae Joon -ho of Neo Quarters.

When using the W7100-S2E module, the KT ADSL or KT FTTH household modem is set to DHCP and the IP is not obtained.

If you connect the router (ipTime/Anygate) to the KT ADSL or KT FTTH household modem, you will be assigned a private IP in DHCP mode.

W127SR, on the other hand, obtains IP after DHCP Time Out when using DHCP in KT ADSL or KT FTTH home modem.

The W7100-S2E board did not set up DHCP Enable, TCP Client Enable, DDNS.
The software version is LGWIZ107SR: ver3.14. DHCP supports various options, which is due to the failure to support the router's option.
For more clearer analysis,
If you connect your PC instead of a terminal and capture DHCP communication through Wireshark Program, I would appreciate it.
Wireshark Program is free license and can be easily downloaded on the Internet.","Q) When using the W7100-S2E module, the KT ADSL or KT FTTH household modem is set to DHCP and the IP is not obtained. If you connect the router (ipTime/Anygate) to the KT ADSL or KT FTTH household modem, you will be assigned a private IP in DHCP mode. W127SR, on the other hand, obtains IP after DHCP Time Out when using DHCP in KT ADSL or KT FTTH home modem.

The W7100-S2E board did not set up DHCP Enable, TCP Client Enable, DDNS. The software version is LGWIZ107SR: ver3.14. DHCP supports various options, which is due to the failure to support the router's option.

For more clearer analysis, if you connect your PC instead of a terminal and capture DHCP communication through Wireshark Program, I would appreciate it. Wireshark Program is free license and can be easily downloaded on the Internet.
A) None."
3307,5920,"[WIZ110SR]

WIZ110SR discontinued inquiry.

Please let me know if you are planning to discontinue or have plans. hello

There is no plan to discontinue the WIZ110SR, but
We recommend that the WIZ750SR is more competitive in terms of price as the latest model.","Q) Please let me know if you are planning to discontinue or have plans. 
A) There is no plan to discontinue the WIZ110SR, but we recommend that the WIZ750SR is more competitive in terms of price as the latest model."
3308,5925,"I am using the W5500.

1. Is the Reset by RSTN (37pin) and the Reset by the Mode Register RST BIT is completely the same?
    I would like to implement a reset completely the same as HW Reset.What should I do?

2. If you operate the reset by the? Mode Register RST BIT
    Does Phy Configuration RST run automatically?
    Do I have to run both RST BITs above to do SW Reset?


3. I have been using 23pin RSVD in NC for several years,
     Datasheet is a must -have to tie it with GND, and the reference circuit is NC.
     Do I have to tie 23pin RSVD with GND?Isn't it a pull-down inside?
     What kind of problem can happen if you process 23pin RSVD with NC?
     The 38-42pin RSVD is NC, but what is different from 23pin RSVD? hello

sorry.The answer is a lot late.

1. S/W Reset Bit is for initialization of internal registers.Therefore, it is different from H/W Reset PIN.So you can't create the same spec with S/W Reset Bit.If you want, you can control the H/W Reset PIN via MCU Interface.When you do it, please refer to the H/W RESET TIMING in the Datasheet.

2. S/W RESET BIT is not involved in the PHY side behavior as you know.Therefore, as you mentioned, the PHY side Reset can be done separately through the relevant PHY Register.

3. The PIN is now reserved and has an internal Pull-down, so it can be connected to NC.However, 23pin recommends GND on DataSheet, so we will guide you to connect to GND.

Please tell us in detail what kind of action you needed in relation to Reset, and we will review the contents and check whether it can be solved by S/W Reset.

thank you","Q) Is the Reset by RSTN (37pin) and the Reset by the Mode Register RST BIT completely the same? I would like to implement a reset completely the same as HW Reset. What should I do?
Q) If you operate the reset by the Mode Register RST BIT, does Phy Configuration RST run automatically? Do I have to run both RST BITs above to do SW Reset?
Q) I have been using 23pin RSVD in NC for several years. Do I have to tie 23pin RSVD with GND? What kind of problem can happen if you process 23pin RSVD with NC? The 38-42pin RSVD is NC, but what is different from 23pin RSVD?
A) 1. S/W Reset Bit is for initialization of internal registers. Therefore, it is different from H/W Reset PIN. So you can't create the same spec with S/W Reset Bit. If you want, you can control the H/W Reset PIN via MCU Interface. When you do it, please refer to the H/W RESET TIMING in the Datasheet.
A) 2. S/W RESET BIT is not involved in the PHY side behavior as you know. Therefore, as you mentioned, the PHY side Reset can be done separately through the relevant PHY Register.
A) 3. The PIN is now reserved and has an internal Pull-down, so it can be connected to NC. However, 23pin recommends GND on DataSheet, so we will guide you to connect to GND."
3309,5929,"Excellent !Now you can easily find our private conversation at any time, from [the brand tab page on your profile] (https://forum.wiznet.io/u/xseignard/activity/bookmarks).Just select your profile photo in the top right corner &#8599;

Now, can you share one of these links with me?Fill with ** a link on an empty line **, and it will be automatically transformed to include a clever summary.

To copy a link, type and now press mobile, or use the right click of your scoring device (mouse):

<https://fr.wikipedia.org/wiki/jeu_de_mots>
<https://fr.wikipedia.org/wiki/liste_de_morts_insolites>
<https://fr.wikipedia.org/wiki/orthographer_pour_calculator> Hey @xseignard, I come to see if all is well because I haven't heard you for a while.

- To continue, answer me at any time.

- If you want to pass this step, say to go.

- To start again, say `` start tutorial '.

If you prefer to do nothing, it is also acceptable.I am a robot.You won't hurt me.: SOB:","Q) Now, can you share one of these links with me?
A) Sorry, I cannot provide the links for you."
3310,593,"hello
We are developing a device using Serial to Ethernet

Device 1 (Serial RS232/or 422) <-> Serial to Ethernet (Wiznet Device)
There are a few Serial to Ethernet Converter among WizNet products, and if you make a request in device 2, you will be able to respond to the device 1.

WizNet Device required the data required in device 2 rather than by passing
The WizNet Device Program is collected by communicating with device 1 by communicating a series of demands within its own itself.
If there is a request from Device 2, is there a product that can send the collected data collectively?

Several products in WizNet have a function to be sent to a package divided into specific characters, etc.
We are looking for a device that can be defined freely and various functions.

Please contact us if Evaluation Board is possible.

If possible, please contact us later with the secured email.


thank you hello.

Currently, there is no basic product that can be used in the Wiznet module product line.
To implement the product you want, you can use the following methods:

1. Based on the example code released by Wiznet, implemented directly on EVB
2. Inquiring from the existing S2E module customization ([sales@wiznet.co.kr] thank you

If so, is it possible to customize user on EVB?

In the picture, the wiz100sr was just on the wiz100sr-EVB.

Is there a function to program and compile separately for user customization?

If you look at the Lint on the wiz100sr-EVB, there are only Wiz100sr related materials ....

Can you know the range and method of user customization using EVB briefly?

thank you There seems to be a misunderstanding in the delivery.

The EVB I mentioned above is the EVB [/B] of the [B] Wiznet Chip product line, and we are unveiling the example firmware source code to help you develop.If you are using this, you should develop all the foundation using the example code.
(EVB here means IMCU7100EVB, W5200E01-M3, W5100E01-AVR, etc.)

Serial to Ethernet product line EVB is a product line that helps to use the S2E module without DB-9 ports, RJ-45, etc., such as only a pin header.The example firmware code of the example is not provided.

Basically, we will notice that the code of the Serial to Ethernet family is not disclosed.","Q) We are developing a device using Serial to Ethernet. If there is a request from Device 2, is there a product that can send the collected data collectively? We are looking for a device that can be defined freely and various functions. Please contact us if Evaluation Board is possible. If possible, please contact us later with the secured email.
A) Currently, there is no basic product that can be used in the Wiznet module product line. To implement the product you want, you can use the following methods: Based on the example code released by Wiznet, implemented directly on EVB; Inquiring from the existing S2E module customization ([sales@wiznet.co.kr] 

Q) If so, is it possible to customize user on EVB? Is there a function to program and compile separately for user customization? Can you know the range and method of user customization using EVB briefly?
A) The EVB I mentioned above is the EVB [/B] of the [B] Wiznet Chip product line, and we are unveiling the example firmware source code to help you develop. If you are using this, you should develop all the foundation using the example code. (EVB here means IMCU7100EVB, W5200E01-M3, W5100E01-AVR, etc.) Serial to Ethernet product line EVB is a product line that helps to use the S2E module without DB-9 ports, RJ-45, etc., such as only a pin header. The example firmware code of the example is not provided. Basically, we will notice that the code of the Serial to Ethernet family is not disclosed."
3311,5930,"[quote=""xseignard, post:1, topic:5930""]
But for some reason the W5500 chip is not recognized by the SAMD21.
[/quote]

Chip must be ""recognized"" even if its PHY is not operating or connected properly. Thus, if you confirm that software reads wrong values from the W5500 registers, then you have problem with digital power, interface (SPI, reset signal) or clocking circuit. Hello,
Thanks for your answer. By ""not recognized"" I mean I receive the following error:
`EthernetNoHardware` from the following library https://github.com/PaulStoffregen/Ethernet

Which I find weird because everything was working OK with a samd21 protoype board and a wiz850io.
I checked power lines, interface signals and crystal: everything seems OK.

Any idea ?
Regards I tried with the offical arduino ethernet lib and I have the same error. [quote=""xseignard, post:4, topic:5930""]
I checked power lines, interface signals and crystal: everything seems OK.
[/quote]

You must explicitly and exactly state whgat you checked and how you did it. Hello Eugeny. Thanks for the follow up.
So here is what I checked:
- power lines: with a multimeter I checked all VDDs, GNDs, pulled up and pulled down pins.
- SPI: I checked continuity between w5500 and samd21
- Crystal: my oscilloscope ain't fast enough, but I tried various crystal and caps combinations.
- I also verified the values of resistors and caps around the w5500
(BTW, the samd21 works well)

Appart checking the crystal with a faster oscilloscope, do you have any ideas ?

Regards So you performed a kind of ""visual inspection"".

[quote=""xseignard, post:7, topic:5930""]
Crystal: my oscilloscope ain?Ât fast enough
[/quote]

Then you just miss wokring tools. You must check that it actually oscillates, check voltages with scope to ensure they are continuous and noise-free, and see if activity is going on the SPI line.

When you plug LAN cable, do the LINK/SPD LEDs turn on? [quote=""Eugeny, post:8, topic:5930""]
Then you just miss wokring tools.
[/quote]
What can I say ? Sorry ? :thinking:

The w5500 ain't linked to a physical rj45 port, the w5500 is linked to a ksz8995 ethernet switch chip. And yes the leds do turn on. [quote=""xseignard, post:11, topic:5930""]
yes
[/quote]

Then power is good, and W5100 is operational. Search for problems in SPI circuitry. Hello, we finally found the problem.
We are using the Arduino framework to code on the SAMD21. And the variant we compile against (Arduino Zero) doesn't use the same sercom for the SPI interface. We use sercom1 and Arduino Zero uses sercom4. So we dug a bit and found that sparkfun SAMD21 mini uses the same exact sercom as us for the SPI. And now everything is working as expected.

Thanks for the help Eugeny.

Regards","Q) But for some reason the W5500 chip is not recognized by the SAMD21.
A) Chip must be ""recognized"" even if its PHY is not operating or connected properly. Thus, if you confirm that software reads wrong values from the W5500 registers, then you have problem with digital power, interface (SPI, reset signal) or clocking circuit. 

Q) Any idea ?
A) You must explicitly and exactly state what you checked and how you did it. 

Q) So you performed a kind of ""visual inspection"".
A) Then you just miss working tools. You must check that it actually oscillates, check voltages with a scope to ensure they are continuous and noise-free, and see if activity is going on the SPI line. 

Q) When you plug LAN cable, do the LINK/SPD LEDs turn on?
A) Then power is good, and W5100 is operational. Search for problems in SPI circuitry."
3312,5933,"TCP communication is successful

I don't understand UDP communication ...

Every time I send it with TCP, I know it's a port address and IP address.

Is the UDP no server or client concept?

If you set the UDP to the SOCKET function, the state register fell only into the UDP.

In that state, if you try to send it to the PC from the w5500 chip to the SendTo function, the chip will be a food.

I want to check with the Hercules program. What can I do? hello

TCP is only possible with Target and 1: 1 communication, while
The UDP is possible to transmit and receive different targets every time.
Hercules also has UDP communication.Open the port to the UDP and send the data from 5500 to that port. ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡?Ã¬Â´ÂÃªÂ¸Â°?ÂÃ­ÂÂÃªÂ³??Â´Ã«Â ÂÃªÂ²??ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂÃ«Â°ÂÃ­ÂÂ ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ¬ÂÂÃªÂ¹ÂÃ¬ÂÂ?
Hercules?ÂÃ«ÂÂ UDP ??ÂÂ??Ã«ÂªÂ¨Ã«ÂÂIP 192.168.1.43 ,?Â¬Ã­ÂÂ¸ 5000, Ã«Â¡ÂÃ¬Â»Â¬ ?Â¬Ã­ÂÂ¸ 5500
?Â´Ã«ÂÂÃªÂ³?Ã«Â¦Â¬Ã¬ÂÂ¨ ?ÂÃ«ÂÂ¬?ÂÃ¬? ?ÂÃ­ÂÂ?ÂÃ¬ÂÂ??

wiz_NetInfo gWIZNETINFO = { .mac = {0x30, 0x28, 0x6c, 0xa6, 0xad, 0xaf},
                            .ip = {192, 168, 1, 2},
                            .sn = {255, 255, 255, 0},
                            .gw = {192, 168, 1, 254},
                            .dns = {203, 248, 252, 2},
                            .dhcp = NETINFO_STATIC };

int main (void)
{
    uint8_t ipwnth[4]={192,168,1,43};     
    uint8_t sw2_key[12]={83,87,73,84,67,72,80,85,83,72,13,10};

    socket(0, Sn_MR_UDP, 5000, 0);

	while(1)
	{
		if(Check_Buttons_Pressed() == BUTTONS_BUTTON1)
		{
			sendto(0, sw2_key,12,ipwnth,5000);
		}
      }
} If you have Localport 5500 in Hercules,
Sendto should be written in port 5500. What IP is the module IP?
IP of my PC?IP saved in the W5500 chip?

And should IP of SendTo function factors be the IP of my PC?

What is the FIND feature of the UDP Setup tab in Hercules?
Do I have to search something to UDP?...

Thank you for helping from the morning ...
I'm sorry that I didn't have too much knowledge .. ?ÂÃ£ÂÂ ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

?Â°Ã¬ÂÂ  W5500?ÂÃ¬ÂÂ
Ã«Â§Â¨Ã¬Â²Â?ÂÃ¬ÂÂ
W5500???Â¤Ã­ÂÂ¸?ÂÃ­ÂÂ¬ ?ÂÃ«Â³Â´??ip, mac, subnet, gateway ?Â±Ã«ÂÂ±???Â¤Ã¬Â Â?Â©Ã«ÂÂ??
port??ÃªÂ²Â½Ã¬ÂÂ°?ÂÃ«ÂÂ socketÃ«Â³ÂÃ«Â¡Â ?Â¤Ã«Â¥Â´ÃªÂ²??Â¤Ã¬Â Â??ÃªÂ°??Â¥Ã­ÂÂÃªÂ¸Â°Ã«ÂÂÃ«Â¬Â¸Ã¬ÂÂ socket()?Â¨Ã¬ÂÂ?ÂÃ¬ÂÂ portÃ«Â¥?Ã¬Â§??ÂÃ­ÂÂ©?ÂÃ«ÂÂ¤.
sendto?ÂÃ¬ÂÂ???Â¤Ã«Â¡ÂÃ¬Â§? destination(?ÂÃ¬ÂÂ¬ÃªÂ²Â½Ã¬ÂÂ°PC)ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ«Â Â¥?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ??

[quote=""www, post:5, topic:5933""]
ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³?sendto ?Â¨Ã¬ÂÂ ?Â¸Ã¬ÂÂÃ¬Â¤ÂÃ¬ÂÂ ip????PC??IPÃ«Â¡??Â´Ã¬ÂÂ¼?ÂÃ«ÂÂ??
[/quote]
?Â°Ã«ÂÂ¼???ÂÃ¬ÂÂÃªÂ²Â½Ã¬ÂÂ° PC IPÃ«Â¡?Ã¬Â§??ÂÃ­ÂÂ´?Â¼Ã«ÂÂ?ÂÃªÂ²Â??Ã«Â§ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤



[quote=""www, post:5, topic:5933""]
hercules?ÂÃ¬ÂÂ??UDP SETUP??ÂÂ
[/quote]
?????Â´Ã«?Ã«Â¶ÂÃ¬? ?Â¬Ã¬ÂÂ©???ÂÃ­ÂÂ´??Ã«ÂªÂ¨Ã«Â¥Â´ÃªÂ²Â Ã¬ÂÂµ?ÂÃ«ÂÂ¤Ã«Â§?
Required parameters?ÂÃ¬ÂÂ ?Â´Ã«ÂÂ¹ ?ÂÃ«Â³Â´?Â¤Ã¬ÂÂ ?ÂÃ«Â Â¥?ÂÃªÂ³Â  Find devicesÃ«Â¥??ÂÃ«Â¥Â´Ã«Â©??Â´Ã«ÂÂ¹?ÂÃ«ÂÂ deviceÃªÂ°? ?ÂÃ«ÂÂÃ¬Â§? Ã¬Â°Â¾Ã«ÂÂÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤

UDP ?ÂµÃ¬ÂÂ ???ÂÃ«Â Â¤??ÃªÂ²ÂÃ¬ÂÂ´?ÂÃ«Â©Â´ UDP Setup ??Ã«Â§ÂÃªÂ³Â  UDP??ÂÂ??Listen?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ?? Ah ... I realized as soon as I saw the answer.thank you
Port and Local Port","Q) Is the UDP no server or client concept? If you set the UDP to the SOCKET function, the state register fell only into the UDP. In that state, if you try to send it to the PC from the w5500 chip to the SendTo function, the chip will be a food. What can I do? And should IP of SendTo function factors be the IP of my PC?
A) UDP does have the concept of server and client. In the case of the SendTo function, the IP in the parameters should be the IP of the destination PC. You can also use the Hercules program with the appropriate settings for UDP communication. Thank you for helping from the morning.

Q) If you have Localport 5500 in Hercules, Sendto should be written in port 5500. What IP is the module IP? IP of my PC?IP saved in the W5500 chip?
A) If the Localport in Hercules is set to 5500, the Sendto function should specify the same port (5500). The module IP is the IP saved in the W5500 chip, and the IP in the SendTo function should be the IP of the destination PC.

Q) What is the FIND feature of the UDP Setup tab in Hercules? Do I have to search something to UDP?
A) The FIND feature in the UDP Setup tab of Hercules allows you to search for devices to establish UDP communication. This feature helps in finding and establishing communication with the devices you want to interact with."
3313,5938,"In this document: https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:wiz610io:wiz610io_user_manual_v1.0.pdf on page 4 there is a pinout diagram of the WIZ610io module. It is incorrect. The pinouts in the Reference Schematic on page 14 look to be correct.

At the top of the page are 2 connector drawings. They are incorrect.
A little further down the page is a module graphic. It is incorrect as well. It does not match the connector drawing above it, and even if it did, that drawing is wrong.

Specifically:
J2 pin 1 is GND
J1 pin 3 is MOSI
J2 pin 6 is MISO Oh thank you.

I'll check it out and fix it.

Scott","Q) In this document: https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:wiz610io:wiz610io_user_manual_v1.0.pdf on page 4 there is a pinout diagram of the WIZ610io module. It is incorrect. The pinouts in the Reference Schematic on page 14 look to be correct. At the top of the page are 2 connector drawings. They are incorrect. A little further down the page is a module graphic. It is incorrect as well. It does not match the connector drawing above it, and even if it did, that drawing is wrong. Specifically: J2 pin 1 is GND J1 pin 3 is MOSI J2 pin 6 is MISO Oh thank you.
A) I'll check it out and fix it."
3314,594,"Hi,

I'm trying to set up a TCP connection from a w5500 to a local server. The socket seems to initialise fine, but when I issue the command to connect, the status register still says INIT. What does this mean? I would either expect it to closed or be established, based on the documentation. The interrupt register says that there is a timeout btw. Looks like it may have been some IP address issues. Seems to be working now. Does anyone know if there are any detailed and accurate schematics for the w5500io board? On a similar note ( I found the schematic I was after :slight_smile: ), does anyone know where I might be able to get a datasheet for the magjack used on the w5500io. The part num on the schematic is J1B1211CCD, but I can't find anything on it on the internet. Want to compare it with a UDE magjack I'm using to make sure I've wired it up right to a w5500 chip. I've got a UDE magjack with part no. RB1-125BAG1A, which shows the CT lines connected together within the transformer, so based on the schematics for the w5500io which shows them seperate and the TCT line pulled high, how would I go about connecting up the UDE magjack I have which has only the one CT line coming out? Ok, I've made some changes to my circuit and i now have it working with my UDE magjack :slight_smile: Hehe, but now I have another question/problem. I'm using the chip to establish a TCP connection to an FTP server. I've managed to establish the connection, and so would be expecting the server to send me back some sign-on banner of sorts. I've verified that the server does in fact do this using telnet, but for some reason, when I go to check my RX_RSR register, it says there is 0 bytes in my buffer instead of the 60 odd I'm expecting. Is there anything I need to do in between connecting and checking the register to make sure the chip is ready to receive the banner? Hi

Is status register(Sn_SR) SOCK_ESTABLISHED ??

If then, I recommend to test loopback from WIZnet reference code and AX1(PC program).

There are so many causes that you cannot receive any packet.

Best regards. Yes it says SOCK_ESTABLISHED. Where do I get the reference code and AX1 you mentioned? Is there any kind of write protect on the rx_rd and rx_wr registers? When I read from them, they return a value of 0, and if I write a value to them and try to then read it again, it still returns with a value of 0.... Can you also confirm that I am doing things right? I am setting up socket 0 as a tcp socket on port 4001. I'm then setting up the destination ip address and connecting to it. All this seems to work right as I can see the server receiving the connect request and responding. Is there anything else I need to do between connecting and looking in the RX buffer for a response? Hi,

You can download code and AX1 at wiznet.co.kr

There are all reference code each models, and search ax1 then you can download.

And I recommend to read W5500 datasheet, it is very helpful to you.

RX_RD pointer is updated after you do RECV command, RX_WR is increased automatically by data received. If status register is ESTABLISHED, your connection is success. Discovered what my receive problem was. Turns out the way I had configured my code, it wasn't sending the right values when I was setting up my buffers. Now works fine. Got another question now though with regards to using 2 sockets at the same time. I've got one socket configured as an ftp ctrl socket, and it works fine sending and receiving commands. When I try to open up another socket to use as a data socket, it opens up fine, connects to my ftp server fine, but if I then try to go back to my ctrl socket, it sends the message to my server but doesn't get anything in response to my command. Is there anything that could be going on with the chip or is this maybe an ftp server issue? [quote=""jdcowpland""]Discovered what my receive problem was. Turns out the way I had configured my code, it wasn't sending the right values when I was setting up my buffers. Now works fine. Got another question now though with regards to using 2 sockets at the same time. I've got one socket configured as an ftp ctrl socket, and it works fine sending and receiving commands. When I try to open up another socket to use as a data socket, it opens up fine, connects to my ftp server fine, but if I then try to go back to my ctrl socket, it sends the message to my server but doesn't get anything in response to my command. Is there anything that could be going on with the chip or is this maybe an ftp server issue?[/quote]

I suggest that you investigate the message exchange on the Ethernet by run Wireshark or Tcpdump, either on your ftp server or on a third box connected to a port mirroring switch. This way at least you know if something was received by the W5500.

Kind regards, Sebastian Hi,

I agree.

I want to know what packets are exchanged.
So, try to capture packets.

Then we could know W5500 has problem or server has problem or network has problem.

Best regards.","Q) I'm trying to set up a TCP connection from a w5500 to a local server. The socket seems to initialise fine, but when I issue the command to connect, the status register still says INIT. What does this mean? I would either expect it to closed or be established, based on the documentation. 
I've verified that the server does in fact do this using telnet, but for some reason, when I go to check my RX_RSR register, it says there is 0 bytes in my buffer instead of the 60 odd I'm expecting. Is there anything I need to do in between connecting and checking the register to make sure the chip is ready to receive the banner?
Is there any kind of write protect on the rx_rd and rx_wr registers? When I read from them, they return a value of 0, and if I write a value to them and try to then read it again, it still returns with a value of 0....

Where do I get the reference code and AX1 you mentioned?
Is there anything else I need to do between connecting and looking in the RX buffer for a response? 
I've got one socket configured as an ftp ctrl socket, and it works fine sending and receiving commands. When I try to open up another socket to use as a data socket, it opens up fine, connects to my ftp server fine. If I then try to go back to my ctrl socket, it sends the message to my server but doesn't get anything in response to my command. Is there anything that could be going on with the chip or is this maybe an ftp server issue?
A) If then, I recommend to test loopback from WIZnet reference code and AX1(PC program).
RX_RD pointer is updated after you do RECV command, RX_WR is increased automatically by data received. If status register is ESTABLISHED, your connection is success. 
You can download code and AX1 at wiznet.co.kr. There are all reference code each models, and search ax1 then you can download. 
I suggest that you investigate the message exchange on the Ethernet by run Wireshark or Tcpdump, either on your ftp server or on a third box connected to a port mirroring switch. This way at least you know if something was received by the W5500."
3315,5942,"[W5500] Please recommend transformer.

The H1102NLT specifications on the forum are not an industrial version.Temperature spect 0 ~ 70 degrees

I need an industrial version, but I wonder if you have experiments in the company.

On the data sheet, it seems to be only 1: 1, 350uh .....

So we selected 749013011 of Wurth Electronics.

please answer about my question. [quote = ""sangcheol_kim, post: 1, topic: 5942""]
5500] Please recommend transformer.

The H1102NLT specifications on the forum are not an industrial version.Temperature spect 0 ~ 70 degrees

I need an industrial version, but I wonder if you have experiments in the company.

On the data sheet, you only need to match 1: 1, 350Uh.

So we selected 749013011 of Wurth Electronics.

please answer about my question.
[/Quote]

hello~
I asked the hardware manager.
I will answer you tomorrow as soon as possible.

thank you
Irina Hello, this is Wiznet.

There is no transformer we recommend.

Only 1: 1, 350uh is required.

The selected transformer seems to be available.

thank you","Q) Please recommend transformer.
A) There is no transformer we recommend. Only 1: 1, 350uh is required. The selected transformer seems to be available."
3316,5944,"I am trying to work on 4 different WIZ750SR modules (2 of them are 110 and other 2 are TTL). I am finding it difficult to check all 4 of them on the wizconfig-V1.0.0 program simultaneously. The program window only shows any 2 devices at given time. Suppose all 4 of them are powered up and connected to the same network, now to configure, I need to first power down/disconnect two modules and then configure remaining ones. After first 2 devices are configured, I have to repeat the same process for the remaining two.

Is there any solution to view all of them simultaneously?

Am I doing something wrong?

Please advise. Hello @neo ,
Sorry for the late reply.

[quote=""neo, post:1, topic:5944""]
The program window only shows any 2 devices at given time. Suppose all 4 of them are powered up and connected to the same network,
[/quote]

I have never seen such a problem.

Wizconfig tool is implemented to detect all supported devices.
If devices are on the same network, all 4 devices must be searched.

I think the network environment seems to be the cause.
Can you capture network packets using wireshark? Hello @rena,

Thank you for your reply. I figured out the problem and it is exactly what you suggested. The devices were indeed on different address space. ","Q) Is there any solution to view all of them simultaneously?
Q) Am I doing something wrong?
A) The program window only shows any 2 devices at a given time because the devices were indeed on different address space. Wizconfig tool is implemented to detect all supported devices. If devices are on the same network, all 4 devices must be searched. I think the network environment seems to be the cause. Can you capture network packets using wireshark?"
3317,5946,"hello

If you look at the data sheet, the AGND/GND is separated.
We use AGND/GND using bead BLM18HE152SN1/1608/0.5A
It is planned to be separated.
Is it appropriate to connect to AGND after the 10 -pin Exres1 12.4K ohm to the W5500?
In the reference circuit, AGND hello

Repeated the same questions and answered the link below.
Please confirm.

https://forum.wiznet.io/t/topic/5948?u=lawrrence

thank you","Q) Is it appropriate to connect to AGND after the 10-pin Exres1 12.4K ohm to the W5500? 
A) If you look at the data sheet, the AGND/GND is separated. We use AGND/GND using bead BLM18HE152SN1/1608/0.5A. It is planned to be separated. In the reference circuit, AGND is connected, so it is appropriate to connect to AGND after the 10-pin Exres1 12.4K ohm to the W5500.

Q) Repeated the same questions and answered the link below. Please confirm. 
A) You can find the repeated questions and answers in the following link: [https://forum.wiznet.io/t/topic/5948?u=lawrrence]

Thank you."
3318,5948,"hello

W5500 will be used for circuit design.
Please contact us to remove the W5500 AGND/GND.

Internally, I decided to separate AGnd/GND by bead
In the forum article below, I will refer to the AGND/GND bead connection as a heating problem.
https://forum.wiznet.io/t/topic/3602/11

And the data sheet is divided into AGND/GND, but
In the reference circuit, the AGND/GND is connected to the GND without distinction.
Can you know why?

And please check if you are GND or AGND after 12.4K ohm 10 times in the W5500.

Please answer. Thank you. hello

The AGND mentioned in the contents of the reference forum is AGND in the shield module, not the AGND pin of the W5500.
Therefore, when designing the W5500, you can connect to the GND according to the schematic provided.

The AGND of the W5500 is a PIN associated with the internal PHY.In addition, PHY's reference is connected to GND, so we guide this.

You can also connect 10 pin to GND.

thank you","Q) Can you know why the AGND/GND in the reference circuit is connected to the GND without distinction?
A) The AGND mentioned in the contents of the reference forum is AGND in the shield module, not the AGND pin of the W5500. Therefore, when designing the W5500, you can connect to the GND according to the schematic provided.

Q) Please check if you are GND or AGND after 12.4K ohm 10 times in the W5500.
A) The AGND of the W5500 is a PIN associated with the internal PHY. In addition, PHY's reference is connected to GND, so we guide this. You can also connect 10 pin to GND."
3319,595,"hello.For the use of Wizfi630, please contact us as shown below.
This is an issue when introducing a product using the Wizfi630 to Japan.

1. We ask for the exact specification of Wi -Fi.Do you have any specifications other than Datasheet?

2. Please introduce the company's introduction of Wi-Fi developer.(It would be nice if a company with Japanese certification)

3. How far is the distance from one to different security, such as security equipped with Wi -Fi?
(It depends on the situation, but how much is the distance of Wi -Fi reception?)

4. How many Wi -Fi security can be controlled from the main server?
(Wi -Fi security, etc. play a role as a repeater?

  -The group ping optimal configuration method (unconditionally relay or grouping unit relay, etc.)

5. What is the distance with Wi -Fi security?We ask for a recommended distance.
(If you control with grouping, how much will you ask for each Wi -Pi security?)

6. If one or a group's Wi -Pi security, etc.
Is it possible to control other Wi -Fi security?
  (For example, if one or a few security, etc. are impossible to operate by an earthquake, I am curious about how to control other security.)
   -The same part as multi -set

Please answer fast.
take care hello

The answer to the following will be contacted in [Sales@wiznet.co.kr] (mailto: sales@wiznet.co.kr).","Q) We ask for the exact specification of Wi-Fi. Do you have any specifications other than the Datasheet?
A) We provide detailed Wi-Fi specifications in addition to the Datasheet. Please contact us at [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr) for more information.

Q) Please introduce the company's introduction of Wi-Fi developer. (It would be nice if a company with Japanese certification)
A) We can introduce Wi-Fi developers with Japanese certification. Please contact us at [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr) for further assistance.

Q) How far is the distance from one to different security, such as security equipped with Wi-Fi? (It depends on the situation, but how much is the distance of Wi-Fi reception?)
A) The distance of Wi-Fi reception depends on the specific situation. Please contact us at [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr) for information on Wi-Fi range and security equipment.

Q) How many Wi-Fi security can be controlled from the main server? (Wi-Fi security, etc. play a role as a repeater? -The group ping optimal configuration method - unconditionally relay or grouping unit relay, etc.)
A) The control and configuration of Wi-Fi security from the main server and its role as a repeater depend on specific setups. Please contact us at [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr) for detailed information.

Q) What is the distance with Wi-Fi security? We ask for a recommended distance. (If you control with grouping, how much will you ask for each Wi-Fi security?)
A) For information on the recommended distance and control with grouping for Wi-Fi security, please contact us at [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr) for personalized recommendations.

Q) If one or a group's Wi-Fi security, etc. Is it possible to control other Wi-Fi security? (For example, if one or a few security, etc. are impossible to operate by an earthquake, I am curious about how to control other security.) -The same part as multi-set
A) For inquiries about controlling Wi-Fi security in different situations, such as during an earthquake, please contact us at [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr) for tailored solutions."
3320,5950,"Hello, Rana_Uzair

Could I ask some network setting?
Are they same Switch between Uno to Switch and Due to Switch?
And Do you only connect Shield to PC via Switch? no other network like internet?
What about shield ip? do you fix them or use dhcp?
And What kind of communication do you use like UDP, TCP.. ?

Sorry, lots of question.. for me it is so strange too.

Thank you Alright thanks for your checking.

One thing could I know more about switch specific name ?
Because some how W5x00 affected by some switches like Cisco.
(And what if you change Uno and Due, then we can find what happens the problem.)

And If Link LED is flashing, could you fix the speed 100 or 10 from switch configuration tool ?

Thank you The switch is usual hub type unmanaged 5 port.
Hence the speed cannot be specified. 
The packages have been sealed so the shielda cannot be swaped in between uno and due. Could I know which model they are and which company they came from?

I could not get the point, it is packages. It does not matter it is package or not.

case1) package a (uno+shield) <--> switch a <--> pc :  work?
case2) package b (due+shield) <--> switch a <--> pc :  work?
case3) package a (uno+shield) <--> switch b <--> pc : work?
case4) package b (due+shield) <--> switch b <--> pc :  work?

I just want to check the switch is working well with W5100.

Thank you [quote=""Rana_Uzair, post:3, topic:5950""]
The shild?Âs IP for all are fixed, with different MAC addresses.
[/quote]

What are the MAC address, IP address, IP mask and gateway settings for both W5100 devices?","Q) Could I ask some network setting? Are they same Switch between Uno to Switch and Due to Switch? And Do you only connect Shield to PC via Switch? no other network like internet? What about shield ip? do you fix them or use dhcp? And What kind of communication do you use like UDP, TCP.. ?
A) The network settings vary depending on the connection. The Shield's IP for all are fixed, with different MAC addresses. The communication type used includes UDP and TCP. 

Q) One thing could I know more about switch specific name? Because somehow W5x00 affected by some switches like Cisco. (And what if you change Uno and Due, then we can find what happens the problem.) And If Link LED is flashing, could you fix the speed 100 or 10 from switch configuration tool ?
A) The switch is a usual hub type unmanaged 5 port, hence the speed cannot be specified. If the Link LED is flashing, the speed configuration from the switch configuration tool may not be applicable.

Q) Could I know which model they are and which company they came from?
A) The specifics of the switch model and the company they came from are not provided.

Q) case1) package a (uno+shield) <--> switch a <--> pc :  work? case2) package b (due+shield) <--> switch a <--> pc :  work? case3) package a (uno+shield) <--> switch b <--> pc : work? case4) package b (due+shield) <--> switch b <--> pc :  work? I just want to check the switch is working well with W5100.
A) The functionality of the different configurations with the switches is not clarified.

Q) What are the MAC address, IP address, IP mask and gateway settings for both W5100 devices?
A) Information on the MAC address, IP address, IP mask, and gateway settings for the W5100 devices is not provided."
3321,596,"I need this to setup as a client on an existing wifi network. The configuration on the webpage all seems to be designed to operate in bridge mode. Is there a guide on how to plug in the ssid and other parameters of the existing wifi I want it to connect to? As written in WIZ6000 web-page, WIZ6000 is made of WIZ610wi.
So, you had better refer to the below link.

[url]http://wiznet.co.kr/Sub_Modules/en/product/product_detail.asp?Refid=723&page=1&cate1=&cate2=&cate3=&pid=1020&cType=2[/url]

There may be some materials which will be helpful for you.","Q) Is there a guide on how to plug in the ssid and other parameters of the existing wifi I want it to connect to? 
A) As written in WIZ6000 web-page, WIZ6000 is made of WIZ610wi. So, you had better refer to the below link. [url]http://wiznet.co.kr/Sub_Modules/en/product/product_detail.asp?Refid=723&page=1&cate1=&cate2=&cate3=&pid=1020&cType=2[/url] There may be some materials which will be helpful for you."
3322,5961,"The situation
1. When you put the power, the power LED will come in and the Daplink window will appear.
2. When programming with daplink seems to be good.
3. Enter the boot mode (press the boot button and connect it) to connect it with ISP.
4. There is no problem when ISP gives the Verify After Programming option and writes the Write Main Flash.

5. In any case, the program is not executed and the board has no reaction.
6. There is no response to press the Reset button.

7. The board has begun to react strangely since I started writing Code Read Lock with ISP.Can I go wrong with this?
8. SYSCFG-> I changed the Resetop to 1.Can this cause a problem? The problem that the board did not respond was solved.It was a program problem.
And after setting up Code Read Lock with ISP, the problem that could not be reset was not solved.","Q) The board has begun to react strangely since I started writing Code Read Lock with ISP. Can I go wrong with this?
A) It's possible that writing Code Read Lock with ISP may have caused the board to react strangely.

Q) SYSCFG-> I changed the Resetop to 1. Can this cause a problem? 
A) Changing the Resetop to 1 might cause the board to not respond as expected.

Q) When you put the power, the power LED will come in and the Daplink window will appear. When programming with daplink seems to be good. Enter the boot mode (press the boot button and connect it) to connect it with ISP. There is no problem when ISP gives the Verify After Programming option and writes the Write Main Flash. In any case, the program is not executed and the board has no reaction. There is no response to press the Reset button. And after setting up Code Read Lock with ISP, the problem that could not be reset was not solved.
A) It seems like the board is not responding properly, despite the initial setup and programming with daplink. The issue persisting even after setting up Code Read Lock with ISP indicates a potential problem with the programming or configuration."
3323,5962,"Hello,

Our automated spam filter, [Akismet](https://akismet.com/), has temporarily hidden your post in *[W7500P] WIZWIKI W7500P Ã«Â³Â´Ã«ÂÂ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃªÂ²Â¼?ÂµÃ«ÂÂ??* for review.

A [staff member](https://forum.wiznet.io/about) will review your post soon, and it should appear shortly.

We apologize for the inconvenience. It has been solved.You can delete this article.","Q) Can I delete this article now? 
A) Yes, you can delete this article."
3324,5965,"Hello, in Wizfi310, I know that the Visian 1883 port can be connected to the server side with the security port 8883.
I wondered here, I think I need a certificate of X509 to connect to 8883.

In Wizfi310, there is a certificate inside the module itself, so I wonder if the 8883 port connection is possible.

(I would like to connect 8883 security with wired boards of WizNet.

That is all.
thank you hello

The WIFI module has a certificate in the storage space inside the module.

Wired products do not support TLS by default, so you need to use a separate TLS library. ÃÂ¾eÃÂ³ccxi, aacn ÃÂ± ÃÂ± ÃÂ¼.

A | ÃÂ° ÃÂ¡509 interestsÃÂ¼ÃÂ¸ |ÃÂ¸ÃÂ¸ÃÂ¼eÃÂ¾iÃÂºÃÂ¸ÃÂ´I, ÃÂ±aÃÂ°Ã¯Â¿?AoAÃÂ¤CIÃÂ´AÃÂ°O AOÃÂ´ÃÂ¸ÃÂ¼Ã¯Â¿Â¥ÃÂ¿a, ÃÂ±ÃÂÃÂ·ÃÂ³ wizfi ÃÂ¸ÃÂ°ÃÂ¼a ÃÂ³?Â«ÃÂºI AuAaÃÂ°ÃÂ¸ÃÂ°Ã¯Â¿Â¡ÃÂ¿Ã?AOÃÂ´A AIAoÃÂ¼ÃÂ´A AIAoÃÂ±ÃÂ° ÃÂ£ \ ÃÂ° of ÃÂ¼ÃÂ³ÃÂªs?ÃÂ¾ Vexie out rightÃÂ¼ ÃÂ° ÃÂ¡ÃÂ° ÃÂ»ÃÂ½ Nazco ÃÂ° ofÃÂ² ÃÂ¼u ÃÂ¼soÃÂ¾ÃÂ¿a?

And it is.

ÃÂ° ??the

Sand dissaw When I made a certificate of X509, there was a period of time, so what is the certificate in the Wizfi module's storage space?Or is the certificate updated?","Q) In Wizfi310, I know that the Visian 1883 port can be connected to the server side with the security port 8883. I wondered here, I think I need a certificate of X509 to connect to 8883. In Wizfi310, there is a certificate inside the module itself, so I wonder if the 8883 port connection is possible. (I would like to connect 8883 security with wired boards of WizNet. That is all. thank you hello. And it is. Sand dissaw When I made a certificate of X509, there was a period of time, so what is the certificate in the Wizfi module's storage space? Or is the certificate updated? 

A) The WIFI module has a certificate in the storage space inside the module. Wired products do not support TLS by default, so you need to use a separate TLS library."
3325,5967,"https://en.wikipedia.org/wiki/Death_by_coconut :slight_smile: That?Âs :sparkles: _emojitastic!_ :sparkles:

Sometimes you might want to get a person?Âs attention, even if you aren?Ât replying to them directly. Type `@` then complete their user name to mention them.

Can you mention **`@discobot`** in your reply? **`@discobot`** I don?Ât see my name in there anywhere :frowning: Can you try mentioning me as `@discobot` again?

(And yes, my user name is spelled _disco_, as in the 1970s dance craze. I do [love the nightlife!](https://www.youtube.com/watch?v=B_wGI3_sGf8) :dancer:) @discobot _Did someone say my name!?_ :raised_hand: I believe you did! :wave:  Well, here I am! Thanks for mentioning me.  :ok_hand:

Can you make some words **bold** or _italic_ in your reply?

- type `**bold**` or `_italic_`

- or, push the <kbd><b>B</b></kbd> or <kbd><i>I</i></kbd> buttons in the editor ** `@ discohjhjjjbbot` ** Great job! HTML and BBCode also work for formatting ? to learn more, [try this tutorial](http://commonmark.org/help) :nerd:

Can you try quoting me when you reply, so I know exactly which part you?Âre replying to?

> If this is coffee, please bring me some tea; but if this is tea, please bring me some coffee.
>
> One advantage of talking to yourself is that you know at least somebody?Âs listening.
>
> Some people have a way with words, and other people??oh, uh, not have way.

Select the text of whichever &uarr; quote you prefer, and then press the **Quote** button that pops up over your selection ? or the **Reply** button at the bottom of this post.

Below the quote, type a word or two about why you picked that one, because I?Âm curious :thinking: [quote=""discobot, post:12, topic:5967""]
Below the quote, type a word or two about why you picked that one
[/quote]

because this bores me Hey @itsonlyaudio, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start tutorial`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob: So :herb: Yay you found it :tada:

- For more detailed searches, head over to the [full search page](https://forum.wiznet.io/search).

- To jump anywhere in a long discussion, try the topic timeline controls on the right (and bottom, on mobile).

- If you have a physical :keyboard:, press <kbd>?</kbd> to view our handy keyboard shortcuts.","Q) Can you mention **`@discobot`** in your reply? **`@discobot`** I don?Ât see my name in there anywhere :frowning: Can you try mentioning me as `@discobot` again?
A) Well, here I am! Thanks for mentioning me.  :ok_hand:

Q) Can you make some words **bold** or _italic_ in your reply?
A) Great job! HTML and BBCode also work for formatting ? to learn more, [try this tutorial](http://commonmark.org/help) :nerd:

Q) Can you try quoting me when you reply, so I know exactly which part you?Âre replying to?
A) 

> If this is coffee, please bring me some tea; but if this is tea, please bring me some coffee.
>
> One advantage of talking to yourself is that you know at least somebody?Âs listening.
>
> Some people have a way with words, and other people??oh, uh, not have way.

because this bores me"
3326,5970,"hello.
 
 I was guided by the wire to contact us, but
 There is no related topic board, so please contact the open hardware.

 Run the remote example provided by the UI_flow and the LED BAR's ON/OFF is normal on the site connected through the barcode.

However, add the ""Add Remote ??Label ?? code to that code hello.

In this part, we must do the test.

I will answer after the test.

In addition, the UI-Flow part related to the M5Stack is not developed by WizNet, so the answer may be delayed.

If possible, you can get a faster answer by searching for Facebook's M5stack Korea User Group and posting on the community.(The M5Stack headquarters developer is involved in the community.)","Q) I was guided by the wire to contact us, but there is no related topic board, so please contact the open hardware. However, add the ""Add Remote ??Label ?? code to that code hello. In this part, we must do the test. Can you help with this? 
A) The UI-Flow part related to the M5Stack is not developed by WizNet, so the answer may be delayed. If possible, you can get a faster answer by searching for Facebook's M5stack Korea User Group and posting on the community. (The M5Stack headquarters developer is involved in the community.)"
3327,5973,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸?? ?Â¸Ãª?Ã¬Â§? ?Â¬Ã­ÂÂ­ Ã«Â¬Â¸Ã¬ÂÂ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

1. WIZ750SR??ISP TOOLÃ«Â¡??Â¤Ã¬ÂÂ´Ã«Â¡ÂÃ«ÂÂÃ«Â¥??ÂÃ«Â Â¤?ÂÃ«ÂÂ° ?Â´Ã¬ÂÂ?Â´Ã¬ÂÂ Ã«Â¬Â¸Ã¬ÂÂ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

ISP?Â´Ã¬? W7500_ISP_20180731.exeÃ«Â²ÂÃ¬Â Â???Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃªÂ³Â ??

binary?ÂÃ¬ÂÂ¼??
http://wizwiki.net/wiki/lib/exe/fetch.php?tok=7ebe52&media=https%3A%2F%2Fgithub.com%2FWiznet%2FWIZ750SR%2Freleases%2Fdownload%2Fv1.2.4%2FWIZ750SRv124_incl_Boot.bin
???ÂÃ«ÂÂ ?ÂÃ¬ÂÂ¼???Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

Serial Open CompleteÃªÂ¹ÂÃ¬? ?ÂÃ¬ÂÂ¸???ÂÃ¬ÂÂ binary ?Â¤Ã¬ÂÂ´Ã«Â¡ÂÃ«ÂÂÃ«Â¥??ÂÃ«Â Â¤?ÂÃ«ÂÂ°
Start Step5Ã«Â¥??ÂÃ«Â¥Â´Ã«Â©?loading memory Ã¬Â°Â½Ã¬ÂÂ´ ?Â¨ÃªÂ³Â  ÃªÂ±Â°Ã¬ÂÂ Ã«Â°ÂÃ«Â¡Â ?Â¤Ã¬ÂÂ´Ã«Â¡ÂÃ«ÂÂÃªÂ°? ?ÂÃ«Â£Â?ÂÃ«ÂÂ¤ÃªÂ³??Â¹Ã«ÂÂ??

ÃªÂ·Â¸Ã«ÂÂ°???Â¤Ã¬Â ÂÃ«Â¡ÂÃ«ÂÂ ?Â¤Ã¬ÂÂ´Ã«Â¡ÂÃ«ÂÂÃªÂ°? ?ÂÃ«ÂÂÃªÂ±Â¸Ã«Â¡Â Ã«Â³Â´Ã¬ÂÂ´?ÂÃ«ÂÂ°??

WIZnet S2E Configuration Tool?ÂÃ¬ÂÂ Ã«Â²ÂÃ¬Â Â??ÃªÂ·Â¸Ã«?Ã«Â¡ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.

?ÂÃ¬ÂÂ¬ verify after programming??Ã¬Â²Â´Ã­ÂÂ¬?ÂÃªÂ³Â  ?Â¤Ã¬ÂÂ ?Â¤Ã¬ÂÂ´Ã«Â¡ÂÃ«ÂÂ ?ÂÃ«ÂÂ?ÂÃ¬??ÂÃ«ÂÂ
[ERROR:200] Flash DumpÃªÂ°? ?Â¨ÃªÂ³Â  Fail to verifyÃªÂ°? ?Â¹Ã«ÂÂ??

unlock???ÂÃ¬ÂÂ?ÂÃª? ?Â¶Ã¬ÂÂ´ Step2,3,4Ã«Â¥??Â¸Ã«ÂÂ½?Â¼Ã«Â¡Â ?ÂÃªÂ³Â  ÃªÂ°??Â¤Ã­ÂÂ???Â¤Ã­ÂÂ?Â´Ã«Â´Â¤Ã¬Â§?Ã«Â§??ÂÃ«Â¬Â´??Ã¬Â°Â½Ã¬ÂÂ´ ?ÂÃ«ÂÂ¨?ÂÃªÂ±Â° Ã«Â´ÂÃ¬ÂÂ???ÂÃ¬ÂÂ???ÂÃ­ÂÂ?ÂÃªÂ²Â ÃªÂ°ÂÃªÂ³Â ??

WIZnet S2E Configuration Tool?ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¨???ÂÃ«Â¡Â?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ?Â©Ã«ÂÂ??



2.WIZnet S2E Configuration Tool???ÂÃ¬ÂÂ¤Ã¬Â½ÂÃ«ÂÂÃ«Â¥??Â¤Ã­ÂÂ?Â´Ã«ÂÂ?Â¨Ã«ÂÂ?????ÂÃ¬ÂÂ¤Ã¬Â½ÂÃ«ÂÂÃ«Â¥??ÂÃ¬Â Â?Â´Ã¬ÂÂ  ?Â¬Ã¬ÂÂ©???Â´Ã«ÂÂ ?ÂÃ«ÂÂÃ¬Â§???

ÃªÂ³Â ÃªÂ°Â?Â¬Ã¬ÂÂ ?Â¸Ã¬Â§Â ?Â´Ã«Â¡Â ?ÂÃªÂ³Âµ?ÂÃ«Â Â¤ÃªÂ³??Â©Ã«ÂÂ??

3. WIZnet S2E Configuration Tool ?ÂÃ¬ÂÂ¤ Ã¬Â½ÂÃ«ÂÂÃ«Â¥?Ã«Â°ÂÃ¬ÂÂ??Ã¬Â»Â´Ã­ÂÂ???ÂÃ«Â Â¤ÃªÂ³??ÂÃ«ÂÂ??Ã¬Â»Â´Ã­ÂÂ??Ã«ÂªÂÃ«Â Â¹?Â´Ã«? Ã«ÂªÂ¨Ã«Â¥Â´ÃªÂ²Â Ã«ÂÂ¤??. pipinstaller -F main_gui.pyÃ«Â¡??ÂÃ«ÂÂ???Â¤Ã­ÂÂ?ÂÃ¬ÂÂ¼???Â¤Ã­ÂÂ?ÂÃ«Â©Â´ ?ÂÃ«ÂÂ¬ÃªÂ°? ?ÂÃ«ÂÂ¤??

?ÂµÃ«? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? I made a 3.wiznet-s2e-tool-gui executable file.
Even though I did the same source code, the capacity is twice as large as the existing file.
Is there any way to reduce the capacity? Please make sure that the Rock is hanging in STEP 3 or 4 of the ISP Tool.
It would be nice to capture the program window. There is no way to reduce capacity at this time.
However, the capacity may vary depending on the type and version of the imported package, so it is good to check the installed package versions. I used a high version, but I'll try it in the version in Requirements.txt.

Pyinstaller confirmed that it was possible to use the latest version of 3.4.

The rest was run in the version in Requirements.txt.

The capacity is so small, but it's bigger than you distributed.

Can you know the versions of Python, Pyqt5, and ifadDr? [quote = ""fpain3, post: 7, topic: 5973""]
We connected the boot pin to the wiz750sr-ttl and connected it to the next VCC pin and the jumper.
[/Quote]
The description seems to be using the product in the form of a module, not EVB.
I tested it in the same conditions in my environment, but the phenomenon is not reproduced.

First of all, please reply after testing the contents below.
-Step 3,4 options are checked
-START STEP 3, 4, respectively, respectively
-Start all steps execution


[Quote = ""fpain3, POST: 8, Topic: 5973""]
Can you know the versions of Python, Pyqt5, and ifadDr?
[/Quote]
Pyinstaller is version 3.4.
PYQT5 and IFADDR are also the same as the version shown in Requirems.txt.
The Python version uses 3.6.4, and the capacity may have increased as the version of the basic packages rose.

Please refer to it. ? STEP 3,4 options can be released
? START STEP 3, 4, respectively
? Start All Steps Run

I've been to the part you mentioned, but there are no five wiz750sr-ttls you have.
Even if you run STEP 3,4, no window will appear.
Main Flash Dump function
I think the USB to TTL I have is a problem, but it seems that there is no problem when I saw it as a good use and the port Open was done normally.
What more parts should I check? ? STEP 3,4 options can be released
? START STEP 3, 4, respectively
? Start All Steps Run

I've been to the part you mentioned, but there are no five wiz750sr-ttls you have.
Even if you run STEP 3,4, no window will appear.
I tried to run Main Flash Dump.
 I think the USB to TTL I have is a problem, but it seems that there is no problem when I saw it as a good use and the port Open was done normally.
What more parts should I check? The USB to TTL configuration is connected to the 232 to TTL board, which is produced in-house on KW-825, a USB Toserial converter cable of Gangwon Electronics.
I usually have been using ST's ISP tools.
I tried to apply it to ST's ISP tool with the same configuration, but I confirmed that it would be good.
At this time, there is no way to implement another USB to TTL, so you need to buy it. hello.
I'm glad you solved it.
Because it was a UART communication, the Reset pin was not considered, but you connected it.Let's review the manual.

[Quote = ""fpain3, POST: 15, Topic: 5973""]
Start All STEPS The finished window is followed after the loading window after half of the bar is proceeded as shown below.
[/Quote]
Yes, when the completion window comes out, it is proceeded normally and you don't have to worry about the bar.

thank you","Q) WIZ750SR is not responding. How can I resolve this issue? 
A) The ISP tool seems to have failed while loading the memory. You may need to check the unlock steps and verify after programming. Additionally, the S2E Configuration Tool might be helpful to resolve this issue. 
Q) How can I reduce the capacity of the executable file generated using WIZnet S2E Configuration Tool? 
A) It's uncertain whether the capacity of the executable file can be reduced at this point. However, it's worth checking the installed package versions and trying different versions. 
Q) How can I know the versions of Python, Pyqt5, and ifadDr? 
A) The Python version used is 3.6.4, and the versions of Pyqt5 and ifadDr are the same as shown in Requirems.txt. 
A) The USB to TTL configuration is connected to the 232 to TTL board, which is produced in-house on KW-825, a USB to serial converter cable of Gangwon Electronics. 
Q) What should I check if the WIZ750SR-TTLs are not showing up even after running STEP 3,4? 
A) If the WIZ750SR-TTLs are not showing up, it might be necessary to consider the connection and configuration of the USB to TTL. It could also be useful to refer to the manual. 
A) When the completion window comes out, it is proceeded normally and you don't have to worry about the bar."
3328,5974,"hello.

WIZ550SR module KC certified product?
Please email related documents.
COOLLHC@com- pass.co.kr
thank you Hello, this is Wiznet.

The WIZ550SR is not certified by KC.

Since it is a module product, it is not certified.

thank you ","Q) WIZ550SR module KC certified product?
Please email related documents.
COOLLHC@com- pass.co.kr
thank you Hello, this is Wiznet.
A) The WIZ550SR is not certified by KC.
Since it is a module product, it is not certified."
3329,5978,"Currently, we are developing through 28377 and W5500.
CLK Bandwidth is set in 10MHz network and ping test works normally
If you are slower than this, there is no response, ""Request time has expired.""
Is it a W5500 problem?
Or please answer 28377. I'm sorry for late reply.
What is it like to set 10MHz?Are you talking about the SPI CLK for the W5500?
For example, if you set 10MHz with the SPI CLK of the W5500, it will turn around.

It is recommended to connect the board and PC in the W5500 and then test it.
Most of the problems with ping tests are often due to network settings.
If you tell me the network settings on the PC and the network settings in the W5500, you can respond faster.
(Each IP Address, Gateway, SubNet Mask ....)


thank you
Irina","Q) Is it a W5500 problem? Or please answer 28377. What is it like to set 10MHz? Are you talking about the SPI CLK for the W5500? 
A) It is recommended to connect the board and PC with the W5500 and then test it. Most of the problems with ping tests are often due to network settings. If you tell me the network settings on the PC and the network settings in the W5500, you can respond faster. 

Thank you."
3330,598,"How long is the length of SMA cable when using an external antenna in the Wizfi220 Module? I can't tell you that the length is supported because there are many variables depending on the type of antenna/cable.
In general, it is recommended to produce cables within tens of cm to do not have loss.","Q) How long is the length of SMA cable when using an external antenna in the Wizfi220 Module? 
A) I can't tell you that the length is supported because there are many variables depending on the type of antenna/cable. In general, it is recommended to produce cables within tens of cm to do not have loss."
3331,5987,"Hello,
I have a question.

The WizFi310 can handle multiple sockets separately ?
Reading data through way of query ?

Will Hi will71

WizFi310 supports multi sockets you need.

you can refer to following link.
https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310pg:start#example_-_ssl_connection","Q) The WizFi310 can handle multiple sockets separately? Reading data through way of query? 
A) WizFi310 supports multi sockets. You can refer to the following link for more information: https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310pg:start#example_-_ssl_connection"
3332,5989,"hello

Did you add Submodule?
IO6LIBRARY is made of submodule
Download the zip file as an aljang and download it separately and put it in the W6100EVB-HTTP_SERVER folder.
https://github.com/wiznet/IO6LIBRARY/tree/1A2CB294EDDDB64A78D9CFE9AF7D4BE4

If you downloaded Github, you can add submodule. Can I paste it anywhere? Yes, I confirmed it. thank you Hello, I'm a beginner.
wiz_netinfo gwiznetinfo = {.mac = {0x00,0x08,0xdc, 0xFF, 0xFF, 0xFF},
 .IP = {192,168,0,30},
 .gw = {192, 168, 0, 1}
 .dns = {168, 126, 63, 1},
 .lla = {0xfe, 0x80, 0x00,0x00,
 0x00,0x00, 0x00,0x00,
 0x02,0x00, 0xdc, 0xFF,
 0xFE, 0x57, 0x57,0x62},
The kit is the W6100EVB. Here, where IP = {192,168,0,30}, IP address of the IP address as an external labeling device (FND white top * 4) and the.IP can be changed.
 .IP = {192,168,0,30}, please explain where you can change the IP.
thank you How to unlock, how to modify network information, and how to lock it again.
please. ipÃ«Â¥?192,168,0,23?Â¼Ã«Â¡Â Ã«Â³?ÃªÂ²Â½Ã­ÂÂÃªÂ³Â Ã¬ÂÂ¶?Â¼Ã¬ÂÂ  ÃªÂ²Â½Ã¬ÂÂ°
  gWIZNETINFO.ip[0]=192;
  gWIZNETINFO.ip[1]=168;
  gWIZNETINFO.ip[2]=0;
  gWIZNETINFO.ip[3]=23;
  ctlwizchip(CW_SYS_UNLOCK,& syslock);
  ctlnetwork(CN_SET_NETINFO,&gWIZNETINFO);
?ÂÃ¬?ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ´Ã¬Â£Â¼Ã¬ÂÂÃ«Â©??Â©Ã«ÂÂ??
2641,4523.0,5989,11,Thank you hello.
As shown in the picture above, the W6100-EVB board is modified (Ethernet-related) and 16 LED LAMPs are controlled by on-site computers and Ethernet communication.
We plan to use LAMP 16 ON OFF and PWM values of the lamps to adjust the brightness on the computer.
In this regard, I would like to hear about the coding of the W6100-EVB and communication protocol coding. hello.
wiz_netinfo gwiznetinfo = {.mac = {0x00,0x08,0xdc, 0xFF, 0xFF, 0xFF},
.IP = {192,168,0,30},
.gw = {192, 168, 0, 1}
.dns = {168, 126, 63, 1},
I think there will be an input range of the above IP number, but please tell me the range of the number used as an IP address. hello.
wiz_netinfo gwiznetinfo = {.mac = {0x00,0x08,0xdc, 0xFF, 0xFF, 0xFF},
 .IP = {192,168,0,30},
 .gw = {192, 168, 0, 1}
 .dns = {168, 126, 63, 1},
I think there will be an input range of the above IP number, but please tell me the range of the number used as an IP address. The IPv4 address range is a total of 32bit address system of 8BIT X4, with a range of 0 to 255.
For more information, please search the Internet. I will all ask questions about the W6100-EVB.
You may be busy, but please answer me a good answer.
Thank you for always. STM32F103VT has been made to STM103ZET LQFP144.
It will be good, but there is no build error. hello

This is difficult to apply for ST boards. What I sent earlier is the original, which I added. [?ÂÃ«Â¥Â´?ÂÃ¬Â¤Â: W6100EVB-HTTP_Server-master (2).zip...]() ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??
Ã¬Â¶ÂÃª?????Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ???ÂÃ¬? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.?ÂÃ¬ÂÂ¸ Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??  

HAL_TIM_PWM_Start(&htim2,TIM_CHANNEL_1);
  HAL_TIM_Encoder_Start(&htim3,TIM_CHANNEL_1);
 HAL_TIM_Base_Start_IT(&htim4);
  HAL_TIM_Base_Start_IT(&htim5);

/* USER CODE BEGIN 0 */
void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)
{
	//HAL_GPIO_WritePin(GPIOB,lp1_Pin,1);

	//if(0 == HAL_GPIO_ReadPin(GPIOB,lp2_Pin))

	{
		if(htim->Instance == TIM4){HAL_GPIO_TogglePin(GPIOC,GPIO_PIN_9);}
		{
			//if(0 == HAL_GPIO_ReadPin(GPIOC,LP2_Pin))TIM4_100msCnt++;
			if(4<=TIM4_100msCnt){TIM4_100msCnt=0;}
		}
	}
	//if(GPIO_Pin == IP_Pin)



	cnt = TIM3->CNT;
//-----------------------------------------Ã¬Â²ÂÃ«ÂÂ¨???ÂÃ¬ÂÂ------------------------------------------
	cjs = cnt/1000;
	cjs1 = cnt - (cjs *1000);
//-----------------------------------------Ã«Â°Â±Ã«ÂÂ¨???ÂÃ¬ÂÂ------------------------------------------
	qor = cjs1/100;
	qor1 = cjs1 - (qor * 100);
//-----------------------------------------??ÂÂ ???ÂÃ¬ÂÂ------------------------------------------
	tlq = qor1/10;
	tlq1 = qor1 - (tlq * 10);
//-----------------------------------------?Â¼Ã«ÂÂ¨???ÂÃ¬ÂÂ------------------------------------------
	dlf = tlq1/1;
//-----------------------------------------????Ã«Â°?Ã¬Â²??Â¨Ã¬ÂÂ GPIO reset---------------------------
	HAL_GPIO_WritePin(GPIOC,S0_Pin,0);
	HAL_GPIO_WritePin(GPIOC,S1_Pin,0);
	HAL_GPIO_WritePin(GPIOC,S2_Pin,0);
	HAL_GPIO_WritePin(GPIOC,S3_Pin,0);
//-----------------------------------------0,1,2,3,4,5,6,7,8,9 GPIO set---------------------
	HAL_GPIO_WritePin(GPIOE, A_Pin|B_Pin|C_Pin|D_Pin|E_Pin|F_Pin|G_Pin, GPIO_PIN_SET);


//-----------------------------------------TIME5 counter FND ?ÂÃ¬Â°Â¨?ÂÃ¬ÂÂ ?Â¸Ã«ÂÂ?Â½Ã­ÂÂ¸--------------------
	if(htim->Instance == TIM5)
	{
		if((1<TIM3->CNT)|(1999>TIM3->CNT))
		if(1>TIM3->CNT){TIM3->CNT = 0;}
		if(1999<TIM3->CNT){TIM3->CNT = 1999;}
		TIM2->CCR1 = TIM3->CNT; hello
The code part is cut off, making it difficult to check.
Please check the entire part of main.c, not just the additional part. The code sent above is the code run on the W6100-EVB board.
Please coding only one counter at the W6100-EVB. thank you so much.
I hope to go along well. Until now, we have supported the parts that are not related to our chips
In the future, it will be possible to support the parts that are not related to our chips.
thank you How much is it? hello
Please contact Kim Yeon -seop for inquiries about the development service.
Email: jameskim@wiznet.io
thank you hello

Module IP has 192,168,0,13 in the few. The last IP is the same. In Hercules, Module IP should be written as a period, not a comma. ah !Thank you for the end.
Where is the IP re -setting part here? hello.
What are you talking about?

thank you
Irina hello.

It means to set the IP 192.168.0.13 to 192.168.0.20.

thank you ","Q) Did you add Submodule? Can I paste it anywhere?
A) IO6LIBRARY is made of submodule. The zip file should be downloaded separately and put in the W6100EVB-HTTP_SERVER folder. If you downloaded Github, you can add submodule. As for pasting it anywhere, yes, I confirmed it.

Q) Please explain where you can change the IP.
A) The .IP = {192,168,0,30} in the code can be changed. 

Q) I think there will be an input range of the above IP number, but please tell me the range of the number used as an IP address.
A) The IPv4 address range is a total of 32bit address system of 8BIT X4, with a range of 0 to 255. For more information, please search the Internet.

Q) How to unlock, how to modify network information, and how to lock it again.
A) To unlock and modify the network information, and to lock it again, you can use the following sequence:
gWIZNETINFO.ip[0]=192; gWIZNETINFO.ip[1]=168; gWIZNETINFO.ip[2]=0; gWIZNETINFO.ip[3]=23; ctlwizchip(CW_SYS_UNLOCK,& syslock); ctlnetwork(CN_SET_NETINFO,&gWIZNETINFO);

Q) Where is the IP re-setting part here?
A) The IP re-setting part is not present in the given context.

Q) How much is it?
A) Please contact Kim Yeon-seop for inquiries about the development service. Email: jameskim@wiznet.io. 

Q) Module IP has 192,168,0,13 in the few. The last IP is the same. In Hercules, Module IP should be written as a period, not a comma.
A) The IP should be written using periods, not commas as in 192.168.0.13. 

Q) It means to set the IP 192.168.0.13 to 192.168.0.20.
A) Understood.

A) You may be busy, but please answer me a good answer. Thank you for always. It will be good, but there is no build error. This is difficult to apply for ST boards. What I sent earlier is the original, which I added.  

(Non-response)"
3333,5990,": Then:
https://en.wikipedia.org/wiki/inherently_funny_Word :australia: :nerd_face: That?Âs :sparkles: _emojitastic!_ :sparkles:

Sometimes you might want to get a person?Âs attention, even if you aren?Ât replying to them directly. Type `@` then complete their user name to mention them.

Can you mention **`@discobot`** in your reply? @discobot, I kind of like this tutorial style - but how long is it? _Did someone say my name!?_ :raised_hand: I believe you did! :wave:  Well, here I am! Thanks for mentioning me.  :ok_hand:

Can you make some words **bold** or _italic_ in your reply?

- type `**bold**` or `_italic_`

- or, push the <kbd><b>B</b></kbd> or <kbd><i>I</i></kbd> buttons in the editor Like I asked: _how_ **long** is this? Great job! HTML and BBCode also work for formatting ? to learn more, [try this tutorial](http://commonmark.org/help) :nerd:

Can you try quoting me when you reply, so I know exactly which part you?Âre replying to?

> If this is coffee, please bring me some tea; but if this is tea, please bring me some coffee.
>
> One advantage of talking to yourself is that you know at least somebody?Âs listening.
>
> Some people have a way with words, and other people??oh, uh, not have way.

Select the text of whichever &uarr; quote you prefer, and then press the **Quote** button that pops up over your selection ? or the **Reply** button at the bottom of this post.

Below the quote, type a word or two about why you picked that one, because I?Âm curious :thinking: [quote=""discobot, post:10, topic:5990""]
Some people have a way with words, and other people??oh, uh, not have way.
[/quote]

I'm a proof-reader, and I empathise with this completely! Here you go: :herb: Yay you found it :tada:

- For more detailed searches, head over to the [full search page](https://forum.wiznet.io/search).

- To jump anywhere in a long discussion, try the topic timeline controls on the right (and bottom, on mobile).

- If you have a physical :keyboard:, press <kbd>?</kbd> to view our handy keyboard shortcuts.","Q) Can you mention **`@discobot`** in your reply?
A) @discobot, I kind of like this tutorial style - but how long is it?

Q) Can you make some words **bold** or _italic_ in your reply?
A) Yes, I can make some words **bold** or _italic_.

Q) Can you try quoting me when you reply, so I know exactly which part you’re replying to?
A) If this is coffee, please bring me some tea; but if this is tea, please bring me some coffee.

Q) I'm a proof-reader, and I empathise with this completely! Here you go: :herb: Yay you found it :tada:
A) None."
3334,5992,"I have a requirement for a tiny, _tiny_ module. WIZnet make the W5500 chip, the W7100A chip, and the (even better) W7500P chip with on-board PHY. They are interesting chips because they are 64QFN 7mmÃÂ² - _**tiny**_! I want this so small that I might not even use a MAGJACK: I could solder UTP direct to the circuit board.

To describe my requirements, I will go back to first principles:

1. Here is a Device connected to a PC with Ethernet:

        +-----+                       +----+
        | Dev | ===================== | PC |
        +-----+                       +----+
1. Here is the same Device connected to the same PC with Ethernet-to-Serial (E2S) and Serial-to-Ethernet (S2E) adapters (with cross-over cable). The Device and PC only ""see"" that the link is now slower:

        +----+    +-----+     +-----+    +----+
        | Dev| == | E2S | -X- | S2E | == | PC |
        +----+    +-----+     +-----+    +----+
   Yes, the E2S and S2E adapters are identical, just pointing the opposite way! I was going to use W7500Ps for this.

1. And here is what I need:

        +-----+    +-----+    +-------+       +-------+    +-----+    +----+
        | Dev | == | E2S | -- | Radio | . . . | Radio | -- | S2E | == | PC |
        +-----+    +-----+    +-------+       +-------+    +-----+    +----+
I have the radios, but they are already _nearly_ too large, so I need the E2S/S2E to be _**tiny**_! I also do not need them to understand TCP/IP (which WIZnet chips can - but I can use their MACRAW mode).

I can easily write firmware that:
* On Ethernet RX, convert packets to a PPP-like payload and send them out the (TTL) UART;
* On UART RX, convert them _from_ PPP and send them to the Ethernet.

I do not need any of the high-level PPP protocol: no LCP; no authentication; no multilink. All I need is the HDLC-like framing, since I will only be talking to other identical devices on the same radio net. But that means that I need to program the firmware, and I don't believe that I can reprogram the WIZ610io / WIZ810Sio / WIZ850io cores?

To be clear: this is _NOT_ a PPPoE system, and nor does it need to be. It is exactly the reverse: the Ethernet Device and PC don't ""know"" that the ""cable"" is in fact a serial Radio link.

Although any hardwired TCP/IP chip is overkill, WIZnet chips are small (I could only find 100-pin alternatives). I was going to use the W7100A (I've programmed 8051s for years), but the PHY on the W7500P is attractive (and I've programmed Cortex M chips before). Dear JohnAdrain!

I have understood what you need is small S2E module and What you are interrested in is W7500P.


So, I will recommend pre-programmed iMCU - W7500P-S2E. 
WIZnet sells W7500P-S2E for people who make small or own module such like you. 


For more detail, refer to https://wizwiki.net/wiki/doku.php?id=products:w7500x-s2e:start.

Thank you.","Q) What are the interesting chips made by WIZnet? 
A) WIZnet makes the W5500 chip, the W7100A chip, and the (even better) W7500P chip with on-board PHY. They are 64QFN 7mm² - tiny!

Q) Can the WIZnet chips understand TCP/IP? 
A) WIZnet chips can understand TCP/IP, but you can use their MACRAW mode if not needed.

Q) Can the WIZ610io / WIZ810Sio / WIZ850io cores be reprogrammed? 
A) The WIZ610io / WIZ810Sio / WIZ850io cores cannot be reprogrammed.

Q) What is recommended for a small S2E module? 
A) I will recommend pre-programmed iMCU - W7500P-S2E.

Q) Where can I find more details about W7500P-S2E? 
A) For more detail, refer to https://wizwiki.net/wiki/doku.php?id=products:w7500x-s2e:start."
3335,600,"hi 

I have one issue at my hend ... 
-I configure TCP protocol and everything else 
-than issue OPEN socket command 
at this point [b]Sn_TX_RD[/b] gets written with some number ussualy > 1k, but the [b]Sn_TX_WR[/b]  is 0
-after issue CONNECT command  [b]Sn_TX_WR[/b]  have the same value as [b]Sn_TX_RD[/b] 

is this normal ???

after that if i issue SEND command ..even i do not write anything i receive >1k of data on on the server?
if i write some data to TX memory and send it, i receive this data + some garbage data from before 

any idea ?

regards zorz Hi,

Sn_TX_WR is changed after the send command is successfully executed to Sn_CR.
With the SEND command of Socket n Command Register, it transmits data from the current Sn_TX_RD to the Sn_TX_WR and automatically updates after transmission is finished. 
Therefore, after transmission is finished, Sn_TX_RD and Sn_TX_WR will have the same value.

thanks :slight_smile:","Q) Is this normal? After that, if I issue SEND command, even if I do not write anything, I receive >1k of data on the server?
Any idea?

A) Sn_TX_WR is changed after the send command is successfully executed to Sn_CR. With the SEND command of Socket n Command Register, it transmits data from the current Sn_TX_RD to the Sn_TX_WR and automatically updates after transmission is finished. Therefore, after transmission is finished, Sn_TX_RD and Sn_TX_WR will have the same value."
3336,6001,"hello.

It seems that there was an error in the process of updating the function of the CLI Tool before.

We have updated the revised version to Github, so please test it.
* [WizNet-S2E-Tool V1.1.2 Release] (https://github.com/wiznet/wiznet-s2e-tag/tag/v1.1.2)

thank you I was late for the test.
It works well.
thank you ","Q) It seems that there was an error in the process of updating the function of the CLI Tool before. We have updated the revised version to Github, so please test it.
A) thank you I was late for the test. It works well."
3337,6004,"[quote=""Caspar, post:1, topic:6004""]
I am using the MSP430F5529LP to connect with the wiz550io over SPI. Now I have the following problem. The wiz550io keeps sending the following bytes 0x01, 0x02, 0x03. see the picture
[/quote]

Hi ~ Caspar

It has sending the bytes 0x01,0x02,0x03 and this operation is right. We did designed it that it has sending sequential data than meaningless data.

thanks
BR
irina Hi Kim, 

I'm not sure if I understand correctly what you mean.  So it first sends the data and after that it sends 3 dummy bytes or it sends dummy bytes when it doesn't receive anything over the MOSI? [quote=""Caspar, post:3, topic:6004""]
So it first sends the data and after that it sends 3 dummy bytes or it sends dummy bytes when it doesn?Ât receive anything over the MOSI?
[/quote]

Hi Caspar

W5500 SPI Frame is sending the 4bytes for data  write operation or read operation.
If it operates 1byte  data writing, MOSI has sending ADDH,ADDL,OP,DATA sequentially and MISO also has sending 0x1,0x2,0x3 sequentially.

That all operation(MOSI, MISO) has run concurrently.


thanks,
BR
irina","Q) I am using the MSP430F5529LP to connect with the wiz550io over SPI. Now I have the following problem. The wiz550io keeps sending the following bytes 0x01, 0x02, 0x03. see the picture.
A) It has sending the bytes 0x01,0x02,0x03 and this operation is right. We did design it to send sequential data than meaningless data. 
Q) So it first sends the data and after that it sends 3 dummy bytes or it sends dummy bytes when it doesn’t receive anything over the MOSI?
A) W5500 SPI Frame is sending the 4 bytes for data write operation or read operation. If it operates 1 byte data writing, MOSI has sending ADDH, ADDL, OP, DATA sequentially and MISO also has sending 0x1, 0x2, 0x3 sequentially. That all operation (MOSI, MISO) has run concurrently."
3338,6006,"CAT.M1 Module WD-N400S is connected to Arduino and is being tested.

It repeats a series of processes of sending data once and terminating the access after connecting to TCP socket.

If the same code was tested with WiFi, I checked the normal operation, but the delay function is not eaten because I use the M1 module.

If you don't have a delay between the AT phrases, the data is not displayed, so there's a problem with debugging. What should I do? hello.
I'm sorry for the late answer.

The CAT.M1 external modem I contacted is a product that sends and receives serial data from Arduino, and when I receive data from Arduino, I only perform the operation according to that command.
Therefore, I think that the part that does not apply the delay function in the Arduino source code is the source code problem.

If you are still unresolved, if you tell me the source code, you will be able to give you more accurate information.

thank you","Q) What should I do if the delay function is not working with the CAT.M1 module when testing with WiFi?
A) The CAT.M1 external modem I contacted is a product that sends and receives serial data from Arduino, and when I receive data from Arduino, I only perform the operation according to that command. Therefore, I think that the part that does not apply the delay function in the Arduino source code is the source code problem. If you are still unresolved, if you tell me the source code, you will be able to give you more accurate information."
3339,6011,"I'm using a port of the Wiznet ioLibrary driver (from here: https://github.com/Wiznet/ioLibrary_Driver), running on a Cypress PSoC.

When receiving a UDP packet (actually a DHCP packet) in the socket.c function recvfrom I'm encountering a scenario where the header is corrupt (or the RX pointer is pointing to something that is not the head of the message). In any case the result is that the pack_len is some random number depending on what point of the packet it happens to land. In my case that random number is very big, which of course is larger than the buffer I'm writing to and therefore destroys a bunch of memory and crashes the application. 

One solution is to implement the packet length check that's eluded to in the comment immediately before reading the RX buffer that says ""//Need to packet length check"" (or check if the IP and port in the header are valid) but that raises 2 questions: 

1) If I run that test what do we do if we encounter and invalid value, there's no way to flush the buffer and start over and if I read the entire buffer I risk never getting the pointer back to the head of the UDP message.

2) How could this be happening in the first place? This library is pretty old and presumably used by others so I'd be surprised if something like this had been missed if it happened frequently.

For what it's worth this only happens when I'm running an application that handles a large number of TCP packets on a different socket and even then it only happens after a few minutes/hours of runtime, so it's inconsistent. The DHCP packets only come in every minute or so, is it possible that something else is actually stomping on the RX pointer or RX buffer (in the W5500) for this socket? [quote=""eng101, post:1, topic:6011""]
...In any case the result is that the pack_len is some random number depending on what point of the packet it happens to land. In my case that random number is very big, which of course is larger than the buffer I?Âm writing to and therefore destroys a bunch of memory and crashes the application.
[/quote]
I can't see how the problem could happen as you described.  If the buffer length (len) is less than sock_remained_size[sn], then pack_len = len, otherwise, pack_len = sock_remained_size[sn]. Can you add a console printf to make sure the contents of sock_remained_size[sn] is reasonable after this 16-bit value has been loaded from head[6] and head[7]? But because the initial read does not read the correct location I'm not reading the actual header but rather some random location in the RX buffer. Therefore head[6] and head [7] don't contain the actual length of the packet but rather random data from within the RX buffer. Even the header read is wrong, how can it ""...destroys a bunch of memory and crashes the application..."" as you have claimed? You control the size of the receive buffer.  I don't see how  recvfrom() can put more data into the buffer than you have allocated. Duh, you are correct in that, I read that piece of code a bunch of times and for some reason thought it was doing the opposite. Well that's what I get for trying to debug on a Friday afternoon!! 

It looks like in the DHCP code the message buffer size, RIP_MSG_SIZE isn't big enough to hold the entire buffer, that has never been an issue before though, hmm. I'm going to have to step through that code when I'm back at the bench again on Monday to see what's going on. [quote=""eng101, post:3, topic:6011""]
But because the initial read does not read the correct location I?Âm not reading the actual header but rather some random location in the RX buffer.
[/quote]

Do you read RX buffer pointer every time before accessing RX buffer, or use your own cached value? [quote=""eng101, post:7, topic:6011""]
I can?Ât see the actual length returned from that read
[/quote]

I am afraid we need more details. You must perform log of the packets using Wireshark, and perform log of all socket operations from your processor/MCU (packet sizes, RX/TX pointers).

[quote=""eng101, post:7, topic:6011""]
The only place I can see where there should be another check is in the parseDHCPMSG function where it reads the size of the data in the RX buffer (using the getSn_RX_RSR macro) and then attempts to read in that much data regardless of whether or not it will fit in the allocated DHCP message buffer (which isn?Ât big enough to read the entire W5500 RX buffer).
[/quote]

Looking into the [code of parseDHCPMSG](https://github.com/Wiznet/W5500_EVB/blob/master/ioLibrary/Internet/DHCP/dhcp.c) I see it uses buffer `pDHCPMSG`, and is expected to read whole DHCP message.

You must catch which library routine has pointers corrupt, and then consider it for exceptions/bugs.

[quote=""eng101, post:7, topic:6011""]
Unfortunately stepping through the code isn?Ât an option as it takes a long time for this bug to show up.
[/quote]

But you can log required information to trace the operation? [quote=""eng101, post:7, topic:6011""]
The only place I can see where there should be another check is in the parseDHCPMSG function where it reads the size of the data in the RX buffer (using the getSn_RX_RSR macro) and then attempts to read in that much data regardless of whether or not it will fit in the allocated DHCP message buffer (which isn?Ât big enough to read the entire W5500 RX buffer).
[/quote]
W5500 can support up to 8 sockets and each socket's RX and TX buffers are 2KB by default.  The DHCP buffer is initialized by DHCP_init(). The library allocates a 2KB buffer for DHCP.

    #define DATA_BUF_SIZE   2048
    uint8_t gDATABUF[DATA_BUF_SIZE];

    ...
    	/* DHCP client Initialization */
    	if(gWIZNETINFO.dhcp == NETINFO_DHCP)
    	{
    		DHCP_init(SOCK_DHCP, gDATABUF);
    		// if you want different action instead default ip assign, update, conflict.
    		// if cbfunc == 0, act as default.
    		reg_dhcp_cbfunc(my_ip_assign, my_ip_assign, my_ip_conflict);

    		run_user_applications = false; 	// flag for running user's code
    	}
If everything is default, the maximum size getSn_RX_RSR() can return is 2KB. I still don't see how the buffer overflow could occur unless you have memory corruption elsewhere. Ok I see that now. Since the DHCP buffer is just a pointer to a RIP_MSG type I defined it to be of size RIP_MSG_SIZE, assuming that the type we were using was large enough to hold the entire buffer, I realised in debugging that it was not which is why I mentioned that the DHCP buffer wasn't large enough. 

FWIW I was able to read the value returned by getSn_RX_RSR and the debugger was indicating a value of 0xFFF8 in that register. I don't think it's possible for that to be a real response from the W5500 so I have to assume the entire stack and memory is corrupt by the time I get to it after a fault condition.

Further testing indicates this only happens in a very narrow use case for the device so I suspect the actual cause might be elsewhere in the code although it is still odd that it fails during a DHCP read, possibly a buffer stored in adjacent memory. [quote=""eng101, post:10, topic:6011""]
... I was able to read the value returned by getSn_RX_RSR and the debugger was indicating a value of 0xFFF8 in that register....
[/quote]
This is interesting and maybe Eugeny can help - I don't know how the W5500 internal receive buffer operates. According to the comment in w5500.h

    /**
     * @ingroup Socket_register_group
     * @brief Received data size register(R)
     * @details @ref Sn_RX_RSR indicates the data size received and saved in Socket n RX Buffer.
     * @ref Sn_RX_RSR does not exceed the @ref Sn_RXBUF_SIZE and is calculated as the difference between
     * iÃÂ¿ÃÂ½Socket n RX Write Pointer (@ref Sn_RX_WR)and iÃÂ¿ÃÂ½Socket n RX Read Pointer (@ref Sn_RX_RD)
     */
    #define Sn_RX_RSR(N)       (_W5500_IO_BASE_ + (0x0026 << 8) + (WIZCHIP_SREG_BLOCK(N) << 3))

So what happens if the RX write pointer wraps around? The number 0xFFF8 could simply be a (-6), indicating a buffer overrun situation.  

What is this ""very narrow use case"" if you don't mind sharing? Also, are you using non-blocking mode (SF_IO_NONBLOCK) for TCP sockets?","Q) If I run that test what do we do if we encounter an invalid value, there's no way to flush the buffer and start over and if I read the entire buffer I risk never getting the pointer back to the head of the UDP message. How could this be happening in the first place? This library is pretty old and presumably used by others so I'd be surprised if something like this had been missed if it happened frequently. Is it possible that something else is actually stomping on the RX pointer or RX buffer (in the W5500) for this socket? Do you read RX buffer pointer every time before accessing RX buffer, or use your own cached value?
A) Unfortunately, stepping through the code isn’t an option as it takes a long time for this bug to show up. W5500 can support up to 8 sockets and each socket's RX and TX buffers are 2KB by default. The DHCP buffer is initialized by DHCP_init(). The library allocates a 2KB buffer for DHCP. If everything is default, the maximum size getSn_RX_RSR() can return is 2KB. I still don't see how the buffer overflow could occur unless you have memory corruption elsewhere. This is interesting and maybe Eugeny can help - I don't know how the W5500 internal receive buffer operates. According to the comment in w5500.h, the RX buffer size is calculated as the difference between Socket n RX Write Pointer (Sn_RX_WR) and Socket n RX Read Pointer (Sn_RX_RD).

Q) How could this be happening in the first place? This library is pretty old and presumably used by others so I'd be surprised if something like this had been missed if it happened frequently.
A) I can't see how the problem could happen as you described. If the buffer length (len) is less than sock_remained_size[sn], then pack_len = len, otherwise, pack_len = sock_remained_size[sn]. Can you add a console printf to make sure the contents of sock_remained_size[sn] is reasonable after this 16-bit value has been loaded from head[6] and head[7]? But because the initial read does not read the correct location, I'm not reading the actual header but rather some random location in the RX buffer. Therefore, head[6] and head[7] don't contain the actual length of the packet but rather random data from within the RX buffer. Even the header read is wrong, how can it ""...destroys a bunch of memory and crashes the application..."" as you have claimed? You control the size of the receive buffer. I don't see how recvfrom() can put more data into the buffer than you have allocated. Duh, you are correct in that, I read that piece of code a bunch of times and for some reason thought it was doing the opposite. Well that's what I get for trying to debug on a Friday afternoon!!

Q) How could this be happening in the first place? This library is pretty old and presumably used by others so I'd be surprised if something like this had been missed if it happened frequently.
A) Ok, I see that now. Since the DHCP buffer is just a pointer to a RIP_MSG type I defined it to be of size RIP_MSG_SIZE, assuming that the type we were using was large enough to hold the entire buffer, I realized in debugging that it was not which is why I mentioned that the DHCP buffer wasn't large enough. Further testing indicates this only happens in a very narrow use case for the device so I suspect the actual cause might be elsewhere in the code although it is still odd that it fails during a DHCP read, possibly a buffer stored in adjacent memory. The only place I can see where there should be another check is in the parseDHCPMSG function where it reads the size of the data in the RX buffer (using the getSn_RX_RSR macro) and then attempts to read in that much data regardless of whether or not it will fit in the allocated DHCP message buffer (which isn't big enough to read the entire W5500 RX buffer). I'm going to have to step through that code when I'm back at the bench again on Monday to see what's going on. I was able to read the value returned by getSn_RX_RSR and the debugger was indicating a value of 0xFFF8 in that register. I don't think it's possible for that to be a real response from the W5500, so I have to assume the entire stack and memory is corrupt by the time I get to it after a fault condition."
3340,6014,"[WIZFI250] When connected to STM32F765, the UART setting of STM is an IDLE LINE DETECTION, there is a phenomenon in which the serial data of the wizfi250 is cut in the middle.Can't you be? Please explain more about the phenomenon that mentioned below.

(Although it may vary depending on the MCU) Wizfi250, if it is 115200's Baud Rate, the loss of the serial data did not occur.

Please explain in detail what is the meaning of ""breaking in the middle"" or ""no data."" While communicating with IDLE LINE DETECTION, I read the data when I received one data (10 or 100 data lengths) and let me recognize the time without data.In the case of Wizfi250, the STM was cut off and recognized.Hihihi is coming in.There is no loss of data.It may have been wrong to say that you can't get it in a row than to break it, but I didn't know how to express it. In the transmission of serial data, this situation should be common.
This is difficult to see as a problem of the Wizfi250, and strictly speaking, it is irrelevant to the Idle-line-Detection.

Even if the Wizfi250 sends ""12345"" data in a row,
Depending on the operation situation of the STM MCU
  ""1 2 3 4 5""
  "" 1 2 3 4 5""
  ""1 2 3 4 5""
It should be considered to be variously received.","Q) When connected to STM32F765, the UART setting of STM is an IDLE LINE DETECTION, there is a phenomenon in which the serial data of the wizfi250 is cut in the middle.Can't you be? Please explain more about the phenomenon that mentioned below.
Please explain in detail what is the meaning of ""breaking in the middle"" or ""no data.""

A) It seems like the issue you are facing is related to the way the serial data is being received and processed by the STM MCU when using IDLE LINE DETECTION. The ""breaking in the middle"" or ""no data"" phenomenon refers to the reception of fragmented or incomplete serial data from the Wizfi250, which may result in unexpected characters such as ""Hihihi"" being inserted. This issue may not be directly related to the Wizfi250 but rather the STM MCU's handling of the received serial data. Depending on the operation situation of the STM MCU, the continuous data sent by Wizfi250 may be received in fragmented or varied ways, leading to the observed phenomenon."
3341,602,"hello

We are using your network using your W5200 chip.
 
1. MCU -STM32F407XX
 
2. TCPIP -W5200
 
3. 5 Port Ethernet Switch -IC+ IP1750D LF
 
We are connecting the network as shown above.
 
* STM32F407XX and W5200 are connected to Fast SPI.
-Input SPI1_SCK is 42MHz.
 
* W5200 and IP1750 are connected to PHY to PHY.
-Phy to PHY Please let me know if you have a precaution.
 
-The current ping test OK
-TCP connection through AX1 OK
 
-It takes about 40 seconds for 1MBYTE transmission when testing TCP LOOPBACK using AX1.
-The transmission speed is so slow that we will contact us if we have any reviews.
- And when the test using the AX1, the transmission speed is not displayed like an attachment, which can be displayed.
   Please tell me how to know how.
 
-The source is used by Wiznet.
 
Please answer fast.
 
thank you ?Â´Ã«?Ã¬Â§? Ã¬Â²Â¨Ã«?Ã«Â°Â©Ã«Â²Â??Ã«ÂªÂ°Ã«ÂÂ¼??ÃªÂ·Â¸Ã«Â¦Â¼??AX1 ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨???Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ Loopback Test??
?Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ ?Â©Ã«ÂÂ??  

Send Progressing... Ã¬Â¤ÂÃ¬ÂÂ??0.00 Mbps(196608 Byte) Ã«Â¡??ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

[1] iInChip Send: 0.0000 Mbps(1007370 bytes, 1.#INF sec)
iInChip Recv: 0.0000 Mbps(1007370 bytes, 1.#INF sec)

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? hello.

First of all, I wonder how we set the size of the TX and RX buffer.
If the size of the buffer is small, the speed is lowered.

Please increase the size once.

In addition, please check the four -digit number (ROT number) at the bottom of the W5200.

thank you Thank you for answer.

First of all, the buffer size is 2kbyte.
How should I modify it?

And the last four digits of the chip are 1323.
And the number is H7S217.

thank you hello.

There is no separate that you should not do more than a few.However, as the size of the buffer grows, the more data roses are increased and the speed is improved, so the user must judge and use it properly.

Please do all the sockets you do not use, set only the sockets you are trying to use, and please test it again.

thank you","Q) First of all, I wonder how we set the size of the TX and RX buffer. If the size of the buffer is small, the speed is lowered. Please increase the size once. In addition, please check the four-digit number (ROT number) at the bottom of the W5200.
A) The buffer size is set in the socket registers of the W5200. To increase the size of the TX and RX buffer, you need to write the appropriate values to the Sn_RXMEM_SIZE and Sn_TXMEM_SIZE registers. Regarding the ROT number, the last four digits ""1323"" indicate the production batch. 

Q) First of all, the buffer size is 2kbyte. How should I modify it? And the last four digits of the chip are 1323. And the number is H7S217.
A) To modify the buffer size, you need to write the desired size to the respective socket's RX and TX memory size registers. In this case, you can set the size to a value greater than 2kbyte to potentially improve speed. The number ""1323"" and ""H7S217"" represent the production batch and shouldn't require any modification.

Q) There is no separate that you should not do more than a few. However, as the size of the buffer grows, the more data roses are increased and the speed is improved, so the user must judge and use it properly. Please do all the sockets you do not use, set only the sockets you are trying to use, and please test it again.
A) It's advisable not to increase the buffer size excessively. As the buffer size increases, the memory allocation for data also grows, which can potentially improve speed. Only configure the sockets that are in use and perform the necessary tests to assess the impact on speed."
3342,6020,"Development environment
 -MCU: W7500P
 -IDE: Ewiar Arm 8.32.1
 -DGB Tool: J-Link (SWD)

Both SSP0 and SSP1 are used as master mode, and three devices are inherited on SSP1.

The 3 devices are 25AA02E48, MAX31855, ADS1247 and 375 kHz clock frequency.
The 25AA02E48 is the opposite of the clock polarity, so the clock is delivered through the 74LVC1G04GV inverter.


If you f/w with the J-Link debugger, please contact the SSP1 DR 1 bytesmill.

When the symptoms occur, the EEPROM is read by one bytes from the read command, and in the case of MAX31855, only one byte is pushed even if the clock is entered without a Si pin.

In this regard, it is judged that there is a problem with the SSP.

1. IAR -Whether it is a SSP reset when downloading the program with JLINK
2. Whether you can reset only SSP
3. Even if an MCU reset occurs, whether the SSP DR can be prevented from being pushed 1 bytes

Please contact us. I couldn't check it because there was no CMSIS-DAP.

1. I suspect that only the core is reset at the SW RST with the debugger and no SSP reset is generated.
I asked for inquiries.

    Now, after the SSP initialization, I check the FIFO unconditionally and empty the buffer.
Please check if that's not happening.

1. If the SSP is initialized with the core, the question is that the SSP-FIFO is not completely initialized when the SSP is initialized.

The problem is that it only occurs when reading DR.

** When you write in DR, it is issued without a jungle. If you read DR, the data you used in DR is read 1 bytes and the data you need to read is read. **

This problem does not always happen, and this problem occurs when you download F/W on SWD. Hello, I moved the post to the Korean Forum. There was no answer for 10 days at the Korean Forum, but I moved to the English Forum and received an answer in two days.

I don't think it's a bit in the situation where I don't get a wired inquiry and only answer the forum.
This doesn't mean that the datasheet is well made, so you don't need wired.

After going through this, I think I'd rather not use it.
Due to other problems, there have been a few days ago, but it has been delayed.
How can we believe, develop and use WizNet products? There is no difference between the English and Korean Forum in the answer.
I will pay more attention in the future.sorry. hello,
1. If you use SW RST, if you use the SSP deinit () function, the SSP will be reset.
2. Also, if the SSP is reset, the FIFO will be initialized.

First of all, the data is pushed, but if possible, if you can check the Osilo Sko Pro, please send that part.
1. We recommend that you test it except for different SLAVE with SPI Clock.
2. We hope that one slave will operate and then operate another slave after a certain time.

One more thing is that there is no such thing after downloading F/W?Is it a phenomenon that only happens just before downloading F/W?


thank you
Irina It is intermittent after downloading F/W, and has never been experienced in Power on Reset.

SSP deinit () function has never been used. hello~

You said it was pushed after downloading F/W,
Are you checking this part through the UART, or do you use Debug as a memory value?
In the latter case, it may not be a real push.
The value you see with the Debug may be pushed back, so we recommend that you check it through UART.

thank you
Irina","Q) Whether it is a SSP reset when downloading the program with JLINK
A) I suspect that only the core is reset at the SW RST with the debugger and no SSP reset is generated. I asked for inquiries.

Q) Whether you can reset only SSP
A) If you use SW RST, if you use the SSP deinit () function, the SSP will be reset. Also, if the SSP is reset, the FIFO will be initialized.

Q) Even if an MCU reset occurs, whether the SSP DR can be prevented from being pushed 1 byte
A) You said it was pushed after downloading F/W, Are you checking this part through the UART, or do you use Debug as a memory value? In the latter case, it may not be a real push. The value you see with the Debug may be pushed back, so we recommend that you check it through UART.

(Note: Personal information such as name, address, and contact information has been removed from the conversation.)"
3343,6024,"Hello, I have bought WIZwiki-W7500 board. I have a problem with own firmware. Original binaries are working - hardware test binary works, original blinky binary works. No problem.

But my programs are not working. For example blinky program. I try to compile it with mbed online compiler and with platformio too. The program is working about 0.5 second after reset the board. Then it is stopped. So, I get one small blink of the LED, and nothing. I wrote simple program for serial communication - for example write Hello World to serial port. I only get 1 or 2 characters after reset. And, then program is stopped.

Do you have any idea? Hi~ Clexpert
I am sorry about answering late.
I tried to compile it with mbed web compiler and I also don't work the wait function. I will check the mbed library code and I'll tell you as soon as possible.

And I think I wish you test using gcc compiler or IAR or keil.
@teddy 


thanks,
irina Hi Irina,

thank you for the response. I solved the issue with online mbed compiler by importing library from:

https://github.com/ARMmbed/mbed-os

Following the instructions here:

https://os.mbed.com/platforms/WIZwiki-W7500/#update-or-restore-firmware

Now the compiled code works on this board. But unfortunately I am not able to achieve this in the PlatformIO environment. Hi Clexpert
How about you use mbed studio?
https://os.mbed.com/studio/

It's compile and debug tool
that gives you blink example.

thanks,
teddy Hi Teddy,

Thank you. I used mbed online and PlatformIO till now. But I installed Mbed Studio just now. I tried blink example. And it looks that it is working right. It works without debug features. I must copy binary manually. But it is working. Hi Clexpert

Maybe your DAP needs upgrade.
Below is the latest version.

lpc11u35_wizwiki_w7500_if_crc_20170420.bin

https://wizwiki.net/wiki/doku.php?id=products:wizwiki_w7500:start_getting_started:write_firmware_cmsis_dap

Please check your DAP version. and try upgrade.

thanks,
Teddy. Hi Teddy,

thank you very much! Yes, Mbed Studio recognized the board, but I didn't have the option of debugging. It really was necessary to update the DAP firmware. I don't know what version I had, the text document shows the same. But I downloaded the firmware and made an update. Since then, the software has been offering debugging and it works.

Thank you so much!","Q) Do you have any idea? 
A) Hi~ Clexpert I am sorry about answering late. I tried to compile it with mbed web compiler and I also don't work the wait function. I will check the mbed library code and I'll tell you as soon as possible. And I think I wish you test using gcc compiler or IAR or keil. @teddy

Q) How about you use mbed studio? 
A) Hi Clexpert How about you use mbed studio? https://os.mbed.com/studio/
It's compile and debug tool that gives you blink example. thanks, teddy

Q) Maybe your DAP needs upgrade. 
A) Hi Clexpert Maybe your DAP needs upgrade. Below is the latest version. lpc11u35_wizwiki_w7500_if_crc_20170420.bin https://wizwiki.net/wiki/doku.php?id=products:wizwiki_w7500:start_getting_started:write_firmware_cmsis_dap Please check your DAP version. and try upgrade. thanks, Teddy.

Q) Thank you. 
A) Hi Teddy, Thank you. I used mbed online and PlatformIO till now. But I installed Mbed Studio just now. I tried blink example. And it looks that it is working right. It works without debug features. I must copy binary manually. But it is working.

A) Hi Teddy, thank you very much! Yes, Mbed Studio recognized the board, but I didn't have the option of debugging. It really was necessary to update the DAP firmware. I don't know what version I had, the text document shows the same. But I downloaded the firmware and made an update. Since then, the software has been offering debugging and it works. Thank you so much!"
3344,6026,"I am unable to access the serial configuration while a DHCP request is pending. This is a problem as a user, who is connected to my device via serial, is unable to switch to a static IP in the case of no DHCP. How can I solve this? If you can input serial commands on the UART port, then you can change its IP address acquisition method with one of serial commands.
Can you do this? That is currently my problem. The WIZ105SR does not respond to the +++ command while waiting for DHCP. I checked the firmware of WIZ105SR and found out that we can't intercept the control of MCU before DHCP process finishes. 
It might take a quite long time to change this logic to make it accept user's command from Ethernet or Serial while DHCP process is running. 

We, WIZnet, have another module the form factor of which is the same as WIZ105SR. So we call it WIZ750SR-105 and it can be handled with user's commands while DHCP running because it has different code structure.
Can you use WIZ750SR-105 instead of the old one?

James. Thanks James. I've ordered the other module and will evaluate it for our application.","Q) How can I solve the problem of accessing the serial configuration while a DHCP request is pending? 
A) If you can input serial commands on the UART port, then you can change its IP address acquisition method with one of the serial commands. It might take a quite long time to change this logic to make it accept user's command from Ethernet or Serial while DHCP process is running. Alternatively, you can consider using WIZ750SR-105 module instead of the old one, as it can be handled with user's commands while DHCP is running due to its different code structure. 
"
3345,6029,"hello
We are going to communicate with Wi -Fi based on the OCF (Open Connectivity Foundation), the IoT standardization standard.
OCF is a standard protocol that is currently introducing home appliances.

Our products are also trying to implement OCF -based data communication with Wi -Fi modules.

thank you Unfortunately, there are no modules that support the OCF standard among the current WizNet WiFi products. all right.
Thank you for answer.
If so, can it be available if you can directly mount the OCF profile in the WiFi module? The contents (customer directly) are no longer supported by Wizfi310.
The new module, Wizfi360, is likely to be possible after business review.

First of all, it is better to consult with the Wiznet agency.","Q) If so, can it be available if you can directly mount the OCF profile in the WiFi module? 
A) The new module, Wizfi360, is likely to be possible after business review."
3346,6032,"How do I set to communicate with Ethernet 2 cereal using two Wiz100sr?

Do I have to set the IP separately?
Server in mode mode?Client?Should I use it?
Should I set some settings with a serial setting with a separate Mycom?


If you put it in, without setting up a separate PC
I want to be a two -way cereal communication through the Ethernet line.

thank you WIZ100SR ?ÂÃ«ÂÂ??Client,  ?Â¤Ã«Â¥Â¸ ?ÂÃ«ÂÂ??Server Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡??Â¤Ã¬Â Â?ÂÃ¬ÂÂÃªÂ³?Client??WIZ100SR???ÂÃ¬ÂÂ???ÂÃ«Â²Â??IP Ã¬Â£Â¼Ã¬ÂÂ?? Port Ã«Â²ÂÃ­ÂÂ¸Ã«Â¥?Server Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡??Â¤Ã¬Â Â??WIZ100SR??IP?? Local Port Ã«Â²ÂÃ­ÂÂ¸Ã«Â¡??Â¤Ã¬Â Â?ÂÃ«Â©Â´ ?Â©Ã«ÂÂ??

?ÂÃ«? ?Â¤Ã¬ÂÂ´, 

<WIZ100SR 1>                            
Local IP : 192.168.11.10
Local Port : 5000
?ÂÃ¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ : TCP Client
Remote IP : 192.168.11.20
Remote Port : 5000

<WIZ100SR 2>
Local IP : 192.168.11.20
Local Port : 5000
?ÂÃ¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ : TCP Server

?Â´Ã«Â ÂÃªÂ²??Â¤Ã¬Â Â?ÂÃ¬ÂÂÃ«Â©??Â©Ã«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??

?ÂÃ«Â Â¤Ã¬Â£Â¼Ã¬ÂÂ  ?Â¤Ã¬Â Â?Â¼Ã«Â¡Â??Ã«Â³Â´Ã«ÂÂ ?ÂÃ«Â¦Â¬???Â°Ã¬ÂÂ´?? ?ÂÃ«ÂÂ¬?ÂÃ«ÂÂ???ÂÃ«Â Â?Â´Ãª? Ã«Â°ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¬ Ã«Â°ÂÃªÂ¾Â¸??Ã«Â³Â´Ã¬ÂÂ?ÂµÃ«ÂÂ??

<WIZ100SR 1>
Local IP : 192.168.11.10
Local Port : 5000
?ÂÃ¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ : Mixed
Server IP : 192.168.11.20
Remote Port : 5000

<WIZ100SR 2>
Local IP : 192.168.11.20
Local Port : 5000
?ÂÃ¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ : Mixed
Server IP : 192.168.11.10
Remote Port : 5000","Q) How do I set to communicate with Ethernet 2 cereal using two Wiz100sr?
A) You can achieve two-way serial communication through the Ethernet line by configuring the Wiz100SR devices properly.

Q) Do I have to set the IP separately? Server in mode mode?Client?Should I use it? Should I set some settings with a serial setting with a separate Mycom?
A) Yes, you need to set the IP separately for each Wiz100SR device. Additionally, one Wiz100SR should be configured as a TCP Client, while the other should be set as a TCP Server. You also need to configure the serial settings separately.

Q) If you put it in, without setting up a separate PC, I want to be a two-way cereal communication through the Ethernet line.
A) It is possible to establish two-way serial communication through the Ethernet line without the need for setting up a separate PC.

Q) thank you WIZ100SR ?ÂÃ«ÂÂ??Client,  ?Â¤Ã«Â¥Â¸ ?ÂÃ«ÂÂ??Server Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡??Â¤Ã¬Â Â?ÂÃ¬ÂÂÃªÂ³?Client??WIZ100SR???ÂÃ¬ÂÂ???ÂÃ«Â²Â??IP Ã¬Â£Â¼Ã¬ÂÂ?? Port Ã«Â²ÂÃ­ÂÂ¸Ã«Â¥?Server Ã«ÂªÂ¨Ã«ÂÂÃ«Â¡??Â¤Ã¬Â Â??WIZ100SR??IP?? Local Port Ã«Â²ÂÃ­ÂÂ¸Ã«Â¡??Â¤Ã¬Â Â?ÂÃ«Â©Â´ ?Â©Ã«ÂÂ?? ?ÂÃ«Â Â¤Ã¬Â£Â¼Ã¬ÂÂ  ?Â¤Ã¬Â Â?Â¼Ã«Â¡Â??Ã«Â³Â´Ã«ÂÂ ?ÂÃ«Â¦Â¬???Â°Ã¬ÂÂ´?? ?ÂÃ«ÂÂ¬?ÂÃ«ÂÂ???ÂÃ«Â Â?Â´Ãª? Ã«Â°ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¬ Ã«Â°ÂÃªÂ¾Â¸??Ã«Â³Â´Ã¬ÂÂ?ÂµÃ«ÂÂ??
A) This paragraph does not contain a response."
3347,6034,"The W5100s's response to a SYN message has both the ACK and RST flags set.

What is causing the reset flag to be set in the ACK?
Thanks.
Giri Because it can not accept the SYN request. Most probably you reuse port number from previous communication, and W5100s thinks that it is continuation of the closed connection. You must use another source port number at the sender side. Thanks for the response.

I am only starting to play with the w5100s, so it is its basic testing.

And here it is the first connect request after power cycle of the wiznet module. Show the related packets / share Wireshark log. Does the W5100s listen on the port 5000 with at least one socket? I only have 1 socket. 
The SR(0) is at 0x14 -> Sock_LIsten. Eugeny:
I am not sure what I did - yet, But I have socket connection.
I think the only thing I did was added a delay between SR(0) reads.
Will debug some more, but wanted to let you know the updated status.
Very much appreciate your Cpu cycles.
Giri","Q) What is causing the reset flag to be set in the ACK?
Q) Does the W5100s listen on the port 5000 with at least one socket?
A) Because it cannot accept the SYN request. Most probably you reused port number from previous communication, and W5100s thinks that it is a continuation of the closed connection. You must use another source port number at the sender side. 
A) I am not sure what I did - yet, But I have socket connection. I think the only thing I did was added a delay between SR(0) reads. Will debug some more, but wanted to let you know the updated status."
3348,6035,"hello,
At AT Command
AT+WSET enters the router ID
AT+WSEC entered the password and connected it.

In the case of the above, it is connected when the password is set in the router,
If you stick to an open router (without password)
Which AT command should I stick? Please try the following command.

At+wsec = 0, Open","Q) Which AT command should I stick if I want to connect to an open router (without password)?
A) You can use the following command: AT+WSEC=0. This command is used to connect to an open router without a password."
3349,604,"Hi,

In W5100 schematic there is a inductor between analog and digital ground. What is its value?
Do I use a ferrite bead or I can use a normal inductor ?

Regards Hi,
What is exact value of inductor FB2 in this circuit ? ( as you mentioned its part no. is ""HB-1M1608-121"" )
I saw in the schematic that the digital ground ( GNDD ) and analog ground ( GNDA ) pins of the chip is tied together. Is it right ? I must short these pins ?

Regards. Hi,


You have to use  0.5A or 0.3A/120 ohm or 60 ohm as Ferrite bead value and we use the  ""HB-1M1608-121"".
I recommend that these pins(GNDD/GNDA)is connected to Ferrite bead for stability.

thanks, :slight_smile:","Q) In W5100 schematic there is a inductor between analog and digital ground. What is its value? Do I use a ferrite bead or I can use a normal inductor ? 
A) The value of the inductor between the analog and digital ground in the W5100 schematic should be 0.5A or 0.3A/120 ohm or 60 ohm as a ferrite bead value. You can use the ""HB-1M1608-121"" inductor for this purpose.

Q) What is exact value of inductor FB2 in this circuit? (as you mentioned its part no. is ""HB-1M1608-121"") I saw in the schematic that the digital ground (GNDD) and analog ground (GNDA) pins of the chip are tied together. Is it right? I must short these pins? 
A) The exact value of inductor FB2 in this circuit is 0.5A or 0.3A/120 ohm or 60 ohm as a ferrite bead value, and the part number is ""HB-1M1608-121"". It is correct that the digital ground (GNDD) and analog ground (GNDA) pins of the chip are tied together. It is recommended to connect these pins to a ferrite bead for stability."
3350,6047,"#Rab -JULY, 2019
## wizfi360
-W600 SDK analysis and ESP compatible firmware (BASED on HK Office)
-Reading as an ESP compatible version (Beta Release Target 2 Week 2 in July)
-IoT Cloud Support (WizNet Cloud, AWS, Azure) At Command Additional version release
- (During discussion) Wiznet Standard;Existing wireless module wizfi250/310Custom first work
- (During discussion) Version 2.0 -Mbed Enabled Board

-Wizfi360 Shield (EVB) Example Code Release
-GITHUB page open and example file based on Arduino/Mbed ESP compatible firmware
- (During discussion) AI speaker reference design planning
-Need to cooperate with the wireless division;First external developers and carriers (SK, KT Gigani) Meeting channel needs
-Recide Google/Amazon Solutions

-Hardware product
-Wizfi360 EVB design and launch
-Design completion and mass production
-Data sheet, user guide and wiki/homepage release
-WIZFI360IO assembly and test (design is completed)
-V100 -I & C compatible interface board launch and feedback
-SM360 design and production
-SM module prototypes and tests (Support for Hong Kong branch)
-Baseboard design and assembly
-Smart LED, Smartplug, ...)
-Stone smartphone app interlocking firmware work and test

-Bundle app prototype creation and distribution with NetDevice
-Production of specifications, development and primary release

-Checking cloud solutions and planning scenarios
-Prominated product registration and personal dashboard function demonstration

## IoT IOFFLOAD CONTEST and embedded network community support
-Arduino: Wiznet Arduino Ethernet
- (After Wizfi360 Example) W6100 Library Development: Cloud Application Example Development
-ARM Mbed: Intensive: Wiznet Mbed Ethernet
-WizNetInterface for W6100 development porting work (currently completed static IPv6 function)
-DHCPV6 feature additional work
-SW TCP/IP VS HW TOE Pros and Pristity White Paper
-ARM PELION SDK in the W5000/6000 series

## New chip development work
-W6300 (high -performance chip)
FPGA Board interface test;QSPI, 16-bit memory interface
Core memory logic design work;Similar to the W5300 architecture to improve performance
-WizNet Prop-up platform assembly and test
-FPGA function board production (function board can change according to schedule)

## Existing chip support
-W5500 technical support (new network switch compatibility test)
-WIZ850IO module PCN issuance (compatible test results improvement module)

## Patent
-Ad newly promoted ideas related to apps and cloud solutions that are linked to new wireless modules
-Cloud Patent China/India/US Patent Submission
-IPv6 Core Patent China/US Patent Submission ?ÂµÃ«????ÂÃ¬ÂÂ©?Â©Ã¬ÂÂ??!
ÃªÂ²??ÂÃ«ÂÂ ???ÂÃªÂ²Â Ã¬Â£???? :shallow_pan_of_food:
**?ÂÃ¬Â Â** ","This appears to be a technical document discussing various developments and plans related to Wizfi360 and other chips. There are no questions or personal information present in the text. Therefore, there are no questions or answers to separate."
3351,6048,"Refer to the Wizwiki-W7500P to create a board with W7500P

I want to connect CMSIS-DAP separately.

I want to summarize the connections between the CMSIS-DAP and the W7500P and create a board.

1. Is the SWD (SWDIO, SWCLK, RSTN) line that seems to be connected to put the firmware?

2. UART (u_txd2, u_rxd2) line is connected to PC with USB via LPC11U35FHI33/501
    Is it right to be connected to use cereal communication?

3. If the 2 is correct, can you download using the ISP tool with the serial communication connected in 2?
    Of course, the BOOT mode of the W7500P is set.

please answer about my question.
thank you I will answer you.

[Quote = ""fpain3, POST: 1, Topic: 6048""]
SWD (SWDIO, SWCLK, RSTN) line appears to be connected to put firmware?
[/Quote]
you're right.

[Quote = ""fpain3, POST: 1, Topic: 6048""]
UART (u_txd2, u_rxd2) line is connected to PC with USB via LPC11U35FHI33/501
Is it right to be connected to use cereal communication?
[/Quote]
you're right.

[Quote = ""fpain3, POST: 1, Topic: 6048""]
If it's correct, can you download using the ISP tool with a serial communication connected in No. 2?
Of course, the BOOT mode of the W7500P is set.
[/Quote]
you're right.

thank you ","Q) Is the SWD (SWDIO, SWCLK, RSTN) line that seems to be connected to put the firmware?
Q) UART (u_txd2, u_rxd2) line is connected to PC with USB via LPC11U35FHI33/501. Is it right to be connected to use cereal communication?
Q) If the 2 is correct, can you download using the ISP tool with the serial communication connected in 2? Of course, the BOOT mode of the W7500P is set.
A) you're right.
A) you're right.
A) you're right."
3352,6055,"## 1. Sales channel construction activities

   1) Construction of domestic SALES CHANNEL

      -Sales acquired WizNet OB or Distributor OB as Sales Channel

   2) Building Japanese Sales Channel

      Japanese SALES REP.Collection of information on the system

      -Redding cooperation from companies with Japanese distribution networks such as Kuo Pin / Mobile Eco (Company introduction and product introduction materials)

        => Target company investigation and pre -contact targeting the president of the Candidate company at the end of August

      -It hiring Japan FAE

   3) Establishment of European Sales Channel

      -Feating Wiznet Germany and Sales Channel construction

      -For cooperation plan with Joachim

## 2. Wizfi630s mass production setup finish

   1) Signed an OEM supply contract with Seyeon Miy -7/4

   2) Factory mass production system and QC system establishment

      -Discussing the details at 7/4 meetings

      -En the end of July

   3) Set WIZNET HK to be involved in work

## 3. ECO SYSTEM construction

   1) Request for outsourcing projects on SDT

   2) Request for improvement of mobile apps on Netdi Vice (wizfi360 setting function, etc.)

   3) Design house construction such as Trit Korea RND ","Q) What are the activities involved in sales channel construction?
A) The activities involved in sales channel construction include acquiring sales channel partners like WizNet OB or Distributor OB, building Japanese sales channels through sales representatives, collecting information on the system, establishing European sales channels, and cooperating with German and other distribution networks.

Q) When was the OEM supply contract signed for Wizfi630s mass production setup?
A) The OEM supply contract for Wizfi630s mass production setup was signed on 7/4 with Seyeon Miy.

Q) What are the components of the ECO SYSTEM construction?
A) The components of the ECO SYSTEM construction include outsourcing projects on SDT, improvement of mobile apps on Netdi Vice, and the construction of design houses such as Trit Korea RND."
3353,6058,"I used Wireshark to monitor the UDP packets between my PC and W5500 using UDP protocol since day 1.  

After figured out all troubles, everything works perfect as expected.  I turned off Wireshark, and W5500 does not response.

RECV and SEND_OK interrupts happened, so I know that W5500 received and replied to the command from the PC.  However, the PC did not get anything.

From the hardware side, I used switch, hub, and even crossed cable, and the result is the same.

W5500 only works while Wireshark is running.

I switched to TCP/IP protocol and W5500 worked fine without wireshark running. 

Any idea and help please?  

Thank you. For your information.  

I found an issue here.

The destination MAC was left blank (all zeros).  Fill it with the PC MAC, and everything worked well together.

Thanks.

Mtuan Hi~
Mtuan

I'm glad that this issue has been resolved.
If any question arises, please post  to the Q&A board again.

thanks,
BR
irina","Q) Any idea and help please?
A) The destination MAC was left blank (all zeros). Fill it with the PC MAC, and everything worked well together. Thank you. 
Q) Mtuan Hi~ 
A) I'm glad that this issue has been resolved. If any question arises, please post to the Q&A board again. Thank you."
3354,606,"Hi,

What is the maximum network cable length when using W5100?
When my cable exceeds 10-12 meters the module don't plug into network ( all LEDs are off ).

Regards Hi, 

I will confirm about your question.
I will contact you as soon as possible.

thanks, :slight_smile: Hi~

We had tested about LAN cable length to below 100 meter.
Test result,W5100 has been operated without any problem. Can you test the Ping reply(from W5100)?
Do you operate Other products well when this LAN cable?

thanks :slight_smile: Hi,
Cable is OK. I have tested it with my laptop.
When I connect a cable more than 10-12 meters to W5100 it is not plug at all. All Leds go off and there is no response ( even Ping test ).
any suggestion ?

Regards Hi,

We tested using module on the W5100. It has been operated without any problem.
Could you send me your schematic? 
If you send your schematic,I'll look over your schematic and tell you in a few days.

thanks, :slight_smile: Hi~

Could you send me the datasheet of RJ000002(J3)?
I can't find out the datasheet.
first, I will confirm the schematic you sent me.
thanks, :slight_smile: Hi,
Sometimes, Some problem is due to cable.
Cable can be made well. Each line of cable UTP-CAT5 have different impedence value. So each line should be cross or direct connected with other side as the specification. (refer to [url]http://www.ertyu.org/steven_nikkel/ethernetcables.html[/url]).

In addition, R5, R6, R7, R8 register values are different from wiznet recommended values.
WIZnet recommened the value 49.9 ohm. These register are for impedence match. You'd better follow the value.

Thank you. Hi,
If the analog ground plane can't be seperated from digital ground plane, you'd better use together.
If analog ground plane is not enough wide, it is weak from some noise.

Thank you. Have you checked power stability when exceeds 10-12meter cable?
If Your module is applied PoE, You should be use PoE module for Power stability.
It seems like there is only bridge-diode for PoE in your schematics. But I recommend to use PoE module. Hi Midnight,

So does it cause limitation on cable length ?
Regards Hi Peter,

What do you mean of POE module ?
The bridge is just for protecting circuit from fault in arranging of network cable pairs that causes of negative voltage pair.
When I use longer cable, I use POE with more voltage ( e.g. 15V adapter ). The voltage is stable.
The main problem is about data signals. It seems that data signals is so weak that can not travel over the network cable more than 10-12 meters. How can I solve this problem? As I know the network chip must be capable to detect weak signals over a 90 meters cable and inject signals so powerful that can travel over a cable in same length.
Any suggestion ?

Regards Ok, if power stability is good, it isn?Ât required PoE module.
The mean of PoE module is PD such as silvertel product([silvertel.com/products/poe-p ... ernet.html](http://www.silvertel.com/products/poe-power-over-ethernet.html)). Hi,
We already have tested on 100m lenght and that's ok.
But, your case is not understood. The different part is MAG-Jack, But the mag-jack maybe have no problem.
Can you show me the pcb layout?

Thank you.","Q) What is the maximum network cable length when using W5100? 
Q) When my cable exceeds 10-12 meters the module don't plug into network ( all LEDs are off ). 
Q) Can you test the Ping reply(from W5100)? 
Q) Do you operate Other products well when this LAN cable? 
Q) When I connect a cable more than 10-12 meters to W5100 it is not plug at all. All Leds go off and there is no response ( even Ping test ). any suggestion ? 
Q) Could you send me the datasheet of RJ000002(J3)? 
Q) Could you send me the schematic you sent me? 
Q) Have you checked power stability when exceeds 10-12meter cable? 
Q) So does it cause limitation on cable length ? 
Q) What do you mean of POE module ? 
A) We had tested about LAN cable length to below 100 meter. Test result, W5100 has been operated without any problem. sometimes, Some problem is due to cable. Cable can be made well. Each line of cable UTP-CAT5 have different impedence value. So each line should be cross or direct connected with other side as the specification. In addition, R5, R6, R7, R8 register values are different from wiznet recommended values. WIZnet recommened the value 49.9 ohm. These register are for impedence match. If the analog ground plane can't be separated from digital ground plane, you'd better use together. If analog ground plane is not enough wide, it is weak from some noise. But your case is not understood. The different part is MAG-Jack, But the mag-jack maybe have no problem. 
A) I will confirm about your question. I will contact you as soon as possible. We tested using module on the W5100. It has been operated without any problem. Could you send me your schematic? If you send your schematic, I'll look over your schematic and tell you in a few days. Could you send me the datasheet of RJ000002(J3)? I can't find out the datasheet. first, I will confirm the schematic you sent me. Have you checked power stability when exceeds 10-12meter cable? If Your module is applied PoE, You should use a PoE module for Power stability. It seems like there is only bridge-diode for PoE in your schematics. But I recommend to use a PoE module. But, your case is not understood. The different part is MAG-Jack, But the mag-jack maybe have no problem. Can you show me the pcb layout? 
A) We already have tested on 100m length and that's ok. If power stability is good, it isn’t required PoE module. The mean of PoE module is PD such as Silvertel product ([silvertel.com/products/poe-p ... ernet.html](http://www.silvertel.com/products/poe-power-over-ethernet.html)). 
A) Thank you. Thank you."
3355,607,"Hi,

I am using W5100 in TCP Server mode. I can ping my module but when I try to connect to it using e.g. ""Hyperterminal"" it fails to connect. I analyzed it using ""wireshark"" and i concern the chip sets the window size to zero.
any suggestion ?

Regards hi,

Do you use the our source code?
In case of Ping,If IP address of W5100 set up and link connect with router, you can ping test.
Do you execute the socket open operation before connection operation?
Could you tell me detail description about your problem?

thanks :slight_smile: Hi,

Yes, I have done all of this. I have built a lot of modules with this chip and all works as well. Only one of these works as I described.
I can Ping it and I did port open commands. But when I try to connect to module it reports zero windows size so refuses the sync.

any suggestion ?

Regards. Hi~~

How do you set up the rx/tx buffer size?
Our driver set up the using sysinit() function as tx/rx buffer 2K.
1. For example, If you open the socket 0, please confirm the tx/rx buffer size of socket 0.
2. please test after maximum tx/rx buffer size set up.

thanks, :slight_smile: Hi,
I have left the buffer size in its default value ( 2K for each buffer ).

Regards.","Q) I am using W5100 in TCP Server mode. I can ping my module but when I try to connect to it using e.g. ""Hyperterminal"" it fails to connect. I analyzed it using ""wireshark"" and i concern the chip sets the window size to zero. any suggestion ?
A) Do you use the our source code? In case of Ping, If the IP address of W5100 is set up and linked with the router, you can perform a ping test. Also, ensure you execute the socket open operation before the connection operation. Could you provide a detailed description of your problem?

Q) Yes, I have done all of this. I have built a lot of modules with this chip and all works as well. Only one of these works as I described. I can Ping it and I did port open commands. But when I try to connect to the module it reports zero windows size so refuses the sync. any suggestion ?
A) How do you set up the rx/tx buffer size? Our driver sets up the using sysinit() function as tx/rx buffer 2K. Please confirm the tx/rx buffer size of the socket you are trying to open and consider testing after setting up the maximum tx/rx buffer size.

Q) I have left the buffer size in its default value (2K for each buffer).
A) None."
3356,608,"I am a student preparing for graduation works.

In a situation where the overall knowledge of the current communication is very lacking



                                                       [Camera] a
You must communicate with [Micro Controller Board (Arduino MEGA)] - [WiFi Module] - [Smartphone (Android)].

For use, the smartphone is sent to the microcontroller to control the motor.

It must be sent.The two functions should be at the same time ..



To know, an AP is required in the middle to connect the WiFi module and the smartphone.

We know that Wiz610Wi has AP features.

If so, if you use the WIZ610 of the WiFi module, I wonder if you can communicate with your smartphone.

And if possible, if you have an example or source that will help you, can you tell me? The features you want are both Wiz610Wi, Wizfi630, Wizfi210, and Wizfi250.

Wizfi210 and Wizfi250 also contain AP functions.

However, it seems that there is a little speed issue to send the camera video.

Overall, you need to explain a little more detail with DIAGRAM to give you a little specific answer.","Q) Can you communicate with a smartphone using the Wiz610Wi WiFi module? Do you have any examples or source that can help with this? Also, what about the Wizfi630, Wizfi210, and Wizfi250? 
A) It is possible to communicate with a smartphone using the Wiz610Wi WiFi module, as it has AP features. The Wizfi210 and Wizfi250 also have AP functions, but there may be speed issues when sending camera video. For a more detailed answer, it would be helpful to provide a diagram for better understanding."
3357,609,"Hi,

is there any way to control the GPIOs through TCP/IP communication?

Does the IF-Board also exist in eagle format? Or is there an eagle lib? I only need the Footprint.

Thanks Hi

If you want to control the GPIOs through TCP/IP, you have to control in your MCU.
For example, When WizFi250 receives TCP/IP packet, Your MCU can use AT command like <AT+FGPIO>.
For detailed information about <AT+FGPIO>, refer to [url]http://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#at_fgpio[/url]

And I will check it about eagle lib and footprint data.

Thank you. Hi,

thanks for your response. I have to control it through TCP/IP commands, so the web interface is no option for me.
But that's not real problem for me, beacause of this I will use a separate MCU now.

At the moment the eagle data are more important for me. Were you able to find something out about it?

Thanks.","Q) is there any way to control the GPIOs through TCP/IP communication? Does the IF-Board also exist in eagle format? Or is there an eagle lib? I only need the Footprint. 
A) If you want to control the GPIOs through TCP/IP, you have to control in your MCU. For example, When WizFi250 receives TCP/IP packet, Your MCU can use AT command like <AT+FGPIO>. For detailed information about <AT+FGPIO>, refer to [url]http://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#at_fgpio[/url]. And I will check it about eagle lib and footprint data. Thank you. 

Q) At the moment the eagle data are more important for me. Were you able to find something out about it? 
A) thanks for your response. I have to control it through TCP/IP commands, so the web interface is no option for me. But that's not real problem for me, beacause of this I will use a separate MCU now."
3358,6097,"Hello,

I am trying to transmit data from my micro controller connected to S2E Wiz750SR-TTL  and read it out on my computer using a serial terminal device PuTTY via WIZVSP (Server). But I am not able to establish a connection between the S2E (Client) and WIZVSP (Server).

Although, I am able to transmit data by using a TCP/IP client software (Hercules) to WIZVSP and read it on Serial Terminal PuTTY.

Can anyone suggest what am I doing wrong? (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) Hello,

First, I want you to check if PC receive a response when sends PING to WIZ750SR. Hello @becky,

Yes I do receive the Ping response at 0% loss.

But on the VSP side running server mode with *""Start listening only when local virtual port is open""* UNCHECKED, I still cannot see any active connections/remote hosts.

Wiz750SR S2E is configured as a client with my computer's IP and PORT address as its remote host settings. Hello @neo.

The firewall may be the problem.

Even if data is transmitted and received when using Hercules in a local PC environment,
When using WIZ750SR-TTL, the connection may not be established due to the firewall problem.

Please turn off the firewall and test it, and let me know if you still have a problem.

Thank you. @rena: I tried establishing communication after disabling firewall but still no luck.

Although, by setting the WIZ750SR as server and running client mode on VSP the communication works just fine even with the firewall ON.

But for my application, I want WIZ750SR to run as client and VSP to run as server. @rena I was disabling my antivirus software firewall but after disabling Windows 10 Firewall the connection was established as I wanted. I have added the program to exclusion list but the firewall still seems to be blocking it.

Let me know if you know anything in this regards. Thank you for all the help! Thank you!

It certainly helped me fix the problem! ","Q) Can anyone suggest what am I doing wrong?
Q) I tried establishing communication after disabling firewall but still no luck. Let me know if you know anything in this regards. Thank you for all the help! Thank you!

A) The firewall may be the problem. Even if data is transmitted and received when using Hercules in a local PC environment, when using WIZ750SR-TTL, the connection may not be established due to the firewall problem. Please turn off the firewall and test it, and let me know if you still have a problem. Thank you."
3359,6102,"Overseas companies that use Ethernet Cards shipped by our company have a symptom of disconnection during use.

**Symptom)**
-If you turn on the printer, the connection will be connected for about 5 minutes, and the connection is cut off (rebooting the printer can be connected, but afterwards)

** Network equipment used) **
1. Linksys 52 POE Smart Switch
2. Barracuda F80 Firewall

How should we check the cause of the above problem?
Is there a History that is a problem for compatibility with network equipment?

** W7500P is in use. **

Please confirm.
thank you Hello, this is Wiznet.

Please tell me exactly what modules are.

thank you ","Q) How should we check the cause of the above problem? Is there a History that is a problem for compatibility with network equipment? 
A) 

**Symptom)** - If you turn on the printer, the connection will be connected for about 5 minutes, and the connection is cut off (rebooting the printer can be connected, but afterwards) 

** Network equipment used)** 1. Linksys 52 POE Smart Switch 2. Barracuda F80 Firewall 

But Is there a History that is a problem for compatibility with network equipment? 

Please confirm."
3360,6104,"hello.
you worked hard.

today,
Using the wiz850io (W5500) on the Nucleo-F746ZG board
I am using Ethernet well.

But the system I want to apply wants a higher communication speed
 I'm trying to use SPI DMA.

There is no related data, so we will ask you.

If you have a W5500 DMA example code consisting of a HAL driver of STM32F,
I hope you will help you.

In addition, there is also an example code of the W5300.

Answers I'll wait.

thank you hello

W5500 DMA code
Unfortunately, it is not a HAL driver, but please refer to it.
https://github.com/javakys/w5500_STM32F4_SPI_DMA

It would be nice to refer to the blog below.
https://roruca.blog.me/221415955502 I moved the post to the Korean Forum and added [W5500] to the title of the post. hello..

If you use the IO Library provided by WizNet,
It is also good to check the data from the link below.

https://wizwiki.net/wiki/doku.php?id=products:W5100s:w5100s_evb
thank you
Irina","Q) If you have a W5500 DMA example code consisting of a HAL driver of STM32F, I hope you will help you.
A) W5500 DMA code
Unfortunately, it is not a HAL driver, but please refer to it.
https://github.com/javakys/w5500_STM32F4_SPI_DMA

Q) Answers I'll wait.
A) It would be nice to refer to the blog below.
https://roruca.blog.me/221415955502 I moved the post to the Korean Forum and added [W5500] to the title of the post. 

Q) If you use the IO Library provided by WizNet, It is also good to check the data from the link below.
A) https://wizwiki.net/wiki/doku.php?id=products:W5100s:w5100s_evb"
3361,611,"hello.

If you support IEEE802.11 B/G in the WIZ610WI product, AP mode should be supported as well as AD-HOC mode.

Can I know how to set AD-HOC mode?

thank you hello

Wiz610wi does not support AD-HOC mode.
The model that supports AD-HOC mode is as follows.
-AP & STATION
  -Wizfi630

-STATION dedicated (limited AP function available)
  -Wizfi210/220

thank you hello.

I would like to use the WIZ610WI module using the DSP's MII interface.

1. MDC (PIN 16) is an input of the MDIO signal of the wiz610wi in the Wiz610Wi EVB, and the MDC (PIN 25) of the Ethernet transceiver is also an input. Who occurs?

2. I would like to ask questions because there is no explanation related to MDIO in the design guide of the MII directly between the 'W5300 and WIZ610WI' provided by your company.
1) Do you have to use MDIO if you use the MII of Wiz610Wi?

2) How is it configured when designing H/W?

3) How do I set up the PHY Address, Register Address of Wiz610Wi?

thank you 1. The MDC of the WIZ610WI Mac is OUTPUT.

2. About W5300 and WIZ610WI MII.
    1) The W5300 does not use MDIO/MDC I/F, so it is not used.
    2) For MDIO/MDC on PHY side, it is recommended to connect via VCC.

thank you","Q) Can I know how to set AD-HOC mode?
Q) I would like to use the WIZ610WI module using the DSP's MII interface. 
1. MDC (PIN 16) is an input of the MDIO signal of the wiz610wi in the Wiz610Wi EVB, and the MDC (PIN 25) of the Ethernet transceiver is also an input. Who occurs?
2. I would like to ask questions because there is no explanation related to MDIO in the design guide of the MII directly between the 'W5300 and WIZ610WI' provided by your company.
    1) Do you have to use MDIO if you use the MII of Wiz610Wi?
    2) How is it configured when designing H/W?
    3) How do I set up the PHY Address, Register Address of Wiz610Wi?

A) Wiz610wi does not support AD-HOC mode. The model that supports AD-HOC mode is as follows.
-AP & STATION -Wizfi630
-STATION dedicated (limited AP function available) -Wizfi210/220 

1. The MDC of the WIZ610WI Mac is OUTPUT.
2. About W5300 and WIZ610WI MII.
    1) The W5300 does not use MDIO/MDC I/F, so it is not used.
    2) For MDIO/MDC on PHY side, it is recommended to connect via VCC."
3362,6110,"What is the cause of retransmission at a different time with the setting of the RTR register?
What is the solution?Please refer to the following.This is a question that was posted last year.

https://forum.wiznet.io/t/topic/5142 hello

I will answer again after testing the contents.
Please check the RTR value once more. Please upload some captured wire shark packet files.It will help you look. Thank you for sending the capture file.If you look at the capture file you sent, you are re -transmitted every 8 to 90ms.
The board we tested seems to have different results by testing System Clock in 20MHz.
In our register, there is a regist called TCKCNTR (TCKCNTR (Ticker Counter Register, and the address value of 0x4600_2000).
This value will be informed of 100usec as an internal TCP core, which seems to occur because of 20 MHz (reset value).The above article seems to be using 48MHz.Therefore, if you adjust this register value to 4800 (0x12C0) for 48MHz, it is expected to produce expected results. Regardless of how much the system clock is, if the RTR is set to 100US resolution, shouldn't the CPU speed be fast or slow, or it should operate at 100us resolution?

[quote = ""bong, post: 7, topic: 6110""]
This value will be informed of 100usec as an internal TCP core, which seems to occur because of 20 MHz (reset value).The above article seems to be using 48MHz.Therefore, if you adjust this register value to 4800 (0x12C0) for 48MHz, it is expected to produce expected results.
[/Quote]
There is no phrase that RTR and TCKCNTR have a relationship in the reference manual.

If you do not record the reason why you should adjust the TCKCNTR when you adjust the system clock, you will not be able to know why the syntax is needed when maintenance is maintained in the future.

[quote = ""bong, post: 8, topic: 6110""]
If you are using the W7500P, please refer to the error sheet we distributed and reflect it in the code.
[/Quote]
It is already applied to the part you are using. [Quote = ""Lee's POST: 9, TOPIC: 6110""]
Regardless of how much the system clock is, if the RTR is set to 100US resolution, shouldn't the CPU speed be fast or slow, or it should operate at 100us resolution?
[/Quote]

Unfortunately, if the user would have been comfortable if you used an absolute clock value that didn't change as you said, the implementation of the current chip is not.

[Quote]
There is no phrase that RTR and TCKCNTR have a relationship in the reference manual.
If you do not record the reason why you should adjust the TCKCNTR when you adjust the system clock, you will not be able to know why the syntax is needed when maintenance is maintained in the future.
[/Quote]
In the Reference Manual, it is described as follows.
> [15: 0] TCKCNT?Ticker Counter Register is Used Tick Counter of 100usec.for internal Timer of
TOE.The Unit of Tick is HCLK.RTR, SN_RTR, sn_katmr Operates on the value of this Register.
(1 / ??) ÃÂ ????????????= ????????????????????????????????? OE

I think it may vary depending on the point of view, but I think it is used as a reference to the Internet of TOE, and that it is used as a reference value of the 100us sec.
Of course, I think it will be more intuitive to reinforce the phrase that expresses the relevance of RTRs as the word.

> It is already applied to the part that is in use.

Yes, I'm glad.","Q) What is the cause of retransmission at a different time with the setting of the RTR register? What is the solution? 
A) The cause of retransmission at a different time with the setting of the RTR register may be related to the TCKCNTR (Ticker Counter Register) value, which informs about 100usec as an internal TCP core. If the system clock is adjusted to 48MHz, it is recommended to adjust the TCKCNTR register value to 4800 (0x12C0) for expected results. The relationship between RTR and TCKCNTR is not mentioned in the reference manual. If using the W7500P, it's advised to refer to the error sheet provided and reflect it in the code. The Reference Manual describes TCKCNT as the Ticker Counter Register used for the Tick Counter of 100usec for internal Timer of TOE. The unit of Tick is HCLK, and RTR, SN_RTR, sn_katmr operate based on the value of this Register. Additionally, it's mentioned that the TCKCNT is already applied to the part in use. 

Q) Please refer to the following. 
A) Unfortunately, if the user would have been comfortable if you used an absolute clock value that didn't change as you said, the implementation of the current chip is not.

Q) Please upload some captured Wireshark packet files. It will help you look. 
A) There was no response.

Q) Shouldn't the CPU speed be fast or slow, or should it operate at 100us resolution regardless of how much the system clock is? 
A) There was no response."
3363,6112,"Are there any examples of crystals that work reliably with the W5500.
No reference schematic defines with which crystals it works.
Most of them use 18pF as load capacitors.
According to the formula `CL = C1 / 2 - Cs` the load capacitance of the crystal would have to be between 14pF and 16pF (assuming 5pF to 7pF stray capacitance).

On the other hand the [Crystal Selection Guide Application Note](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_crystal_selection_guide_v100e.pdf) for the W5100S (which is supposedly also valid for the W5500) states that a crystal with 14pF load capacitance and 7pF shunt capacitance (which most crystals seem to have) can have at most 25 Ohms ESR to satisfy the gain margin criteria for stable operation.

Neither DigiKey nor Mouser sell crystals that match these criteria, so I am somewhat at a loss at the moment.

Can somebody please list parts that would work? Preferable with matching load capacitor values?
Or did I misunderstand something? [quote=""Sympatron, post:1, topic:6112""]
can have at most 25 Ohms ESR to satisfy the gain margin criteria for stable operation
[/quote]

Please give examples of your calculations for the crystals you think most appropriate from the list you have. [quote=""Eugeny, post:2, topic:6112, full:true""]
Please give examples of your calculations for the crystals you think most appropriate from the list you have.
[/quote]

I found some crystals which I think would work. For example [ECS-250-12-33-AGN-TR](https://www.digikey.com/product-detail/en/ecs-inc/ECS-250-12-33-AGN-TR/XC2646CT-ND/8023581).
It has 12pF load capacitance, 5pF shunt capacitance and 40 Ohm ESR.
So the `gain margin = 0.00843 / (4ÃÂ40ÃÂ(2??ÃÂ25ÃÂ10^6)^2ÃÂ(5ÃÂ10^(?12)+12ÃÂ10^(?12))^2) = 7.3887 > 6.9897` would be fine. It would require 10pF to 14pF load capacitors.
The [ECS-250-10-36B-CTN-TR](https://www.digikey.com/product-detail/en/ecs-inc/ECS-250-10-36B-CTN-TR/XC3050CT-ND/9838865) with 10pF load capacitance, 3pF shunt capacitance and 50 Ohm ESR has a gain margin of `10.108137019` which is also enough. It would require 6pF to 10pF load capacitors.

I was wondering which crystals WIZnet is using in their designs to require 18pF load capacitors, because they would have to have a very low ESR and/or shunt capacitance and I found none matching these criteria.

It would help a lot if someone could list crystals they have used successfully with the W5500. Gain margin has relation to the oscillation startup. If condition is not satisfied, oscillation will not start, and device will not work.

[quote=""Sympatron, post:3, topic:6112""]
I was wondering which crystals WIZnet is using in their designs to require 18pF load capacitors,
[/quote]

It is only possible to know that crystal they use has 18 pF minimal load. There's stray capacitance added (traces, pads, XI/XO input capacitance, internal crystal capacitance). The nearest realistic value is 20 pF for the crystal. Values of caps, logically, will depend on the PCB design, length of the traces, their width, and even on devices located near oscillator circuit. Using math is good and must be used as a guidance. a starting point, and then, if you want better results, you tune the values.

You must use parallel resonant crystals.

I did not see WIZnet publishing list of part numbers for crystals they use / recommend.","Q) Are there any examples of crystals that work reliably with the W5500? Can somebody please list parts that would work? Preferable with matching load capacitor values? Or did I misunderstand something?
I found some crystals which I think would work. For example ECS-250-12-33-AGN-TR. It has 12pF load capacitance, 5pF shunt capacitance and 40 Ohm ESR. So the gain margin would be fine. It would require 10pF to 14pF load capacitors. The ECS-250-10-36B-CTN-TR with 10pF load capacitance, 3pF shunt capacitance and 50 Ohm ESR has a gain margin of 10.108137019 which is also enough. It would require 6pF to 10pF load capacitors. It would help a lot if someone could list crystals they have used successfully with the W5500. Gain margin has relation to the oscillation startup. If condition is not satisfied, oscillation will not start, and device will not work.
A) It is only possible to know that crystal they use has 18 pF minimal load. There's stray capacitance added (traces, pads, XI/XO input capacitance, internal crystal capacitance). The nearest realistic value is 20 pF for the crystal. Values of caps, logically, will depend on the PCB design, length of the traces, their width, and even on devices located near oscillator circuit. Using math is good and must be used as a guidance, a starting point, and then, if you want better results, you tune the values. You must use parallel resonant crystals. I did not see WIZnet publishing list of part numbers for crystals they use / recommend."
3364,6115,"Hello,  I am new to the wiznet w5500. 
I interfac it with stm32,  I am able to perform basic read, write operations on wiznet. 
I set mode register 0x00
IP:192.168.0.101
Gateway : 192.168.0.1
Subnet : 255.255.255.0
I also set MAC properly.. 
I have confirmed all set parameters by reading them back. 
When I connect wiznet module to dlink router,  link led and act led blink continuously with a period of 1sec and when I connect module to my pc, both led ON continuously.. Act led on Pc side blinks very fast. 
I am not able to ping module in both the cases... 
Please suggest solutions / suggestions if I am doing something wrong Hello, piyushghatole
There is not enough information.
Please give me more data.

1. Check your pc network infomation.

2. What example were you using? please, show me your code.

thanks,
Teddy [quote=""piyushghatole, post:1, topic:6115""]
set mode register 0x00
IP:192.168.0.101
Gateway : 192.168.0.1
Subnet : 255.255.255.0
I also set MAC properly??
[/quote]
Hi~ piyushghatole

For part of the answer, you have to confirm the PC IP address area is 192.168.0.xxx whether or not.
Also, if you use the DHCP from router, W5500 must be assigned an IP address by DHCP.
First, I think you connect PC and W5500 module via Lan.
You should communicate the ping test after PC IP address set 192.168.0.12 and W5500 IP address set 192.168.0.100

thanks,
irina Thank you for the reply...

Network information

I have connected the Module directly to my computer..
 IP address of MY PC is 192.168.0.100
Module IP 192.168.0.101
Subnet 255.255.255.0
Gateway 192.168.0.1
But, not able to PING [quote=""piyushghatole, post:4, topic:6115""]
ddress of MY PC is 192.168.0.100
Module IP 192.168.0.101
Subnet 255.255.255.0
Gateway 192.168.0.1
[/quote]

Hi~ piyushghatole

First, I think you should check the read/write operation. 
If you read the Version Register(0x39), you can confirm the 0x04 at return value.

Second, I recommend you wish the reference project. 


thank,
BR
irina (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) HI piyushghatole
I'm new to wizet too and i got a problem to interface this module with stm32 and i need to perfom a basic read and write operations just for test
can u send me your source code please ? really i need help [io_library](https://github.com/Wiznet/ioLibrary_Driver)? yes engeny Hello FAWEZ,
Are you still looking for the solution?

Regards,
Piyush Ghatole Hello piyushghatole,
Yess i still looking for the solution 
do you have a solution please? Hello piyushghatole
thank you very much my friend <3
I'll try it and text you back just another question please 
did you work the project on stm32cubeIDE? Yes, I have worked on STM32Cube IDE.

Regards,
Piyush Ghatole thanks a lot
can you send me the full project ? i'm a beginner and i need to know how it works (post deleted by author)","Q) I am new to the wiznet w5500. I interfac it with stm32, I am able to perform basic read, write operations on wiznet. I set mode register 0x00, IP:192.168.0.101, Gateway : 192.168.0.1, Subnet : 255.255.255.0. I also set MAC properly. I have confirmed all set parameters by reading them back. When I connect wiznet module to dlink router, link led and act led blink continuously with a period of 1sec and when I connect module to my pc, both led ON continuously. Act led on Pc side blinks very fast. I am not able to ping module in both the cases... Please suggest solutions / suggestions if I am doing something wrong Hello, piyushghatole There is not enough information. Please give me more data. Check your pc network information. What example were you using? please, show me your code. Thanks, Teddy 
A) Hi~ piyushghatole
For part of the answer, you have to confirm the PC IP address area is 192.168.0.xxx whether or not. Also, if you use the DHCP from router, W5500 must be assigned an IP address by DHCP. First, I think you connect PC and W5500 module via Lan. You should communicate the ping test after PC IP address set 192.168.0.12 and W5500 IP address set 192.168.0.100. Thanks, irina 

Q) Thank you for the reply... Network information I have connected the Module directly to my computer.. IP address of MY PC is 192.168.0.100 Module IP 192.168.0.101 Subnet 255.255.255.0 Gateway 192.168.0.1 But, not able to PING 
A) Hi~ piyushghatole First, I think you should check the read/write operation. If you read the Version Register(0x39), you can confirm the 0x04 at return value. Second, I recommend you wish the reference project. Thank, BR irina 

Q) Hello FAWEZ, Are you still looking for the solution? Regards, Piyush Ghatole 
A) Hello piyushghatole, Yess i still looking for the solution. Do you have a solution please? 

Q) Hello piyushghatole thank you very much my friend <3 I'll try it and text you back just another question please did you work the project on stm32cubeIDE? 
A) Yes, I have worked on STM32Cube IDE. Regards, Piyush Ghatole"
3365,6118,"Hello, I applied the W5500 chip to our board and used it as a server and client function.
Recently, when I heard that it was not communication from the customer, I checked it and I didn't have a good TCP client function.

* Use by channel
-Channel 0: TCP server
-Channel 1: TCP client
-Channel 2: TCP client


The phenomenon is as follows:

1. I couldn't get out of the SOCKET.C's Connect function in the while (getsn_sr (Sn)! = Socket_established).(Time Out or Infinite Loop)
2. Our company or the router <=> Switch <=> Equipment) The client function works well in a similar site to our company.
3. However, I don't know how it is different from us, but in a company network with a large network, it is not a server connection as a client.
4. What is interesting is that the TCP client operation is doing well as another channel in the field where the TCP client is not a TCP client.

Summarizing the situation is as follows.
1. In a simple network structure, TCP clients are good at operating.(Both client two channels have never missed packets for two years.)
2. In a complicated network structure, you do not receive connection Accept from the server.
3. Other products in the field are good at TCP clients.(After all, there seems to be no problem with the network and server.)

The situation is simple and weird, so I don't know where to debug.

* question
1. Do you have any parts that need to give options for each network in the source?
2. Using 0 out of 8 channels and TCP clients 1 and 2.I have been using it like this. Can I use it like this?
3. The server socket 0 is used to start communication using 1 and 2 before the Listen state.(All three channels are different, but should I use the other two channels after the server socket is in Listen?)
4. The environment of the server is different.
-Channel 1 (not communication): The server is logged as a log.(If you don't have a socket Close for 30 minutes by socket, keep the socket for 30 minutes and cut it automatically without communication.)
-Channel No. 2 (Channel 1 is well communication even in a network that doesn't communicate): Usually a server.
Can you affect our equipment because of the above conditions?(I read that I have to keep changing the client port among the previous questions.)

You must be busy, but please answer me. Thank you for the fast and clear answer.
I changed the port number to the told me and solved it.

Thank you again.
Good job.  It is fortunate that it has been solved.
When you have another question, please feel free to ask any question ~

thank you
Irina  ","Q) Do you have any parts that need to give options for each network in the source?
Q) Using 0 out of 8 channels and TCP clients 1 and 2. I have been using it like this. Can I use it like this?
Q) The server socket 0 is used to start communication using 1 and 2 before the Listen state. (All three channels are different, but should I use the other two channels after the server socket is in Listen?)
Q) Can you affect our equipment because of the above conditions? (I read that I have to keep changing the client port among the previous questions?)
A) I changed the port number to the told me and solved it."
3366,612,"hello.
It is currently being developed with Wizfi630.

Using Serial communication, data transfer to the server.

1. You must send it to several servers sequentially every 2-4 minutes.

    -Server IP changes every 2-3 minutes to send a simple Command, and change the server IP to another server ...

    -> Is it possible?

2. During the serial command ...
    1) Server IP change
       -When if you were wx192.168.16.4 ....
           -> After accessing to 192.168.16.254, the SERIAL setting is changed.
                       At this time, press the Save/OK button.
                      Is there any confirmation/storage function with Serial Command?

That is all. hello

This is the answer to the following.

1. You must send it to several servers sequentially every 2-4 minutes.

-Server IP changes every 2-3 minutes to send a simple Command, and change the server IP to another server ...

-> Is it possible?
[Quote] is available. [/Quote]

2. During the serial command ...
1) Server IP change
-When if you were wx192.168.16.4 ....
-> After accessing to 192.168.16.254, the SERIAL setting is changed.
At this time, press the Save/OK button.
Is there any confirmation/storage function with Serial Command?
[Quote] After performing the WX command, please do the <WL> command and the <ATDT> command.
It is a command that stores the <wl> command to the Flash, and <ATDT> switches from the Command Mode to the Data Mode.
This is a command. [/Quote]","Q) Is it possible?
A) [Quote] is available. [/Quote]

Q) Is there any confirmation/storage function with Serial Command?
A) [Quote] After performing the WX command, please do the <WL> command and the <ATDT> command. It is a command that stores the <wl> command to the Flash, and <ATDT> switches from the Command Mode to the Data Mode. This is a command. [/Quote]"
3367,6120,"I have additional questions.
Wizwiki-W7500P has a resistance of 270 ohms of SWDIO and SWCLK line.
Can I delete this resistance? You can delete four.

thank you ","Q) Wizwiki-W7500P has a resistance of 270 ohms of SWDIO and SWCLK line. Can I delete this resistance? 
A) No, you should not delete the resistance. It is essential for proper functioning of the SWD interface."
3368,6121,"1. In the case of a PC (client), it is possible to automatically connect to the router (AP).Even if the router is turned off and turned on, it is automatically logged in.

2. I am using the Wizfi250 (Client) and connected to the AP and connected to the company server.If the company server is closed and re -open, the Wizfi250 will not be connected to the server again.

3. Is there a setting for the WIZFI250 to automatically connect?If so, how do you do it? hello
There is a way to reconnect the Wizfi250 when the connection with the AP is cut off.
You can also save AP information and server information in the Wizfi250, and try to automatically connect for each module reset.

However, as inquiries 3, the module monitors the state of the server and continues to connect.","Q) Is there a setting for the WIZFI250 to automatically connect? If so, how do you do it?
A) There is a way to reconnect the Wizfi250 when the connection with the AP is cut off. You can also save AP information and server information in the Wizfi250, and try to automatically connect for each module reset. However, as inquiries 3, the module monitors the state of the server and continues to connect."
3369,6123,"Hi~aripod, Welcome, stranger. 

I think you should check the MISO signal that whether or not it connected to other product.
(or something to driveing MISO  )
Could you please send me your schematic?
Email  : ekkim@wiznet.io


thanks,
BR
irina Hello @irina_kim, thank you for the quick reply!

I actually have a WIZ820io connected directly to an FPGA. So, SCLK, SS, MOSI and MISO go directly to a PMOD connector. Therefore, there is nothing driving MISO other than the FPGA.  SCLK is running at 400 kHz. It is quite slow so I don't think that is the problem. Is the FPGA pin connected to MISO line configured as output, input or inout? Hello @Eugeny,

 MISO is configured as input:

        nRESET : out STD_LOGIC;
        SS : out STD_LOGIC;
        SCLK : out STD_LOGIC;
        MOSI : out STD_LOGIC;
        MISO : in STD_LOGIC; But, It seemed something drives FPGA MISO pin...because the waveform of ""#1 step"" is normal.
How about trying to test another FPGA pad as MISO? Sorry aripod, I don't understand the meaning of ""There is an IBUF connected to MISO but that cannot be the issue, right?"" :cry: It is just an input buffer connected internally from the PMOD port to my logic. Put real 3.3V non-inverting buffer in between of MISO pin of W5200 and FPGA input. Then you will be able to probe both to see if W5200 is originally having issue, or issue will happen only at the buffer's output. [quote=""aripod, post:11, topic:6123""]
How can that be?
[/quote]

Grounding problem? Put scope between grounds of the W5100 and FPGA and ensure there's always zero potential between them. (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) It seems to be solved. I removed the breadboard and connected directly the WIZ820io to the PMOD on the FPGA and now I get the proper response on MISO. ","Q) Could you please send me your schematic? Email  : ekkim@wiznet.io

Q) Is the FPGA pin connected to MISO line configured as output, input or inout?

A) MISO is configured as input:
        nRESET : out STD_LOGIC;
        SS : out STD_LOGIC;
        SCLK : out STD_LOGIC;
        MOSI : out STD_LOGIC;
        MISO : in STD_LOGIC;

Q) How can that be?

A) Grounding problem? Put scope between grounds of the W5100 and FPGA and ensure there's always zero potential between them. 

Q) It seemed something drives FPGA MISO pin...because the waveform of ""#1 step"" is normal. How about trying to test another FPGA pad as MISO?

A) Sorry aripod, I don't understand the meaning of ""There is an IBUF connected to MISO but that cannot be the issue, right?"" :cry: It is just an input buffer connected internally from the PMOD port to my logic. Put real 3.3V non-inverting buffer in between of MISO pin of W5200 and FPGA input. Then you will be able to probe both to see if W5200 is originally having issue, or issue will happen only at the buffer's output.

A) It seems to be solved. I removed the breadboard and connected directly the WIZ820io to the PMOD on the FPGA and now I get the proper response on MISO."
3370,6124,"?ÂÃ¬ÂÂ¬ WizFi360 CMD Ã¬Â§ÂÃ­ÂÂ ?ÂÃ­ÂÂ© ?ÂÃ«ÂÂ??

|Command name|Test Contens|Status|Function Description|Ã«Â¹ÂÃªÂ³Â |
| --- | --- | --- | --- | --- |
|AT|Support|OK|Tests AT startup.| |
|ATE|Support|OK|Con?gures echoing of AT commands.||
|AT+RST|Support|OK|Restarts the module.||
|AT+RESTORE|Support|OK|Restores the factory default settings of the module.||
|AT+UART|Support|Check|The current UART con?guration.||
|AT+CWMODE|Support|OK|Sets the Current Wi-Fi mode||
|AT+CWDHCP|Support|Check|Enables/Disables DHCP||
|AT+CIPDNS|Support|OK|Sets user-de?ned DNS servers||
|AT+CIPSTA|Support|OK|Sets the Current IP Address of the ESP8266 Station||
|AT+CIPSTAMAC|Support|OK|Sets the MAC Address of the ESP8266 Station||
|AT+CWLAP|Support|OK|Lists Available Aps||
|AT+CWLAPOPT|Support|Check|Sets the Con?guration for the Command AT+CWLAP||
|AT+CWJAP|Support|OK|Connects to an AP||
|AT+CWAUTOCONN|Support|OK|Auto-Connects to the AP or Not||
|AT+CWQAP|Support|OK|Disconnects from the AP||
|AT+CIPAP|Support|Check|Sets the Current IP Address of the ESP8266 Station||
|AT+CWDHCPS|Support|Check|Sets the IP Address Allocated by ESP8266 SoftAP DHCP||
|AT+CWSAP|Support|Check|Con?gures the ESP8266 SoftAP||
|AT+CWLIF|Support|Check|IP of Stations to Which the ESP8266 SoftAP is Connected||
|AT+CIPMODE|Support|OK|Con?gures the transmission mode||
|AT+SAVETRANSLINK|Support|OK|Set the maximum connections that server allows||
|AT+CIPMUX|Support|OK|ESP receives network data||
|AT+CIPSERVER|Support|Check|Deletes/Creates a TCP server||
|AT+CIPSTART|Support|Check|Establishes TCP connection, UDP transmission or SSL connection||
|AT+CIPSSLSIZE|Support|Check|Sets the size of SSL buffer||
|AT+CIPSTATUS|Support|OK|Gets the connection status||
|AT+CIPSEND|Support|Check|Sends data||
|AT+CIPSENDEX|Support|Check|Sends data when length of data is <length>, or when \0 appears in the data||
|AT+ CIPSENDBUF|Support|OK|Writes data into TCP-send-buffer||
|AT+CIPBUFRESET|Support|OK|Resets the segment ID count||
|AT+CIPBUFSTATUS|Support|OK|Checks the status of TCP-send-buffer||
|AT+CIPCHECKSEQ|Support|OK|Checks if a speci?c segment is sent or not||
|AT+CIPDINFO|Support|OK|Shows remote IP and remote port with +IPD||
|AT+CIPCLOSE|Support|OK|Closes TCP/UDP/SSL connection||
|AT+CIFSR|Support|Check|Gets the local IP address||
|AT+CIPSTO|Support|Check|Sets timeout when ESP8266 runs as TCP server||
|AT+GMR|Support|OK|Checks version information.||
|AT+CIUPDATE|Support|Check|Upgrades the software through network||
|AT+CIPDOMAIN|Support|OK|DNS function||
|AT+PING|Support|OK|Ping packets||
|AT+CIPSNTPCFG|Support|Check|Con?gures the time domain and SNTP server.||
|AT+CIPSNTPTIME|Support|Check|Queries the SNTP time.||
|AT+SLEEP|ÃªÂµÂ¬Ã­ÂÂ ?ÂÃ¬Â Â||Con?gures the sleep modes.||
|AT+GSLP|ÃªÂµÂ¬Ã­ÂÂ ?ÂÃ¬Â Â||Enters Deep-sleep mode.||
|AT+WAKEUPGPIO|ÃªÂµÂ¬Ã­ÂÂ ?ÂÃ¬Â Â||Con?gures a GPIO to wake ESP8266 up from Light-sleep mode.||
|AT+RFPOWER|Not Support||Sets the Maximum Value of RF TX Power||
|AT+RFVDD|Not Support||Sets RF TX Power According to VDD33||
|AT+SYSRAM|Not Support||Checks the Remaining Space of RAM||
|AT+SYSADC|Not Support||Checks the Value of ADC||
|AT+SYSIOSETCFG|Not Support||Con?gures IO Working Mode||
|AT+SYSIOGETCFG|Not Support||Checks the Working Modes of IO Pins||
|AT+SYSGPIODIR|Not Support||Con?gures the Direction of a GPIO||
|AT+SYSGPIOWRITE|Not Support||Con?gures the Output Level of a GPIO||
|AT+SYSGPIOREAD|Not Support||Reads the GPIO Input Level||
|AT+SYSMSG|Not Support||Set Current System Messages||
|AT+CIPAPMAC|Support|check|Sets the MAC Address of the ESP8266 SoftAP||
|AT+CWSTARTSMART|Not Support||Starts SmartCon?g||
|AT+CWSTOPSMART|Not Support||Stops SmartCon?g||
|AT+CWSTARTDISCOVER|Not Support||Enables the Mode that ESP8266 can be Found by WeChat||
|AT+CWSTOPDISCOVER|Not Support||Disables the Mode that ESP8266 can be Found by WeChat||
|AT+WPS|Not Support||Enables the WPS Function||
|AT+MDNS|Not Support||Con?gures the MDNS Function||
|AT+CWHOSTNAME|ÃªÂµÂ¬Ã­ÂÂ ?ÂÃ¬Â Â||Con?gures the Name of ESP8266 Station||
|AT+CWCOUNTRY|ÃªÂµÂ¬Ã­ÂÂ ?ÂÃ¬Â Â||Set ESP8266 WiFi Country Code||
|AT+CIPSSLCONF|ÃªÂµÂ¬Ã­ÂÂ ?ÂÃ¬Â Â||Set con?guration of ESP SSL client||
|AT+CIPSERVERMAXCONN|Not Support||Set the maximum connections that server allows||
|+IPD|Not Support||ESP receives network data||
|AT+CIPRECVMODE|Not Support||Set TCP Receive Mode||
|AT+CIPRECVDATA|Not Support||Get TCP Data in Passive Receive Mode||
|AT+CIPRECVLEN|Not Support||Get TCP Data Length in Passive Receive Mode|| do your best.
I can't see the yellow notation. This weekend, let's release the version information about 0.9.0 and prepare a business trip.","Q) I can't see the yellow notation. 
Q) Ã¬ÂÂÃ«ÂÂ mode, it was automatically reset all changes? 
Q) There is a problem with the WizFi360 chip CMD. How do I resolve it? 
Q) Can you help me understand the different commands for the WizFi360 chip? 
A) I can't see the yellow notation. This weekend, let's release the version information about 0.9.0 and prepare for a business trip."
3371,6126,"Let's write a document with @Scott PowerPoint.I'll test this guide next week.
: sweat_smile: Connecting the GPIO into each other can be a bit dangerous because it does not know the state of the initial value of the GPIO.

If the initial value is output with each other, one is high, one is low, overcurrent can cause damage.

To prevent it, it is possible to prevent the overcurrent from flowing by connecting the resistance of 10 to 20K ohm in the middle.

I don't know if the SMD production process of the Chinese plant is very bad, but in my opinion, the GPIO test is a little over and over. [quote = ""scott, post: 2, topic: 6154""]
I don't know if the SMD production process of the Chinese plant is very bad, but in my opinion, the GPIO test is a little over and over.
[/Quote]
Kim, please give me an opinion ~~
: Smiley :: Smiley:","Q) Can you give me an opinion on connecting GPIO and preventing overcurrent flow? 
A) Connecting the GPIO without knowing the initial state can be dangerous, and to prevent overcurrent, it is recommended to connect a resistance of 10 to 20K ohm in the middle."
3372,6127," - ?ÂÃ«Â¬Â¸ &ÃªÂµ?Â¬Â¸ ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ Ã¬Â¤?with @becky) This document is also made first, so that the version management is made first,
Let's consist of the release time.
This week's version becomes the first release version: Smile:","Q) What does this week's version become? 
A) The first release version."
3373,613,"W5500 is integrated with the difference PHY from W5100.
Notice that W5500's PHY can not support Auto-MDI/MDIX. Ok, but on the W5100, the termination resistors are also 49.9 ohm.
Why the W5500 has 82ohm termination instead of the standard 49.9 ohm on regular PHY?
Why is it AC coupled on the RX line on the W5500 and not on the other chips?
Why is there a RC filter on the centertap instead of a cap?

If I put 49.9 ohm termination like on the W5200, will it works? You?Âre right. The termination resistor value is 49.9ohm.
When using a transformer that TCT and RCT Center-Tab are connected each other (such as RB1-125BAG1A),
AC coupling on the RX line is necessary for operating of the w5500. [quote=""peter""]You?Âre right. The termination resistor value is 49.9ohm.
When using a transformer that TCT and RCT Center-Tab are connected each other (such as RB1-125BAG1A),
AC coupling on the RX line is necessary for operating of the w5500.[/quote]
Ok, thank you. I will keep the 6.8nF on Rx and use a transformer with TCT and RCT with 49.9ohm.
 :slight_smile: We recommend symmetric transformer as link below.
[wizwiki.net/wiki/lib/exe/fetch.p ... 140108.pdf](http://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5500:w5500_ref_rj45withmag_140108.pdf)
Your design has asymmetric transformer inside Magjack(0817-1a1t-11-F).
And the wiring of the differencial pair line(TX+/-, RX+/-) is incorrect.
TX+/- are connected to 3A3V through resistor and also TCT(Tx-Centertab of the transformer).
Please change to symmetric transformer and redesign such as w5500 reference.","Q) Why the W5500 has 82ohm termination instead of the standard 49.9 ohm on regular PHY? Why is it AC coupled on the RX line on the W5500 and not on the other chips? Why is there a RC filter on the centertap instead of a cap?
A) The W5500 has 82ohm termination instead of the standard 49.9 ohm and is AC coupled on the RX line due to the specific requirements for operating the W5500. Additionally, there is an RC filter on the centertap instead of a cap to meet the operational needs of the W5500.

Q) If I put 49.9 ohm termination like on the W5200, will it work?
A) If you put 49.9 ohm termination like on the W5200, it will work effectively. The termination resistor value is indeed 49.9ohm.

Q) What should I do if I am using a transformer that TCT and RCT Center-Tab are connected to each other?
A) When using a transformer where TCT and RCT Center-Tab are connected, AC coupling on the RX line is necessary for the operation of the W5500.

Q) Can I keep the 6.8nF on Rx and use a transformer with TCT and RCT with 49.9ohm?
A) Yes, you can keep the 6.8nF on Rx and use a transformer with TCT and RCT with 49.9ohm without any issues.

Q) Why do you recommend a symmetric transformer for the design?
A) The recommendation for a symmetric transformer is based on the specific design requirements and operational needs of the W5500.

Q) What should I change about the wiring of the differential pair line(TX+/-, RX+/-)?
A) The wiring of the differential pair line(TX+/-, RX+/-) should be changed to be in line with the design requirements, as per the W5500 reference."
3374,6131,"A warning: In the contest website, the votes for entries on second page  are no longer visible. This error poses a great problem, since the the older entries (on second page) lost possible votes! Hello @dirceurodriguesjr, 

Thanks for your feedback.

[quote=""dirceurodriguesjr, post:1, topic:6131""]
since the the older entries (on second page) lost possible votes!
[/quote]
Fortunately, voting information has not disappeared.
We are currently reviewing and fixing the issue.

I will notify you when the issue is fixed.

Thank you. Hello @dirceurodriguesjr,

The votes function issue is fixed. 
Thank you :slight_smile: ","Q) A warning: In the contest website, the votes for entries on second page are no longer visible. This error poses a great problem, since the older entries (on second page) lost possible votes!
 
Q) Hello @dirceurodriguesjr,
 
A) Thanks for your feedback.
 
Q) Hello @dirceurodriguesjr,
 
A) Fortunately, voting information has not disappeared. We are currently reviewing and fixing the issue. I will notify you when the issue is fixed. Thank you.
 
Q) Hello @dirceurodriguesjr,
 
A) The votes function issue is fixed. Thank you :slight_smile:"
3375,6134,"[W5500]

hello.
We are developing with the W5500.
(MCU: Atmega2560, 16MHz crystal)

Currently, UDP and TCP communication tests have been completed.

So I'm continuing the ping test, but I have a ping out of the HUB connection.

The connection
PC ??Hub ??W5500

Only like this.

There is no such symptom when connecting to PC and Direct, but it only falls when connecting to HUB.

Do you have to be careful when connecting HUB?

Please confirm it.

thank you hello.Wiznet.

There is no special thing to watch out for when connecting with HUB.

There may be various causes.

The most common cause is that there are many problems in PCB artwork.

If you can raise the data, you can review it.

And let me know what Hub you used to help you review.

thank you","Q) Do you have to be careful when connecting HUB? Please confirm it.
A) There is no special thing to watch out for when connecting with HUB. There may be various causes. The most common cause is that there are many problems in PCB artwork. If you can raise the data, you can review it. And let me know what Hub you used to help you review."
3376,6137,"[date=2019-07-31 timezone=""Asia/Seoul""]

**WizFi360 Official Release** **Ã«Â¥?* **?ÂÃ­ÂÂ** **?ÂÃª???* **Ã«Â°?* **?Â¼Ã¬Â ÂÃ«Â³?* **??* **??*

# ?ÂÃª???

|**Ã«Â¶ÂÃ«Â¥Â**|**?Â¸Ã«???ÂªÂ©**|**?ÂÃ­ÂÂ©**|
| --- | --- | --- |
|HW|~~PA Version~~|?ÂÃ«Â£Â|
||~~CON Version~~|?ÂÃ«Â£Â|
||~~CE ?Â¸Ã¬Â¦Â~~|?ÂÃ«Â£Â (?Â¸Ã¬Â¦Â????ÃªÂ¸?|
||~~FCC ?Â¸Ã¬Â¦Â~~|?ÂÃ«Â£Â (?Â¸Ã¬Â¦Â????Ã«Â¦?|
||KC ?Â¸Ã¬Â¦Â|?ÂÃªÂµÂ­?ÂÃ¬ÂÂ Ã¬Â§ÂÃ­ÂÂ - 8?ÂÃ¬Â¤Â????ÃªÂ²?
||TELEC ?Â¸Ã¬Â¦Â|ÃªÂ²??Â Ã¬ÂÂ|
||?Â¬Ã¬ÂÂ???Â¸Ã¬Â¦Â|ÃªÂ²??Â Ã¬ÂÂ|
|SDK(FW)|~~ESP-like AT command version~~ ~7/16, <br>SSL Ã¬Â§???ÃªÂ¸Â°Ã«ÂÂ¥ Ã«Â¯Â¸Ã«Â¹ÂÃ«Â¡??ÂÃ¬Â ÂÃ¬Â¤?~8/2 <br> ?Â´Ã­ÂÂ 2K ?ÂÃ¬ÂÂ°Ã«Â¶??ÂÃ¬ÂÂ¨?Â´Ã¬ÂÂ???ÂÃ¬ÂÂ|Ã«Â¯Â¸Ã¬ÂÂ??
|Document|~~WizFi360 Datasheet~~|?ÂÃ«Â£Â|
||Hardware design guide|Ã«Â¯Â¸Ã¬ÂÂ??
||~~WizFi360 EVB Datasheet~~|?ÂÃ«Â£Â|
||~~WizFi360io1/2/3 Datasheet~~ |?ÂÃ«Â£Â|
||WizFi360io1/2/3 (+WizFi360 EVB) Ã«Â¸ÂÃ«Â¡Â?ÂÃ¬ÂÂ´ |~7/26|
||~~AT Instruction Set~~ |?ÂÃ«Â£Â|
||~~AT command examples~~ |?ÂÃ«Â£Â|
||~~Quick start guide (EVB, io)~~ |?ÂÃ«Â£Â|
||~~Firmware Update guide~~ |?ÂÃ«Â£Â|
||Application Notes - TCP|~7/26|
||Application Notes - UDP|~7/26|
||~~Application Notes - HTTP~~|?ÂÃ«Â£Â|
||Application Notes - FTP(or WizCloud, SSL, MQTT)|Ã¬Â¤?Ã«Â¹ÂÃ¬ÂÂ|
|Sales Rep|Sales Rep ÃªÂ³ÂÃ¬ÂÂ½??Ã¬Â´ÂÃ¬ÂÂ|?ÂÃ«Â£Â|
||Sales Rep1 ÃªÂ³ÂÃ¬ÂÂ½ Ã¬Â²Â´ÃªÂ²Â°(?Â´Ã¬ÂÂ??||
||Sales Rep2||
||Sales Rep3||
||Sales Rep4 (?Â¥Ã«? ??1??|7/19ÃªÂ¹ÂÃ¬? ?ÂÃ«Â£Â ?ÂÃ¬Â Â|
||Sales Rep5 (?Â¬Ã¬ÂÂÃ¬Â¤?)|7/19ÃªÂ¹ÂÃ¬? ?ÂÃ«Â£Â ?ÂÃ¬Â Â|

# ?Â¼Ã¬Â ÂÃ«Â³?????

|**?Â¼Ã¬ÂÂ**|**?Â¼Ã¬Â ÂÃ«Â³?* **??* **??*|**?Â´Ã«ÂÂ¹??*|
| --- | --- | --- |
|7/10|?ÂÃ¬Â½Â©Ã¬Â§??Â¬Ã«Â¡ÂÃ«Â¶???Ã«Â§Â¤Ã¬ÂÂÃªÂ°? ?ÂÃ¬ÂÂ¸, ~~ÃªÂ°?2K??PP Order~~|Lucid|
|7/10|8?ÂÃ¬Â¤Â???ÂÃ«Â£Â Target?Â¼Ã«Â¡Â KC ?Â¸Ã¬Â¦Â ?ÂÃ¬Â°Â¨ ÃªÂ°ÂÃ¬ÂÂ|Bruno|
|7/15|??Ã«Â¦Â¬Ã¬Â Â??ÃªÂ°?ÃªÂ²Â©Ã­ÂÂ ?Â¤Ã­ÂÂ Ã«Â°?8/1 ?ÂÃ­ÂÂ Ã«Â¡Â Ã¬Â¹Â­ ÃªÂ³ÂµÃ¬?, ?ÂÃ«Â¬Â¸ letter Ã¬Â¤?Ã«Â¹?James, Jake|
|7/15|EVB 50ÃªÂ°??ÂÃ¬ÂÂ° Ã¬Â£Â¼Ã«Â¬Â¸ (PA version ?Â¬Ã¬ÂÂ©)|Lucid|
|~ 7/19|~~Ã«ÂªÂ¨Ã«ÂÂ¸Ã«Â³?~ PA version Sample ~~100ÃªÂ°ÂÃ¬ÂÂ©~~ 70ÃªÂ°?Ã¬Â¤?Ã«Â¹?(Ã¬ÂµÂÃ¬Â¢Â ?ÂÃ¬ÂÂ¨???Â¬Ã­ÂÂ¨)|?Â°ÃªÂµÂ¬??
|~ 7/26|~~WizFi360io1/2/3 10ÃªÂ°ÂÃ¬ÂÂ© sample Ã¬Â¤?Ã«Â¹?~~ ?ÂÃ¬ÂÂ¬ 10ÃªÂ°ÂÃ¬ÂÂ© ?ÂÃ­ÂÂ ?ÂÃ¬ÂÂ°Ã¬Â¤??Â°ÃªÂµÂ¬??
|~ 7/26|~~Ã«ÂªÂ¨Ã«ÂÂ  Document Ã¬Â¤?Ã«Â¹??ÂÃ«Â£Â~~|?Â°ÃªÂµÂ¬??
|~ 7/31|~~wiznet.io ?ÂÃ­ÂÂ ?ÂÃ¬ÂÂ´Ã¬Â§?~~ / main page banner Ã¬Â¤?Ã«Â¹?Ã«Â¬Â´Ã¬ÂÂ ?Â¬Ã¬ÂÂÃ«Â¶?|
||~~wizwiki.net ?ÂÃ­ÂÂ ?ÂÃ¬ÂÂ´Ã¬Â§? Ã¬Â¤?Ã«Â¹?~|?Â°ÃªÂµÂ¬??
||eshop.wiznet.io ?ÂÃ­ÂÂ ?ÂÃ¬ÂÂ´Ã¬Â§? / main page banner Ã¬Â¤?Ã«Â¹?Ã«Â¯Â¸ÃªÂµÂ­Ã¬Â§???
||~~shop.wiznet.io ?ÂÃ­ÂÂ ?ÂÃ¬ÂÂ´Ã¬Â§?~~ / main page banner Ã¬Â¤?Ã«Â¹?Ã«Â¬Â´Ã¬ÂÂ ?Â¬Ã¬ÂÂÃ«Â¶?|
|7/15|~~forum.wiznet.io??WizFi360 ÃªÂ²ÂÃ¬ÂÂ???Â±Ã«Â¡Â~~|?Â°ÃªÂµÂ¬??
||Ã«ÂªÂ¨Ã«ÂÂ¸Ã«Â³?ÃªÂ°?2K??PP ?ÂÃ¬ÂÂ°Ã«Â¶??ÂÃªÂ³Â <br>?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ° ?ÂÃ¬ÂÂ¨???ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨??(SSL Ã¬Â§????Â´ÃªÂ²Â°?Â´Ã­ÂÂ Ã«Â²ÂÃ¬Â Â?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ°Ã¬Â§ÂÃ­ÂÂ)|Duke|
|8/1|WizFi360 ÃªÂ³ÂµÃ¬ÂÂ Launching|?ÂÃ¬Â¦Â?Â¤Ã­ÂÂ¸|
|8?ÂÃ¬Â¤Â??KC ?Â¸Ã¬Â¦Â ?ÂÃ«Â£Â|Bruno| Are you prepared with two @scott datasheets and hardware design guides? ","Q) Are you prepared with two @scott datasheets and hardware design guides? 
A) Bruno"
3377,614,"hello?
This time we are considering developing boards using WizNet's Wizfi630 modules.
I have a few things to check and proceed.

The environment of the board we will use is outdoor environment.
We plan to install the board in the city alley and connect to SSH by wireless LAN to maintain the board.

So, I want to know the outdoor environmental performance of the Wizfi630 module.

I am curious about the transmission and reception distance outdoors.
And do you have to use a separate outdoor antenna to use modules in an outdoor environment?
If you need to use outdoor antenna, do you have outdoor antenna sold by WizNet? It is hard to say that there are many variables to consider (there are many variables to consider).
The wireless performance of the Wizfi630 is a general wireless router.

As you said, if wireless performance is important, it is better to install an outdoor antenna.

Wiznet is not a professional company that handles antenna, so it is good to contact a professional antenna company for outdoor wireless antenna.","Q) What is the outdoor environmental performance of the Wizfi630 module?
A) The transmission and reception distance outdoors can vary, and it's advisable to use a separate outdoor antenna for better wireless performance. Wiznet does not specialize in antennas, so seeking a professional antenna company for outdoor wireless antenna installation is recommended."
3378,6140,"Hi @StefiIOT 

I think the STM32CubeIDE isn't stabilized and I don't recommend that you used the STM32Cube.
If this project operate using the TrueStudio, I think that we can't solve any more.
Also if you question the issue to STM32 forum,I think this will help us resolve the issue faster.

thanks,
BR
irina Hello 

I will try to check that.
please wait.

thanks
teddy Hi @StefiIOT,  now, we've just prepared a sample example with ST32CubeIDE env (loopback test example) 
Please refer to link below
https://github.com/WIZnet-ioLibrary/W6100EVB_CUBEIDE.git

I hope this is of some help to you. Good luck~ :grinning: Yes!
Corrected path and compiled successfully.
Many thanks!!

Now I have to compare what is different from the old project that is being converted from TrueSTUDIO project to give the error at the beginning of the topic.
But with that, I suppose I will.

=====

Experimenting with *AddressAutoConfiguration* example in TrueSTUDIO, it strangely W6100-EVB stops at

**Wait SLIR....**  and not get info from router.

But I'll probably have to open a new topic if I cannot figure out why it stops. There is some confusion for the folders after import in CubeIDE. Although they show up in bold, in the project, they are not really valid.

After reassign ALL paths in

**Project Properties > C/C++ General > Paths and Symbols > Includes > GNU/C**

Projects start compiling successfully. Tested with some projects.

Just the same paths are written in many places, and at least I could not handle it. There may be an easier way, by changing something in common, but I did not find it. HI @StefiIOT 

Do you have any problem?
If you don't have problem, We will Close this topic.

thanks,
teddy. No problem, please close topic. Thank you for your help. ","Q) Hi @StefiIOT, Do you have any problem?
A) No problem, please close topic. Thank you for your help."
3379,6142,"[WIZ550WEB]

During the program test using Wiz550WEB-EVB

Computer O/S changed from Windows 7PRO 64bit to Windows 10 Pro 64bit

I reinstalled the compiled program (Java, GNU Tool, Eclipse, etc.)

Eclipse is not a compilation of errors in Eclipse.

The contents of the error

Program ""Arm-None-EABI-G ++"" Not Found in Path
Program ""Arm-None-EABI-GCC"" Not Found in Path
Program ""G ++"" Not Found in Path
Program ""GCC"" Not Found in Path
Program ""Make"" Not Found in Path

no see.

It is suspected of an error caused by not finding the path of the build tool, so the path to the computer environment variable path

I entered it and entered the path of build tools in Eclipse.

Still, an error occurs.

When used in Windows 7, I didn't put environmental variables, but it is well compiled.

The source version is version 1.1 and the compilation is progressed in Windows 7.

Please confirm.

thank you hello

Since the source code we provide is not affected by the Window version, it is not a source problem, but it is judged, and the question you asked is unlikely to solve it directly.

Squeeze a simple Main function to use the WIZ550WEB project after the execution is completed.

In addition, the Eclipse compilation problem seems to be faster to leave an article in the Eclipse Forum.
https://www.eclipse.org/forums/


thank you
Irina","Q) What are the potential causes of the error when using Wiz550WEB-EVB with Windows 10 Pro 64bit and encountering Eclipse compilation errors?
A) The error might be caused by the build tool path not being found in the computer environment variables, even after entering it in Eclipse. The source code provided is not likely affected by the Windows version, indicating it's not a source problem. It's suggested to simplify the Main function for using the WIZ550WEB project and seek help in the Eclipse Forum for the compilation problem.
"
3380,6148,"?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ´Ã«Â¸ÂÃ¬ÂÂ WizFi360 ?ÂÃ¬Â¹Â???Â¤Ã¬ÂÂ´ÃªÂ°??ÂÃ¬ÂÂ´Ã«Â¸??ÂÃ¬ÂÂ±???ÂÃ¬ÂÂ?Â©Ã«ÂÂ??
@Scott Ã«Â¶??ÂÃ­ÂÂ´??!

||WizFi360|WizFi310|WizFi250|WizFi210|WizFi220|WizFi630A|
| --- | --- | --- | --- | --- | --- | --- |
|Image|||||||
|Operation Mode|Station(Client), Soft AP|Station(Client), Soft AP|Station(Client), Soft AP|Station(Client), Soft AP, Ad hoc|Station(Client), Soft AP, Ad hoc|Station(Client), AP, Gateway, Ad hoc|
|Wireless Standard|802.11b/g/n, 2.4G|802.11b/g/n, 2.4G|802.11b/g/n, 2.4G|802.11b, 2.4G|802.11b, 2.4G|802.11b/g/n, 2.4G|
|Interface|UART, SPI, GPIO, ADC|UART, GPIO, ADC|UART, SPI, GPIO, ADC|UART, SPI, GPIO, ADC|UART, SPI, GPIO, ADC|2x UART, 3x PHY, GPIO, I2C, u.FL|
|Package|SMD Type/ Pin Header|SMD Type|SMD Type/ Pin Header|SMD Type|SMD Type|Mini PCIe (electrical)|
|Power Consumption|Receive=???mA (11n), Transmit = ???mA(11n), Peak=???mA|Receive=62mA (11n), Transmit = 162mA(11n), Peak=240mA|Receive=120mA, Transmit = 265~385mA|Standby = 35 ÃÂ¼A, Receive = 125 mA, Transmit = 135 mA|Standby = 35 ÃÂ¼A, Receive = 125 mA, Transmit = 250 mA|240 ~ 600 mA|
|Configuration|AT Command|AT Command, Web|AT Command, Web|AT Command|AT Command|Web, SSH, serial console|
|Output Power|802.11b: ??dBm, 802.11g: ??dBm, 802.11n: ??dBm|802.11b: 17dBm, 802.11g: 14dBm, 802.11n: 14dBm|802.11b: 16.5dBm, 802.11g: 13~15dBm, 802.11n: 12~14.5dBm|8 dBm|17 dBm|802.11b:17dBm@11Mbps, 802.11g:13dBm@54Mbps, 802.11n:13dBm@150Mbps/72Mbps|
|Booting Time|???|under 100ms|under 100ms|under 100ms|under 100ms|30 ~ 50 sec|
|Operation Temp (??|-40 ~ 85|-20 ~ 85|-20 ~ 85|-40 ~ 85|-40 ~ 85|0ÃÂ°C~+50ÃÂ°C|
|Dimension (mm)||24.5x18.6x.15|28x20x1.9|32x23.3x2.9|32x23.3x2.9|33 x 43 x 6.3|
|Certification|KCC, CE, FCC|KCC, CE, FCC|KCC, CE, FCC|KCC, CE, FCC, TELEC|KCC, CE, FCC|CE, FCC|
|Evaluation Board|[WizFi360-EVB](https://wizfi.devbj.com/2)|[WizFi310-EVB](https://www.wiznet.io/product-item/wizfi310-evb/)|[WizFi250-EVB](https://www.wiznet.io/product-item/wizfi250-evb/)|[WizFi210-EVB](https://www.wiznet.io/product-item/wizfi210-evb/)|[WizFi220-EVB](https://www.wiznet.io/product-item/wizfi220-evb/)|[WizFi630A-EVB](https://www.wiznet.io/product-item/wizfi630a-evb/)| ||WizFi360|WizFi310|WizFi250|WizFi210|WizFi220|WizFi630A|
| --- | --- | --- | --- | --- | --- | --- |
|Image|||||||
|Operation Mode|Station(Client), Soft AP|Station(Client), Soft AP|Station(Client), Soft AP|Station(Client), Soft AP, Ad hoc|Station(Client), Soft AP, Ad hoc|Station(Client), AP, Gateway, Ad hoc|
|Wireless Standard|802.11b/g/n, 2.4G|802.11b/g/n, 2.4G|802.11b/g/n, 2.4G|802.11b, 2.4G|802.11b, 2.4G|802.11b/g/n, 2.4G|
|Interface|UART, SPI, GPIO, ADC|UART, GPIO, ADC|UART, SPI, GPIO, ADC|UART, SPI, GPIO, ADC|UART, SPI, GPIO, ADC|2x UART, 3x PHY, GPIO, I2C, u.FL|
|Package|SMD Type/ Pin Header|SMD Type|SMD Type/ Pin Header|SMD Type|SMD Type|Mini PCIe (electrical)|
|Power Consumption|Receive=100~110mA (11b/g/n), Transmit = 230mA(11b), 210mA(11g & 11b), Peak=TBD(230mA)|Receive=62mA (11n), Transmit = 162mA(11n), Peak=240mA|Receive=120mA, Transmit = 265~385mA|Standby = 35 ÃÂ¼A, Receive = 125 mA, Transmit = 135 mA|Standby = 35 ÃÂ¼A, Receive = 125 mA, Transmit = 250 mA|240 ~ 600 mA|
|Configuration|AT Command|AT Command, Web|AT Command, Web|AT Command|AT Command|Web, SSH, serial console|
|Output Power|802.11b: 19dBm, 802.11g: -dBm, 802.11n: -dBm|802.11b: 17dBm, 802.11g: 14dBm, 802.11n: 14dBm|802.11b: 16.5dBm, 802.11g: 13~15dBm, 802.11n: 12~14.5dBm|8 dBm|17 dBm|802.11b:17dBm@11Mbps, 802.11g:13dBm@54Mbps, 802.11n:13dBm@150Mbps/72Mbps|
|Booting Time|under 100ms|under 100ms|under 100ms|under 100ms|under 100ms|30 ~ 50 sec|
|Operation Temp (??|-40 ~ 85|-20 ~ 85|-20 ~ 85|-40 ~ 85|-40 ~ 85|0ÃÂ°C~+50ÃÂ°C|
|Dimension (mm)|PA : 24x16x3, CON : 17x16x3 |24.5x18.6x.15|28x20x1.9|32x23.3x2.9|32x23.3x2.9|33 x 43 x 6.3|
|Certification|KCC, CE, FCC|KCC, CE, FCC|KCC, CE, FCC|KCC, CE, FCC, TELEC|KCC, CE, FCC|CE, FCC|
|Evaluation Board|[WizFi360-EVB](https://wizwiki.net/wiki/doku.php?id=products:wizfi360:board:wizfi360-evb)|[WizFi310-EVB](https://www.wiznet.io/product-item/wizfi310-evb/)|[WizFi250-EVB](https://www.wiznet.io/product-item/wizfi250-evb/)|[WizFi210-EVB](https://www.wiznet.io/product-item/wizfi210-evb/)|[WizFi220-EVB](https://www.wiznet.io/product-item/wizfi220-evb/)|[WizFi630A-EVB](https://www.wiznet.io/product-item/wizfi630a-evb/)|","Q) What is WizFi360? 
A) WizFi360 is a module that operates in station (client) mode and soft access point mode. It supports wireless standards 802.11b/g/n in the 2.4GHz band and has various interfaces including UART, SPI, GPIO, and ADC. The module's power consumption varies based on operation and transmission modes, with different output power capabilities and booting times. It also has a wide range of operation temperatures and is certified by KCC, CE, and FCC.

Q) What are the differences between WizFi360, WizFi310, WizFi250, WizFi210, WizFi220, and WizFi630A? 
A) Each module differs in aspects such as operation modes, wireless standards, interface types, power consumption, configuration methods, output power, booting time, operational temperatures, dimensions, and certifications. Additionally, specific evaluation boards are available for each module."
3381,615,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ­?ÂÃªÂ¹Â.

?ÂÃ¬ÂÂ¬ WIZ820io ???Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ?Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ«ÂÂ??

?ÂÃ«Â¨Â¸Ã¬Â§? Local IP ?Â¤Ã¬Â Â?Â´Ã«ÂÂ Mac Address ?Â¤Ã¬Â Â ???ÂÃ«Â¨Â¸Ã¬Â§? Ã«Â¶?Ã«Â¶ÂÃ«ÂÂ¤?? ???Â¤Ã¬Â Â???ÂÃ«ÂÂ??

Server IP ?Â¤Ã¬Â Â ?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ«Â§Â ?Â¤Ã¬Â Â???ÂÃ«ÂÂ??ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¸ ?ÂÃ¬Â²Â­ ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.
//
//
// ?Â´Ã¬ÂÂ?Â¬Ã­ÂÂ­
// Server IPÃ«Â¥?Register??Setting ???Â¤Ã¬ÂÂ Read?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ¸ÃªÂ²Â°ÃªÂ³Â¼ ??ÂÂ 0 ?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ´?ÂÃ¬ÂÂ
//
// Register??ÃªÂ°ÂÃ¬ÂÂ Read?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ¸?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬? ??Source??ÃªÂ°????ÂÃ«ÂÂ¬Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ.
//

#define SPI_CS      PORTB.0
#define SCK         PORTB.1
#define MOSI        PORTB.2
#define MISO        PORTB.3


//-----------------------------------------
// Server IP ?Â¤Ã¬Â Â
// Ã¬Â°Â¸ÃªÂ³Â ?Â¬Ã­ÂÂ­ : Register??Setting?ÂÃ¬? ?ÂÃ¬ÂÂ.
//-----------------------------------------
void SET_SERVER_IP()
{
unsigned int addr = 0x400C;

        SPI_CS = 0;
         
        //?Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ Shift ?Â°Ã¬ÂÂ°?ÂÃ«? ?Â¬Ã¬ÂÂ©?ÂÃ¬? ?ÂÃªÂ³Â  Ã¬Â§ÂÃ¬Â Â ÃªÂ°ÂÃ¬ÂÂ ?Â Ã«ÂÂ¹?Â´Ã«ÂÂ Ã«Â§ÂÃ¬Â°Â¬ÃªÂ°?Ã¬Â§? ÃªÂ²Â°ÃªÂ³Â¼ÃªÂ°? ?ÂÃ¬ÂÂ´.
        //SPDR = 0x40;
        //while( !(SPSR & (1<<SPIF)) );
            
        //SPDR = 0x0C;
        //while( !(SPSR & (1<<SPIF)) );


        //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
        SPDR = ( (addr & 0xFF00) >> 8 );
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = (addr & 0x00FF);
        while( !(SPSR & (1<<SPIF)) );
            
        //OP-CODE + Length ----------
        SPDR = 0x80;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x04;
        while( !(SPSR & (1<<SPIF)) );
       
        //Data ---------------------      
        SPDR = 192;
        while( !(SPSR & (1<<SPIF)) ); 
         
        SPDR = 168;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 100;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPI_CS = 1; 
}

//***************************************************************************
// ?Â´Ã­ÂÂ??Ã«ÂªÂ¨Ã«ÂÂ  Register ?Â¤Ã¬Â Â?? ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ­ÂÂ??
//***************************************************************************

//-----------------------------------------
// PORT DDR ?Â¤Ã¬Â Â
//-----------------------------------------
void Init_Port(void)
{
    DDRB.3 = 0; //PB3(MISO) 
    DDRB.2 = 1; //PB2(MOSI);
    DDRB.1 = 1; //PB1(SCK)
    DDRB.0 = 1; //PB0(CS);
    PORTB.0 = 1;
}


//-----------------------------------------
// Local IP ?Â¤Ã¬Â Â
//-----------------------------------------
void SET_CLIENT_IP()
{
        SPI_CS = 0;
         
        //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
        SPDR = 0x00;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x0F; 
        while( !(SPSR & (1<<SPIF)) );
            
        //OP-CODE + Length ----------
        SPDR = 0x80;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x04;
        while( !(SPSR & (1<<SPIF)) );
       
        //Data ---------------------      
        SPDR = 192;
        while( !(SPSR & (1<<SPIF)) ); 
         
        SPDR = 168;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 50;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPI_CS = 1; 
}

//-----------------------------------------
// Local Subnet mask ?Â¤Ã¬Â Â
//-----------------------------------------
void SET_CLIENT_SUBNET()
{

        SPI_CS = 0;
         
        //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
        SPDR = 0x00;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x05; 
        while( !(SPSR & (1<<SPIF)) );
            
        //OP-CODE + Length ----------
        SPDR = 0x80;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x4;
        while( !(SPSR & (1<<SPIF)) );
       
        //Data ---------------------      
        SPDR = 255;
        while( !(SPSR & (1<<SPIF)) ); 
         
        SPDR = 255;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 255;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPI_CS = 1;      
}

//-----------------------------------------
// MAC ADDRESS ?Â¤Ã¬Â Â
//-----------------------------------------
void SET_CLIENT_MAC()
{
        SPI_CS = 0;
         
        //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
        SPDR = 0x00;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x09; 
        while( !(SPSR & (1<<SPIF)) );
            
        //OP-CODE + Length ----------
        SPDR = 0x80;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x06;
        while( !(SPSR & (1<<SPIF)) );
       
        //Data ---------------------      
        SPDR = 0x01;
        while( !(SPSR & (1<<SPIF)) ); 
         
        SPDR = 0x02;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0x03;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0x04;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0x05;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0x06;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPI_CS = 1;      
}

//-----------------------------------------
// GATEWAY ?Â¤Ã¬Â Â
//-----------------------------------------
void SET_CLIENT_GATEWAY()
{
        SPI_CS = 0;
         
        //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
        SPDR = 0x00;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x01; 
        while( !(SPSR & (1<<SPIF)) );
            
        //OP-CODE + Length ----------
        SPDR = 0x80;
        while( !(SPSR & (1<<SPIF)) );
            
        SPDR = 0x04;
        while( !(SPSR & (1<<SPIF)) );
       
        //Data ---------------------      
        SPDR = 192;
        while( !(SPSR & (1<<SPIF)) ); 
         
        SPDR = 168;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 0;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPDR = 1;
        while( !(SPSR & (1<<SPIF)) );  
         
        SPI_CS = 1; 
}


//-----------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------
// Register???Â¤Ã¬Â Â??ÃªÂ°??ÂÃ¬ÂÂ¸?ÂÃªÂ¸Â°
//-----------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------



//-----------------------------------------
// Local IP ?ÂÃ¬ÂÂ¸
//-----------------------------------------
void GET_CLIENT_IP()
{
unsigned char ADDR[4];
unsigned char BUFF[50];
unsigned char i = 0;
 
    SPI_CS = 0;
    
    //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
    SPDR = 0x00;
    while( !(SPSR & (1<<SPIF)) );
    
    SPDR = 0x0F; 
    while( !(SPSR & (1<<SPIF)) );
    
    //OP-CODE + Length ----------
    SPDR = 0x00;
    while( !(SPSR & (1<<SPIF)) );
    
    SPDR = 0x04; 
    while( !(SPSR & (1<<SPIF)) );
    
    //Data Read -----------------
    SPDR = 0x00;             
    while( !(SPSR & (1<<SPIF)) );
    ADDR[0] = SPDR;          
    
    SPDR = 0x00;             
    while( !(SPSR & (1<<SPIF)) );
    ADDR[1] = SPDR;          
    
    SPDR = 0x00;              
    while( !(SPSR & (1<<SPIF)) );
    ADDR[2] = SPDR;          
    
    SPDR = 0x00;              
    while( !(SPSR & (1<<SPIF)) );
    ADDR[3] = SPDR;           
    
    SPI_CS = 1;
      
    delay_ms( 100 );
               
    sprintf(BUFF,""%c  IP ADDRESS:%03d.%03d.%03d.%03d%c"",2,ADDR[0],ADDR[1],ADDR[2],ADDR[3],3);
    
    for(i=0; i<30; i++) putchar1( BUFF[i] );
}

//-----------------------------------------
// Server IP ?ÂÃ¬ÂÂ¸
//-----------------------------------------
void GET_SERVER_IP()
{
unsigned int addr = 0x400C;
unsigned char ADDR[4];
unsigned char BUFF[50];
unsigned char i = 0;
 
    SPI_CS = 0;
    
    //Ã¬Â£Â¼Ã¬ÂÂ 16 Bit --------------
    SPDR = ( (addr & 0xFF00) >> 8 );
    while( !(SPSR & (1<<SPIF)) );
    
    SPDR = (addr & 0x00FF);
    while( !(SPSR & (1<<SPIF)) );
    
    //OP-CODE + Length ----------
    SPDR = 0x00;
    while( !(SPSR & (1<<SPIF)) );
    
    SPDR = 0x04; 
    while( !(SPSR & (1<<SPIF)) );
    
    //Data Read -----------------
    SPDR = 0x00;            
    while( !(SPSR & (1<<SPIF)) );
    ADDR[0] = SPDR;           
    
    SPDR = 0x00;             
    while( !(SPSR & (1<<SPIF)) );
    ADDR[1] = SPDR;          
    
    SPDR = 0x00;              
    while( !(SPSR & (1<<SPIF)) );
    ADDR[2] = SPDR;          
    
    SPDR = 0x00;              
    while( !(SPSR & (1<<SPIF)) );
    ADDR[3] = SPDR;           
    
    SPI_CS = 1;
    
    delay_ms( 100 );
             
    sprintf(BUFF,""%c   SERVER IP:%03d.%03d.%03d.%03d%c"",2,ADDR[0],ADDR[1],ADDR[2],ADDR[3],3);
    
    for(i=0; i<30; i++) putchar1( BUFF[i] );
} The server IP address you mentioned, or sn_dipr is not read/write register.
Write values and read values may be different.
If you operate as a TCP server or client, you can read the valid information when the other person has accessed or I succeed.
In other words, if you say that it operates as a client, records the Sever IP and performs the Connect Command, and then reads when SN_IR (Connect) Bit is set to '1' or SN_SR is in SOCK_ESTABLISHED. and also

In addition to SN_DIPR, the Register, which is set for destination, like SN_DHAR/SN_DPORT, changes the value after connection.
Please refer to it.

Thanks,: slight_smile:","Q) What is the WIZ820io pin for Local IP and Mac Address? 
A) The WIZ820io pin for Local IP and Mac Address is not directly available, as it is handled by the internal registers and the SPI communication protocol to write and read the values. 

Q) How can I set the Server IP? 
A) To set the Server IP, you need to operate it as a TCP server or client, record the Sever IP, perform the Connect Command, and then read when SN_IR (Connect) Bit is set to '1' or SN_SR is in SOCK_ESTABLISHED.  

Q) Is the server IP address stored in sn_dipr a read/write register? 
A) The server IP address mentioned or sn_dipr is not a read/write register. The write and read values may differ based on the operational state of the device.  

Q) How can I retrieve the Server IP address? 
A) To retrieve the Server IP address, you need to operate as a TCP server or client, record the Sever IP, perform the Connect Command, and then read when SN_IR (Connect) Bit is set to '1' or SN_SR is in SOCK_ESTABLISHED.  

Q) What should I consider regarding SN_DIPR and related registers after connection? 
A) After the connection, the Register, which is set for the destination like SN_DHAR/SN_DPORT, changes its value. Please take this into consideration."
3382,6154,3 posts were merged into an existing topic: [WizFi360 ?Â¨Ã«ÂÂ ?ÂÃ¬ÂÂ¤???ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´ ?Â¤Ã¬Â Â Ã«Â°??ÂÃ«ÂÂÃ«Â¦Â¬Ã¬ÂÂ¤ ?ÂÃ¬Â Â?ÂÃ¬ÂÂ!](/t/topic/6126) ,This is a non-response paragraph.
3383,6156,"Looks like code

    buf[3]=SPDR;

is having problems. This code is intended to get 8 bits of data into `buf[3]`, but for some reason it does nothing,

Edit: I am not originally familiar with how ot works, but according to [this source](https://github.com/feilipu/avrfreertos/blob/master/freeRTOS82x/lib_iinchip/w5500.c)

	SPDR = (uint8_t)((addrbsb & 0x00FF0000)>>16);	// load the Address byte 1 to be transmitted
	Byte = (uint8_t)((addrbsb & 0x0000FF00)>> 8); 	// pre-load the Address byte 2 to be transmitted
	while ( !(SPSR & _BV(SPIF)) );

	SPDR = Byte;									// load the Address byte 2 to be transmitted
	Byte =  (uint8_t)(addrbsb & 0x000000F8); 		// pre-load the Data Read command
	while ( !(SPSR & _BV(SPIF)) );

	SPDR = Byte;					// load the Data Read command
	Byte = 0x5A;					// pre-load a dummy byte to be transmitted
	while ( !(SPSR & _BV(SPIF)) );

	SPDR = Byte;					// load a dummy byte to be transmitted
	while ( !(SPSR & _BV(SPIF)) );

	Byte = SPDR;					// copy received byte in case we get swapped out, and lose SPDR.

	portEXIT_CRITICAL();

	spiDeselect(Wiznet);			// CS=1, SPI end, give semaphore

	WIZCHIP_ISR_ENABLE();

	return Byte;

you must perform the dummy byte write to SPDR (which value does not matter for reading the data) and obtain read data from the same register `SPDR`. Thus your mistake that you omit writing to SPDR. Thanks, Eugeny. Now it's working fine :+1:","Q) It looks like the code `buf[3]=SPDR;` is having problems. This code is intended to get 8 bits of data into `buf[3]`, but for some reason it does nothing. Can you help me understand what could be going wrong?
A) According to the provided source, you must perform the dummy byte write to SPDR (which value does not matter for reading the data) and obtain read data from the same register `SPDR`. Thus, your mistake is that you omit writing to SPDR. Thanks, Eugeny. Now it's working fine."
3384,6157,"Hello Eugeny,

Sorry that I write to you directly. I am not sure if I should open a thread for this simple question.

I have managed to write and read to the registers of the WIZ820io (W5200). I set up MAC address, Gateway, Subnetmask and Source IP. According to the documentation that is the basic configuration. I have also set the Mode Register to 0x10 to enable the Ping Block Mode, but when I try to ping from a pc connected to the same network, I don't get any package back from the W5200. Is there any other thing to configure?

Thank you for your help. Hello, ""ping block"" bit set is meant to stop W5200 responding to ping requests - bit set blocks the ping operation. You must set (leave) this bit as 0 in order for the chip to be ping-able.
Eugeny Thank you for the quick reply!

So I just wrote to SHAR, GAR, SUBR and SIPR register but still cannot ping as the host is unreachable (from pc). Do I need to open a socket before or by configuring these four registers I should be able to ping? No, you do not need to open socket. What IP information you wrote to the chip and what IP information of PC you are pinging from, and what is between then? On the chip I wrote:

* SHAR (0x0009): MAC that has been reserved by the IT admin here.
* GAR (0x0001): I checked the gateway that I have on my pc and wrote the same one. I double checked with other pc on the same network and they match.
* SUBR (0x0005): Same as GAR, I checked the subnet mask that I see on my pc plus on the other one on the same network.
* SIPR (0x000F): A fixed IP has been assigned to the reserved MAC.

Then, from the pc, I just run the command line (ubuntu) ""ping IP"". In between there is the whole IT infrastructure that I have no control over. [quote=""aripod, post:5, topic:6157""]
In between there is the whole IT infrastructure that I have no control over.
[/quote]

Continuously keep pinging W5200 and watch at its activity LED. It must flash with the same frequency ping requests are sent. If it does not flash, then requests to not reach W5200, if it is then it gets requests. Next step is to look at the TX/RX LEDs for receive and reply activity. I thin kyou have got the idea. The leds are always on. They don't blink at all.

If I understood correctly, there is an dhcp server which will assign the ip by just providing the mac. 

So we are in a sub-network with 141.34.15.xx. Therefore, I have been assigned as IP 141.34.15.21. The gateway I see on the command line is 141.34.15.254. Therefore, the subnet mask is 255.255.255.0. Does that look correct to you?

I want to try with a router to have a local network. Is there anything special I should configure? Any range of IPs for source or gateway? [quote=""aripod, post:7, topic:6157""]
The leds are always on. They don?Ât blink at all.
[/quote]

On = no activity. For me means W5200 does not get anything from the outside.

[quote=""aripod, post:7, topic:6157""]
Does that look correct to you?
[/quote]

Depends on the intermediate device configuration. Generally looks ok.

[quote=""aripod, post:7, topic:6157""]
I want to try with a router to have a local network. Is there anything special I should configure? Any range of IPs for source or gateway?
[/quote]

You will have to configure router properly, nothing else is needed. I have PHYSTATUS always 0x37. Now connected to the router, I see the green LED blinking from time to time, but in the configuration of the router I only see one device connected. Could there be something wrong with the WIZ820io? [quote=""aripod, post:9, topic:6157""]
I see the green LED blinking from time to time, but in the configuration of the router I only see one device connected.
[/quote]

Good. It may take some time for router to list connected devices. Proceed pinging the device. The green led still blinks but pinging does not work nor I see the device listed in the router page. Is there any other register that I can check?

And just to be double sure. I am writing to these four register, then wait a bit and to make sure they have been written properly, I just go I read each of them. Should I check for some other register? Read all registers in the common register block back to ensure that all required values are set up (ip address and mac address) properly. [quote=""aripod, post:11, topic:6157""]
And just to be double sure. I am writing to these four register, then wait a bit and to make sure they have been written properly, I just go I read each of them. Should I check for some other register?
[/quote]

I edited the previous message while you were writing I believe What is the MAC address? It is 00:00:35:00:00:54 If you disconnect W5200 from router both devices' port LEDs go off? And after reconnect then turn on? Yes. I disconnect w5200 from router, both green and orange leds go off. I connect it back on, orange is constantly on and green goes on as well....and it turns off a shorter period compared to when it is on. Something like : ----_---- [quote=""Eugeny, post:16, topic:6157""]
both devices??port LEDs go off
[/quote]

At router side? At the router there are not ethernet leds. Only one indicating that there is a device plugged, which there is. I can even see it on the configuration's website that there is one. It has 4 different LAN ports, which I switched from 2 to 3 and back and it always shows where I connect it. [quote=""aripod, post:11, topic:6157""]
nor I see the device listed in the router page
[/quote]

Thus W5200 is seen by the router and listed by it at the port you connect to? unfortunately not. It only shows that there is something connected to the LAN port bur it only shows the pc connected as a ""wired client"" (where I can see its MAC and the IP given by the router).

Could it be that I set the IP rather than letting the router do it? Or maybe it assigns one IP but it is not the one I chose (which I did randomly) No, normally router must show this information, at least MAC address, as it is on level 2. Ip address is on level 3 and also should be obtainable. Connect PC in bridge mode between  W5200 and router and use Wireshark to capture the packet exchange on both interfaces. [quote=""Eugeny, post:22, topic:6157""]
Connect PC in bridge mode between W5200 and router and use Wireshark to capture the packet exchange on both interfaces.
[/quote]

Sorry, let me get this straight. Connect W5200 directly to the PC? And then to the router, but I only have one eth port on my pc. No, another PC. This will help you to see what router says to the W5200 and what it responds to router. And then pinging from original PC and see what is going on between router and W5200. But I think that there's something wrong with W5200 responding. W5200 does not have separate TX/RX LEDs, thus no way to see if it answers anything to the incoming reqiests, and then only way to know is to monitor the wire. So I plugged everything back to the network (not router as it seems to be the same). I added a 2nd pc which I just use to ping the w5200 and with the original pc I have wireshark running. I cannot see any package when I ping from 2nd pc to w5200... I can see the packages when I ping between pcs I was able to receive a byte from the pc on the w5200 so I guess I should be able to send something as well. Everything with the router. I will have to talk to the it guys here.

Anyways, thank you very much for your help! Hello @Eugeny,

Sorry to bother again :frowning:

I am trying to send a 2 bytes from w5200 to PC but every time more bytes are sent. 
I am using socket 0 with 2kb of internal memory. Therefore, my base address is 0x8000 and highest is 0x87FF. 
Now, according to the documentation, I have to read Sn_TX_WR and do a bitwise-and with the mask (0x07FF).

Consider the case when Sn_Tx_WR = 0xE9AA. Then, doing a bitwise and with 0x7FF is 0x1AA. So, I add the base address which would be 0x81AA which is where I have to write the data that I want to send, right? After I write it, I have to increase Sn_TX_WR by the number of bytes I want to send (2 in this case) and then send.

By doing that, that is sent, but way more bytes than I want. Isn't the amount of bytes to send determined by the difference between Sn_TX_WR before and after I update it?

Thanks again for the help. Sorry for the quick double message. I repeated the process and the second time I got 1 byte. Although, on wireshark I see the protocol shows ""IPA"", length=60 and in info it says ""Malformed packet"" It must have been something I entered wrong. I tested everything from scratch, with a clean code and it worked from the beginning.

I do have one more question. the pointer Sn_WX_WR will never increase beyond the base address plus its corresponding mask, right? I mean, in the example I mentioned (following the documentation), for socket 0, once I write 2K, the pointer will go back to 8000, right?

I hope I made myself clear.
Thank you! I can not say that, did not use W5200. For W5100/W5500, and I guess for W5200 must be the same, pointers are 16-bit and wrap when reach 0xffff -> 0x0. You calculate address by masking it by the socket buffer size and adding the base. This info must be explained in the datasheet. Yes yes, that is how it's done.

Okay, again, thanks for your help! It clearly says that you reuse source port number. Just increment value of the PORT register value (04/05) every time you open the connection, ensuring values are within 0xc000-0xf000. I think log is clear on what is going on. You may have some mistake in the socket workflow. Where's socket disconnect/close before packet 1670? Of course it complais about reuse because it did not see socket disconnect messages. The sequence I follow is writing to register 4001 0x08 (disconnect), 0x10 (close) and 0x10 No FIN message from W5200 in the wireshark means you do not perform disconnect command. Debug your code.

Or you do not properly wait for command reception by checking CR being 0 and only then issuing another command (e.g. CLOSE). [quote=""Eugeny, post:38, topic:6157""]
Or you do not properly wait for command reception by checking CR being 0 and only then issuing another command (e.g. CLOSE).
[/quote]

It seems that is the issue....I went step by step and the issue was not there. I will add the waits.

Thanks a lot again Hello one more time :blush:

I am facing another issue. So far I have been opening a socket, sending and then receiving. 
Now I am doing the other way. I open a socket, and I change the status to listen to wait until the status changes to connection established. Once that happens, I read the receiving buffer correctly. 
My issue now is that I want to reply, so send something over the same socket. Therefore, I only do the send process but data never leaves the w5200. Is there anything I should change in MR or CR registers in between processes? 
As the connection has been established, I checked that the destination IP address and port are set properly after the connection is established.

And another thing is that the RX_RSR registers stay the same after I read the receiving buffer....shouldn't it change to 0 after reading the incoming data?

Thanks again for your time. [quote=""aripod, post:40, topic:6157""]
but data never leaves the w5200
[/quote]

How did you know that? Did you perform SEND command?

[quote=""aripod, post:40, topic:6157""]
And another thing is that the RX_RSR registers stay the same after I read the receiving buffer?Â¦shouldn?Ât it change to 0 after reading the incoming data?
[/quote]

If you updated RX_RD pointer. [quote=""Eugeny, post:41, topic:6157""]
How did you know that? Did you perform SEND command?
[/quote]

That was actually the issue. I had a problem with some pointers and a function and was writing the wrong command to the register.

Thanks a lot for taking the time to reply. Hello again,

This time everything works :D I just have a functional question....
Would it be possible to only use one socket to send and receive messages from/to different IPs? 

Let's suppose I use socket0 on the w5200 (IP0, Port0). In theory, I can listen to any incoming connections from any other IP...right?
Then, let's say PC1 (IP1, Port1) connects to the w5200 over IP0, Port0. Then I can send information back and forth W5200<->PC1.
The question is....is it possible to keep listening to other incoming connections? 
Let's say now I have PC2(IP2, Port2) establishing a connection with the W5200 that only listens to IP0,Port0. Is that possible? If it is, can I also establish a communication between IP0,Port0 to IP2, Port2?
So it should look something like:

* W5200 (IP0, Port0) <--> PC1 (IP1, Port1)
* W5200 (IP0, Port0) <--> PC2 (IP2, Port2)

I have been doing it so far with multiple sockets but I believe that is not the way to do it....

Thank you! [quote=""aripod, post:43, topic:6157""]
messages from/to different IPs?
[/quote]

IPRAW mode. But in this case you will have to implement this mode driver yourself, no built-in sockets any more. Then it was the correct way to use multiple sockets.... what do you mean I should implement the driver myself? It means that your software will need to look into every IP packet, manage sockets and decide what packet to process or discard. In other words you will have to implement sockets layer in software. Yes, I thought so. But on the w5200, I should only use one socket and handle everything myself So, it would be correct to say then: I can have socket0 listening to incoming connections. When PC1(IP1,Port1) connects to that listening socket, then a connection between these two is fixed. Hence, I cannot keep listening with socke0 expecting that I would get an incoming connection from PC2(IP2, Port2) as it is bounded to PC1 and that is why there are multiple sockets. So, then I should open socket1 to wait for PC2 to connect. Is this correct?

And with IPRAW, i see that I will get only the IP from the incoming connection. What about its port? There must be at least one socket open listening for the connection request. And your software must be able to catch this request.

IPRAW: you will have to parse IP packets yourself finding out port and other TCP or UDP related information, and keep table of open ports and connections. [quote=""Eugeny, post:49, topic:6157""]
There must be at least one socket open listening for the connection request. And your software must be able to catch this request.
[/quote]

Yes, but once I receive a request and establish a connection to receive the message and/or send something back....does that mean that that socket is bounded to that peer? Or I can keep using the same socket to listen for other connections and keep sending messages to either the first one that sent a requests or new ones as well? 
As I mentioned before, I want to have only one socket with one IP and Port on the w5200 but being able to receive and send from/to multiple other devices and it is not clear whether I can do it with the IP mode or not. [quote=""aripod, post:50, topic:6157""]
does that mean that that socket is bounded to that peer?
[/quote]

Yes you must have another socket open. Better have several open at the same time if you want to get concurrent connections.

[quote=""aripod, post:50, topic:6157""]
being able to receive and send from/to multiple other devices
[/quote]

Socket per device. Multiple devices = multiple sockets. [quote=""Eugeny, post:51, topic:6157""]
Socket per device. Multiple devices = multiple sockets.
[/quote]

So regardless of the mode, if I want to have the w5200 communicating with several devices, I will only be able to do it with up to 8 as it gives me 8 sockets.","Q) I have managed to write and read to the registers of the WIZ820io (W5200). Is there any other thing to configure? 
A) No, you do not need to open socket. What IP information you wrote to the chip and what IP information of PC you are pinging from, and what is between then?

Q) Does that look correct to you? 
A) Depends on the intermediate device configuration. Generally looks ok.

Q) Is there anything special I should configure? Any range of IPs for source or gateway? 
A) You will have to configure router properly, nothing else is needed.

Q) Could there be something wrong with the WIZ820io? 
A) Good. It may take some time for router to list connected devices. Proceed pinging the device.

Q) Should I check for some other register? 
A) Read all registers in the common register block back to ensure that all required values are set up (ip address and mac address) properly.

Q) If you disconnect W5200 from router both devices' port LEDs go off? 
A) Yes. I disconnect W5200 from router, both green and orange leds go off. I connect it back on, orange is constantly on and green goes on as well...

Q) At the router there are not ethernet leds. Only one indicating that there is a device plugged, which there is. 
A) unfortunately not. It only shows that there is something connected to the LAN port bur it only shows the pc connected as a ""wired client"".

Q) Could it be that I set the IP rather than letting the router do it? 
A) No, normally router must show this information, at least MAC address, as it is on level 2. Ip address is on level 3 and also should be obtainable. 

Q) Connect W5200 directly to the PC? 
A) No, another PC. This will help you to see what router says to the W5200 and what it responds to router. 

Q) I want to try with a router to have a local network. Is there anything special I should configure? 
A) Nothing special, you will have to configure router properly.

Q) Okay, again, thanks for your help! 
A) You calculate address by masking it by the socket buffer size and adding the base. This info must be explained in the datasheet.

Q) You may have some mistake in the socket workflow. Where's socket disconnect/close before packet 1670? 
A) Of course it complains about reuse because it did not see socket disconnect messages. The sequence I follow is writing to register 0x08 (disconnect), 0x10 (close) and 0x10.

Q) So, it would be correct to say then: I can have socket0 listening to incoming connections. Is this correct? 
A) There must be at least one socket open listening for the connection request. And your software must be able to catch this request."
3385,616,"I contacted you as a request for the W7100A MCU technical support.

Even though the symptoms of disorders that are still occurring are low, even though the booten pin is low,
 
Entering the boot occurs.
 
We want to improve the disability, so please respond below.
 
 
=> When entering the boot, if there is no HOST command for a certain time, request a boot f/w correction to jump back to the app.
 
 
 
??For reference, even in the initial development, no data on the order specifications and versions of the BOOT were not provided at all.
 
    We request data. The BOOT of the W7100 is written in Hard Macro, so it is impossible to modify.
In addition, Boot Code can be disclosed after the agreement of both companies.
For more information, please contact [Sales@wiznet.co.kr] (mailto: sales@wiznet.co.kr). I talked to the business division.
I used Watchdog to prevent MCU HALT, but regardless of the external pin settings
I am entering the boot.
If you can't modify the boot code, you will need a available boot command specification.
To JMP again as the APP area. The answer was late.
You say you go to the boot regardless of the external pin settings (?) Then there is no guarantee that the boot works exactly.
I would appreciate it if you could tell me how BOOT is working.Boots are exchanged through UART, so they do not support FUNCION API CALL.

First of all, if you briefly explain the boot,
1. Check the booten pin settings
2. Baud rate auto configure.
3. ISP processing
4. App JUMP","Q) Can you briefly explain how the boot works for the W7100A MCU? I am encountering issues even though the booten pin is low and used Watchdog to prevent MCU HALT. 
A) The boot process involves checking the booten pin settings, baud rate auto-configure, ISP processing, and app JUMP. Additionally, if there is no HOST command for a certain time, a boot f/w correction to jump back to the app can be requested. Furthermore, the boot code can only be modified with an agreement between companies, and it's not possible to modify the Boot Code written in Hard Macro. For more information and data requests, please contact [Sales@wiznet.co.kr](mailto:sales@wiznet.co.kr)."
3386,6161,"Hi,

I bought WIZ107SR module. After power on, no actions or communications, with disconnected ethernet cable, i think the operational temperature too high. I measured 55CÃÂ° with my MX-25 304 multimeter.

Is it normally? Dear ExtSol

Yes, WIZ750SR is a product with a lot of heat.

When the power is connected, the temperature increases by more than 50 ÃÂ° C.

It is normally.

Soctt","Q) Is it normal for the WIZ107SR module to reach a temperature of 55°C after powering on with disconnected ethernet cable?
A) Yes, WIZ750SR is a product with a lot of heat. When the power is connected, the temperature increases by more than 50 °C. It is normal.
"
3387,6162,"Hi,

I bought WIZ107SR module. 

Process no1:
- After power on, i started both nRESET and HW_TRIG pin low state
- wait 100ms
- set nRESET pin to high
- wait 1000ms
and the serial commands not working.

Process no2:
- After power on, i started both nRESET and HW_TRIG pin low state
- wait 100ms
- set nRESET pin to high
- wait 3000ms
and the serial commands now working fine.

How long time to keep HW_TRIG pin low state before the module entering CMD mode? Dear ExtSol

It takes some time to enter CMD mode.

WIZ107SR enters CMD mode after network configuration after booting.

The time is estimated to be up to 2000ms after booting.

Is this a problem for you?

Scott Hy Scott,

Thank you for the fast response.

No it is not problem, only i interested :)

Best Regards:
ExtSol","Q) How long time to keep HW_TRIG pin low state before the module entering CMD mode?
A) It takes some time to enter CMD mode. WIZ107SR enters CMD mode after network configuration after booting. The time is estimated to be up to 2000ms after booting. Is this a problem for you? 

Q) Is this a problem for you?
A) No it is not problem, only i interested :) Best Regards: ExtSol"
3388,6163,"Hi i was trying to find some post with the same issue, but mine is a little diferent, i plug the cable and canÃÂ´t get no link led. but i debbug my code and i can go until the listen stage. a few times when i press conect from hercules ussing the tcp client i can conect, the most times, donÃÂ´t iÃÂ´m also checking the link bit on PHYCFGR and always is set.
regards Circuit diagram and board picture please.

[quote=""Shaka, post:1, topic:6163""]
iÃÂ´m also checking the link bit on PHYCFGR and always is set
[/quote]

You have link bit set even when cable is not plugged in?","Q) You have link bit set even when cable is not plugged in?
A) Circuit diagram and board picture please."
3389,6166,"?ÂµÃ«? ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
?Â´Ã«ÂÂ¹ wiz750sr-evb ÃªÂ°? ?ÂÃ«ÂÂ ?ÂÃ­ÂÂ?ÂÃ«ÂÂ??
?Â°Ã¬ÂÂ  **Application Firmware Binary** Ã«Â§?config ?Â´Ã«Â¡Â
update ?Â´Ã«ÂÂ ?Â ÃªÂ¹Â??

::  ???Â´ÃªÂ²Â Application Ã«Â§?update ?ÂÃ«ÂÂÃªÂ¹?
?Â¤Ã«ÂÂ???ÂÃ«ÂÂ¤??! tool ÃªÂµÂ¬Ã«Â§Â¤ ????Ã¬Â§ÂÃ­ÂÂ ?ÂÃªÂ²Â ?ÂµÃ«ÂÂ?? Even after updating to 1.2.4
The same phenomenon is found ~!
Assuming that the module is nothing wrong
Let's check the client side.
thank you","Q) ?´ë¹ wiz750sr-evb ê° ì ììëê¹?
A) You are asking about the status of the wiz750sr-evb."
3390,617,"Hello, 

We have been using the WIZ107SR (and WIZ108SR) for quite some time and are have been quite happy with it.  We are using it in a control panel with switches, encoders, LEDs and LCDs for a bidirectional data link to a host computer.  

Unfortunately, we have received a report from a customer that is experiencing occasional lost bytes.  

Here is a sample of the data exchange between the serial side and the ethernet side of the WIZ107SR.  Each line is a separate TCP Packet:

Serial -> Ethernet  80 00 0d f7
Ethernet -> Serial  f0 15 31 04 01 0d f7
Ethernet -> Serial  f0 15 31 02 02 b4 00 ef 1f 00 01 f7
Ethernet -> Serial  f0 15 31 02 03 b5 01 ee 1e 01 00 f7
Ethernet -> Serial  f0 15 31 01 02 b7 08 01 00 31 20 30 30 30 31 f7
Ethernet -> Serial  f0 15 31 02 02 b4 20 ef 3f 00 01 f7
Ethernet -> Serial  f0 15 31 02 03 b5 21 ee 3e 01 00 f7
Ethernet -> Serial  f0 15 31 01 02 b7 28 01 00 31 20 30 30 30 31 f7
Ethernet -> Serial  f0 15 31 02 02 b4 40 ef 5f 00 01 f7
Ethernet -> Serial  f0 15 31 02 03 b5 41 ee 5e 01 00 f7
Ethernet -> Serial  f0 15 31 01 02 b7 48 01 00 31 20 30 30 30 31 f7
Ethernet -> Serial  f0 15 31 02 02 b4 60 ef 7f 00 01 f7
Ethernet -> Serial  f0 15 31 02 03 b5 61 ee 7e 01 00 f7
Ethernet -> Serial  f0 15 31 01 02 b7 68 01 00 31 20 30 30 30 31 f7
Serial -> Ethernet  80 0c f7
Serial -> Ethernet  80 00 0b f7
Serial -> Ethernet  80 00 0a f7

Looking on the serial side, the data coming into the serial side of the WIZ107SR is:
Serial -> Ethernet  80 [color=#FF0000][b]00[/b][/color] 0c f7 
Serial -> Ethernet  80 00 0b f7
Serial -> Ethernet  80 00 0a f7

The byte 00 highlighted in red is missing from the TCP packet.
This does nor occur if I do not send  Ethernet -> Serial data.
This issue occurs on multiple WIZ107SR modules.

I am using:
WIZ107SR Rev 1.1
Firmware 2.20
TCP Server Mode
Debug Message Output disabled
Baud Rate = 115200
Data bits = 8
Parity = odd
Stop bits = 1
Flow Control = none 
Timer = 10
Size = 0
Character = F7 (this is the end of our command, we use this to trigger new TCP packet)
Inactivity Timer = 0

Is there anything we can do to prevent this behavior from occurring?
Thanks in advance. Hi,
I'm so sorry to answer late.
Data loss problem is very difficult to analyse the reason.

Do you use the converter USB to UART?
Is the loss data same value in every case?","Q) Is there anything we can do to prevent this behavior from occurring?
A) Data loss problem is very difficult to analyze the reason. Do you use the converter USB to UART? Is the loss data the same value in every case?"
3391,6171,"I only have one socket opened. The RMSR is initialized to 0x55.
However, when I wrote 1950 bytes, then 100 bytes.
I expected this to cause a wrap around. However, I see the Rx write pointer is at 0x802 (2002d).

Is this expected behavior?
Thanks.
Giri RX_RD is rather 16-bit counter than pointer. You get pointer to the data according to the datasheet by masking with buffer size and adding buffer base address. Thus counter us 0x802, buffer size is 0x800 then relative data location in the buffer is 0x002. That doesn?Ât make sense.

If each Socket Receive pointers do a wrap around, then when I get data > RX Buffer size it should start back at the start of buffer.

What you define is NOT wrap around, if the counter continues to increment PAST the buffer size.

The RX_RD has to be a 16-bit pointer as the buffer/socket would be > 256bytes.

 So a Wrap around definition to me is (ignoring the base offset), then the buffer (of 2KB will go from 0000 to x0800. Then when I get the next byte the RX_RD has
to have a value of 0x001 (and not 0x0801).

If not, the SN0 Rx data would be overwriting the data in Sn1 Rx buffer.

Giri [quote=""grama, post:3, topic:6171""]
That doesn?Ât make sense.
[/quote]

What exactly does not make sense?

[quote=""grama, post:3, topic:6171""]
when I get data > RX Buffer size it should start back at the start of buffer.
[/quote]

This is true. And you **can not** get more data than RX buffer size. By definition. Extra data will wait at another end (TCP) or will be discarded (UDP/RAW).

[quote=""grama, post:3, topic:6171""]
What you define is NOT wrap around
[/quote]

I did not say these words - ""wrap around"", and did not define this term. It seems you want to see wraparound here.

[quote=""grama, post:3, topic:6171""]
The RX_RD has to be a 16-bit pointer
[/quote]

It is.

[quote=""grama, post:3, topic:6171""]
So a Wrap around definition to me
[/quote]

You can see definition of wraparound [here](https://en.wikipedia.org/wiki/Wraparound):

> **Wraparound** ,  **wrap around** , or  **wrap-around**  is anything that [wraps](https://en.wiktionary.org/wiki/wrap) [around](https://en.wiktionary.org/wiki/around) something.

[quote=""grama, post:3, topic:6171""]
the buffer (of 2KB will go from 0000 to x0800. Then when I get the next byte the RX_RD has to have a value of 0x001 (and not 0x0801).
[/quote]

Did you read the [datasheet](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_ds_v100e.pdf), sepecially chapter 4? It clearly says how to use RX_RD register, and how to obtain address to the data from it.

[quote=""grama, post:3, topic:6171""]
the SN0 Rx data would be overwriting the data in Sn1 Rx buffer.
[/quote]

It will if you do not follow datasheet guidelines and do not mask the RX_RD value with the RX buffer size. You are right. I wanted the Rx_Rd to behave a certain way, and didn't fully understand the datasheet.
I apologize for my response.
Giri No problem. There're some uncertainties even in datasheets, thus if you have questions come here and ask.","Q) Is this expected behavior?
A) No problem. There're some uncertainties even in datasheets, thus if you have questions come here and ask. 
Q) What exactly does not make sense?
A) That doesn?Ât make sense. 
Q) This is true. And you **can not** get more data than RX buffer size. By definition. Extra data will wait at another end (TCP) or will be discarded (UDP/RAW).
A) You **can not** get more data than RX buffer size. By definition. Extra data will wait at another end (TCP) or will be discarded (UDP/RAW). 
Q) Did you read the [datasheet](https://wizwiki.net/wiki/lib/exe/fetch.php?media=products:w5100s:w5100s_ds_v100e.pdf), sepecially chapter 4? It clearly says how to use RX_RD register, and how to obtain address to the data from it.
A) It clearly says how to use RX_RD register, and how to obtain address to the data from it."
3392,6178,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

W5300 ICÃ«Â¥??Â¤Ã«ÂÂ«?ÂÃ¬ÂÂ ?Â¬Ã¬ÂÂ©???Â Ã¬??ÂÃ«ÂÂ??

??Ã«Â¶?Ã«Â¶??ÂÃ¬Â¼Â 0Ã«Â²ÂÃ«Â§Â?Â¼Ã«Â¡Â UDP,TCPÃ«Â¡??ÂµÃ¬ÂÂ Ã«Â¬Â¸Ã¬Â Â?ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ°ÃªÂ³??ÂÃ¬ÂÂ?ÂÃ«ÂÂ° 
?Â´Ã«Â²Â ?ÂÃ«Â¡Â?ÂÃ­ÂÂ¸?ÂÃ¬ÂÂ???ÂÃ¬Â¼Â 1~7???Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ?Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ¼ ?ÂÃ¬ÂÂ ÃªÂµÂ¬Ã­ÂÂÃ¬Â¤ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.
?ÂÃ«???0Ã«Â²ÂÃ¬ÂÂÃ¬Â¼ÂÃ¬? ?ÂÃ«Â¬Â´Ã«Â¬Â¸Ã¬Â Â?ÂÃ¬ÂÂ¼??ÃªÂ·Â¸Ã¬ÂÂ¸ ?ÂÃ¬Â¼Â?ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ ???Â°Ã¬ÂÂ´?Â°Ã¬Â¤Â Ã¬Â²ÂÃ¬ÂÂ 2byteÃ«Â§??ÂÃ«ÂÂ¤?Â´Ã¬ÂÂ¤??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°?
?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.ÃªÂ·??Â¤Ã¬ÂÂ ?Â¤Ã«ÂÂ ?Â°Ã¬ÂÂ´?Â°Ã«ÂÂ ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤. ?ÂÃ¬ÂÂ???ÂÃªÂ³Â ?ÂÃ¬ÂÂÃ¬Â§?Ã«Â§??Â¨Ã­ÂÂ·Ã¬Â²ÂÃ¬ÂÂ 2bytesÃ«Â¥?Ã«Â¬Â´Ã¬ÂÂ?ÂÃªÂ³Â  ?Â¬Ã¬ÂÂ©?ÂÃ¬??ÂµÃ«ÂÂ?? Ã¬Â§?ÃªÂ¸ÂÃ¬? 1byte?ÂÃ¬ÂÂ ?Â°Ã¬ÂÂ´?Â°Ã«ÂÂ ?Â¸Ã¬ÂÂ?Â´Ã¬ÂÂ¼?ÂÃªÂ¸Â° ?ÂÃ«Â¬Â¸??Ã¬Â¤ÂÃ¬ÂÂ?Â©Ã«ÂÂ??(uart?ÂµÃ¬ÂÂ Ã¬Â²ÂÃ«ÂÂ¼ ?Â¬Ã¬ÂÂ©???ÂÃ¬Â Â)
ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³? TCP/UDP ?ÂÃ«ÂÂ¤ ÃªÂ·Â¸Ã«Â Â?ÂµÃ«ÂÂ?? ÃªÂ·Â¸ÃªÂ±Â° ?Â´Ã¬ÂÂ¸?ÂÃ«ÂÂ Ã¬Â§?ÃªÂ·Â¹Ã­ÂÂ ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.

2byte???Â´Ã¬ÂÂ ÃªÂ°? 16bitÃ«ÂªÂ¨Ã«ÂÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ¬ÂÂ´??ÃªÂ·Â¸Ã«ÂÂ°ÃªÂ±?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?Â°Ã¬ÂÂ´?Â°Ã«? ?ÂÃ¬ÂÂ¸??Ã«Â³Â´Ã«ÂÂ  rxdata[0]=192, rxdata[1]=168 ?Â´ÃªÂ°Â???Â¤Ã¬ÂÂ´?Â¬Ã«ÂÂÃªÂ°? Ã«Â§ÂÃ¬ÂÂ¼Ã«Â©?  Ã«ÂªÂÃ«Â²Â?ÂÃ«ÂÂÃ¬Â§?Ã«Â§??ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??Â¤Ã¬ÂÂ´??ÃªÂ²Â½Ã¬ÂÂ°???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤. ?ÂÃ«Â§Â?ÂÃ«Â¡Â ?Â°Ã«Â ÂÃªÂ¸??Â°Ã¬ÂÂ´?Â°Ãª? ?Â¤Ã¬ÂÂ´?ÂµÃ«ÂÂ??

?Â¬Ã«ÂÂ¼???ÂÃ¬ÂÂ¸?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ¼Ã¬Â¦ÂÃ¬ÂÂ???ÂÃ¬ÂÂ´ Ã¬Â§ÂÃ«Â¬Â¸?????Â Ã¬????ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃ¬??ÂµÃ«ÂÂ??

ÃªÂ·Â¸Ã«ÂÂ??W5300_Drv_V1.2.4 Ã«Â²ÂÃ¬Â Â¼?Â¼Ã«Â¡Â ?Â¤Ã¬ÂÂ ?Â´Ã«Â´Â¤?ÂÃ«ÂÂ°???ÂÃ¬ÂÂ¼?Â©Ã«ÂÂ??

?Â¬Ã¬ÂÂ© MCU??STM32F407 + W5300?ÂÃ«ÂÂ??(16bitÃ«ÂªÂ¨Ã«ÂÂÃ«Â§??Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ¼?Â©Ã«ÂÂ??)

Ã¬Â°Â¸ÃªÂ³Â Ã«Â¡?
  switch (IINCHIP_READ(Sn_MR(s)) & 0x07)       // check the mode of s-th SOCKET
  {                                            // -----------------------------
     case Sn_MR_UDP :                          // UDP mode 
        wiz_read_buf(s, (uint8*)head, 8);      // extract the PACKET-INFO
        // read peer's IP address, port number.
        if(*((vuint16*)MR) & MR_FS)            // check FIFO swap bit
        {
           head[0] = ((((head[0] << 8 ) & 0xFF00)) | ((head[0] >> 8)& 0x00FF));
           head[1] = ((((head[1] << 8 ) & 0xFF00)) | ((head[1] >> 8)& 0x00FF));
           head[2] = ((((head[2] << 8 ) & 0xFF00)) | ((head[2] >> 8)& 0x00FF));
           head[3] = ((((head[3] << 8 ) & 0xFF00)) | ((head[3] >> 8)& 0x00FF));
        }
        addr[0] = (uint8)(head[0] >> 8);       // destination IP address
        addr[1] = (uint8)head[0];
        addr[2] = (uint8)(head[1]>>8);
        addr[3] = (uint8)head[1];
        *port = head[2];                       // destination port number
        data_len = (uint32)head[3];            // DATA packet length
        
        #ifdef __DEF_IINCHIP_DBG__
           printf(""UDP msg arrived:%d(0x%04x)\r\n"",data_len,data_len);
           printf(""source Port : %d\r\n"", *port);
           printf(""source IP : %d.%d.%d.%d\r\n"", addr[0], addr[1], addr[2], addr[3]);
        #endif
   
        wiz_read_buf(s, buf, data_len);        // data copy.
        break;

UDPÃ¬Â½ÂÃ«ÂÂ?Â¸Ã«ÂÂ° ?Â¬ÃªÂ¸Â°??sockettest?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?Â¼Ã«Â¡Â ?Â´Ã¬ÂÂ©???ÂÃ¬ÂÂ¤?Â¸Ã«ÂÂ ?Â´Ã«Â´Â¤?ÂµÃ«ÂÂ??
ÃªÂ°ÂÃ¬Â Â?ÂÃ¬ÂÂ¼Ã«Â¡?4byteÃ«Â§?Ã«Â³Â´Ã«ÂÂ´ÃªÂ³??Â´Ã­ÂÂ¨?ÂÃ«? ?ÂÃ¬Â Â?ÂÃ¬ÂÂ¬ ÃªÂ·Â¸Ã«ÂÂ¥  wiz_read_buf(s, buf, 12);  Ã«Â§??Â½Ã¬ÂÂ´Ã«Â³Â´Ã¬ÂÂ?ÂÃ«ÂÂ°
?Â´Ã«Â ÂÃªÂ²??Â½Ã¬ÂÂ¼Ã«Â©??ÂÃ¬ÂÂ ?Â°Ã¬ÂÂ´??Ã«ÂªÂ¨Ã«ÂÂ ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ??   
ÃªÂ·Â¸Ã«ÂÂ°??ip?? port,data_lenÃ«Â¥??ÂÃ¬ÂÂ¸?ÂÃªÂ³Â  4byteÃ«Â§??Â½Ã¬ÂÂ¼Ã«Â©?
rxdata[0]~[1]?? ?Â°Ã«Â ÂÃªÂ¸Â°ÃªÂ³Â  rxdata[2]~[3]?? ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ?? 

?Â¼ÃªÂ³Â¤???ÂÃ­ÂÂ?Â¬Ã¬ÂÂ ?ÂÃªÂ°Â?ÂÃ«ÂÂ?Â°Ã«Â¡Â ?ÂÃ¬ÂÂ¼??Ã«Â¬Â¸Ã«Â§Â¥???Â´Ã¬ÂÂ?ÂÃ¬ÂÂ???ÂÃ­ÂÂ´Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??
Ã«Â¹Â Ã«Â¥Â¸?ÂµÃ«? Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â´ÃªÂ»Â??

010-??12-??Ã¬Â¹? Ã«Â°ÂÃ«ÂÂÃ¬Â§??Â¼Ã«Â¡Â ?ÂÃ­ÂÂÃ¬Â£Â¼Ã¬ÂÂ???Â©Ã«ÂÂ?? I just tested it, but the transmission data is normal. hello
Thank you for using the W5300 well.
[Quote = ""PureDJ, POST: 1, Topic: 6178""]
if ( * ((Vuint16 *) MR) & MR_FS) // check FIFO Swap Bit
[/Quote]
Among the phrases you attached, there is a syntax comparing MR & MR_FS,
MR should be used using getmr ().
That is, when you start the function, write it in advance,
      'UINT16 MR = getmr ();'

after
'If (MR & MR_RS) instead of' if ((Vuint16 *) MR) & MR_FS '

Please use it.
If you have a problem again after changing, please leave a reply and we will respond quickly.

thank you
Irina The next day I solved it using iOLIBRARY.
I will do it later and answer it as you said.

And can I set the Big Dian and Little Little Diane in IOLIBRARY the same as the previous library?

MR = getmr ();
setmr (MR | MR_FS);

I can't do it by adding the above code, but I don't set up MR_FS.

In the future, we use Big Nien to link between other companies, but I would like to ask you how to set up the bigen design in iOLIBRARY. [Quote = ""PureDJ, POST: 4, Topic: 6178""]
And can I set the Big Dian and Little Little Diane in IOLIBRARY the same as the previous library?
[/Quote]
Yes ~ It is right to set it in the beginning.
By default, it is used as a Big-Endian, and if you set the FS BIT of the MR register, it will operate as Little-Endian.

Please feel free to contact us later.","Q) W5300 IC Chip Details? 
A) W5300 is a Hardwired TCP/IP embedded Ethernet controller chip providing an easy way to integrate the Internet into your embedded systems.

Q) Can you explain the usage of 2byte in W5300 IC? 
A) The 2-byte mode uses a 16-bit address bus, enabling a larger address space and extended features for communication.

Q) How to set up the Big Dian and Little Little Diane in IOLIBRARY for W5300? 
A) MR = getmr();
setmr(MR | MR_FS);
By default, it is used as Big-Endian, and if you set the FS BIT of the MR register, it will operate as Little-Endian.

Q) Can you provide an example of code to use to check the mode of s-th SOCKET in W5300? 
A) 
```c
switch (IINCHIP_READ(Sn_MR(s)) & 0x07)       // check the mode of s-th SOCKET
{
case Sn_MR_UDP :                              // UDP mode
    // Your code here
    break;
}
```"
3393,6179,"Hi,

I want to know if I can communicate with WIZ750SR-TTL over the internet. Let me clarify my question further. What I want to achieve is remote access between two domains over internet?

Can this be done with some software and no port forwarding or configuring the firewalls. If there is some other device that can achieve this feat, please do let me know.

Thank you. Hello, @neo.

[quote=""neo, post:1, topic:6179""]
What I want to achieve is remote access between two domains over internet?
[/quote]
I didn't understand what your question means.
Do you want to control the device on a remote network?

Please give more details.
Thank you. Ok so I have a computer running wizvsp and it is at my home (Network 1). 

Through VSP i want to communicate with WIZ750SR-TTL S2E over internet.

S2E is located at my office (Network 2). Now, i can configure S2E to act a server but then I cannot access it through Internet. Basically I want to access my serial device over internet. Hello, @neo, 

Ok, I understood.

In this case, you can set up port forwarding on the server side network. 
(In this case, WIZ750SR side)
and in the WIZVSP settings, change the remote host setting with external IP & forwarding port. Hi, @neo

And 'Port Forwarding' is not hard.
Your office Router has 'Port Forwarding' function. (set port number and local IP address)
And you need to fix the S2E IP address as local IP address assigned from Router.

Then you can connect to the S2E with Router external IP & S2E forwarding port.

Thank you I have tried and successfully connected to WIZ750SR using port forwarding. But the only reason I am searching for an alternate method or a device is because my company is not so keen on opening ports to the outside internet traffic.

We have a VPN service which allows access into the company's local area network but for reasons unknown, I am not able to connect to WIZ750SR over VPN. Hi, neo

Could you tell me more details about VPN network connection you tried?

WIZnet module does not support VPN client. So, WIZ750SR would be communicated via VPN router.

Thank you","Q) I want to know if I can communicate with WIZ750SR-TTL over the internet. Let me clarify my question further. What I want to achieve is remote access between two domains over internet?
Can this be done with some software and no port forwarding or configuring the firewalls. If there is some other device that can achieve this feat, please do let me know.
A) What I want to achieve is remote access between two domains over internet? I didn't understand what your question means.
Do you want to control the device on a remote network?
Please give more details.

Q) Ok so I have a computer running wizvsp and it is at my home (Network 1). Through VSP i want to communicate with WIZ750SR-TTL S2E over internet. S2E is located at my office (Network 2). Now, i can configure S2E to act a server but then I cannot access it through Internet. Basically I want to access my serial device over internet.
A) Ok, I understood. In this case, you can set up port forwarding on the server side network. (In this case, WIZ750SR side) and in the WIZVSP settings, change the remote host setting with external IP & forwarding port.

Q) I have tried and successfully connected to WIZ750SR using port forwarding. But the only reason I am searching for an alternate method or a device is because my company is not so keen on opening ports to the outside internet traffic. We have a VPN service which allows access into the company's local area network but for reasons unknown, I am not able to connect to WIZ750SR over VPN.
A) Could you tell me more details about VPN network connection you tried? WIZnet module does not support VPN client. So, WIZ750SR would be communicated via VPN router."
3394,6181,"wizs2e configtool(v1.0.0.5)?ÂÃ¬ÂÂ ?Â¤Ã¬Â Â?? ?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??Â´Ã«Â£Â¨??Ã¬Â§ÂÃ«ÂÂ??

?ÂÃ¬?Ã«Â§?tcp/ip ?Â°ÃªÂ²Â°???ÂÃ¬Â§Â ?ÂÃ¬ÂÂ??Ã«Â¬Â¸Ã¬ÂÂÃ«Â¥??ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

use the follow ip address Ã¬Â²Â´Ã­ÂÂ¬

ip address : 192.168.1.88
subnetmask: 255.255.255.0
gateway: 192.168.1.1
dns server:0.0.0.0 (dns t?ÂÃ«Â²ÂÃ«Â¥??Â¤Ã¬Â Â?ÂÃ¬? ?ÂÃ¬ÂÂ¼Ã«Â©??ÂÃ­ÂÂ???ÂÃ«ÂÂ???Â´Ã«Â ÂÃªÂ²??Â£Ã¬ÂÂ?ÂµÃ«ÂÂ??)

ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³?pc ???ÂÃ¬ÂÂ´?Â¼Ã«ÂÂ 192.168.1.209 ?ÂÃ«ÂÂ??
pc?ÂÃ¬ÂÂ tcp ?ÂÃ¬ÂÂ???ÂÃ«ÂÂ?ÂÃ«Â©Â´ ?Â¤Ã­ÂÂ¨?Â©Ã«ÂÂ??

ping test???ÂÃ¬ÂÂ?ÂÃ«ÂÂ??

9Ã«Â²ÂÃªÂ³Â¼ 10Ã«Â²????? HIGHÃ«Â¡??Â¤Ã¬Â Â?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

Ã«Â¬Â´Ã¬ÂÂ??Ã«Â¬Â¸Ã¬Â Â?Â¼ÃªÂ¹Â?? hello.

Please check if you have the same symptoms when you set the mode of the device to TCP Client.

In addition, we will request the following information to confirm the symptoms.
* Device Type & Firmware Version
* Device setting information (Capture the Config Tool screen.)

thank you The firmware version can be viewed by pressing the + button on the left side of the Mac address on the left device list.

There are three types of devices because there are three types of W7500S2E, so I asked what modules are using.It seems that you are using the W7500S2E-R1.

I will answer after confirming the symptoms with the information you uploaded.

thank you Ah ... I found that when I checked the firmware version, I found that the start mode was at Command.

It works well to change to data mode.

Thank you very much for your quick answer. Yes, I'm glad to find the cause right away.
thank you ","Q) Please check if you have the same symptoms when you set the mode of the device to TCP Client.
A) I will answer after confirming the symptoms with the information you uploaded.

Q) There are three types of devices because there are three types of W7500S2E, so I asked what modules are using. It seems that you are using the W7500S2E-R1.
A) I will answer after confirming the symptoms with the information you uploaded."
3395,6186,"hello.We are currently using the Wizfi250 Wi-Fi module for our products.
I would like to contact you two things.

1. What is the shipping firmware version of the Wizfi250 module?The firmware version of the current Wizfi250 module is 1.0.3.3.
According to http://wizwiki.net/wiki/doku.php?id=products:WIZFI250: WIZFI250FIRMWARE:Start, the official firmware version is 1.0.3.3, but the latest version except the beta version is 1.0.4.9 There is.If you buy a WIZFI250 module based on the current basis, I wonder if it is 1.0.3.3 or 1.0.4.9.

2. I would like to use the AT+WCHECK command to automatically reconnect the specified AP when the connection is broken.
http://wizwiki.net/wiki/doku.php?id=products:WIZFI250:WIZFI250pg:atat_Command_Set#at_WCHECK is said to be used in more than 1.0.3.5 version 1.0.3.5.If you set the AT+WCHECK command at 1.0.3.3, you will get OK return.

thank you hello

Currently, general mass production firmware is 1.0.3.3.
If you want to use the +WCHECK command, we recommend using the latest version (1.0.4.9).","Q) What is the shipping firmware version of the Wizfi250 module?
Q) I would like to use the AT+WCHECK command to automatically reconnect the specified AP when the connection is broken.
A) Currently, general mass production firmware is 1.0.3.3. If you want to use the +WCHECK command, we recommend using the latest version (1.0.4.9)."
3396,6189,"Check two things: powers (3.3V and 1.2V), and crystal clocking at correct frequency.

[quote=""syvic, post:1, topic:6189""]
We have also verified that we have a 14Mhz signal on the INT line
[/quote]

What is it?

[quote=""syvic, post:1, topic:6189""]
This same fault is proven in the 20 PCBs that we have ordered to manufacture.
[/quote]

Must be either design fault, or some bad/incorrect component. [quote=""syvic, post:3, topic:6189""]
Could have the old crystal broke the w5500?
[/quote]

Most probably not. Try removing pull-up resistors from RSVD pins. Not sure why you have them as they create 2.95V through built-in pull-downs of 85k. We just left the RSVD signals disconnected (pins 38 to 42) and we have made some progress:

Now when booting without Ethernet cable connected the two LEDs (ACT and LINK) are off.

If we connect an Ethernet cable the LINK LED stays off, although now, for the first time, the computer does recognize LINK. In fact, if we ping or generate any type of traffic, the ACT LED already lights up.

However, we still have no response in the MISO line.

Any other suggestions?

Thanks again for your help. >W5500 does not support auto-MDIX feature

Ensure you use correct cable. We have tried to make the same change (remove the resistors that we had in RSVD) in the rest of the PCBs and it seems that they work correctly. For some reason the PCB to which we changed the crystal does not work well, but we will investigate.

Thank you very much for your help!","Q) What is it?
A) We have also verified that we have a 14Mhz signal on the INT line.
Q) Could have the old crystal broke the w5500?
A) Most probably not. Try removing pull-up resistors from RSVD pins. Not sure why you have them as they create 2.95V through built-in pull-downs of 85k. We just left the RSVD signals disconnected (pins 38 to 42) and we have made some progress: Now when booting without Ethernet cable connected the two LEDs (ACT and LINK) are off. If we connect an Ethernet cable the LINK LED stays off, although now, for the first time, the computer does recognize LINK. In fact, if we ping or generate any type of traffic, the ACT LED already lights up. However, we still have no response in the MISO line. Any other suggestions?
A) >W5500 does not support auto-MDIX feature Ensure you use correct cable. We have tried to make the same change (remove the resistors that we had in RSVD) in the rest of the PCBs and it seems that they work correctly. For some reason the PCB to which we changed the crystal does not work well, but we will investigate. Thank you very much for your help!"
3397,619,"We have send Parallel data to pc from our Embedded circuit using tcp/ip. For this we want use wiz830mj module.Pls conform whether we can load parallel data of 4lines in to wiz830MJ using strobe pulse on separate line, without using Micro controller Hi,
I don't understand exaclty what you want.

Can you explain to me more detail? 
Can you draw a simple block diagram about that?

Thank you.","Q) Can we load parallel data of 4lines into wiz830MJ using strobe pulse on separate line, without using a Microcontroller?
A) Hi, I don't understand exactly what you want. Can you explain to me more detail? Can you draw a simple block diagram about that? Thank you."
3398,6198,"Hello,

Our team is currently using WIZ820io in one product and we would like to migrate WIZ850io.
My teammates is working on how to migrate but they are still in progress.

I would like to know that is there any document specify how to migrate from WIZ820io to WIZ850io in terms of software.
Is there anything we need to take into before migration ?

Best regards. Hi~
@erdemsimsek
I?Âm so sorry about getting back to you so late.
WIZ850io is hardware compatible with WIZ820io. WIZ820io users, to migrate to WIZ850io, need to modify the Firmware.
Because  of the SPI frame of WIZ850io  is different from WIZ820io.

thanks,
BR Hi. I have an issue about the process of migration firmware.

To successfully program the new firmware into the WIZ850io, what is needed? Do you have any dedicated program for this? Also, do you have any guidelines on how to do this change?

Regards.","Q) To successfully program the new firmware into the WIZ850io, what is needed? Do you have any dedicated program for this? Also, do you have any guidelines on how to do this change?
A) WIZ850io is hardware compatible with WIZ820io. WIZ820io users, to migrate to WIZ850io, need to modify the Firmware. Because of the SPI frame of WIZ850io is different from WIZ820io."
3399,6199,"Dear Team,
I am trying to send an HTTP GET Request, and eventually Post Requests. I am using the site: httpbin.org/get to test my sequence, but am stumped.
AT

[OK]

AT+WSET=0,Mything

[OK]

AT+WSEC=0,WPA2,ihopethisworkswell

[OK]

AT+WNET=1

[OK]

AT+WJOIN

Joining : Mything

Successfully joined : Mything

[Link-Up Event]

IP Addr : 172.20.10.2

Gateway : 172.20.10.1

[OK]

AT+SCON=SO,TCN,52.73.47.183,80,5000,0

[OK]

[CONNECT 0]

AT+SSEND=0,,,170

GET http://httpbin.org/get User-Agent:Mozilla/5.0 HTTP/1.1

[ERROR: INVALID INPUT]

I tried following post 5834 on this forum, but even with translating the page I had a tough time.

I would appreciate any help you could give. Hi GMK.

you should use the +SSEND command like below.
AT+SSEND=0,,,18{0x0d}

I hope this documents in below links will be helpful to you.
--> SSEND Command description
https://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#method_of_setting_tcp_client_and_exchanging_data_in_command_mode

--> HTTPS Requset 
https://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#example_of_ssl_connection Hi wizdaniel,

Thank you for the correction on my SSEND command, I think it has helped.
The next question is how are headers supposed to be formatted for this? 
The example provided shows no header, other than the GET call, and I get an error 400 if I try like this. I also get error 400 the way I am formatting the command right now, so I would appreciate any help you could give me on this as well.

Edit: Thought I should add that I would like to know if there's a place where I should insert the full url, as I am trying to access a specific page of an IIS server at this ip address. I have tried inserting the full header to access this site into this line but with no luck.

GET / HTTP/1.1 {0x0d}{0x0a}

{0x0d}{0x0a}

[OK]

x0d}{0x0a}

[ERROR: INVALID INPUT]

{0x0d}{0x0a}

[ERROR: INVALID INPUT]

{0,192.168.1.13,80,490}HTTP/1.1 400 Bad Request

Content-Type: text/html; charset=us-ascii

Server: Microsoft-HTTPAPI/2.0

Date: Mon, 22 Jul 2019 19:58:15 GMT

Connection: close

Content-Length: 311



<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.01//EN""""http://www.w3.org/TR/html4/strict.dtd"">

<HTML><HEAD><TITLE>Bad Request</TITLE>

<META HTTP-EQUIV=""Content-Type"" Content=""text/html; charset=us-ascii""></HEAD>

<BODY><h2>Bad Request</h2>

<hr><p>HTTP Error 400. The request is badly formed.</p>

</BODY></HTML>

[DISCONNECT 0] Hi

here is the HTTP request message sample to request hello.html page from the webserver running on abc.com
```
GET /hello.html HTTP/1.1{0x0d}{0x0a}
Host: www.abc.com{0x0d}{0x0a}
{0x0d}{0x0a}
```

if you want to send formed data to the server, you have to use a 'POST' method instead of the 'GET' like below.
Content-Type and Length are important parameters in the POST method.

```
POST /test/example HTTP/1.1{0x0d}{0x0a}
Host: www.abc.com{0x0d}{0x0a}
Content-Type: application/json{0x0d}{0x0a}
Content-Length: 18{0x0d}{0x0a}
{0x0d}{0x0a}
{""name"": ""daniel""}
{0x0d}{0x0a}
{0x0d}{0x0a}
```

Regards Hi

there is a example request to get some message from the httpbin.org as you tried.

```
GET /get HTTP/1.1{0x0d}{0x0a}
Host: 52.22.188.80:80{0x0d}{0x0a}{0x0d}{0x0a}
```
I guess that the message you sent was right formed message.
but message length was wrong. you should set the message length in the AT+SSEND the 18 to right length.

I prefer to set the length '44' for above example.
```
AT+SSEND=0,,,44{0x0d}
GET /get HTTP/1.1{0x0d}{0x0a}
Host: 52.22.188.80:80{0x0d}{0x0a}{0x0d}{0x0a}
```

the {0x0d}{0x0a} means the carrige return&line feed.
be careful when you put the CR&LF using the options in the TeraTerm.
because AT+SSEND cmd only needs ""CR"". and HTTP messages need ""CR&LF"".","Q) The next question is how are headers supposed to be formatted for this? The example provided shows no header, other than the GET call, and I get an error 400 if I try like this. I also get error 400 the way I am formatting the command right now, so I would appreciate any help you could give me on this as well.
A) If you want to send formed data to the server, you have to use a 'POST' method instead of the 'GET' like below.
Content-Type and Length are important parameters in the POST method.
```
POST /test/example HTTP/1.1{0x0d}{0x0a}
Host: www.abc.com{0x0d}{0x0a}
Content-Type: application/json{0x0d}{0x0a}
Content-Length: 18{0x0d}{0x0a}
{0x0d}{0x0a}
{""name"": ""daniel""}
{0x0d}{0x0a}
{0x0d}{0x0a}
```

Q) Thought I should add that I would like to know if there's a place where I should insert the full url, as I am trying to access a specific page of an IIS server at this ip address. I have tried inserting the full header to access this site into this line but with no luck.
A) here is the HTTP request message sample to request hello.html page from the webserver running on abc.com
```
GET /hello.html HTTP/1.1{0x0d}{0x0a}
Host: www.abc.com{0x0d}{0x0a}
{0x0d}{0x0a}
```"
3400,620,"hello.

The production board using the W5300 is TCP communication with PC (PC: Client, Production Board: Server)
PLC is trying to communicate simultaneously with MODBUS TCP communication (production board: client, PLC: Server).
 
Is it possible to communicate with a client in some situations using one W5300 chip in some situations?
Currently, PCs and W5300 are doing TCP communication.
(PC: Client, Production Board: Server, 7 out of 8 available SOCKETs)
 
It is also a situation where you need to add a client socket for this.
As you mentioned in the existing e -mail question, I checked the program example on the WIZNET site, but
I'm not sure what to refer to in detail to add a client socket.
 
Thank you for explaining a little more detail. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

socket open ?ÂÃ¬ÂÂ ?Â¸Ã­ÂÂ?ÂÃ«ÂÂ ÃªÂ²ÂÃ¬? TCP Server ?Â¸Ã­ÂÂ?ÂÃ«ÂÂ ÃªÂ²ÂÃªÂ³Â¼ ?ÂÃ¬ÂÂ¼?Â©Ã«ÂÂ??
(Sn_MR???ÂÃ¬ÂÂ 4bitÃ«Â¥?TCP(""0001"")Ã«Â¡??Â¸Ã­ÂÂ) 
ÃªÂµÂ¬Ã­ÂÂ??Ã«Â°Â©Ã«Â²Â???Â°Ã«ÂÂ¼ TCP client or TCP ServerÃ«Â¡??ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

TCP Server??ÃªÂ²Â½Ã¬ÂÂ° : open -> listen -> recv or send -> disconnect or close
TCP Client??ÃªÂ²Â½Ã¬ÂÂ° : open -> connect -> recv or send ->disconnect or close


thanks, :slight_smile: hello.

See Socket.C, H and W5300.C H in the example code.

The W5300 has a well -known datasheet and doxygen document, so if you look at these documents more than first viewing the source,

I think it can be implemented without difficulty.If you have a basic network knowledge, I think you can implement it more easily.

In addition, you can operate with client and server for each socket on one chip, so you can implement it according to the application.
There is no situation separately.

thank you Thank you for your answer.
It's not easy to access because I am a beginner stage in communication and programming itself and I need to modify other code.
Looking at the existing code, you use the same handler as if you are using it as a server.
If you want to modify the Handler code to a client rather than server, do you think the connect part should be in place instead of the Listen part?
How can I fix it? hello.

Yes, that's right.

In the case of Server, the Client is listed to connect, but in the case of the client, it is correct to connect to the server side.

[Code]
CASE SOCK_INIT:
#IFDEF Debug_msg_W5300_API
if (S_PTR-> Status_PREV! = s_ptr-> STATUS)
{
SPRINTF (GDBGSTR, ""SOCKET %U: SOCK_INIT \ N"", S_PTR-> s);
DBG_PRINT (GDBGSTR);
}
#endif
s_ptr-> status_prev = s_ptr-> status;
[B] LISTEN (S_PTR-> s);[/B]
Break;
[/Code]

In the case above, you can make a connection using the connect function towards the server, not the listen.

thank you Thank you for your answer.
We know that seven out of 8 ports can be used as server and the other as client.
But can I use the port used as a client as Modbus/TCP?
MODBUS/TCP knows that if TCP communication is supported, only the protocol format can be delivered in a fixed format.
The W5300 Data Sheet is not mentioned separately. I didn't know much about MODBUS TCP, so I briefly searched
If you can send and receive a TCP packet, it seems to be possible.

Therefore, it seems to be available.
Of course, it must be implemented in software.

thank you Ã¬Â§??ÂÃ¬Â Â???ÂµÃ«? ÃªÂ°ÂÃ¬ÂÂ¬?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.
?Â´Ã¬Â Â Ã¬Â²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ?ÂÃ«ÂÂ ?Â¨ÃªÂ³Â??Ã¬Â§ÂÃ«Â¬Â¸??Ã«Â§ÂÃ«ÂÂ¤??
Client ?ÂÃ¬Â¼Â Ã¬Â¶ÂÃª??ÂÃ¬ÂÂ¬ test Ã¬Â¤?' case SOCK_ESTABLISHED: ' ?ÂÃ­ÂÂÃ«Â¡??ÂÃªÂ·Â¼?ÂÃ«Â Â¤Ã«Â©??Â´Ã«ÂÂ»ÃªÂ²??Â´Ã¬ÂÂ¼ ?ÂÃ«ÂÂ??
?ÂÃ­ÂÂ?Â´Ã¬? ?ÂÃ¬ÂÂ ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?ÂÃ¬ÂÂ void     loopback_tcpc(SOCKET s, uint8* addr, uint16 port, uint8* buf, uint16 mode)
Ã«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬?ÃªÂ³? SOCK_CLOSED ?? SOCK_INIT ?Â¼Ã«Â¡Â??Ã¬Â§ÂÃ¬ÂÂ???ÂÃ«ÂÂ??SOCK_ESTABLISHED Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ¼Ã«Â¡ÂÃ«ÂÂ Ã¬Â§ÂÃ¬ÂÂ???ÂÃ­ÂÂ?Â¤Ã¬ÂÂ.
Data SheetÃ«Â¥?Ã«Â³Â´Ã«Â©Â´ Sn_CR ?ÂÃ¬ÂÂ Connect(0x04)ÃªÂ°? ?ÂÃ«Â©Â´ Sn_SSR??SOCK_ESTABLISHEDÃ«Â¡?Ã«Â³?ÃªÂ²Â½Ã«ÂÂ?Â¤ÃªÂ³Â  ?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ??
?ÂÃ«Â²ÂÃªÂ·Â¸Ã«? ÃªÂ±Â¸Ã¬ÂÂ´??Ã«Â³Â´Ã«Â©Â´ ÃªÂ³ÂÃ¬ÂÂ SOCK_CLOSED?? SOCK_INIT?Â¼Ã«Â¡ÂÃ«Â§??ÂÃ­ÂÂÃªÂ°? Ã«Â³?ÃªÂ²Â½Ã«ÂÂ©?ÂÃ«ÂÂ¤.
SOCK_INIT??Connect ?Â¨Ã¬ÂÂÃ«Â¡ÂÃ«ÂÂ Ã¬Â§ÂÃ¬ÂÂ???ÂÃªÂ³Â , ?Â´Ã«ÂÂ¹ ?Â¨Ã¬ÂÂÃ«Â¥?
?ÂÃ¬Â ÂÃ«Â¬Â¸Ã¬ÂÂ 'connect(s, addr, port)' ?ÂÃ¬ÂÂ
plc_tcp_connect_check=connect(s_ptr->s, PLCIP, 502)
?ÂÃªÂ¸Â° Ã«ÂªÂ¨Ã¬ÂÂµ?Â¼Ã«Â¡Â Ã«Â³?ÃªÂ²Â½Ã­ÂÂ???ÂµÃ«ÂÂ??
ConnectÃªÂ°? ?ÂÃ«?Ã«Â¡??ÂÃªÂ³Â  ?ÂÃ«ÂÂÃ¬Â§? ?ÂÃ¬ÂÂ¸?????ÂÃ«ÂÂ Ã«Â°Â©Ã«Â²ÂÃªÂ³? EstablishedÃ«Â¡?Ã¬Â§ÂÃ¬ÂÂ?????ÂÃ«ÂÂ Ã«Â°Â©Ã«Â²Â???ÂÃ«Â Â¤Ã¬Â£Â¼Ã¬ÂÂÃ«Â©?ÃªÂ°ÂÃ¬ÂÂ¬?ÂÃ«Â¦Â¬ÃªÂ²Â Ã¬ÂÂµ?ÂÃ«ÂÂ¤.

?ÂÃªÂ¸Â°???ÂÃª? Ã¬Â°Â¸Ã¬Â¡Â°???ÂÃ¬ÂÂÃ¬Â½ÂÃ«ÂÂ?ÂÃ«ÂÂ??
======================================================================================================
// void     loopback_tcps(SOCKET s, uint16 port, uint8* buf, uint16 mode)
/**
 * ""TCP CLIENT"" loopback program.
 */ 
void     loopback_tcpc(SOCKET s, uint8* addr, uint16 port, uint8* buf, uint16 mode)
{
   uint32 len;
   static uint16 any_port = 1000;
   
   switch(getSn_SSR(s))                   // check SOCKET status
   {                                      // ------------
      case SOCK_ESTABLISHED:              // ESTABLISHED?
         if(getSn_IR(s) & Sn_IR_CON)      // check Sn_IR_CON bit
         {
            printf(""%d : Connect OK\r\n"",s);
            setSn_IR(s,Sn_IR_CON);        // clear Sn_IR_CON
         }
         if((len=getSn_RX_RSR(s)) > 0)    // check the size of received data
         {
            len = recv(s,buf,len);        // recv
            if(len !=send(s,buf,len))     // send
            {
               printf(""%d : Send Fail.len=%d\r\n"",s,len);
            }
         }
         break;
                                          // ---------------
   case SOCK_CLOSE_WAIT:                  // PASSIVE CLOSED
         disconnect(s);                   // disconnect 
         break;
                                          // ---------------
   case SOCK_CLOSED:                      // CLOSED
      close(s);                           // close the SOCKET
      socket(s,Sn_MR_TCP,any_port++,mode);// open the SOCKET with TCP mode and any source port number
      break;
                                          // ------------------------------
   case SOCK_INIT:                        // The SOCKET opened with TCP mode
      connect(s, addr, port);             // Try to connect to ""TCP SERVER""
      printf(""%d : LOOPBACK_TCPC(%d.%d.%d.%d:%d) Started.\r\n"",s,addr[0],addr[1],addr[2],addr[3],port);
      break;
   default:
      break;
   }
} TCP connections are connected in the same way.
TCP Client TCP Server
SYN ---------->
       <---------- SYN ACK
ACK ------------>

It is necessary to make sure that the packets are properly delivered and received.

If you test the test device and the W5300, you cannot observe the packet,
Change it to a PC instead of Test Device and observe the packet with Wireshark PC Program.
Please note that the Wireshark program has a detailed way to use on the freeware and the Internet.

[Code] PLC_TCP_CONNECT_CHECK = Connect (S_PTR-> S, PLCIP, 502) [/Code]
Please also check if the S_PTR-> S value has a value of 0 ~ 7. In relation to PLC and PC, I already connected Ethernet communication (TCP/IP) to fly the command from PLC to PLC in the form of Modbus/TCP Protocol.
Currently, we are trying to check the communication between the production board (client) and the PLC (Server) with the W5300.
Can you check which register part of the W5300 and see if the connection is done properly? If Status Register is Established, the connection is established.

However, only Close and init are repeated.
The easiest.Where the problem occurs, there are so many variables.

You need to connect using the init state, but the packet is right, the protocol configuration of the packet is correct, the roster is not generated in the middle, the accurate data from the PLC, and the response packet on the server is sent properly on the server.It is necessary to check whether the protocol configuration of the response packet is properly composed, the response packet is properly received, and the proper parsing is done. void loopback_tcpc(SOCKET s, uint8* addr, uint16 port, uint8* buf, uint16 mode)
?ÂÃ¬ÂÂ ?ÂÃ¬??ÂÃ«ÂÂ¯??
Socket ?ÂÃ¬ÂÂ ?ÂÃ­ÂÂÃ«Â¥??ÂÃ¬ÂÂ¸ ?ÂÃ«ÂÂ Ã«Â°Â©Ã«Â²Â?? 2ÃªÂ°?Ã¬Â§? ?ÂÃ«ÂÂ??
Sn_SSR ???ÂÃ­ÂÂÃ«Â¥?Ã«ÂªÂ¨Ã«ÂÂ?Â°Ã«Â§Â ?ÂÃªÂ±Â°?? Sn_IR(CONNECT) bitÃªÂ°? Set ?ÂÃ¬ÂÂ?ÂÃ¬? ?ÂÃ¬ÂÂ¸ ?ÂÃ«ÂÂ ÃªÂ²ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.

connect() Ã«ÂªÂÃ«Â Â¹?Â´Ã­ÂÂ connection??Ã¬Â¦? SOCK_EASTABLISHED ?ÂÃ¬ÂÂ¸???ÂÃ«ÂÂ?Â¤ÃªÂ³Â  Ã¬Â§ÂÃ«Â¬Â¸???Â´Ã­ÂÂ´?ÂÃ«ÂÂ?? ?ÂÃ«ÂÂÃªÂ°???

pc?? plc?????ÂÃ«ÂÂ?? w5300ÃªÂ³?plcÃ«Â¡????ÂÃ«ÂÂ?Â¤ÃªÂ³Â  ?Â´Ã­ÂÂ´?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
ÃªÂ·Â¸Ã«ÂÂ??w5300ÃªÂ³?plc ÃªÂ°ÂÃ¬ÂÂ connection packet?Â¤Ã¬ÂÂ´ ???Â¤ÃªÂ³Â  ÃªÂ°??ÂÃ¬? ?ÂÃ¬ÂÂ¸Ã¬Â°?wiresharkÃ«Â¡?Ã¬ÂºÂ¡Ã¬Â³ÂÃ«Â¥?Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â°ÃªÂ²Â?ÂÃ«ÂÂ¤.

?Â¤Ã¬ÂÂ ?ÂÃ«Â²Â wiresharkÃ«Â¡?Ã¬ÂºÂ¡Ã¬Â³Â Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? Thank you for your continuous answer.
There is an additional question.
On page 94 of the Data Sheet of the W5300, the socket initialization is shown.
The 'socket initialization process applies the same regardless of ?ÂTCP SEVER??and ?ÂTCP Client??
Is it mentioned, so does it mean that you can do the same when creating TCP Sever Socket and TCP Client socket?
In other words, TCP SEVER SOCKET is generated using the same function as below (0 ~ 6),
Is it possible to use it as a TCP Client Socket after creating the same 7 times?
In addition, PLC uses Port Num as 502 using MODBUS TCP.Or can I connect to port 502 only in the connect function?
Currently, Port Num has been made to 5007, and as as follows, it is the same init processing from 0 to 7 (portnum 5000 ~ 5007).
In addition, I read Sn_ir value using the getsn_ir (s) function in the connect function, and 0x00000008 is released.
This looks like a timeout.
And what is the part that gives you a packet during connect?
MODBUS TCP has a protocol, so you have to deliver it in a fixed form
When testing PCs and PLCs, I connected to PLC using a general TCP connection program.
After being connected to the MODBUS TCP Protocol, the Response was over.
For this reason, I don't think there is no modification to give the Packet for Connection?

[Code] Section (""SDRAM0"") void W5300_SOCKETS_INIT (void)
{
Uint32 I;

  For (i = 0; I <8; I ++)
  {
    GSOCKETS [I] .s = (SOCKET) I;
    GSOCKETS [I] .status = socket_closed;
    GSOCKETS [I] .status_PREV = socket_closed+1;// temp
    GSOCKETS [I] .port = 5000+I;// check ciu_app.h
    gsockets [i] .stat_rx_cnt = 0;
    gsockets [i] .stat_tx_cnt = 0;
    gsockets [I] .stat_rx_cnt_toto = 0;
    gsockets [I] .stat_tx_cnt_toto = 0;
    GSOCKETS [I] .rxb_cnt = 0;
    gsockets [I] .txb_cnt = 0;
    GSOCKETS [I] .rxb_ridx = 0;
    GSOCKETS [I] .rxb_widx = 0;
    GSOCKETS [I] .txb_ridx = 0;
    GSOCKETS [I] .txb_widx = 0;
    GSOCKETS [I] .rxb_max = getiinchip_rxmax (i);
    GSOCKETS [I] .rxb_PTR = HEAP_MALLOC (gheap_index, gsockets [I] .rxb_max);
    if (GSOCKETS [I] .rxb_PTR == NULL)
      DBG_trap (Exception_user_generic, ""W5300"");
    GSOCKETS [i] .txb_max = getiinchip_txmax (i);
    GSOCKETS [I] .txb_PTR = HEAP_MALLOC (gheap_index, gsockets [I] .txb_max);
    if (GSOCKETS [i] .txb_PTR == NULL)
      DBG_trap (Exception_user_generic, ""W5300"");
    
    // Note: if sn_kpalvtr = 0, no keyp alive is generated
    setsn_kpalvtr (i, 0);// VAL*5sec
  }
} [/code] When I entered the LoopBack_TCPC I asked, repeating only sock_closed and sock_init
In my code, there was a part that set the timeout in sock_closed,
This part went into 4 and was set to be a timeout in only 0.4msec.
I set the part to 1 second (10000) and entered the sock_established state.
If you have any wrong parts, please tell us.

In addition, in the sock_established state, SN_IR is 0x0010 (Sendok), not 0x0001 (Con).
If it's Sendok, I delivered TCP Packet to PLC from the W5300 board.


[Code] // IIINCHIP_WRITE (RTR, 4+EST_NUM*5);// 100us * x: before change
// Timeout time setting 10000 (1 second) enter Established
 IIINCHIP_WRITE (RTR, 10000);// After changing [/Code] hello

1. So does it mean that you can do the same when creating TCP SEVER SOCKET and TCP Client sockets?
-> Yes.This is the difference between the Listen or Connect after Open.

2. Is it possible to use it as TCP Client Socket after creating the same number 7?
-> Yes.

3. Do I have to set the port number of TCP Client Socket to 502?
-> There is no need to match the port number.You only need to match the port number of the server in the connect function.
However, you do not need to create a port number like other sockets.
Also, in the case of Windows OS, once connection is formed, the PORT number of the client and server will be temporarily stored for a while.That's why you shouldn't try to connect with the same port number after Close.So if there is no special reason for general applications, use a method of increasing the client's port number when re -accessing after Close.You just have to pay attention to this.

4. Do you think you don't have to modify the part that gives you a packet for connection?
-> If the PC and PLC are connected to a general TCP connection program, the W5300 is used to connect.If you use the above functions, you will be able to send and receive packets internally, so if there is no problem in the network, connection will be formed.

5. Also, in the sock_established state, SN_IR is 0x0010 (Sendok), not 0x0001 (con).
If it's Sendok, I delivered TCP Packet to PLC from the W5300 board.
-> Errata 1 of W5300 is suspected.Please refer to Errata and if it doesn't work, please ask again.

thank you Ã«Â³Â´Ã¬ÂÂÃªÂ¸Â°Ã¬ÂÂ ?Â´Ã¬ÂÂ??Ã¬Â§ÂÃ«Â¬Â¸??Ã«Â§ÂÃ¬ÂÂ?ÂÃ«ÂÂ° ?ÂµÃ«???Ã¬Â£Â¼Ã¬ÂÂ??ÃªÂ°ÂÃ¬ÂÂ¬?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

'5. ?ÂÃ­ÂÂ Sock_Established ?ÂÃ­ÂÂ?ÂÃ¬ÂÂ Sn_IR ??0x0001 (CON) ???ÂÃ«ÂÂ 0x0010(SendOK) ?ÂÃ­ÂÂ?ÂÃ«ÂÂ??
SendOK?Â´Ã«Â©Â´ W5300 Ã«Â³Â´Ã«ÂÂ?ÂÃ¬ÂÂ PLCÃ«Â¡?TCP Packet?? ?ÂÃ«ÂÂ¬?ÂÃ¬??ÂÃ«ÂÂ° ReceiveÃªÂ°? ?ÂÃ«ÂÂ¬?ÂÃ¬? ?ÂÃ¬?ÃªÂ±Â´Ãª???'
?ÂÃ¬ÂÂ 5Ã«Â²ÂÃ¬ÂÂ???Â¸ÃªÂ¸Â??Ã«Â¶?Ã«Â¶ÂÃ¬? ?ÂÃª? Ã«Â³Â´ÃªÂ³Â  ?ÂÃ«ÂÂ Ã¬Â½ÂÃ«ÂÂ??Established Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ??
'setSn_CR(s_ptr->s, Sn_CR_SEND); '
Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ­ÂÂ?ÂÃªÂ³Â  ?ÂÃ¬ÂÂ 0x0010(SendOK) ?ÂÃ­ÂÂÃªÂ°? ?ÂÃ¬ÂÂ?ÂµÃ«ÂÂ??
?Â´Ã«Â ÂÃªÂ²??ÂÃ­ÂÂ???Â´Ã¬ÂÂ Ã«Â¥??ÂÃ­ÂÂ?ÂÃ«ÂÂ Ã«ÂªÂ¨Ã«Â¥Â´ÃªÂ²Â Ã¬?Ã«Â§? ?Â°Ã¬ÂÂ´?Â°Ã¬ÂÂ?Â¸Ã«? Ã«Â³Â´Ã«Â©Â´ 
'Host??Sn_IR(SENDOK)=1' ???ÂÃ¬ÂÂ¸ ??ÃªÂ·??Â¤Ã¬ÂÂ Data??????Send CommandÃ«Â¥??Â´Ã«Â¦Â´ ???ÂÃ«ÂÂ¤.'
?Â¼ÃªÂ³Â  ??ÃªÂ²ÂÃ¬ÂÂ Ã«Â³Â´Ã¬ÂÂ, Established ?ÂÃ­ÂÂ?ÂÃ¬ÂÂ SendOK ?ÂÃ­ÂÂÃ«Â¡?Ã«Â§ÂÃ«ÂÂ¤??Ã¬Â¤? ???ÂÃ¬ÂÂ??CommandÃ«Â¥??Â Ã«Â¦Â¬ÃªÂ¸??ÂÃ­ÂÂ ÃªÂ²?ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?Â´Ã«ÂÂ¹ ÃªÂµÂ¬Ã«Â¬Â¸???ÂÃªÂ¸Â° ?ÂÃ¬ÂÂÃ«Â¬??ÂÃ­ÂÂ©?ÂÃ¬ÂÂ case Sock_Established Ã«Â°ÂÃ¬ÂÂ if(getSn_IR(s) & Sn_IR_CON) ?Â´Ã«???
setSn_IR(s,Sn_IR_CON);  ÃªÂµÂ¬Ã«Â¬Â¸???ÂÃ­ÂÂ????
        
[code]       setSn_TX_WRSR(s_ptr->s, 1);   
       IINCHIP_WRITE(Sn_TX_FIFOR(s_ptr->s), 0x0000);  
        setSn_CR(s_ptr->s, Sn_CR_SEND);   [/code]
        
?Â´Ã«ÂÂ¬??Ã«ÂªÂÃ«Â Â¹?Â´Ã«? ?ÂÃ­ÂÂ?ÂÃªÂ³Â  ?ÂÃ«Â©Â´ Sn_IR(s)ÃªÂ°? 0x0010 ???ÂÃ¬ÂÂ?ÂµÃ«ÂÂ??
ÃªÂ¶ÂÃªÂ¸Â?ÂÃªÂ±Â´ Estatblished ?Â¤Ã¬ÂÂ´ÃªÂ°??ÂÃ«ÂÂ Sn_IR(s)ÃªÂ°? 0x0001 ?Â´Ã¬ÂÂ?Â¤Ãª? 
setSn_IR(s,Sn_IR_CON);  ÃªÂµÂ¬Ã«Â¬Â¸???ÂÃ­ÂÂ????0x0000 ???ÂÃªÂ³Â 
?Â´Ã­ÂÂ???Â¤Ã¬ÂÂ  setSn_CR(s_ptr->s, Sn_CR_SEND);  ???ÂÃ«Â©Â´ Sn_IR(s)ÃªÂ°? 0x0010 ???ÂÃ«ÂÂ ÃªÂ²ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.
W5300?ÂÃ¬ÂÂ ?ÂÃªÂ³Âµ???ÂÃ¬ÂÂÃ¬Â½ÂÃ«ÂÂÃ«Â¥?Ã«Â´ÂÃ«ÂÂ Established ?Â´Ã«???
' setSn_IR(s,Sn_IR_CON);        // clear Sn_IR_CON' ?Â¼ÃªÂ³Â  ?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ?????Â´Ã«?Ã«Â¶ÂÃ¬ÂÂ ?Â¬Ã¬ÂÂ©?Â´Ã¬ÂÂ 
Sn_IR(s)Ã«Â¥?0x0001 (Connect) ?ÂÃ­ÂÂ?ÂÃ¬ÂÂ 0x0000 ?ÂÃ­ÂÂÃ«Â¡?Ã«Â³?ÃªÂ²Â½Ã¬ÂÂÃ¬Â¼?Ã¬Â£Â¼Ã«ÂÂ???
?ÂÃ­ÂÂ Sn_IR(s)ÃªÂ°? 0x0010 ???ÂÃ­ÂÂ?ÂÃ¬ÂÂ ?ÂÃ­ÂÂ??Data SendÃªÂ°? ÃªÂ°??Â¥Ã­ÂÂÃªÂ²?Ã«Â§ÂÃ«ÂÂ??


ÃªÂ·Â¸Ã«Â¦Â¬ÃªÂ³?Ã«Â§ÂÃ¬ÂÂ½ ?ÂÃª?  ModBus TCP protocol??Ã«Â§ÂÃ¬Â¶Â° W5300?Â¬Ã¬ÂÂ© Ã«Â³Â´Ã«ÂÂ?ÂÃ¬ÂÂ PLCÃ«Â¡?[0000 0000 0006 01 03 0001 0001] ?? ÃªÂ°ÂÃ¬? DataÃ«Â¥?Ã«Â³Â´Ã«ÂÂ´ÃªÂ³?Send),
(Ã¬Â¦?W5300Ã«Â³Â´Ã«ÂÂ(Client) to PLC Send Data(Server))
[ 0000 0000 0006 01  //MBAP Header
  03 //Function Code (Read : 03 / Write : 06)
  0001 0001 // DATA ]

?Â´Ã¬ÂÂ ?Â°Ã«ÂÂ¼ PLC?ÂÃ¬ÂÂ W5300?Â¬Ã¬ÂÂ© Ã«Â³Â´Ã«ÂÂÃ«Â¡?[0000 0000 0005 01 03 02 00C8] ?Â¼Ã«ÂÂ DataÃ«Â¥?Ã¬Â¤??Â¤Ã«Â©Â´(Recieve) 
?Â´Ã«ÂÂ»ÃªÂ²?Ã«Â³Â´Ã«ÂÂ´ÃªÂ³?Ã«Â°ÂÃ¬ÂÂ ???ÂÃ¬ÂÂÃªÂ¹ÂÃ¬ÂÂ? 
DataÃ«Â¥?Send?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬? Established ÃªÂµÂ¬Ã«Â¬Â¸ ?ÂÃ¬ÂÂ ?Â£ÃªÂ³Â  loopback_tcpc Ã«Â¬Â¸Ã¬ÂÂ´ ?ÂÃ­ÂÂ???ÂÃªÂ°ÂÃ«Â§ÂÃ«ÂÂ¤ Ã«Â°ÂÃ«Â³Âµ?ÂÃªÂ²Â???Â´Ã¬Â£Â¼Ã«Â©??Â ÃªÂ¹Â??
?ÂÃ­ÂÂ Recieve Ã«Â°ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬?  Send ?ÂÃ«ÂÂ Ã«Â¶?Ã«Â¶?Ã«Â°ÂÃ«Â¡Â ?Â¤Ã¬ÂÂ Ã«Â¬Â¸Ã¬ÂÂ¥??ÃªÂµÂ¬Ã­ÂÂ?ÂÃ«Â©Â´ ?Â ÃªÂ¹Â??
Send, Recieve Ã¬Â²ÂÃ«Â¦Â¬??????Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸???ÂÃ«Â Â¤Ã¬Â£Â¼Ã¬ÂÂÃ«Â©?ÃªÂ°ÂÃ¬ÂÂ¬?ÂÃ«Â¦Â¬ÃªÂ²Â Ã¬ÂÂµ?ÂÃ«ÂÂ¤.

(Ã¬Â¦?W5300?Â¬Ã¬ÂÂ© Ã«Â³Â´Ã«ÂÂ to PLC Send Data)
[ 0000 0000 0005 01  //MBAP Header
  03 //Function Code (Write 06)
  02 00C8 // DATA ]


[code]
// void     loopback_tcps(SOCKET s, uint16 port, uint8* buf, uint16 mode)
/**
 * ""TCP CLIENT"" loopback program.
 */ 
void     loopback_tcpc(SOCKET s, uint8* addr, uint16 port, uint8* buf, uint16 mode)
{
   uint32 len;
   static uint16 any_port = 1000;
   
   switch(getSn_SSR(s))                   // check SOCKET status
   {                                      // ------------
      case SOCK_ESTABLISHED:              // ESTABLISHED?
         if(getSn_IR(s) & Sn_IR_CON)      // check Sn_IR_CON bit
         {
            printf(""%d : Connect OK\r\n"",s);
            setSn_IR(s,Sn_IR_CON);        // clear Sn_IR_CON
         }
         if((len=getSn_RX_RSR(s)) > 0)    // check the size of received data
         {
            len = recv(s,buf,len);        // recv
            if(len !=send(s,buf,len))     // send
            {
               printf(""%d : Send Fail.len=%d\r\n"",s,len);
            }
         }
         break; [/code] [Quote] setsn_ir (s, sn_ir_con);// Clear sn_ir_con '
Do you change sn_ir (s) from 0x0001 (Connect) to 0x0000 state ?? [/Quote]
SN_IR (Connect) Bit is an interrupt status bit that is set once when the connection is successful.If the SN_IR value is not 0x00, the Interrupt Pin of the W5300 is asserted.If the MCU is implemented in an interrupt method, it is necessary to detect the interrupt generation and check what the interrupt is.At this time, the status bit is used for each bit of SN_IR. See the data sheet for more information on interrupt.

[Quote] Is it possible to have the desired data send with SN_IR (s) 0x0010? [/Quote]
SN_IR (Sendok) bit is set to 1 if you perform data transfer Command.One precaution is that even if Sendok is 1, the actual data is not transmitted to Ethernet.In other words, the W5300 internally recognized the data, which means that it is ready to send it to Ethernet.The user must do the Data Send Command and check the Command Clear and Sendok.

[Quote] If you give a data called [0000 0000 0005 01 03 02 00C8] as a W5300 on PLC (Recieve),
How can I send and receive it?
Can I put the DATA in the ESTABLISHED syntax and make it repeat the LoopBack_tcpc every time I want?
In addition, can I implement the rec. part in the send right next sentence?
Thank you for informing you about the Send and Recieve processing.
[/Quote]
As mentioned earlier, as mentioned earlier, SEND has copy the data with SN_TX_FIFOR and set the Send Size to SN_TX_WRSR, and performs the Send Command via SN_CR, and after SN_CR (s) is 0, SN_IR (Sendok) = '1'You can do it.

In the case of RECEVIE, check SN_IR (recv) = '1' (interrupt method) or if the SN_RX_RSR value is not zero.
If you detect the data reception, you receive the data from SN_RX_FIFOR, perform the recv_command via SN_CR, and watch until 0.

In addition, the periodic transmission you asked is performed every time.Receiving can be checked after the send.","Q) Is it possible to communicate with a client in some situations using one W5300 chip in some situations? 
A) Yes. This is the difference between the Listen or Connect after Open.

Q) If there are words such as 'help','Assist me', 'Give me a hand', it's question. Is it a question? 
A) No, this is not a question.

Q) As you mentioned in the existing e -mail question, I checked the program example on the WIZNET site, but I'm not sure what to refer to in detail to add a client socket. 
A) The W5300 has a well -known datasheet and doxygen document, so if you look at these documents more than first viewing the source, I think it can be implemented without difficulty. If you have a basic network knowledge, I think you can implement it more easily.

Q) In the case of Server, the Client is listed to connect, but in the case of the client, it is correct to connect to the server side. 
A) Yes, that's right.

Q) We know that seven out of 8 ports can be used as server and the other as a client. But can I use the port used as a client as Modbus/TCP? 
A) Yes, it seems to be available. Of course, it must be implemented in software.

Q) On page 94 of the Data Sheet of the W5300, the socket initialization is shown. The 'socket initialization process applies the same regardless of ?ÂTCP SEVER??and ?ÂTCP Client?? 
A) Yes, you can do the same when creating TCP Server Socket and TCP Client socket. In other words, TCP SERVER SOCKET is generated using the same function as below (0 ~ 6), and it is possible to use it as a TCP Client Socket after creating the same 7 times.

Q) So does it mean that you can do the same when creating TCP SERVER SOCKET and TCP Client sockets? 
A) Yes.This is the difference between the Listen or Connect after Open.

Q) Do I have to set the port number of TCP Client Socket to 502? 
A) There is no need to match the port number. You only need to match the port number of the server in the connect function. However, you do not need to create a port number like other sockets.

Q) If it's Sendok, I delivered TCP Packet to PLC from the W5300 board. 
A) Errata 1 of W5300 is suspected. Please refer to Errata and if it doesn't work, please ask again.

Q) So does it mean that you can do the same when creating TCP SEVER SOCKET and TCP Client sockets? 
A) Yes, this is the difference between the Listen or Connect after Open.

Q) If there are words such as 'help','Assist me', 'Give me a hand', it's question. Is it a question? 
A) No, this is not a question.

Q) Do you change sn_ir (s) from 0x0001 (Connect) to 0x0000 state ?? 
A) SN_IR (Connect) Bit is an interrupt status bit that is set once when the connection is successful. If the SN_IR value is not 0x00, the Interrupt Pin of the W5300 is asserted. If the MCU is implemented in an interrupt method, it is necessary to detect the interrupt generation and check what the interrupt is. 

Q) Is it possible to have the desired data send with SN_IR (s) 0x0010? 
A) SN_IR (Sendok) bit is set to 1 if you perform data transfer Command. One precaution is that even if Sendok is 1, the actual data is not transmitted to Ethernet. In other words, the W5300 internally recognized the data, which means that it is ready to send it to Ethernet. The user must do the Data Send Command and check the Command Clear and Sendok.

Q) If you give a data called [0000 0000 0005 01 03 02 00C8] as a W5300 on PLC (Recieve), 
How can I send and receive it? 
A) As mentioned earlier, SEND has to copy the data with SN_TX_FIFOR and set the Send Size to SN_TX_WRSR, and performs the Send Command via SN_CR, and after SN_CR (s) is 0, SN_IR (Sendok) = '1'.

Q) Thank you for informing you about the Send and Receive processing. 
A) You're welcome."
3401,6201,"Hi,

I'm working on a project right now where I want to establish communication between a custom board and PC through the W5500 chipset. I do not need to connect to the internet. I only need to be able to set a static IP, then send and receive text between the two through some form of terminal interface.

I've gotten SPI communication on my board set up and working after tweaking a few examples; I'm using an MSP432 from TI. I'm able to write to registers and read them back successfully. But now I'm somewhat stuck on how to get it to communicate with the PC through TCP or telnet etc. 

For reference, I'm an electrical engineer who designed this board and am very new at writing firmware / ethernet.

Cheers Datasheet explains how communication is being done in TCP, UDP and RAW modes.
Reuse any working example for TCP communication. The only issue could be setting gateway address (as gateway does not exist in your configuration), and I think setting (leaving it) 0.0.0.0 must be ok. If not, set it to the IP address of the PC you are communicating with - I think it will respond to the ARP packets if they are about its IP address.

[quote=""Mondschuhe, post:1, topic:6201""]
or telnet
[/quote]

Telnet is network protocol and it is built upon the TCP. You will have to implement it in software.","Q) I'm working on a project where I want to establish communication between a custom board and PC through the W5500 chipset. I don't need to connect to the internet, just set a static IP and send/receive text between the two through a terminal interface. Any suggestions on how to achieve this?
A) Datasheet explains how communication is being done in TCP, UDP, and RAW modes. You can reuse any working example for TCP communication. The only issue could be setting the gateway address, or leaving it as 0.0.0.0 should be okay. If not, set it to the IP address of the PC you are communicating with. Telnet is a network protocol built upon TCP, so you will have to implement it in software."
3402,6205,"I am using W5100 arduino shield i want to send UDP MULTICAST PACKETS  ,i have got examples on how to read multicast but now help on send process 
please help me how to make it...

thank you.... The same as sending UDP but to specific IP address.","Q) I am using W5100 arduino shield i want to send UDP MULTICAST PACKETS, i have got examples on how to read multicast but now help on send process please help me how to make it...
A) The process for sending UDP multicast packets is similar to sending UDP packets to a specific IP address. You can use the same UDP send functions, but instead of specifying a specific IP address, you would use the multicast IP address. Thank you for reaching out!"
3403,621,"With the W5100, the network is configured to have abnormalities during use.

PC Gateway IP: 192.168.0.1
W5100 Gateway IP: 192.168.0.1

As shown in the above setting, the normal operation must be correct and the board also works.
But even when setting as shown below

PC Gateway IP: 192.168.0.4
W5100 Gateway IP: 192.168.0.1

The communication is good.
 
I'm writing a source of your homepage as a standard, but it's all about declaration, setting, or setting value for gateway.
If the network is different, [B] Gateway is different, but it should not be communication.
I don't know what the problem is. The gateway you mentioned is used to go out to an external network.

If you use the same local network, the gateway is not used.

[URL] http://en.wikipedia.org/wiki/IPV4_SUBNETTING_REFERENCE [/URL].","Q) What could be the issue with the W5100 network configuration? 
A) The issue with the W5100 network configuration might be related to how the gateway is being used for communication. When using the same local network, the gateway is not used, but if the network is different, the gateway is used for external network access. It's possible that the communication abnormalities are related to how the gateway is being utilized in the W5100 network configuration."
3404,6210,"What is the maximum speed support when communicating with STM32F4 and Wizfi310 UART?Or if you have a module that can communicate with more than 10 Mbps per second between STM32F4 and wireless modules. hello

For Wizfi310, the UART maximum Baud rate is 921600bps, less than 1Mbps.
And unfortunately there is no Wi-Fi module that supports UART 10Mbps you have inquired.

Please note that the models that support the SPI interface are Wizfi210, Wizfi220, and Wizfi250.

thank you","Q) What is the maximum speed support when communicating with STM32F4 and Wizfi310 UART? Or if you have a module that can communicate with more than 10 Mbps per second between STM32F4 and wireless modules?
A) For Wizfi310, the UART maximum Baud rate is 921600bps, less than 1Mbps. And unfortunately there is no Wi-Fi module that supports UART 10Mbps you have inquired. Please note that the models that support the SPI interface are Wizfi210, Wizfi220, and Wizfi250."
3405,6218,"hello.

We are currently using the W5300 and W5100 models.
I would like to configure two Ethernet ports using STM32F2 Series.
How to use it is to receive data from one Etheret using the W5300 or W5100.
We want to handle data from STM32F2 Series and send it to the rest of the Ethernet port.
Usually, after uploading OS (usually Linux) using a CPU of high ARM-A8 or A9
I know it's controlling the Dual Ethernet port.
We don't have a lot of data we will send, but I've never used it like this
I would like to seek advice on how to configure Dual Ethernet.
Data on how to configure Dual in WizNet
Please check if you can recommend it. The W5300 or the W5100 must assign a separate Mac Address and IP Address.
If you assign a separate address, two W5300 or W5100 are independent devices.
You can design the same as when designing one, and you can use another address map in a decoder for chip select. thank you for answering.
I would like to contact you one more thing.
The W5300 is higher, so I want to use this model.
When designing the circuit, the data bus and the address bus line are designed to be the same.
Should the rest of the pins be used as other ports?
( /WR, /rd, /cs, /int, BRDY1J ~ BRDY4J)
If you have a pin that needs to be configured differently, please advise. /WR, /RD may share the pin together.
/CS, /int must be assigned another pin.

But I don't know what kind of pin is BRDY1J ~ BRDY4J. hello.

Currently, I use STM32F207 to read and write data by FMSC.
I am using the W5300 as a Dual.
If you read it again after setting the IP, the bit value 0 will always be read as 1.
For example, set to 192.168.1.0 will be read as 192.168.1.1.
Both ICs are.There was no problem when I tested only one circuit and tested it.
Designed and used circuits with two, this problem has occurred.
Is there anything I can review?
Hanbit continues to be distorted and cannot be transmitted and receiving properly.
Please advise. hello.
Please tell me whether it occurs in all addresses or in certain phenomena.
And is it FSMC 8bit or 16bit?

If possible, please share the W5300 Driver Code. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

FSMC 16bitÃ«Â¡??Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃªÂ³Â  ?Â¤Ã¬Â Â?? ?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

void Fsmc_Bank1_Sram_Ne3_Ne4_Iint(void)
{
    FSMC_NORSRAMInitTypeDef  FSMC_NORSRAM_NE3_InitStructure;
    FSMC_NORSRAMInitTypeDef  FSMC_NORSRAM_NE4_InitStructure;
    
    FSMC_NORSRAMTimingInitTypeDef  p3;
    FSMC_NORSRAMTimingInitTypeDef  p4;
    
    GPIO_InitTypeDef GPIO_InitStructure; 
    
    /* Enable GPIOs clock */
    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOD | RCC_AHB1Periph_GPIOE | 
                         RCC_AHB1Periph_GPIOF | RCC_AHB1Periph_GPIOG, ENABLE);
    
    // RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);
    
    /* Enable FSMC clock */
    RCC_AHB3PeriphClockCmd(RCC_AHB3Periph_FSMC, ENABLE); 
    
    FSMC_NORSRAMDeInit(FSMC_Bank1_NORSRAM3);
    FSMC_NORSRAMDeInit(FSMC_Bank1_NORSRAM4);
    
    
    /*-- GPIOs Configuration ------------------------------------------------------*/
    /*
    +-------------------+--------------------+------------------+------------------+
    +                       SRAM pins assignment                                  +
    +-------------------+--------------------+------------------+------------------+
    | PD0  <-> FSMC_D2  | PE0  <-> FSMC_NBL0 | PF0  <-> FSMC_A0 | PG0 <-> FSMC_A10 |
    | PD1  <-> FSMC_D3  | PE1  <-> FSMC_NBL1 | PF1  <-> FSMC_A1 | PG1 <-> FSMC_A11 |
    | PD4  <-> FSMC_NOE | PE7  <-> FSMC_D4   | PF2  <-> FSMC_A2 | PG2 <-> FSMC_A12 |
    | PD5  <-> FSMC_NWE | PE8  <-> FSMC_D5   | PF3  <-> FSMC_A3 | PG3 <-> FSMC_A13 |
    | PD8  <-> FSMC_D13 | PE9  <-> FSMC_D6   | PF4  <-> FSMC_A4 | PG4 <-> FSMC_A14 |
    | PD9  <-> FSMC_D14 | PE10 <-> FSMC_D7   | PF5  <-> FSMC_A5 | PG5 <-> FSMC_A15 |
    | PD10 <-> FSMC_D15 | PE11 <-> FSMC_D8   | PF12 <-> FSMC_A6 | PG9 <-> FSMC_NE2 |
    | PD11 <-> FSMC_A16 | PE12 <-> FSMC_D9   | PF13 <-> FSMC_A7 |------------------+
    | PD12 <-> FSMC_A17 | PE13 <-> FSMC_D10  | PF14 <-> FSMC_A8 | 
    | PD14 <-> FSMC_D0  | PE14 <-> FSMC_D11  | PF15 <-> FSMC_A9 | 
    | PD15 <-> FSMC_D1  | PE15 <-> FSMC_D12  |------------------+
    +-------------------+--------------------+
    */
    /* GPIOD configuration */
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource0, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource1, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource8, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource9, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource10, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource14, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD, GPIO_PinSource15, GPIO_AF_FSMC);
    
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | GPIO_Pin_1 | GPIO_Pin_8 | GPIO_Pin_9 |
                                GPIO_Pin_10 | GPIO_Pin_14 | GPIO_Pin_15;
    
    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
    GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
    GPIO_InitStructure.GPIO_PuPd  = GPIO_PuPd_NOPULL;
    
    GPIO_Init(GPIOD, &GPIO_InitStructure);
    
    
    /* GPIOE configuration */
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource7 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource8 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource9 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource10 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource11 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource12 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource13 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource14 , GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOE, GPIO_PinSource15 , GPIO_AF_FSMC);
    
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_7 | GPIO_Pin_8  | GPIO_Pin_9  | GPIO_Pin_10 |
                                GPIO_Pin_11| GPIO_Pin_12 | GPIO_Pin_13 | GPIO_Pin_14 | 
                                GPIO_Pin_15;
                                
    GPIO_Init(GPIOE, &GPIO_InitStructure);
    
    
    /* GPIOF configuration */
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource0, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource1, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource2, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource3, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource4, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource5, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource12, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource13, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource14, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOF, GPIO_PinSource15, GPIO_AF_FSMC);
    
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0  | GPIO_Pin_1  | GPIO_Pin_2  | GPIO_Pin_3 |
                                GPIO_Pin_4  | GPIO_Pin_5  | GPIO_Pin_12 | GPIO_Pin_13 | 
                                GPIO_Pin_14 | GPIO_Pin_15;      
    GPIO_Init(GPIOF, &GPIO_InitStructure);
    
    
    /* NOE, NWE and CLK configuration */  
    
    GPIO_PinAFConfig(GPIOD,GPIO_PinSource4, GPIO_AF_FSMC);
    GPIO_PinAFConfig(GPIOD,GPIO_PinSource5, GPIO_AF_FSMC);
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4 |GPIO_Pin_5;
    GPIO_Init(GPIOD, &GPIO_InitStructure);
    
    //Ethernet Channel #1_NE3
    GPIO_PinAFConfig(GPIOG, GPIO_PinSource10, GPIO_AF_FSMC);
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10; 
    GPIO_Init(GPIOG, &GPIO_InitStructure);
    
    //Ethernet Channel #2_NE4
    GPIO_PinAFConfig(GPIOG, GPIO_PinSource12, GPIO_AF_FSMC);
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12; 
    GPIO_Init(GPIOG, &GPIO_InitStructure);
    /*-- FSMC Configuration ------------------------------------------------------*/
    
    // < Enable FSMC Bank1_SRAM3 Bank >
    /*
    p3.FSMC_AddressSetupTime = 3;
    p3.FSMC_AddressHoldTime = 0;
    p3.FSMC_DataSetupTime = 20;
    p3.FSMC_BusTurnAroundDuration = 0;
    p3.FSMC_CLKDivision = 0;
    p3.FSMC_DataLatency = 0;
    p3.FSMC_AccessMode = FSMC_AccessMode_A;
    */
    p3.FSMC_AddressSetupTime = 15;
    p3.FSMC_AddressHoldTime = 15;
    p3.FSMC_DataSetupTime = 255;
    p3.FSMC_BusTurnAroundDuration = 15;
    p3.FSMC_CLKDivision = 16;
    p3.FSMC_DataLatency = 17;
    p3.FSMC_AccessMode = FSMC_AccessMode_A;
    
    FSMC_NORSRAM_NE3_InitStructure.FSMC_Bank = FSMC_Bank1_NORSRAM3;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_DataAddressMux = FSMC_DataAddressMux_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_MemoryType = FSMC_MemoryType_SRAM;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_MemoryDataWidth = FSMC_MemoryDataWidth_16b;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_BurstAccessMode = FSMC_BurstAccessMode_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_AsynchronousWait = FSMC_AsynchronousWait_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WaitSignalPolarity = FSMC_WaitSignalPolarity_Low;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WrapMode = FSMC_WrapMode_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WaitSignalActive = FSMC_WaitSignalActive_BeforeWaitState;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WriteOperation = FSMC_WriteOperation_Enable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WaitSignal = FSMC_WaitSignal_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_ExtendedMode = FSMC_ExtendedMode_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WriteBurst = FSMC_WriteBurst_Disable;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_ReadWriteTimingStruct = &p3;
    FSMC_NORSRAM_NE3_InitStructure.FSMC_WriteTimingStruct = &p3;
    
    FSMC_NORSRAMInit(&FSMC_NORSRAM_NE3_InitStructure); 
    FSMC_NORSRAMCmd(FSMC_Bank1_NORSRAM3, ENABLE); 
     
    // < Enable FSMC Bank1_SRAM4 Bank > 
    /*
    p4.FSMC_AddressSetupTime = 3;
    p4.FSMC_AddressHoldTime = 0;
    p4.FSMC_DataSetupTime = 20;
    p4.FSMC_BusTurnAroundDuration = 0;
    p4.FSMC_CLKDivision = 0;
    p4.FSMC_DataLatency = 0;
    p4.FSMC_AccessMode = FSMC_AccessMode_A;
    */
    p4.FSMC_AddressSetupTime = 15;
    p4.FSMC_AddressHoldTime = 15;
    p4.FSMC_DataSetupTime = 255;
    p4.FSMC_BusTurnAroundDuration = 15;
    p4.FSMC_CLKDivision = 16;
    p4.FSMC_DataLatency = 17;
    p4.FSMC_AccessMode = FSMC_AccessMode_A;
    
    FSMC_NORSRAM_NE4_InitStructure.FSMC_Bank = FSMC_Bank1_NORSRAM4;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_DataAddressMux = FSMC_DataAddressMux_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_MemoryType = FSMC_MemoryType_SRAM;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_MemoryDataWidth = FSMC_MemoryDataWidth_16b;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_BurstAccessMode = FSMC_BurstAccessMode_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_AsynchronousWait = FSMC_AsynchronousWait_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WaitSignalPolarity = FSMC_WaitSignalPolarity_Low;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WrapMode = FSMC_WrapMode_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WaitSignalActive = FSMC_WaitSignalActive_BeforeWaitState;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WriteOperation = FSMC_WriteOperation_Enable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WaitSignal = FSMC_WaitSignal_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_ExtendedMode = FSMC_ExtendedMode_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WriteBurst = FSMC_WriteBurst_Disable;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_ReadWriteTimingStruct = &p4;
    FSMC_NORSRAM_NE4_InitStructure.FSMC_WriteTimingStruct = &p4;
    
    FSMC_NORSRAMInit(&FSMC_NORSRAM_NE4_InitStructure); 
    FSMC_NORSRAMCmd(FSMC_Bank1_NORSRAM4, ENABLE); 
} FSMC settings don't seem to have a big problem.
If System Clock is considered to be 120MHz, about 8.3ns per clock

p4.fsmc_datasetuptime = 20;I can reduce it to 10.(Apply if the problem is solved.)

and,
GPIO_INITSTRUCTURE.GPIO_PUPD = GPIO_PUPD_NOPULL;Modify it with PULL-UP (gpio_PUPD_UP).

Oh, and it doesn't matter much, but our code works
FSMC_NONORAMINITSTURE.FSMC_EXTENDEDEDEDE = fsmc_exTendedMode_enable;
no see.

Please also check if the problem appears only in a specific address. thank you for answering.

First of all, I set it as you informed, but the symptoms do not disappear.
While looking for more, all ports associated with FSMC STM32 port setting
After setting the output type as Push Pull as shown below, it has been improved.
It was too simple compared to what I had been worried about for three weeks.
GPIO_INITSTRUCTURE.GPIO_OTYPE = gpio_otype_pp;
As I used it as Dual, I think there was a fanout of the port.
The test should be done, but it was clear that the results were improved.
Thank you for your support. I'm glad it has been solved.","Q) I would like to configure two Ethernet ports using STM32F2 Series. How to use it is to receive data from one Etheret using the W5300 or W5100. We want to handle data from STM32F2 Series and send it to the rest of the Ethernet port. Can you recommend how to configure Dual Ethernet in WizNet? 
Q) When designing the circuit, the data bus and the address bus line are designed to be the same. Should the rest of the pins be used as other ports? If you have a pin that needs to be configured differently, please advise. 
Q) If you read it again after setting the IP, the bit value 0 will always be read as 1. For example, set to 192.168.1.0 will be read as 192.168.1.1. Is there anything I can review? 
Q) If possible, please share the W5300 Driver Code. 
Q) Please tell me whether it occurs in all addresses or in certain phenomena. And is it FSMC 8bit or 16bit? 

A) The Ethernet channel #1_NE3 and Ethernet channel #2_NE4 need to be configured differently. FSMC settings don't seem to have a big problem. If the system clock is considered to be 120MHz, about 8.3ns per clock. You can reduce the FSMC datasetup time to 10 if the problem is solved. Also, modify GPIO_INITSTRUCTURE.GPIO_PUPD to PULL-UP (GPIO_PUPD_UP) and check if the problem appears only in a specific address.

A) The symptoms did not disappear even after the settings were informed. However, after setting all ports associated with the FSMC STM32 port setting to Push Pull, the issue improved. This may have been due to fanout of the port when using Dual, but the results were clear."
3406,6221,"Hello,

Our automated spam filter, [Akismet](https://akismet.com/), has temporarily hidden your post in *How to composite Dual Ethernet Using the W5300* for review.

A [staff member](https://forum.wiznet.io/about) will review your post soon, and it should appear shortly.

We apologize for the inconvenience. ",This is a non-response paragraph.
3407,6222,"I made a pcb with W5100S. 
The software starts with DHCP discovery. the DHCP fail  many trails, but then after a very long time, it seems to get an IP, and everything works well from this point on (fast and reliable TCP connection).
When I use the same software with W5100S module (WIZ810io) all is working well and DHCP  discovery is normal ( < 10 seconds).
What could be the problem? Please provide

- circuit diagram of your design.
- Wireshark log from the PC pn the network between W5100s and DHCP server (or from DHCP server if it is able to run Wireshark).
- any differences in LED operation between your design and WIZnet module. I nailed it...
termination resistors on PHY connection were 49.9 K instead of 49.9 Ohm...
Makes a lot of difference.
Now all works OK. Great!
You are not the first one with this mistake, and not the last one :slight_smile: BTW, will it be OK if I replace the W5100S with the pin compatible W6100 on board? (hardware - I know the library need to change) 
Thanks","Q) What could be the problem? Please provide
A) The problem could be related to the termination resistors on the PHY connection, which were initially 49.9 K instead of 49.9 Ohm. This made a significant difference in the DHCP discovery process. After correcting the termination resistors, everything works well with the W5100S. As for replacing the W5100S with the pin compatible W6100 on board, it should be okay from a hardware perspective, although the library will need to be updated to accommodate the change. 

Q) BTW, will it be OK if I replace the W5100S with the pin compatible W6100 on board? (hardware - I know the library need to change) 
A) It should be okay to replace the W5100S with the pin compatible W6100 on board from a hardware perspective. However, the library will need to be updated to support the change."
3408,6224,"We are developing code to use the WizFi310 in our product, and also testing its features, the main feature we are using, is MQTT connection.
We noted that there is no way of configuring the retain, qos and ""clean session"" flags, or at least we didn't find it.
So i would like to confirm this issue, and knowing if there is any chance of receiving an update, that allows to configure those parameters, or at least, the retain flag, when publishing messages.
The issue with the retain flag set as default when publishing, is that the last message will be received by any subscriber, and we are sending ""real time"" data, that only makes sense if received at that moment.
For example, the weight of one device, that could be already gone of the system ""scope"", the message only had relevance when it was actually sending the message. That ""delayed"" message will cause issues, like the system supposing that the device is inside the measurement ""room"", when it could be already departed.
That are just silly examples to try and explain the reason of why is important to have that feature as configurable. Hi,

Currently WizFi310 is not provided to set MQTT flags like retain, qos, clean session.
they are only fixed flags in the module.

so if you want new function into the module. please request it through the place where you purchased.","Q) We noted that there is no way of configuring the retain, qos and ""clean session"" flags when using WizFi310 for MQTT connection. Is there any chance of receiving an update that allows to configure those parameters, or at least the retain flag when publishing messages? 

A) Currently, WizFi310 does not provide the option to set MQTT flags like retain, qos, clean session. They are only fixed flags in the module. If you want a new function added to the module, you can request it through the place where you purchased."
3409,6226,"Hello to all

I have found a lot of 8-chanel relay modules on the aliexpress.
Red boards are controlled by positive signal, blue boards by negative. 
Relay needs more energy then output of most controllers, so relays has own power (can be 3.3, 5, 12 or 24v). To control relay by controller optocupers are used.
These boards are developed for use with 5v arduino output. I want to use with 3.3v output of w7500 board. But I can not found in docs - what optocuper are used there? Can I use it with 3.3v? What is minimal voltage to open optocuper? I reviewed boards datasheets but there is no any info about used optocupers and minimal signal level.

Project details:
- relays are powered by automobile battery (12~14v)
- relays should be controlled by 3.3v of w7500 output
- relays load can be any, 220v for example.
It is custom alarm system. Car battery (used) is a big power bank) It shoul open electromagnetic lock or actuator if someone cut main 220v line.

Thank you. 
Sorry for my English) Hi~ Yegors

I'm so sorry  about getting back to you so late. 
First, I think you use the 3.3v and 5v as output voltage using the wizwiki-7500.
See  J13 on the wizwki-w7500, you can see the 3.3v and 5v pin.

And I don't know what  ""optocuper"" is. I think it's like the LED or something, is it right?

[quote=""YegorS, post:1, topic:6226""]
. I want to use with 3.3v output of w7500 board. But I can not found in docs - what optocuper are used there? Can I use it with 3.3v? What is minimal voltage to open optocuper?
[/quote]
Tell me more about the optocuper.
thanks,
BR Hello Irina Kim
>>Tell me more about the optocuper.
It is syntax mistake. I mean ""optocoupler"". It is used for electrical isolation. Hi
I am new in mbed and microcontrollers programming.
On the different forums I found solution - how to connect more then 3.3v devices directly to microcontroller: need to 
- enable ""open drain"" mode and 
- disable pull-up resistor. 
It lets to control devices which use more then 3.3v, for example 12v. Disabling the resistor prevents the board from burning out.
My questions is:
- what max current for each IO pin can I use in this mode? (Open drain with disabled pull up)
- what is max voltage can be used in this mode? (Max collector junction breakdown voltage)
- what is max sum current can be used for all pins at same time?

Example of code:
https://os.mbed.com/teams/TVZ-Mechatronics-Team/wiki/Digital-inputs-and-outputs
https://community.st.com/s/question/0D50X00009XkXlk/can-5-v-tolerant-pin-be-turned-off

Thank you.","Q) What optocouplers are used in the w7500 board and can it be used with 3.3v? What is the minimal voltage to open the optocoupler?
A) I'm so sorry about getting back to you so late. First, I think you can use the 3.3v and 5v as output voltage using the wizwiki-7500. See J13 on the wizwki-w7500, you can see the 3.3v and 5v pin. And I don't know what ""optocuper"" is. I think it's like the LED or something, is it right?

A) Tell me more about the optocoupler. It is syntax mistake. I mean ""optocoupler"". It is used for electrical isolation.

Q) What max current for each IO pin can I use in open drain mode with disabled pull-up resistor? What is the max voltage that can be used in this mode? What is the max sum current that can be used for all pins at the same time?
A) On the different forums, I found a solution - how to connect more than 3.3v devices directly to the microcontroller: need to enable ""open drain"" mode and disable the pull-up resistor. It lets to control devices which use more than 3.3v, for example 12v. Disabling the resistor prevents the board from burning out.

Example of code:
https://os.mbed.com/teams/TVZ-Mechatronics-Team/wiki/Digital-inputs-and-outputs
https://community.st.com/s/question/0D50X00009XkXlk/can-5-v-tolerant-pin-be-turned-off"
3410,6229,"I have the WIZ550S2E serial-to-Ethernet converter chip. I?Âm having a little trouble with sending and receiving data. It seems to send just fine, but when receiving data from the Ethernet side of the chip, it seems to add several bits of data to the data packet.

For context, I have performed a loopback test to confirm that data is being sent correctly. I have set up a static IP and I have configured it using the Configuration Tool. I have also set up a virtual serial port using the WIZVSP. 

Thoughts? The captured packets look strange.
You didn't use any Data Packing option and each ethernet packet must have a different bytes size.
But all ethernet packets have the same bytes, 12 bytes, except the last one.
And you said that you sent ""5a5a5b5b5c5c"" but there is no ""5b5b5c5c"".

I'd like to ask you to measure the serial line between your FPGA and WIZ550S2E with oscilloscope.
Please make sure that your FPGA didn't sent the data which is captured on the ethernet line over the serial line.

Thank you.
James.","Q) I have the WIZ550S2E serial-to-Ethernet converter chip. I'm having a little trouble with sending and receiving data. It seems to send just fine, but when receiving data from the Ethernet side of the chip, it seems to add several bits of data to the data packet. For context, I have performed a loopback test to confirm that data is being sent correctly. I have set up a static IP and I have configured it using the Configuration Tool. I have also set up a virtual serial port using the WIZVSP. Thoughts? The captured packets look strange.
A) You didn't use any Data Packing option and each Ethernet packet must have a different byte size. But all Ethernet packets have the same bytes, 12 bytes, except the last one. And you said that you sent ""5a5a5b5b5c5c"" but there is no ""5b5b5c5c"". I'd like to ask you to measure the serial line between your FPGA and WIZ550S2E with an oscilloscope. Please make sure that your FPGA didn't send the data which is captured on the Ethernet line over the serial line."
3411,623,"If I'm only using two serial ports on the WIZ140SR, what should I do with the other two? Are they pulled up on the module, or should I pull them up on my board? Similarly, if I'm not using CTS, should I pull it up on my board or can I leave it unconnected?

Gary You don't need to pull-up or pull-down on unused port.

Thanks,
JB","Q) If I'm only using two serial ports on the WIZ140SR, what should I do with the other two? Are they pulled up on the module, or should I pull them up on my board? Similarly, if I'm not using CTS, should I pull it up on my board or can I leave it unconnected?
A) You don't need to pull-up or pull-down on unused port."
3412,6230,"The addresses below 123.12.123.12, 321.12.123.23 are the internal addresses of the router, which is meaningless within other routers.
If you know the WAN IP of the router, you can communicate if you try to connect with the LAN IP of the opponent's router from the A-1 terminal or A-2 terminal and set the Port Forwarding function on the router.

A -1 Router: WAN IP -123.11.22.100, LAN IP -192.168.0.1
A-1 terminal: 192.168.0.100 (Communication Port 5000)
A -2 Router: WAN IP -123.22.11.200, LAN IP -192.168.0.1
A-2 terminal: 192.168.0.100 (communication port 5000)

The WAN IP of the A-1 router, the WAN IP of the A-2 router is based on Real IP.

A-1 Port Forwarding Setting
Port 5000 -Local IP 192.168.0.100, Port 5000
A-2 Router's Port Forwarding Setting
Port 5000 -Local IP 192.168.0.100, Port 5000

When attempting to connect with the A -2 terminal from the A -1 terminal, it is connected to Remote IP -123.22.11.200, Remote Port -5000.
When attempting to connect with A -1 terminal from the A -2 terminal, it is connected to Remote IP -123.11.22.100, Remote Port -5000.

That is all. Thank you for answer.

You can do port forwarding and send it to Remote IP and Remote Port.
Is the communication transmission in the W5300 both UPD or TCP/IP? Yes, it is possible.","Q) Is the communication transmission in the W5300 both UPD or TCP/IP? 
A) Yes, it is possible."
3413,6234,"When this application pops up with a ""Data Invalid"", what is it trying to tell me. 
Is there a way to make it show the data i am sending?

Everything looks fine on WireShark, and it gets the bytes I send.
The W5100s registers look fine. do you mean ,on wireshark, sending data and receive data are exactly the same data?
could you share the packet info? I don't have Wireshark data readily to send. If necessary, I think I can re-create it.
But the scenerio is as follows:
1. Axi - send data to Wiznet module.
2.  Wiznet module receives.
3. Wiznet module sends data to Axi.

Axi Test Application displays a ""Data Invalid"" MessageBox.

Since I don't have the source for this, I would like to know why this error is displayed. Is the Axi App comparing the data sent to the data received?
The WizNet module may NOT send the same data (or the same number of bytes) it receives from the Axi App in my test scenario.

Thanks.
Giri Yes AX tool compare send data and receive data.
Could you check the receive buffer when you send specific data from AX tool ?

And even you can not find any difference, I recommend you install wireshark to check the packets between PC and WIZnet module.
You can download it here. it is opensource tool. 
https://www.wireshark.org/download.html","Q) When this application pops up with a ""Data Invalid"", what is it trying to tell me? Is there a way to make it show the data I am sending?
A) The ""Data Invalid"" message from the Axi Test Application indicates that there is a discrepancy between the data sent and the data received by the Wiznet module. It is possible that the Wiznet module does not send the same data or the same number of bytes it receives from the Axi App in your test scenario. To troubleshoot and visualize the data being sent and received, you can install Wireshark, an open-source packet analyzer, to inspect the packets between your PC and the Wiznet module.

Q) Could you share the packet info? I don't have Wireshark data readily to send. If necessary, I think I can re-create it.
A) If you are unable to share the Wireshark data, re-creating the scenario and inspecting the packet information using Wireshark is recommended. Additionally, checking the receive buffer when you send specific data from the AX tool can help in understanding the discrepancy and identifying any differences in the received data."
3414,6238,"Dear All,

I am experiencing an issue that I cannot quite figure out. I am using a w5500 on a custom development prototype. After the first time I write a register from my MCU I have to keep a continuous stream of SPI transactions (read or write, it makes no difference) otherwise the w5500 will reset. If I ever wait more than ~40ms between two consecutive transactions the device will reset. Any periodic SPI transaction will keep the device alive, such as simply reading the status register.

If I let this 40ms time elapse and then I try to read the status of the physical layer with getPHYCFGR() I will find it down and I have to recreate and reconnect to all my sockets to restore the ethernet communication.

Any idea what could be causing the issue? Please let me know how I can help reproduce the issue.
Best regards, [quote=""Vittorio_Pascucci, post:1, topic:6238""]
otherwise the w5500 will reset
[/quote]

How did you know that it is being ""reset""? All values in all registers (including common - own IP address, mask, GW) are being reset to default (see datasheet)?

[quote=""Vittorio_Pascucci, post:1, topic:6238""]
I try to read the status of the physical layer with getPHYCFGR() I will find it down
[/quote]

What exactly do you find out? No link?

[quote=""Vittorio_Pascucci, post:1, topic:6238""]
I have to recreate and reconnect to all my sockets to restore the ethernet communication
[/quote]

What state sockets are in? What issues you face if continue in the current state? Hello Eugeny,
Sorry for the late reply. Before we even talk about sockets, reading PHYCFGR normally returns ""10111111"" when everything is working fine. When the issue appears PHYCFGR is first ""10111010"" for some time (so link off and half duplex) and then ""10111110"" for a few us (so only link off) and then it recovers normal operation. I can see the link is truly off because the green led on the ethernet connector is switching off.

This doesn't happen if I implement the aforementioned workaround of polling the status register or the PHYCFGR continuously as a form of ""keepalive"".

I will see what the sockets return and come back to you, but I think this is already enough to say that there is some kind of issue. If you see link LED off and on then there's hardware/connectivity issue. Recheck your circuit (connections, component values), change physical port on the switch. Hello Eugeny,

Cable and switch are fine. The circuit of course could be an issue, I am using an arduino ethernet shield 2 but I modified it quite a bit.

Strange that the issue only occurs when I am not communicating through SPI. My workaround works perfectly, so it is hard to find a hardware failure that matches my observations. I will monitor VCC as well as the reset output from the voltage controller on board, maybe a small brown-out or an interference is triggering a reset. Ensure you do not accidentally write to PHYCFGR resetting PHY.","Q) How did you know that it is being ""reset""? All values in all registers (including common - own IP address, mask, GW) are being reset to default (see datasheet)? 
A) Before we even talk about sockets, reading PHYCFGR normally returns ""10111111"" when everything is working fine. When the issue appears PHYCFGR is first ""10111010"" for some time (so link off and half duplex) and then ""10111110"" for a few us (so only link off) and then it recovers normal operation. I can see the link is truly off because the green led on the ethernet connector is switching off.

Q) What exactly do you find out? No link? 
A) If you see link LED off and on then there's a hardware/connectivity issue. Recheck your circuit (connections, component values), change physical port on the switch.

Q) What state sockets are in? What issues you face if continue in the current state? 
A) I will see what the sockets return and come back to you, but I think this is already enough to say that there is some kind of issue. My workaround works perfectly, so it is hard to find a hardware failure that matches my observations. I will monitor VCC as well as the reset output from the voltage controller on board, maybe a small brown-out or an interference is triggering a reset. Ensure you do not accidentally write to PHYCFGR resetting PHY."
3415,624,"hello

Thank you for your last answer.

 <Wx192.168.16.xx> After setting, how can you run about 400 ~ 600 <w> a day?

What is the life life?I want you to inform you.

However, after setting once, only Server IP is changed ... hello

The number of Write of Flash Memory is 100,000 times.
And once written, the data maintains that value for 10 years.

If you have any additional inquiries, please.

take care

Wiznet","Q) After setting, how can you run about 400 ~ 600 a day? What is the life life?I want you to inform you. However, after setting once, only Server IP is changed ...
A) The number of Write of Flash Memory is 100,000 times. And once written, the data maintains that value for 10 years."
3416,6240,"I have an issue with my board based on W5500. I have successfully implemented a TCP client that sends an HTTP message and then waits for a response. The behavior, however, is quite puzzling. Just about half the time everything works perfectly, while the other half - the TCP socket opens, connects without error and then hangs on `send()`.

There is no return from that function, and it seems like the program is stuck in some sort of infinite loop.

When checking `wizchip_gettimeout`, I have a value of 2000 for timeout and 8 for retries. If I'm not mistaken 2000 means 0.2 seconds? 

I'm not sure why it hangs, and why only half the time, and not sure where to start debugging.

Any help would be greatly appreciate. First check the circuit. Ensure that you used 49.9 Ohm resistors and not 49.9 kOhm resisotrs (for example). My suspicion is that device is having difficulties finding the simeslot on the TX wire to send the packet, and hangs on the loop CR clearing to 0. Try connecting W5500 to another network device (e.g. replace hub/switch, change port of the hub/switch). But it must be proven: compile the code with check points in the `send()` function (outputting some characters to the diagnostic console or anywhere else where you can see them) to find out where code gets stuck. The circuit looks ok, I will check of course, and also I will do check points. But it seems weird to me that DHCP and DNS are 100% reliable, not a single failure. I would imagine a hardware error would affect that too, no?

I can lease IP, and resolve DNS 100% of the time. It's send() for TCP that gets stuck. Yeah, the circuit looks fine. 49.9 Ohm resistors are proper value. 

It's TCP that has a 50% failure rate... I'm gonna try to put checkpoints in send().

Am I wrong to assume that a hardware issue would result in failures with DHCP leasing and DNS resolution as well as TCP? DHCP/DNS work absolutely flawlessly. Did you use the ioLibrary code from WIZnet (https://github.com/Wiznet/ioLibrary_Driver)? Yup, I did use the ioLibrary code from that GitHub repo! As I said, the behavior is super odd to me, because DHCP works 100%, DNS works 100% , but TCP hangs 50% of the time. I'm still debugging it, but was wondering if someone knows where to point me.

In my understanding if there was something wrong with the physical TX line, DNS & DHCP would hang just as much, am I wrong? You're right.
very odd..Would you please give the exact line number you get stuck?
(free size check? before CMD_SEND? or after CMD_SEND? ) So, after some debugging turns out it gets stuck on socket connect() and not send(). Specifically, it gets stuck inside this loop:
```
while(getSn_SR(sn) != SOCK_ESTABLISHED)
   {
		if (getSn_IR(sn) & Sn_IR_TIMEOUT)
		{
			setSn_IR(sn, Sn_IR_TIMEOUT);
            return SOCKERR_TIMEOUT;
		}

		if (getSn_SR(sn) == SOCK_CLOSED)
		{
			return SOCKERR_SOCKCLOSED;
		}
	}
```

That's the spot it ends up stuck at, about 50% of the time. (the rest of the time everything works great).

`getSn_SR` seems to be stuck on `SOCK_SYNSENT`, and never changes to anything else. Which is weird, because I have a value of 2000 for timeout and 8 for retries. So at the very least it should timeout?

This is the relevant code in my application:
```
// create a TCP socket
	if ((sck_status = socket(HTTP_DATA_SOCKET, Sn_MR_TCP, 0, 0)) == HTTP_DATA_SOCKET) {
		// connect to the server
		if ((con_status = connect(HTTP_DATA_SOCKET, (uint8_t*) dest_ip, (uint16_t) dest_port)) == SOCK_OK) {
			if ((send_status = send(HTTP_DATA_SOCKET, (uint8_t*) msg, strlen(msg))) != strlen(msg)) {
				printf_P(PSTR(""[error] unable to send: %"" PRIi32 ""\r\n""), send_status);
                return;
			}
            
            close(HTTP_DATA_SOCKET);
		} else {
			printf_P(PSTR(""[error] connection not available: %i\r\n""), con_status);
		}
	} else {
		printf_P(PSTR(""[error] unable to create socket: %"" PRIi8 ""\r\n""), sck_status);
	}
```

When it works, it works flawlessly, but when it doesn't ,it reliably gets stuck on `connect`, being stuck on `SOCK_SYNSENT`. Do you have timeout in your SPI read/write driver? How about checking firewall setting, port number and server application status on your test server(PC)? 
I think, there's no reply ""SYN+ACK"" packet from your test server(PC). [quote=""dannypovolotski, post:8, topic:6240""]
I have a value of 2000 for timeout and 8 for retries.
[/quote]

For these values TCP timeout will be 31.8 seconds, see RCR section of the datasheet, it has this value calculated. You just need to wait a little more :slight_smile:

As @Bong said it is most probably that some device located on the packet path filters out or loses the SYN/ACK return packet. I saw a similar issue while developing code for the W5500 and used WireShark to debug it. I found the problem was that the W5500 wasn't seeing ARP responses from the wireless device (an old Linksys router running DD-WRT as a bridge) I was trying to connect to.  I saw the ARP request from the W5500 repeated over and over, but there was no response. Never figured out if the problem was the LinkSys router or the ASUS-WRT Merlin-based router it was connected to. Sometimes it worked just fine, other times it didn't. I've never seen this with any other device. I don't Know further What Happened but @dannypovolotski was your problem solved ?
I was Facing the same problem. Now i don't know what solved but it is working.
Most probably the stuck issue is when Sizes of array or buffer assigned to socket does not match with initialization. This i have faced twice. @Eugeny This Time you are talking about is already there by default and i never needed to change it. have tested this earlier ? I'm still having intermittent issues. Those issues are very weird. I'm opening two sockets at a time - same destination IP and everything. As before , there is 100% stability on DNS & DHCP, but sometimes it gets stuck on `connect()`. When it does get stuck, I don't understand why does the retry not help it? Sometimes after timing out, my code tries to open the connection again, but then it works. Most times the first socket connects without an issue, but the second one hangs. However that's not every time.

The behavior is very weird and not very predictable.

I'm not entirely sure how can DHCP & DNS be rock solid, but TCP connections so fickle. Also  - why would one socket to the same IP (I made sure the ports are different e.t.c) open with more stability than two? It also seems like when it *DOES* get stuck, the loop is infinite. It never actually times out :( ... It gets stuck in an infinite loop somewhere in connect() Hello 
I have the same situation, how can I specify "" device is having difficulties finding the simeslot on the TX wire to send the packet"" ?
Thanks This is a complex issue and requires analysis of the wireshark having dump of packets travelling on the network and exact indication of where execution is stuck and why (may require modification of the WIZnet library you use to display debug info and status information).","Q) I have an issue with my board based on W5500. I have successfully implemented a TCP client that sends an HTTP message and then waits for a response. The behavior, however, is quite puzzling. Just about half the time everything works perfectly, while the other half - the TCP socket opens, connects without error and then hangs on `send()`. There is no return from that function, and it seems like the program is stuck in some sort of infinite loop. When checking `wizchip_gettimeout`, I have a value of 2000 for timeout and 8 for retries. If I'm not mistaken 2000 means 0.2 seconds? Am I wrong to assume that a hardware issue would result in failures with DHCP leasing and DNS resolution as well as TCP?
Yup, I did use the ioLibrary code from that GitHub repo! As I said, the behavior is super odd to me, because DHCP works 100%, DNS works 100%, but TCP hangs 50% of the time. I'm still debugging it, but was wondering if someone knows where to point me. Am I wrong to assume that a hardware issue would result in failures with DHCP leasing and DNS resolution as well as TCP?

A) So, after some debugging turns out it gets stuck on socket connect() and not send(). Specifically, it gets stuck inside this loop: 

``` 
while(getSn_SR(sn) != SOCK_ESTABLISHED)
{
	if (getSn_IR(sn) & Sn_IR_TIMEOUT)
	{
		setSn_IR(sn, Sn_IR_TIMEOUT);
		return SOCKERR_TIMEOUT;
	}

	if (getSn_SR(sn) == SOCK_CLOSED)
	{
		return SOCKERR_SOCKCLOSED;
	}
}
```
That's the spot it ends up stuck at, about 50% of the time. (the rest of the time everything works great). 
`getSn_SR` seems to be stuck on `SOCK_SYNSENT`, and never changes to anything else. Which is weird, because I have a value of 2000 for timeout and 8 for retries. So at the very least it should timeout? This is the relevant code in my application:
// create a TCP socket
if ((sck_status = socket(HTTP_DATA_SOCKET, Sn_MR_TCP, 0, 0)) == HTTP_DATA_SOCKET) {
	// connect to the server
	if ((con_status = connect(HTTP_DATA_SOCKET, (uint8_t*) dest_ip, (uint16_t) dest_port)) == SOCK_OK) {
		if ((send_status = send(HTTP_DATA_SOCKET, (uint8_t*) msg, strlen(msg))) != strlen(msg)) {
		printf_P(PSTR(""[error] unable to send: %"" PRIi32 ""\r\n""), send_status);
		return;
	}
	close(HTTP_DATA_SOCKET);
	} else {
		printf_P(PSTR(""[error] connection not available: %i\r\n""), con_status);
	}
} else {
	printf_P(PSTR(""[error] unable to create socket: %"" PRIi8 ""\r\n""), sck_status);
} When it works, it works flawlessly, but when it doesn't, it reliably gets stuck on `connect`, being stuck on `SOCK_SYNSENT`. Do you have timeout in your SPI read/write driver? How about checking firewall setting, port number and server application status on your test server(PC)? [quote=""dannypovolotski, post:8, topic:6240""] I have a value of 2000 for timeout and 8 for retries. [/quote]

For these values, TCP timeout will be 31.8 seconds, see RCR section of the datasheet, it has this value calculated. You just need to wait a little more :slight_smile:

As @Bong said it is most probably that some device located on the packet path filters out or loses the SYN/ACK return packet. I saw a similar issue while developing code for the W5500 and used WireShark to debug it. I found the problem was that the W5500 wasn't seeing ARP responses from the wireless device (an old Linksys router running DD-WRT as a bridge) I was trying to connect to. I saw the ARP request from the W5500 repeated over and over, but there was no response. Never figured out if the problem was the LinkSys router or the ASUS-WRT Merlin-based router it was connected to. Sometimes it worked just fine, other times it didn't. I've never seen this with any other device. I don't Know further What Happened but @dannypovolotski was your problem solved ? I was Facing the same problem. Now I don't know what solved, but it is working. Most probably the stuck issue is when Sizes of array or buffer assigned to socket does not match with initialization. This I have faced twice. @Eugeny This Time you are talking about is already there by default and I never needed to change it. have tested this earlier?

"
3417,6241,"WIZ750SR RS232 H/W I will ask questions.

Suppose the WIZ750SR received 40 bytes data from Ether Netport,

20 bytes are transmitted to serials, and the CTS signal on the user board disable,

After a certain time, if you enable CTS signal,

I wonder if the remaining 20 bytes will be re -transmitted. Yes, that's right.The remaining 20 byte retransmission is not sent rather than the expression, but when it is enable, it is sent. https://github.com/Wiznet/WIZ750SR/blob/master/Projects/S2E_App/src/Serial_to_Ethernet/seg.c

GitHub ÃªÂ³ÂµÃªÂ°Â??Ã¬Â½ÂÃ«ÂÂ??Ã«Â³Â´Ã¬ÂÂÃ«Â©??ÂÃ«ÂÂ ÃªÂ°ÂÃ¬? Ã¬Â½ÂÃ«ÂÂ?ÂÃ¬ÂÂ Ã¬Â²ÂÃ«Â¦Â¬?ÂÃ«ÂÂÃ«Â¡??ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

```
void ether_to_uart(uint8_t sock)
{
...
	if(serial->flow_control == flow_rts_cts)
	{
#ifdef __USE_GPIO_HARDWARE_FLOWCONTROL__
		if(get_uart_cts_pin(SEG_DATA_UART) != UART_CTS_LOW) return;
#else
		; // check the CTS reg
#endif
	}
``` Thank you for answer!!","Q) After a certain time, if you enable CTS signal, I wonder if the remaining 20 bytes will be re-transmitted.
A) Yes, that's right. The remaining 20 byte retransmission is not sent rather than the expression, but when it is enabled, it is sent. The code for enabling CTS signal can be found here: https://github.com/Wiznet/WIZ750SR/blob/master/Projects/S2E_App/src/Serial_to_Ethernet/seg.c"
3418,6245,"Hello.  I buy WizArduino M0 Eth. because WizArduino M0 Eth support POE. 
I try to connect POE Hub(Hub is NX-16250Wn-POE). but......... WizArduino M0 Eth power is not turned on.
using UTP Cable is CAT6. It is board wrong? Hi, Minsoo_Son

Which PoE module do you use?
WizArduino M0 Eth supports Ag9700( [Ag9700 link](https://www.silvertel.com/images/datasheets/Ag9700-Datasheet-low-cost-isolated-Power-over-Ethernet-PoE-module-solution.pdf)) product from Silvertel.

Thank you Thank you!! I don't know why M0 Eth board not POE. Board manual check  this board support POE, but not install POE board.....
Maybe  I buy this board(Ag9700) or not use POE.. 

Thank you very much!!!","Q) Which PoE module do you use?
A) WizArduino M0 Eth supports Ag9700 ([Ag9700 link](https://www.silvertel.com/images/datasheets/Ag9700-Datasheet-low-cost-isolated-Power-over-Ethernet-PoE-module-solution.pdf)) product from Silvertel."
3419,6248,"Guys,

I am new in TCP and in W5100S. Just started to use this chip on W5100S EVB V1.0 board. I initialized  all ports, ip etc. And now when I start communications, I can see only ACKs from server. First ACK to my connection request with Syn set. Then I try to send message from client to server and I have ACK from server, but I do not see messages from client at all on wireshark. 

Anyone had similar issues ?

Thanks,
Val could you share the tcp handshake packets from wireshark?
W5100S is server or client? And did you check socket status is SOCK_ESTABLISHED ? Thank you for your replay. All sorted now and everything is running well. That is so great!! 
Any time, if you have issues or problems, please share it :slight_smile:","Q) Anyone had similar issues ?
Q) could you share the tcp handshake packets from wireshark?
Q) W5100S is server or client? And did you check socket status is SOCK_ESTABLISHED ?
A) Thank you for your replay. All sorted now and everything is running well. That is so great!! 
A) Any time, if you have issues or problems, please share it :slight_smile:"
3420,6250,"ST?Â¬Ã¬ÂÂ STM4x7 MCU??FSMC Ã«Â²ÂÃ¬ÂÂ¤??W5300 ??interface?Â´Ã¬ÂÂ ?Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
?Â¤Ã«Â¥Â¸ Ã«Â¬Â¸Ã¬Â Â???ÂÃªÂ³Â  ?ÂÃ«ÂÂ Ã¬Â½ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ RSR???Â¬ÃªÂ¸Â°Ã«Â¥??Â½Ã«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ???Â½ÃªÂ°Â??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

I am using the W5300 interface to the FSMC bus of ST's STM4x7 MCU.
There is no other problem, and there is a slight problem in reading the size of RSR as shown in the code below.

uint32   getSn_RX_RSR(SOCKET s)
{
   uint32 received_rx_size=0;
   uint32 received_rx_size1=1;
   while(1)
   {
      received_rx_size = IINCHIP_READ(Sn_RX_RSR(s));
      received_rx_size = (received_rx_size << 8) + IINCHIP_READ(Sn_RX_RSR1(s));  // read    
      received_rx_size = (received_rx_size << 8) + IINCHIP_READ(Sn_RX_RSR2(s));
      received_rx_size = (received_rx_size << 8) + IINCHIP_READ(Sn_RX_RSR3(s));                                  
      if(received_rx_size == received_rx_size1) break;                                                                         
delay(1msec);    // <----------------- ?Â¬ÃªÂ¸Â°??delayÃªÂ°? ?ÂÃ¬ÂÂ¼Ã«Â©????Â¨Ã¬ÂÂÃ«Â¥?Ã«Â¬Â´Ã­ÂÂ Ã«Â°ÂÃ«Â³Âµ??
                             // <----------------- If there is no delay here, this function will repeat indefinitely.
      received_rx_size1 = received_rx_size;                                      // if first == sencond, Sn_RX_RSR value is valid.
   }                                                                             // save second value into first
   return received_rx_size;   
}

Ã¬Â²ÂÃ¬ÂÂ ?Â½Ã¬? RSR??ÃªÂ°ÂÃªÂ³Â¼ ?ÂÃ«Â²ÂÃ¬Â§??Â½Ã¬? RSR??ÃªÂ°ÂÃ¬ÂÂ´ ÃªÂ°ÂÃ¬ÂÂ??loopÃ«Â¥?Ã«Â¹Â Ã¬Â Â¸?ÂÃª????ÂÃ«ÂÂ??
delayÃªÂ°? ?ÂÃ¬ÂÂ¼Ã«Â©?loopÃ«Â¥?Ã«Â¬Â´Ã­ÂÂÃ«Â°ÂÃ«Â³Âµ?ÂÃªÂ²Â ?Â©Ã«ÂÂ??
?ÂÃ¬ÂÂ¸??Ã«Â¬Â´Ã¬ÂÂ?Â¼ÃªÂ¹Â??

The value of the first read RSR and the value of the second read RSR are the same,
If there is no delay, the loop repeats indefinitely.
What is the cause? [Quote = ""SHJUNG5619, POST: 1, Topic: 6250""]
if (Received_rx_size == Received_rx_size1) break;
[/Quote]

Check the actual values,
If the RSR value is output, the values are output than the set RX buffer size.
Since the RSR value cannot have a larger value than the size of the RX buffer, if these values are output,
Please set the Host Access Timing more slowly.

And one more suspicious thing is that the recv1 value may not be update due to the code optimize.
Please declare Volatile in both variables.

thank you","Q) What is the cause of the loop repeating indefinitely?
A) The loop repeats indefinitely because if the RSR value is output, the values are greater than the set RX buffer size. The RSR value cannot exceed the size of the RX buffer.

Q) What should be done to address the issue with the loop and the potential code optimization problem?
A) It is recommended to set the Host Access Timing more slowly to prevent the RSR value from exceeding the RX buffer size. Additionally, declare the 'received_rx_size' and 'received_rx_size1' variables as volatile."
3421,6251,"Hi there,
I'm looking the web configuration feature that is stated in the products webpage (https://www.wiznet.io/product/wifi-module/), and i'm not able to find it.
The wizfi250 looks like have it implemented and is possible to configure it, the at instructions related to it are AT+MCWUI and AT+FWEBS

Is this the feature implemented? or is only wrongly stated in the products webpage? Hi
Please refer to the following links about the AT+FWEBS.

https://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:start#at_fwebs
https://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250pg:web_config

Web server for configuration can run after joining to AP or running as Soft AP.

there is a link how to start web server using HW trigger.
https://wizwiki.net/wiki/doku.php?id=products:wizfi250:wizfi250qsg:start#start_serial_to_wi-fi Yes Sir, as i said in the first post, i found the information related to the wizfi250, but this post is made at WizFi310, and is the one i'm asking about, so, does the WizFi310 have implemented the web configuration?
Also i mentioned the product page, that states ""configuration ..... AT Command, Web"", i know there are AT air commands, but that is not properly ""web"" configuration. So, the question, again, is about the WizFi310 web configuration unfortunately, the WizFi310 do not be supported web configuration.
it is wrong information, I will modify it. Hey there, just to point out another misinformation, at the AT commands description, in the wiki page, under the AT+MPROF description, in the example, you can find ""+FWEBS=..."", that i'm guessing, is referreing to the web server","Q) Is this the feature implemented? or is only wrongly stated in the products webpage?
Q) does the WizFi310 have implemented the web configuration?
Q) that is referreing to the web server.

A) Unfortunately, the WizFi310 does not support web configuration. The information mentioned on the product page about ""configuration ..... AT Command, Web"" does not properly refer to ""web"" configuration. The AT+FWEBS command reference in the wiki page is not related to web configuration for WizFi310."
3422,6253,"[quote=""CoolNamesAllTaken, post:1, topic:6253""]
What functions do these 6.8nF capacitors perform (I?Âm assuming an AC-pass filter of some sort)?
[/quote]

No, they are DC decoupling. I suspect for the cases when you mistakenly connect CT to the 3.3V (or have transformer with only one CT - see section ""RJ45 with integrated Transformer and connected CT"").

[quote=""CoolNamesAllTaken, post:1, topic:6253""]
Would the chip still work without them?
[/quote]

I think you have proven that it will not, or better to say functionality is not guaranteed. Change your circuit and board according to the [reference circuit diagram](http://wizwiki.net/wiki/doku.php?id=products:w5500:refschematic). I hope you've seen these documents before designing your board. Also notice that W5500 is not MDIX capable. Thanks Eugeny, I've revised my board to follow the reference diagram RJ45 termination, and have phase-matched my differential pairs out of an abundance of caution.  I'll update here if things go wrong.

After looking at the ""RJ45 with Integrated Transformer and connected CT"" schematic, it looks like things are expected to fail if the RX+ and RX- lines are connected to +3.3V in any way--that seems to be my mistake.  I wonder why the DC decoupling capacitors are present in the reference design even when the center tap of the RX transformer is not connected to +3.3V...

In any case, thanks again for your input!  I'm using a router with my board (no devices in between), so I believe that I wouldn't require MDIX functionality.  Hopefully the board works this next time around.","Q) What functions do these 6.8nF capacitors perform (I'm assuming an AC-pass filter of some sort)?
A) No, they are DC decoupling. I suspect for the cases when you mistakenly connect CT to the 3.3V (or have transformer with only one CT - see section ""RJ45 with integrated Transformer and connected CT"").

Q) Would the chip still work without them?
A) I think you have proven that it will not, or better to say functionality is not guaranteed. Change your circuit and board according to the reference circuit diagram. I hope you've seen these documents before designing your board. Also notice that W5500 is not MDIX capable. Thanks Eugeny, I've revised my board to follow the reference diagram RJ45 termination, and have phase-matched my differential pairs out of an abundance of caution.  I'll update here if things go wrong.

After looking at the ""RJ45 with Integrated Transformer and connected CT"" schematic, it looks like things are expected to fail if the RX+ and RX- lines are connected to +3.3V in any way--that seems to be my mistake.  I wonder why the DC decoupling capacitors are present in the reference design even when the center tap of the RX transformer is not connected to +3.3V...

In any case, thanks again for your input!  I'm using a router with my board (no devices in between), so I believe that I wouldn't require MDIX functionality.  Hopefully the board works this next time around."
3423,6254,"    [WizFi630] [WizFi210/220] [WizFi250] [WizFi310]
**wiznet Ã«Â¬Â´Ã¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ??ÃªÂ´??ÂÃ¬ÂÂ¬ wizfi310ÃªÂ³?wizfi 250ÃªÂ°ÂÃ¬ÂÂstm32f4 ?? ?Â°Ã¬ÂÂ´???ÂÃ¬ÂÂ¡?ÂÃ¬ÂÂ
 
1. Send 10Mbyte data to PC
Baud rate	Time 
(Using Command Mode)	Speed(bit/s)	Flow Control
3686400	47s	                      1.74M	     H/W
1843200	1m 20s	              1.00M	     H/W
921600	        2m 20s	               585K	     H/W

?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ wizfi250 data?ÂÃ¬ÂÂ¡?ÂÃ«ÂÂ ?Â¸Ã«ÂÂ°
wizfi310???ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´ ?ÂÃ«Â¡Â?Â°Ã¬Â»Â¨?Â¸Ã«Â¡Â¤ ?ÂÃ¬ÂÂ© Ã«Â°?dma Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦??ÂÃ¬ÂÂ©???ÂÃ¬? ÃªÂ°ÂÃ¬? ?ÂÃ¬ÂÂ¼???ÂÃ«ÂÂÃ«Â¡??ÂÃ¬ÂÂ¡ÃªÂ°????Â¬Ã«???

mcu?? Ã«Â¬Â´Ã¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ ?ÂµÃ¬ÂÂ ?ÂÃ«ÂÂÃ¬Â¤ÂÃ¬ÂÂ??ÃªÂ³Â Ã¬ÂÂ?ÂµÃ¬ÂÂ ??ÃªÂ°??Â¥Ã­ÂÂ Ã«ÂªÂ¨Ã«ÂÂ???ÂÃ¬ÂÂ¼Ã«Â©?Ã¬Â¶ÂÃ¬Â²Â Ã«Â¶????ÂÃ«Â¦Â¬ÃªÂ²Â Ã¬ÂÂµ?ÂÃ«ÂÂ¤.

---------- The data transmission of Serial to WiFi modules occurs in the serial, so the transmission speed depends on the serial speed and flow control.

Our wireless products are expected to show similar performance because it only supports UART.
If you want high -speed communication, you might want to find a product that supports the high -speed interface.","Q) ?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ wizfi250 data?ÂÃ¬ÂÂ¡?ÂÃ«ÂÂ ?Â¸Ã«ÂÂ° wizfi310???ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´ ?ÂÃ«Â¡Â?Â°Ã¬Â»Â¨?Â¸Ã«Â¡Â¤ ?ÂÃ¬ÂÂ© Ã«Â°?dma Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦??ÂÃ¬ÂÂ©???ÂÃ¬? ÃªÂ°ÂÃ¬? ?ÂÃ¬ÂÂ¼???ÂÃ«ÂÂÃ«Â¡??ÂÃ¬ÂÂ¡ÃªÂ°????Â¬Ã«?? 
mcu?? Ã«Â¬Â´Ã¬ÂÂ Ã«ÂªÂ¨Ã«ÂÂ ?ÂµÃ¬ÂÂ ?ÂÃ«ÂÂÃ¬Â¤ÂÃ¬ÂÂ??ÃªÂ³Â Ã¬ÂÂ?ÂµÃ¬ÂÂ ??ÃªÂ°??Â¥Ã­ÂÂ Ã«ÂªÂ¨Ã«ÂÂ???ÂÃ¬ÂÂ¼Ã«Â©?Ã¬Â¶ÂÃ¬Â²Â Ã«Â¶????ÂÃ«Â¦Â¬ÃªÂ²Â Ã¬ÂÂµ?ÂÃ«ÂÂ¤.
A) The data transmission of Serial to WiFi modules occurs in the serial, so the transmission speed depends on the serial speed and flow control. Our wireless products are expected to show similar performance because it only supports UART. If you want high -speed communication, you might want to find a product that supports the high -speed interface."
3424,6256,"Hi Wizdaniel,

I am trying to add in new certificates to a Wizfi250, but AT+MCERT=W,C is giving an invalid input error. The read and delete functionalities work fine, it's just write that doesn't work. I tried factory resetting and updating the firmware to version 1.0.4.9 and it still gives an invalid input error. Is there another parameter for this command? The AT+MCERT command is not listed in the documentation for this device, I only found out about it through https://forum.wiznet.io/t/topic/1308/2 .

Do you have any suggestions for me to try to be able to get this command working?

Best Regards Hi

Try again with only carriage return<0x0d> next to +MCERT cmd.
```
AT+MCERT=W,C<0x0d>
```
if you put <0x0d><0x0a> after Commands, The module will recognise <0x0a> as part of the data or certificates. then the module will give you an Invalid Input Error. Hi 

I tried it again with only carriage return and still no luck. I also tried backdating to versions 1.0.0.0 and 1.0.1.8, I am currently running on version 1.0.4.9. Is there anything else I can try?

Also I thought you'd like to know that I got the http connection working, but had to remove the ""AT+SSEND"" part of the sequence sent in order for it to work.

Best Regards I think you used data mode instead of command mode.
please give me a AT+SCON command that you used.","Q) Is there another parameter for this command? The AT+MCERT command is not listed in the documentation for this device.
A) Try again with only carriage return<0x0d> next to +MCERT cmd. if you put <0x0d><0x0a> after Commands, The module will recognise <0x0a> as part of the data or certificates. then the module will give you an Invalid Input Error.

Q) Do you have any suggestions for me to try to be able to get this command working?
A) I tried it again with only carriage return and still no luck. I also tried backdating to versions 1.0.0.0 and 1.0.1.8, I am currently running on version 1.0.4.9. Is there anything else I can try?

A) Also I thought you'd like to know that I got the http connection working, but had to remove the ""AT+SSEND"" part of the sequence sent in order for it to work. Best Regards I think you used data mode instead of command mode. please give me a AT+SCON command that you used."
3425,626,"Hello everyone,

I have configured the WizFi220 to the default settings. But I am not being able to connect or even ping to the device. I have assigned a static IP within the same subnet. One thing, the WiFi network I am using is a very secure, password protected network. It's my office network actually. So, can that be a cause for me not being able to connect. If it is, how do assign the password to the module or atleast be able to bypass the password. 

Please let me know if there might be any other reasons.

Thanks for your time,

regards
Gaurav Hello Gaurav

There are some unclear part in your environments.

1. ""I am not being able to connect"" ==> What does it mean?
     
2. Could you show me the <your all AT Command log>? Hi ssekim,

Thanks for the response from your part. 

I got it up and started today morning. it is working with AT command mode. with ""ATA"" command I got connected. 

Now I would like to use the data mode (not command mode). I would like to know how this will connect in data mode on every power cycle without any AT command.

Thanks,
G Hi

For setting data mode on every power cycle without any AT command, you can use AT command as below.

[quote]
AT+WAUTO=0,WizFiDemoAP
AT+NAUTO=0,1,192.168.3.105,5000
AT+NDHCP=1
[b]
ATC1
AT&Y0
AT&W0
[/b]
ATA
[/quote] Hi
I have question about this problem. Do you want to connect Laptop(client) to WizFi220(server) on the different network? right?

If it's right, I wonder What is the IP address of Laptop and WizFi220? Hey Kaizen,

I am not that good in networking, but I think they are on the same network. The line coming from my ISP is fed into router 1 (SSID lets say xxx)  where my laptop is connected and then router 2 (SSID lets say yyy) is connected to router 1 The WizFi device is connected to router 2.

Here are a few more clarifications:
1. Router 1 and Router 2 both has different SSID and Password
2. Router 1 and Router 2 both has different default gateway. 10.96.66.1 (for Router 1) and 192.168.0.1 (for Router 2)
3. However Router 1 and Router 2 has the same subnet mask 255.255.255.0
4. The laptop(client) has a dynamic IP connected to Router 1 (lets say 10.96.66.45 for now) and the  WizFi220 has a static IP connected to Router 2, lets say 192.168.0.26.

Please clarify me on this scenario whether they are considered to be on different or same network. What are the configurations I have to change, if there is any? I might need to ask my network staff to make the changes if required.

PS: Both the client and server works fine if they are both connected to one router either Router 1 or Router 2. 

Thanks for your time,
Gaurav Hi

If you set subnet 255.255.255.0 to Router 1 and Router 2, I think your Router 1( ex, your Laptop ) can't communicate with Router 2( ex, WizFi220). 

I have two idea.
If you don't want change Router's IP, Change the Router 1 and Router 2's subnet value to 255.255.0.0.

Or If you don't want change Router's Subnet, Change the Router 2's IP address to 10.96.66.xx.

Thank you. Thanks for the help Kaizen.
I got your point.

Now I have pushed the reserved button twice consecutively and many times thereafter. I went through the data sheet and it said that the device is restored to factory default if the reserved button is pressed twice. Now I am unable to get into command mode to configure the device back again. I tried switching the hardware trigger for changing over from data mode to command mode but in vain. I opened up the hyperterminal and typed 'AT' and it got typed something as '}w}'. 

Please provide me the steps to get it up again.

Thanks,
G","Q) I have configured the WizFi220 to the default settings. But I am not being able to connect or even ping to the device. I have assigned a static IP within the same subnet. One thing, the WiFi network I am using is a very secure, password protected network. It's my office network actually. So, can that be a cause for me not being able to connect. If it is, how do assign the password to the module or atleast be able to bypass the password. Please let me know if there might be any other reasons.

A) There are some unclear part in your environments.
1. ""I am not being able to connect"" ==> What does it mean?

2. Could you show me the <your all AT Command log>? 

A) For setting data mode on every power cycle without any AT command, you can use AT command as below.
[quote]
AT+WAUTO=0,WizFiDemoAP
AT+NAUTO=0,1,192.168.3.105,5000
AT+NDHCP=1
ATC1
AT&Y0
AT&W0
ATA
[/quote]

Q) I have question about this problem. Do you want to connect Laptop(client) to WizFi220(server) on the different network? right? If it's right, I wonder What is the IP address of Laptop and WizFi220?

A) If you set subnet 255.255.255.0 to Router 1 and Router 2, I think your Router 1( ex, your Laptop ) can't communicate with Router 2( ex, WizFi220). I have two idea. If you don't want to change Router's IP, Change the Router 1 and Router 2's subnet value to 255.255.0.0. Or If you don't want to change Router's Subnet, Change the Router 2's IP address to 10.96.66.xx.

Q) Thanks for the help Kaizen. I got your point. Now I have pushed the reserved button twice consecutively and many times thereafter. I went through the data sheet and it said that the device is restored to factory default if the reserved button is pressed twice. Now I am unable to get into command mode to configure the device back again. I tried switching the hardware trigger for changing over from data mode to command mode but in vain. I opened up the hyperterminal and typed 'AT' and it got typed something as '}w}'. Please provide me the steps to get it up again. 

A) None"
3426,6265,"I am doing a botloader  on a shared 5500, and I was confronted with the problem of how to save ilm to find out the IP address of the device, after switching from the application to bootloader. I not found how set same ip. Hi~ Maksim

Would you tell me correct product name? I think I can do a quick response.

Thanks, what is the name product? I make my bootloader based on tftp protocol and wiznet 5500 + stm32f103","Q) Would you tell me the correct product name?
A) I think I can do a quick response. Thanks, what is the name product? 

Q) I am doing a botloader on a Wiznet 5500 and I was confronted with the problem of how to save ilm to find out the IP address of the device after switching from the application to bootloader. I not found how to set the same IP.
A) I make my bootloader based on TFTP protocol and Wiznet 5500 + STM32F103."
3427,6266,"Sir,
We are using W5500 in an application and are setting internet parameters like
IP setup: Static or DHCP
IP address
Netmask (submask)
port number
etc through the UART port of the support micro controller.
Can we know if the above parameters can be set directly through the ETHERNET PORT ITSELF onto the on board W5500 directly.
Regards [quote=""centurymetering, post:1, topic:6266""]
Can we know if the above parameters can be set directly through the ETHERNET PORT ITSELF onto the on board W5500 directly.
[/quote]

No, and it should not, as this will be serious security breach. Sir,

Thanks for your immediate reply.

But in the WIZNET108SR  we are able to set these parameters directly through the ethernet.

We thought, we should be able to do the same thing in our board without having to resort to another port of the supporting micro controller which after receiving the data through one of its UART ports, programs the on board W5500.

Regards

VTC

Century Metering Systems & Controls Pvt Ltd Hi, centurymetering

there are two ways to set network information by ethernet communication.

first one is you set board' network information at the first time. Then you can connect the board via ethernet and change the information (Actually, WIZ108SR using this way)

second, by mac communication(like ARP), you can communicate the board without default network information.
All wiznet products support macraw communication. But this concept is from wiznet. So, it is hard to find examples out there and you have to make your own application for it.

I recommend you to set default ip network, and then change it through udp or tcp communication.

thank you Sir,
Thanks for the information.

We will try to implement your suggestion.

Regards

VTC","Q) Can we know if the above parameters can be set directly through the ETHERNET PORT ITSELF onto the on board W5500 directly?
A) No, and it should not, as this will be serious security breach.

Q) But in the WIZNET108SR  we are able to set these parameters directly through the ethernet. We thought, we should be able to do the same thing in our board without having to resort to another port of the supporting microcontroller which after receiving the data through one of its UART ports, programs the on board W5500.
A) there are two ways to set network information by ethernet communication. The first one is you set board's network information at the first time. Then you can connect the board via ethernet and change the information (Actually, WIZ108SR using this way). The second, by mac communication(like ARP), you can communicate the board without default network information. I recommend you to set default IP network, and then change it through UDP or TCP communication.

Q) Thanks for the information. We will try to implement your suggestion.
A) None."
3428,6267,"Dear,

please, may i have some information about your new W360 module ?

1/ it seem that it include an ESP8266 chip and the AT firmware.
is the the official Esspressif version or do you customize it ?
do you provide full support on this version in case of bugs are discovered ?

2/ what is the price by 10 and 100 parts for W310-CON version ? 
3/ date of availability ?

thanks, regards [quote=""phil31, post:1, topic:6267""]
1/ it seem that it include an ESP8266 chip 
[/quote]
No, not ESP chipset.

[quote=""phil31, post:1, topic:6267""]
and the AT firmware.
is the the official Esspressif version or do you customize it ?
do you provide full support on this version in case of bugs are discovered ?
[/quote]
Yes, our F/W is a customized one and we can support for fixing, updating it. 


[quote=""phil31, post:1, topic:6267""]
2/ what is the price by 10 and 100 parts for W310-CON version ?
[/quote]
Not yet fixed. Around Sep., we could release our sample price on our online shop & our distributors.

[quote=""phil31, post:1, topic:6267""]
3/ date of availability ?
[/quote]
maybe, you can buy samples around Sep. Hi,

nothing available right now ??.. 
but library for ARMmbed are available since 5 months !!!

and that say that the W360 is an ESP12  ... so an ESP chip 

[https://github.com/ARMmbed/wizfi360-driver](https://github.com/ARMmbed/wizfi360-driver)
if we compare the AT commands list, she's realy identical to the AT Espressif commands list !!

can you message me in private the price for 2 engineering samples ?

regards Hi,
Sorry for late, but we've prepared ESP-compatible SDK & CE/FCC Certi for last 5 months.
For the AT commands list, you know, ESP has a large fan in embedded device area, so we're trying to support ""AT Espressif commands list"".

[quote=""phil31, post:3, topic:6267""]
can you message me in private the price for 2 engineering samples ?
[/quote]
not fixed, but for sample price, around $3.3 each","Q) may i have some information about your new W360 module ? is the the official Esspressif version or do you customize it ? do you provide full support on this version in case of bugs are discovered ?
A) Yes, our F/W is a customized one, and we can support for fixing and updating it.

Q) what is the price by 10 and 100 parts for W310-CON version ?
A) Not yet fixed. Around Sep., we could release our sample price on our online shop & our distributors.

Q) date of availability ?
A) maybe, you can buy samples around Sep.

Q) nothing available right now ??.. but library for ARMmbed are available since 5 months !!! and that say that the W360 is an ESP12  ... so an ESP chip if we compare the AT commands list, she's really identical to the AT Espressif commands list !! can you message me in private the price for 2 engineering samples ?
A) Sorry for late, but we've prepared ESP-compatible SDK & CE/FCC Certi for last 5 months. For the AT commands list, you know, ESP has a large fan in embedded device area, so we're trying to support ""AT Espressif commands list"".

Q) can you message me in private the price for 2 engineering samples ?
A) not fixed, but for sample price, around $3.3 each"
3429,627,"Hi:
I try to use serial CMD <GO6> to set the mode 6(multi bridge). 
But after I restart the module, the mode goes back to the previous one.
If I set up the mode by web interface, the latest can be remembered.
Please tell me why Hi

I think you don't use <WL> command. <WL> command is command for writing to flash memory.
So If you use this command, WizFi630 will save <GO6> command.","Q) I try to use serial CMD <GO6> to set the mode 6(multi bridge). But after I restart the module, the mode goes back to the previous one. If I set up the mode by web interface, the latest can be remembered. Please tell me why Hi
A) I think you don't use <WL> command. <WL> command is command for writing to flash memory. So If you use this command, WizFi630 will save <GO6> command."
3430,6272,"I think it's very bad.

Please refer to the URL below.

http://wizwiki.net/wiki/doku.php?id=design_guide:hardware:start

Thank you Dear gthind

I think you designed it well. What layer is this PCB?

Do you have any questions?

thank you. This is 4 layer PCB with area underneath RJ45 completely isolated. Thanks, GT","Q) What layer is this PCB?
A) This is 4 layer PCB with area underneath RJ45 completely isolated."
3431,628,"We have been producing our products using WizFi210 firmware level 1.1.0.5 for some years.  We recently received a shipment of WizFi210 comprising a mixture of firmware 1.1.0.5 and 1.1.1.0.  Our products continue to function with
1.1.0.5 but fail with firmware 1.1.1.0.  Our implementation uses multiple sockets with a mixture of UDP and TCP.

We determined that 1.1.1.0 does not return <Esc>O or <Esc>F in response to sending data using escape sequences.

Section 4.3.2.1 of WizFi210 Programmers Guide Version 1.3 omits response <Esc>O and <Esc>F when sending using escape sequences.

Section 4.3.2.2 of WizFi210 Programmers Guide Version 1.3 declares that response <Esc>O and <Esc>F is sent to serial
host when receiving using escape sequences.  This is not logical and exactly the compliment of behaviour of firmware
revision 1.1.0.5.

Is this a simple error in documentation?

Or does 1.1.1.0 in fact not return <Esc>O and <Esc>F when sending using escape sequences?

It appears that this is the case.

Is there a configuration command that will cause 1.1.1.0 to return <Esc>O and <Esc>F in response to sending using escape sequences?  Our product firmware is expecting these responses from WizFi210. Yes, you're right.
<1.1.0.5 f/w> returns <Esc>O or <Esc>F, but <1.1.1.0 f/w> doesn't return them.

Please refer to the below link.
[url]http://wiznet.co.kr/Sub_Modules/en/product/product_detail.asp?Refid=730&page=1&cate1=&cate2=&cate3=&pid=1132&cType=2[/url]

And, there is no way to enable <Esc>O/F.","Q) Is this a simple error in documentation? Or does 1.1.1.0 in fact not return <Esc>O and <Esc>F when sending using escape sequences? It appears that this is the case. Is there a configuration command that will cause 1.1.1.0 to return <Esc>O and <Esc>F in response to sending using escape sequences? Our product firmware is expecting these responses from WizFi210.
A) Yes, you're right. <1.1.0.5 f/w> returns <Esc>O or <Esc>F, but <1.1.1.0 f/w> doesn't return them. And, there is no way to enable <Esc>O/F. [Link reference: http://wiznet.co.kr/Sub_Modules/en/product/product_detail.asp?Refid=730&page=1&cate1=&cate2=&cate3=&pid=1132&cType=2]"
3432,6281,"Wizfi 210 transmits data to the UDP server on the PC through the router.

When booting

At
AT & F
ATE0
At+ndhcp = 1
At+NSET = IP
AT+wpapsk = AP SSID, AP password
At+WA = AP SSID
At+ncudp = server IP, server port

As above, the commands are entered and normal.

At this time, if the power of the router is turned off, turned on or the wifi is cut off
I would like to ask you what commands should be reconnected.
Do you have a command to automatically reconnect? ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??
?ÂµÃ«?????ÂÂ´ Ã¬Â£ÂÃ¬ÂÂ¡?Â©Ã«ÂÂ??
?ÂÃ«ÂÂ???ÂÃ¬ÂÂ??Ã«Â¡??Â´Ã«Â³Â´?ÂÃªÂ¸Â¸ Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

    AT+WD

    [OK]

    AT+WWPA=ap password

    [OK]

    AT+NDHCP=1

    [OK]

    AT+WAUTO=0,ap SSID,,0

    [OK]

    AT+NAUTO=1,0,Server ip,Server port

    [OK]

    ATC1

    [OK]

    AT+XAR=20

    [OK]

    AT&W0

    [OK]

    ATA

        IP              SubNet         Gateway   

     192.168.12.12: 255.255.255.0: 192.168.12.1

    [OK]

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??","Q) Do you have a command to automatically reconnect if the power of the router is turned off or the wifi is cut off?
A) Yes, you can use the following commands for automatic reconnection:
    - AT+WD
    - AT+WWPA=ap password
    - AT+NDHCP=1
    - AT+WAUTO=0,ap SSID,,0
    - AT+NAUTO=1,0,Server ip,Server port
    - ATC1
    - AT+XAR=20
    - AT&W0
    - ATA"
3433,6285,"Hello-
I would like to know the normal rage of 1.8V internal regulator.
Our device has 1.71V output. 
Is this enough for VCC1A8 and VCC1V8 inputs?
Please advise me. It is more than 5%, thus in general should not be good.
Can you describe your real problem, and share circuit diagram? Thanks for reply.
Usually our device shows 1.74V
Is it depend on VDD  (3.0V-3.6V) level?
1.71V device has some problem? If it is said in datasheet that it is 1.8V, then it must be 1.8V or very close to this value. In my opinion, ÃÂ±5% must be a threshold.

[quote=""C1S, post:3, topic:6285""]
1.71V device has some problem?
[/quote]

Is the voltage level is the **only** problem you experience in functionality of the chip? Why did you start measuring this voltage in the first place? Thanks  for the advice.
Actually  our customer has the board that mount these devices.
And then they are anxious about  1.71V core operation.
I would like to say that the device was fully tested with such a low core voltage.
and no problem to use.
They should be better to test the board with the minimum Vdd? [quote=""C1S, post:5, topic:6285""]
And then they are anxious about 1.71V core operation.
[/quote]

Then your answer, and the direction of the research must be guided by the customer requirements. It sounds they are performing some kind of certification and stress testing. Regarding the power levels datasheet only details 3.3V input voltage in range of 3.0 to 3.6 (about 9%), but it does not directly mean that 1.8V must have the same tolerance.

Why the customer is anxious about this fact? What risks do they see? What these risks, if materialized, will cause? The device they used before had 1.74V  around voltage.
But the device we shipped has 1.71V,  So they hesitate to use it.
Anyway I will let them inform this forum and get more advice.

Many thanks.","Q) Is the voltage level the only problem you experience in functionality of the chip? Why did you start measuring this voltage in the first place? 
Q) Why the customer is anxious about this fact? What risks do they see? What these risks, if materialized, will cause? 
A) Actually, our customer has the board that mounts these devices and they are anxious about the 1.71V core operation. The device was fully tested with such a low core voltage and showed no problem to use. They should be better to test the board with the minimum Vdd. The customer hesitates to use the device with 1.71V, as the device they used before had a voltage around 1.74V. They are performing some kind of certification and stress testing. 

A) Then your answer, and the direction of the research must be guided by the customer requirements. It sounds like they are looking for more advice. Many thanks."
3434,6286,"Set the MR value to 0xb900 and read it in the debugging mode.
If you sprinkle it while running, it will come out at 0xb800 ..?

Also, if you read the value before setting the MR, is it 0xb800? hello,

The MR value will be 0x3800 or 0xb800.
This is because the value changes according to the Bit 15300's Bit 16en Pin.
This value is set to the selected value before Reset, and it does not apply even after changing the value after the reset.

thank you","Q) Set the MR value to 0xb900 and read it in the debugging mode. If you sprinkle it while running, it will come out at 0xb800 ..?
A) The MR value will be 0x3800 or 0xb800. This is because the value changes according to the Bit 15300's Bit 16en Pin. This value is set to the selected value before Reset, and it does not apply even after changing the value after the reset.

Q) Also, if you read the value before setting the MR, is it 0xb800?
A) None."
3435,6288,"hello.
First of all, I wonder how you did a Loopback test with the Wiz750sR-DBL or WIZ750SR-100.
Did you connect the UART RX/TX pin of the module for the Loopback test?

Please let me know about the test environment. UART0 was initialized for debug, but it was used as an output, but it was not involved in the initial IP information and data transmission.There is no other setting.
The source used the W7500-Master \ w7500x_library_examples \ projects \ Peripheral_examples \ wztoe \ Loopbacktest. I understood that I compiled the code in WizToe \ Loopbacktest and downloaded and used binary.Is that right?
I understand that there is a difference between the clock and the Wiz750sr-100 or the Wiz750sr-DBL in the example in the WZTOE library.I will check it separately and answer.

thank you Yes, if you have a source that needs to be applied when creating a clock, please let me know.thank you WIZ750SR-100 ?ÂÃ«ÂÂ WIZ750SR-DBL?? Clock SourceÃªÂ°? External 12MHzÃ«Â¥??Â¬Ã¬ÂÂ©?Â©Ã«ÂÂ??
WZTOE  ?Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«ÂÂ¬Ã«Â¦??ÂÃ¬Â Â?ÂÃ¬ÂÂ Clock SourceÃ«Â¥?External 12MHz??4Ã«Â¶ÂÃ¬Â£Â¼ ?Â´Ã¬ÂÂ ?Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ ÃªÂ²ÂÃ¬ÂÂ¼Ã«Â¡?Ã¬Â¡Â°Ã¬Â Â?Â´Ã¬ÂÂ ?Â¬Ã¬ÂÂ©?Â´Ã«Â³Â´?Â¸Ã¬ÂÂ. It is also in use.It also comes the same result ..... Hello, this is Wiznet.

Isn't the code you use now is the code that uses the inner clock?

thank you Shouldn't you activate sysclk_extern_osc and modify it with Extern_XTAL 120000UL?What is the interior clock? hello

First of all, the part of the Data Invalid in the AX tool is often broken as you said.

However, I tested with the WIZ750SR-100-only firmware and there was no problem with the external clock operation.(The default value is declared as an external clock.)

Therefore, we recommend that you use the official firmware that is officially provided with the WIZ750SR-100.

The code provided with the firmware of the WIZ750SR-100 is as follows.
https://github.com/wiznet/wiz750sr

thank you SystemCoreclockupdate_user If you are talking about this function, I tested it. hello

There are firmware provided for WIZ750SR-100.
The default setting of the firmware is defined as an external clock.

Although the board you use is not officially released, I think it will also work with the WIZ750SR-100 firmware below.

If you use it, you can change the part defined by w7500x_oard.h to wiz750sr to Wiz750sr-100.

https://github.com/wiznet/wiz750sr

thank you Regarding the above answer, the Loopback test contains the Loopback Application in the firmware, so you can use it after declaring loopback.h.

If you are in progress, please feel free to answer.

thank you I put Loopback in EBOOT source with 750sr-100 source and put it in the WIZ750SR-100 board in 48MHz.There is a stopping symptom.It is defined as wiz750sr_1xx in W7500X_BOARD.H.
Systeminit_user (Clock_source_external, PLL_SOURCE_12MHz, System_clock_48MHz);In AX1, you can stop during the test or have a previous error.thank you Yes, there is no particular wrong part in the setting.
Please send the code you tested.

thank you (post withdrawn by author, will be automatically deleted in 24 hours unless flagged)","Q) I wonder how you did a Loopback test with the Wiz750sR-DBL or WIZ750SR-100. Did you connect the UART RX/TX pin of the module for the Loopback test?
A) The Loopback test contains the Loopback Application in the firmware, so you can use it after declaring loopback.h. If you are in progress, please feel free to answer.

Q) Did you connect the UART RX/TX pin of the module for the Loopback test? Please let me know about the test environment.
A) I put Loopback in EBOOT source with 750sr-100 source and put it in the WIZ750SR-100 board in 48MHz. There is a stopping symptom. It is defined as wiz750sr_1xx in W7500X_BOARD.H. Systeminit_user (Clock_source_external, PLL_SOURCE_12MHz, System_clock_48MHz).

Q) Isn't the code you use now is the code that uses the inner clock?
A) The default setting of the firmware is defined as an external clock. Although the board you use is not officially released, I think it will also work with the WIZ750SR-100 firmware below.

Q) Shouldn't you activate sysclk_extern_osc and modify it with Extern_XTAL 120000UL? What is the interior clock?
A) Regarding the above answer, the Loopback test contains the Loopback Application in the firmware, so you can use it after declaring loopback.h. If you are in progress, please feel free to answer.

Q) If you have a source that needs to be applied when creating a clock, please let me know.
A) There are firmware provided for WIZ750SR-100. The default setting of the firmware is defined as an external clock.

Q) The part of the Data Invalid in the AX tool is often broken as you said. However, I tested with the WIZ750SR-100-only firmware and there was no problem with the external clock operation.
A) SystemCoreclockupdate_user If you are talking about this function, I tested it.

Q) Is that right? I understood that I compiled the code in WizToe \ Loopbacktest and downloaded and used binary. Is that right?
A) The code provided with the firmware of the WIZ750SR-100 is as follows. https://github.com/wiznet/wiz750sr"
3436,629,"I've currently got a WIZ140SR module set up with 1.6.1 firmware, data packing character = 00, size = 0, and time = 0. I would have thought this configuration would not do any data packing, i.e. type one character and it goes in its own packet. This is not what I see, though. I I open a telnet session to the terminal server, type a line followed by a <CR>, and only then do I see the characters come out the serial port. I need the terminal server set up to pass characters on as soon as they are received from the network side.

I'm sure this is not a byproduct of the telnet software, since it works as expected when I replace the Wiznet module with a Cisco terminal server. If you set data packing character = 00, size = 0, and time = 0, packing condition is not applied and any serial data sent to the Ethernet when it comes as you mentioned.

[quote]I open a telnet session to the terminal server, type a line followed by a <CR>, and only then do I see the characters come out the serial port.[/quote]
In my test, whenever I type the character in Win7 telnet session, the character is transferred to the serial so I'd like to know what kind of telnet program do you use. Unfortunately, this does not appear to be true. As I said in my previous message, I do have all data packing fields set to 0, but I don't see any characters come out the serial side until I send a <CR> character. I can send you logic analyzer traces clearly showing this if necessary. [posting.php?mode=reply&f=21&t=582#](http://wizwiki.net/forum/posting.php?mode=reply&f=21&t=582#)

Good to know my interpretation of you scant outdated documentation is correct, but in practice I don't see it work that way.

Gary BTW, I'm using a standard Linux telnet. It works fine through a Cisco, Black Box, or Digi terminal server. In fact, the only terminal server I've found that DOESN'T send one character at a time is yours :^(

Just did a little more snooping, and it looks like ""character"" vs ""Line"" mode is negotiated between the two ends when setting up a telnet session, with the default being ""line"" mode. Looks like I may need to force ""character"" mode for your terminal server, where most others seem to negotiate to ""character"" mode. I may need to play around with the telnet options a little more.

Gary Did some testing, and it looks like if I change the telnet connection to ""character"" mode, everything works like I want. Bothers me a little that this isn't automatic on the Wiznet terminal server while it is on all the others I've tried. This means I need to establish a telnet session, escape to the telnet prompt, issue a telnet mode command, and then resume.

We've got over 300 modules up and running here. Any chance Wiznet would do a firmware build that forced character mode?

Gary It's good to hear you find the cause of this issue and I googled and found below.
[quote]The telnet client, at least on Linux, defaults into line-at-a-time mode, so I always have to do ^]mode char manually.[/quote]

Do you want our module operate like character mode regardless of telnet client's setting?
As you may know our module is general purpose Serial to Ethernet gateway and currently there is no special feature for terminal server.
I think we need to study how to force the telnet client into character mode.

JB","Q) I've currently got a WIZ140SR module set up with 1.6.1 firmware, data packing character = 00, size = 0, and time = 0. I would have thought this configuration would not do any data packing, i.e. type one character and it goes in its own packet. This is not what I see, though. I open a telnet session to the terminal server, type a line followed by a <CR>, and only then do I see the characters come out the serial port. I need the terminal server set up to pass characters on as soon as they are received from the network side. 

[quote]I open a telnet session to the terminal server, type a line followed by a <CR>, and only then do I see the characters come out the serial port.[/quote]
A) In my test, whenever I type the character in Win7 telnet session, the character is transferred to the serial so I'd like to know what kind of telnet program do you use.
Unfortunately, this does not appear to be true. As I said in my previous message, I do have all data packing fields set to 0, but I don't see any characters come out the serial side until I send a <CR> character. I can send you logic analyzer traces clearly showing this if necessary. 

A) Good to know my interpretation of you scant outdated documentation is correct, but in practice I don't see it work that way.
Gary BTW, I'm using a standard Linux telnet. It works fine through a Cisco, Black Box, or Digi terminal server. In fact, the only terminal server I've found that DOESN'T send one character at a time is yours :^(

A) Just did a little more snooping, and it looks like ""character"" vs ""Line"" mode is negotiated between the two ends when setting up a telnet session, with the default being ""line"" mode. Looks like I may need to force ""character"" mode for your terminal server, where most others seem to negotiate to ""character"" mode. I may need to play around with the telnet options a little more.

A) Did some testing, and it looks like if I change the telnet connection to ""character"" mode, everything works like I want. Bothers me a little that this isn't automatic on the Wiznet terminal server while it is on all the others I've tried. This means I need to establish a telnet session, escape to the telnet prompt, issue a telnet mode command, and then resume.

A) It's good to hear you find the cause of this issue and I googled and found below.
[quote]The telnet client, at least on Linux, defaults into line-at-a-time mode, so I always have to do ^]mode char manually.[/quote]
Do you want our module operate like character mode regardless of telnet client's setting?
As you may know our module is general purpose Serial to Ethernet gateway and currently there is no special feature for terminal server.
I think we need to study how to force the telnet client into character mode."
3437,6291,"Hi,
I amb developing a project using a w5500 to make UDP and TCP transmissions via Ethernet with a custom board.

In some occasions, after some time with the board working, the router crashes, **causing all connected devices to lose internet connection**. Working time before the crash may vary from few minutes to full hours, and there are usullay resets in the middle for debug purposes.

As soon as the ethernet is unplugged from the board, router's behavior goes back to normal and the network internet is restored without the need of reset.

**The problem was supposedly caused by not correctly closing the sockets**. Recently I solved a part of code that kept some sockets from correctly disconnecting and closing, and the router problem has not repeated ever since. However, **I want to make sure if this was the real cause**. I will do some testing, but I would love to know the theory behind this misbehavior, what might cause the router to react this way, and get correction if my assumption is wrong.

Additional information:
 - The created sockets are one UDP to get a DNS ip address, and two TCP sockets.
 - W5500 source IP and port are configured static.
 - Devices connected to router use both ethernet and wifi. They all lost internet.

Thanks in advanced for the contributions in that topic.

If any more information is acquired, it will be posted. I am not allowed to share the code and neither have wireshark captures from the moment of the crash. I can make captures of the current behavior if you want.

Don't you know any general reason that may cause the router to act like this? Maybe IP or port conflict, or too many open ports? [quote=""114r5, post:1, topic:6291""]
Additional information:

* The created sockets are one UDP to get a DNS ip address, and two TCP sockets.
* W5500 source IP and port are configured static.
* Devices connected to router use both ethernet and wifi. They all lost internet.
[/quote]
What are those two TCP sockets, server or client? I am not sure what ""static port"" means in your statement. Are you using the WIZnet ioLibrary? TCP  sockets both act as client, pointing simultaneously to two different servers.

As static port, I mean that one arbitrary source port value is assigned and is always the same for each socket (0xCA00+socketNumber).

No WIZnet ioLibrary. I am creating my own functions. If you ask for a certain bit of code, I might be able to share it. > Don?Ât you know any general reason that may cause the router to act like this?

In fact, we have never got any reports like this from customers.
So, we can't guess what made this symptom.

The packets when the router gets crashed are helpful for us to investigate. I am sure router logs will tell you the reason for its reboot/hanging, or will at least give you an idea what was happening before problem occurs.","Q) Don't you know any general reason that may cause the router to act like this? Maybe IP or port conflict, or too many open ports? 
A) In fact, we have never got any reports like this from customers. So, we can't guess what made this symptom. The packets when the router gets crashed are helpful for us to investigate. I am sure router logs will tell you the reason for its reboot/hanging, or will at least give you an idea what was happening before the problem occurs."
3438,6293,"hello.It is called Jistetan. (Koo Seutech)

Around July 4, 2019, our engineer has inquired by e -mail to the master.
The situation is as follows.

*Overseas companies that use Ethernet Card shipped by our company have a symptom of connection during use.

*Symptom)*
*-If you turn on the device, the connection will be connected for about 5 minutes, and the connection will be cut off (rebooting, but it's a later connection)*

*Use network equipment)*
*One.Linksys 52 POE SMART SWITCH*
*2.Barracuda F80 Firewall*

*How do I check to check the cause of the above problem?*
*Is there a History that is a problem for compatibility with network equipment?*

*Please confirm.*
*thank you.*

Afterwards, I heard that you have sent a new firmware (V 3.15).

In addition, the company uses DHCP to assign IP.
Source analysis results DHCP related functions
DHCP_RUN (void)
Check_dhcp_LEASEDIP (void)
check_dhcp_timeout (void)
at
DHCP_TICK_1S variable seems to cause a problem, so I asked.

    ret = dhcp_tick_1s;
    while ((DHCP_TICK_1S -RET) <2);

It is used as above and becomes meaningless code.
or

    if (DHCP_TICK_NEXT <DHCP_TICK_1S) {
    ........... (code to send Discover again)
    dhcp_tick_1s = 0;
    DHCP_TICK_NEXT = DHCP_TICK_1S + DHCP_WAIT_TIME;
    DHCP_RETRY_COUNT ++;
    }

When used as above and Time OUT is caught, the discover signal will not be sent again.

Thus, inquiries
1. What is the 3.15 version that you sent?
2. Can you test the DHCP feature regarding the DHCP_TICK_1S variable?

please answer about my question.thank you hello.
As a result of the internal confirmation, you have developed firmware using our reference code.
The code called v3.15 is not the code that is not on our side.Perhaps it is a version of the firmware developed by you.

Please send us the DHCP related part of the firmware you are currently in use and we will check what is wrong.

thank you Thank you for your confirmation.

Who can send the code to the code?Thank you for your mail address. Please send it to support@wiznet.io.","Q) What is the 3.15 version that you sent? Can you test the DHCP feature regarding the DHCP_TICK_1S variable?
A) The code called v3.15 is not the code that is not on our side. Perhaps it is a version of the firmware developed by you. Please send us the DHCP related part of the firmware you are currently in use and we will check what is wrong. Thank you for your confirmation.

Q) Who can send the code to the code? Thank you for your mail address. Please send it to support@wiznet.io.
A) There is no answer."
3439,6294,"I am working with a company that has integrated your WIZ108SR into their metering pump product.  We need to interface the pumps to an Allen Bradley PLCs using Ethernet IP.   The downstream load is a Schneider Electric Stepper using RS-485.  We most likely would be able to talk to the stepper directly, but before we removed the WIZ108SR, I thought I would ask if you have whitepaper or recommendation to set the module up to talk to a PLC (AB) over Ethernet. Hey @Gravest, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start tutorial`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob: skip Next, can you share one of these links with me? Reply with **a link on a line by itself**, and it?Âll automatically expand to include a nifty summary.

To copy any link, tap and hold on mobile, or right click your pointing device:

 <https://en.wikipedia.org/wiki/Inherently_funny_word>
 <https://en.wikipedia.org/wiki/Death_by_coconut>
 <https://en.wikipedia.org/wiki/Calculator_spelling> https://en.wikipedia.org/wiki/Inherently_funny_word 1 Sorry, I couldn?Ât find the link in your reply! :cry:

Can you try adding the following link, on its own line, in your next reply?

<https://en.wikipedia.org/wiki/Exotic_Shorthair> https://en.wikipedia.org/wiki/Exotic_Shorthair skip again Hey @Gravest, just checking in because I haven?Ât heard from you in a while.

- To continue, reply to me any time.

- If you?Âd like to skip this step, say `skip`.

- To start over, say `start tutorial`.

If you?Âd rather not, that?Âs OK too. I?Âm a robot. You won?Ât hurt my feelings. :sob:","Q) We need to interface the pumps to an Allen Bradley PLCs using Ethernet IP. Do you have a whitepaper or recommendation to set the module up to talk to a PLC (AB) over Ethernet?
A) Sorry, I couldn't find the link in your reply! 

Q) Can you share one of these links with me? 
A) https://en.wikipedia.org/wiki/Exotic_Shorthair"
3440,6295,"If you use 8 or less sockets, **you just use ""TCP"" socket mode, don't need to use ""MACRAW"" mode.**
I'm not sure you've already known about the TCP/IP protocols, TCP is a connection based communication. So, before data transmission, connection process should be completed between W5200 and App1,2,3...
For example, 
1. Assume that W5200 socket 0 is a server.(listen socket)
1. Assume that W5200 socket 1 is a server.(listen socket)
1. App1(IP1,Port1) is a client.(connect)
1. App5(IP3,Port1) is a client.(connect)
1. App1(IP1,Port1) try to connect to W5200 socket 0 and accept the connection (connection established)
1. App5(IP3,Port1) try to connect to W5200 socket 1 and accept the connection (connection established)
1. in case of App1(IP1,Port1), you can send/recv data through W5200 socket 0.
1. in case of App5(IP3,Port1), you can send/recv data through W5200 socket 1.

1 TCP connection supports one peer socket(IP, Port). 
If you want to change peer ( ex) Peer1->Peer2 ), 
1. you must disconnect the exist connection from current peer(Peer1).
1. you need a new connect process between W5200 and another peer(Peer2).

If you need more detail information for TCP/IP and socket programming, I think, you'd better search another simple & good materials from Internet world (google it ;) )

**) W5200, W5500, W6100 can support 8 sockets (8 TCP connections).*
*Please don't use W5200 for your new design. please use W5500 or W6100.* [quote=""Bong, post:2, topic:6295""]
If you use 8 or less sockets, **you just use ?ÂTCP??socket mode, don?Ât need to use ?ÂMACRAW??mode.**
[/quote]

That is the issue I am trying to circumvent, when I need more than 8. Now I have it working with all sockets, but I need to have more connections. That is what I wanted to say with the diagram and why I thought about the MACRAW mode.
I cannot disconnect an existing connection from a current peer as I need that connection later again. 
Wouldn't then be an option the MACRAW mode when I need more than 8 sockets?

[quote=""Bong, post:2, topic:6295""]
* *) W5200, W5500, W6100 can support 8 sockets (8 TCP connections).*
*Please don?Ât use W5200 for your new design. please use W5500 or W6100.*
[/quote]
Why? [quote=""Bong, post:4, topic:6295""]
yes, you should use ?ÂMACRAW??mode if you need more than 8 sockets.
In case, you should port S/W TCP/IP like LwIP on your firmware(software).
[/quote]

I tried but:

[quote=""aripod, post:1, topic:6295""]
I opened the socket in MACRAW, tried to connect from a PC but the w5200 never answers. I want to send data over TCP/IP so I have a simple python code for this. I see on wireshark that only the packets going out of the PC to open the socket are present but there is no response from the w5200. Do I need to first have socket 1 to 7 in used before I can start with MACRAW?:confused:
[/quote] [quote=""aripod, post:5, topic:6295""]
Do I need to first have socket 1 to 7 in used before I can start with MACRAW?:confused:
[/quote]
No, you don't need to use 1~7 socket, Just use ""MACRAW"" socket 0 for all connections.(but you need to port S/W TCP/IP stack)
If you use only MACRAW mode, S/W TCP/IP stack could send response packets. Please check the software part.
I recommend, test simple ARP send()/recv() function first with S/W stack. [quote=""Bong, post:6, topic:6295""]
If you use only MACRAW mode, S/W TCP/IP stack could send response packets. Please check the software part.
I recommend, test simple ARP send()/recv() function first with S/W stack.
[/quote]

Following the datasheet, from the w5200 side, setting the mode and opening the socket, shouldn't I have been able to receive an ethernet package? From the sender part, I know the w5200 IP and I chose a port number from 0xc000 to 0xf00. Then I should be able to filter these when I receive the ethernet package only by opening the port.....right? No, No, when you use ""MACRAW"", W5200 just check you MAC address.
All Broadcast packet and packets with having destination MAC address same as your setting on W5200  will be received.
W5200 don't see any port number & IP address. just look for MAC.
In case of ""MACRAW"" mode, S/W stack should care for IP, Port filter and processing. Yes, I know...but from the pc I can send over tcp/ip by choosing ip and port which will be in the ethernet package that I will read in the w5200, or not? Or it means that from the PC as well, I cannot use standard tcp/ip socket functions? Yes, that is exactly what I want.

But after I opened the socket on the w5200 I sent the same way I did before to receive with the hardwire tcp/ip stack but this time, I can see the package from the pc to the w5200 (to connect to) but when I check if I receive something, there are no new bytes on the w5200's RX buffer. So the question is if I need to do something different then on the PC side as I do when I have a socket with the hardwire tcp/ip? [quote=""Bong, post:12, topic:6295""]
pls check MAC address on W5200. is it same when you used H/W stack?
[/quote]

Yes, it is the same MAC. I use the same function to initialize the w5200 (MAC, subnet, IP and gateway). It's strange, if you set the MAC address, there is no problem to get packet.
I don't know exactly why there is no receiving data.
Could you try it without any switch? Direct connect btw PC & W5200 board.

PS) Sorry, I will check this issue on Monday again. please leave the result & any feedback. Good news~ I think, it looks correct. :smile: and what about the size of data I can send? If it is limited to 1500 bytes....how is it possible to send bigger packages than that? Let's say I have 5000 bytes to send. Then, it will be splitted in 3x1500 and 1x500 but will that represent that on the receiving peer it will be like receiving 4 different packages or it is possible to see it as one big 5000 bytes one?

EDIT: Given that case...it would be possible to subdivide the data to send and establish in the protocol header that the complete message will be sub-divided, right? So it is not up to the w5200 but how the protocol's header is built [quote=""irina_kim, post:20, topic:6295""]
About the sub-divide, I think the lwip function is already built in.
[/quote]

To avoid opening a new thread.....Is it possible to subdivide also with the hardwire tcp/ip stack? In the case to send something larger that the 8kb buffer (considering using only one socket) I think it can't send the data larger the 8K buffer at one time about one packet
The data tha can fit in a packet is less than 1500 bytes and I don't know what it means to send 8 kbytes at a time.

Previously I said ,About the sub-divide, I think the lwip function is already built in......","Q) Wouldn't then be an option the MACRAW mode when I need more than 8 sockets?
A) yes, you should use “MACRAW” mode if you need more than 8 sockets. In that case, you should port S/W TCP/IP like LwIP on your firmware(software).

Q) Why?
A) W5200, W5500, W6100 can support 8 sockets (8 TCP connections). Please don't use W5200 for your new design. please use W5500 or W6100.

Q) Do I need to first have socket 1 to 7 in use before I can start with MACRAW?
A) No, you don't need to use 1~7 socket, Just use ""MACRAW"" socket 0 for all connections. (but you need to port S/W TCP/IP stack). If you use only MACRAW mode, S/W TCP/IP stack could send response packets. Please check the software part.

Q) Following the datasheet, from the W5200 side, setting the mode and opening the socket, shouldn't I have been able to receive an Ethernet package?
A) No, when you use ""MACRAW"", W5200 just checks your MAC address. All Broadcast packet and packets with having destination MAC address same as your setting on W5200 will be received. W5200 doesn't see any port number & IP address, just looks for MAC. In case of ""MACRAW"" mode, S/W stack should care for IP, Port filter and processing.

Q) But from the pc I can send over TCP/IP by choosing IP and port which will be in the Ethernet package that I will read in the W5200, or not?
A) Yes, that is exactly what I want.

Q) So the question is if I need to do something different then on the PC side as I do when I have a socket with the hardwire TCP/IP?
A) pls check MAC address on W5200. is it same when you used H/W stack?
"
3441,63,"[## Arduino / Ethernet Shield?? ARM mbed Platform???Â¬Ã­ÂÂ¨???Â¤Ã­ÂÂ ?ÂÃ¬ÂÂ¤ ?ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´ ##](/t/about-the-category/63)

---

 - Arduino Platform Ã«Â³Â´Ã«ÂÂ
  - [WizArduino M0 Eth](http://wizwiki.net/wiki/doku.php?id=osh:wizarduino_m0_eth:start)
  - [WizArduino Mega WiFi](http://wizwiki.net/wiki/doku.php?id=osh:wizarduino_mega_wifi:start)
 - Arduino Shield Ã«Â³Â´Ã«ÂÂ
  - [W5200 Ethernet Shield](http://www.wiznet.io/product-item/w5200-ethernet-shield/)
  - [W5500 Ethernet Shield](http://wizwiki.net/wiki/doku.php?id=osh:w5500_ethernet_shield:start)
  - [ioShield-A](http://wizwiki.net/wiki/doku.php?id=osh:ioshield-a:start)
 - ARM mbed Platform Ã«Â³Â´Ã«ÂÂ
  - [WIZwiki-W7500](http://wizwiki.net/wiki/doku.php?id=products:wizwiki_w7500:start) (Arduino UNO H/W pin compatible)
  - [WIZwiki-W7500P](http://wizwiki.net/wiki/doku.php?id=products:wizwiki_w7500p:start) (Arduino UNO H/W pin compatible)
  - [WIZwiki-W7500ECO](http://wizwiki.net/wiki/doku.php?id=products:wizwiki-w7500eco:start)
 - ÃªÂ·???
  - [ioShield-K](http://wizwiki.net/wiki/doku.php?id=osh:ioshield-k:start) : KURUMI
  - [ioShield-L](http://wizwiki.net/wiki/doku.php?id=osh:ioshield-l:start) : MSP430 (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) This is a user who uses Wizarduino Mega WiFi.
I am using a UDP client, but the packet transfer is only once every second.
Can't you send it faster?
#include ""wizfi310.h""
#include ""wizfi310udp.h""
Use.","Q) I am using a UDP client, but the packet transfer is only once every second. Can't you send it faster?  
A) You can try modifying the code to use a more efficient method for packet transfer. Consider optimizing the network communication and the code for better performance."
3442,630,"Hi,

My board already has a high efficiency 1.8V switching regulator implemented.  I am wondering (as I see no documentation for this) whether the onboard 1.8V (I presume LDO) can be disabled and the 1.8V be supplied (nice filtered and ripple free) to the Analog and Digital 1.8V pins?

Thanks.

_Michael Hello Michael,

LDO of W5200 can not be disabled.
So you'd better use internal LDO of W5200.

WIZnet has already released a new chip.
It's W5500 and you can find easily on WIZnet website.
The functionallity is all most same.

Thanks,

JC Kim will the code for 5200 work with 5500? Maybe it is similar 
please refer this page to [url]http://wizwiki.net/wiki/doku.php?id=products:w5500:driver[/url]
You could get the more information about this.
Good luck to you~~","Q) My board already has a high efficiency 1.8V switching regulator implemented.  I am wondering (as I see no documentation for this) whether the onboard 1.8V (I presume LDO) can be disabled and the 1.8V be supplied (nice filtered and ripple free) to the Analog and Digital 1.8V pins?
Thanks.
_Michael 

Q) will the code for 5200 work with 5500? Maybe it is similar?

A) LDO of W5200 can not be disabled. So you'd better use the internal LDO of W5200. WIZnet has already released a new chip. It's W5500 and you can find easily on WIZnet website. The functionality is almost the same. Please refer to this page [url]http://wizwiki.net/wiki/doku.php?id=products:w5500:driver[/url] to get more information about this. Good luck to you~~"
3443,6300,"Hello,
Where I can find library for mini W5500 Ethernet compatible with NodeMCU+esp8266 ?

Thank you. hi, mehrzad329

There are alot of w5500 clone board. 
I think mini W5500 ethernet is not wiznet official product.
Cloud you share the product link?

And this is the official library for W5500. You can use this library for the product.
https://github.com/Wiznet/ioLibrary_Driver

Thank you Hi,lawrence
Thanks for your reply

I bought this module.
If it's not wiznet official product, what is your suggestion?
I'm looking for a mini ethernet to work with NodeMCU+ESP8266.

Thank you.

https://www.aliexpress.com/item/32912313798.html?spm=a2g0o.productlist.0.0.217c527dOU7kCP&algo_pvid=8e5f4bbd-35f9-4823-9d14-6059c23872d7&algo_expid=8e5f4bbd-35f9-4823-9d14-6059c23872d7-6&btsid=6c30bb18-ef61-4b8d-a6f6-9ab91aacb00e&ws_ab_test=searchweb0_0,searchweb201602_2,searchweb201603_53 Thank you for your sharing.

This is wiznet official module and the function is all the same.
https://www.wiznet.io/product-item/wiz850io/

I think you can keep using the module you bought with iolibrary I shared. 

And also you can use arduino ethernet library for w5500.
If the board you want to use has SPI interface, you can use the module. no problem.

I have never used NodeMCU, but if you share any problem or issue with it, it will be so helpful.

Thank you","Q) Where I can find a library for mini W5500 Ethernet compatible with NodeMCU+esp8266?
Q) If it's not wiznet official product, what is your suggestion?
Q) I'm looking for a mini Ethernet to work with NodeMCU+ESP8266.

A) There are a lot of w5500 clone boards. I think mini W5500 Ethernet is not a Wiznet official product. Could you share the product link? And this is the official library for W5500. You can use this library for the product: https://github.com/Wiznet/ioLibrary_Driver

A) This is Wiznet official module and the function is all the same: https://www.wiznet.io/product-item/wiz850io/. I think you can keep using the module you bought with the ioLibrary I shared. And also, you can use the Arduino Ethernet library for w5500. If the board you want to use has an SPI interface, you can use the module without any problem. I have never used NodeMCU, but if you share any problem or issue with it, it will be so helpful."
3444,6302,"[W3150A+] [W5100] [W5200] [W5300] [W5500] [W5100s]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------
hello?

The circuit using the W5500 and the STM32F103 is used before, so I think you can use it.

I would like to connect the internet on the mobile phone (Android) and display the remote control and remote data (temperature, humidity) on the mobile phone.

I wonder if there are related education or materials. hello

Currently, there are no IoT courses with 5500.

However, IoT courses using wireless communications such as WiFi and LORA are in progress every month.(Please refer to the link below)
https://wiznetacademy.com/index.php?module=LECTURELE=DISPCourseInfoSeq=4688

If you want to carry out the motion you want with the existing 5500,
You can operate the 5500 as a server and set it to access from your phone via your owner.

thank you hello

First of all, did you decide on the medium to use on your phone?
For the app, Blynk
For the cloud, you can recommend Thingspeak, Ubidots, etc.
Or there is a way to make the W5500 into a web server and access the website from your mobile phone. hello?
Thank you for quick response.
I'm not sure what the medium to use on my phone.
I plan to create an Android app.

As others answered, put the W5500 in server mode.Can I access the IP router using DDNS? Will the following articles be a reference?
Introducing blog posts that can be easily controlled with Wiznet app.
There is only Arduino example, but the sauce is all open, so it seems to be a reference.

https://ts.devbj.com/568
https://ts.devbj.com/570
https://ts.devbj.com/579","Q) I wonder if there are related education or materials for connecting the internet on the mobile phone and displaying remote control and remote data (temperature, humidity) on the mobile phone. 
Q) First of all, did you decide on the medium to use on your phone? 
Q) Can I access the IP router using DDNS? Will the following articles be a reference? 

A) Currently, there are no IoT courses with W5500. However, IoT courses using wireless communications such as WiFi and LORA are in progress every month. If you want to carry out the motion you want with the existing W5500, you can operate the W5500 as a server and set it to access from your phone via your owner. For the app, Blynk, and for the cloud, you can recommend Thingspeak, Ubidots, etc. There is also a way to make the W5500 into a web server and access the website from your mobile phone. Regarding accessing the IP router using DDNS, the following articles can be a good reference:
- https://ts.devbj.com/568
- https://ts.devbj.com/570
- https://ts.devbj.com/579"
3445,6304,"Hello,

We are using the WIZ550S2E (HW Rev 1.1, SW Rev 1.0.3)  in our product. Recently we've started using WIZ550S2E Rev 1.2 (with the same SW Rev. 1.0.3), but its Ethernel link stopped working (with same application); the Ethernet communication can't be established and both PHY LED's are OFF. When WIZ is replaced to previous HW Rev. 1.1 the problem disappears and it works OK once again. The WIZ in or system is connected to ETH/OP card that is OK, if connected directly to external switch. The new WIZ Rev 1.2 also works OK if connected directly to external switch. Voltage and other WIZ signals looks OK. Serial communication with WIZ is established and WIZ responds OK, except Ethernet.

Pls, advise what may be the problem. It looks that it is somehow related to the Rev. 1.2 HW changes.

Thanks,
Pasternak Arie. Dear Ariep

Thank you for your questions. I'll leave you an answer after checking it.

Thank you.

Scott Hello,

We are experiencing a similar issue.  We have been using firmware v1.03 with h/w v1.1 for several years.   We recently received a new batch of WIZ550S2E modules that are hardware v1.2 and firmware v1.4.  When we connect to the new 1.2 version on port 5000, it drops the connection after about 4 seconds.  Please advise as to what is going on and how we can get the connection to stay open as it does in the V1.1 version.

Thanks,

Ken Dear kneeld,

First of all, thanks for using our products!
Regarding your issue, would you mind to inform us what version of Config tool you are using?
Since you are using firmware v1.4, we recommend using latest version of config tool, which is available here: https://github.com/Wiznet/WIZnet_Configuration_Tool

Should you have any questions, do not hesitate to contact us.

Thanks,
Viktor","Q) Pls, advise what may be the problem. It looks that it is somehow related to the Rev. 1.2 HW changes.
A) It seems that the issue may be related to the hardware changes made in the WIZ550S2E Rev 1.2. You may want to check for any differences in the hardware specifications between the two revisions and investigate if any changes are causing the Ethernet link problem. 

Q) We recently received a new batch of WIZ550S2E modules that are hardware v1.2 and firmware v1.4.  When we connect to the new 1.2 version on port 5000, it drops the connection after about 4 seconds.  Please advise as to what is going on and how we can get the connection to stay open as it does in the V1.1 version.
A) It seems like the issue might be related to the communication settings or firmware differences between WIZ550S2E hardware v1.1 and v1.2. I recommend checking if there are any changes in the communication protocol or settings between the firmware v1.03 and v1.4. Also, ensure that you are using the latest version of the config tool, which is compatible with the firmware v1.4. You can download the latest version of the config tool from https://github.com/Wiznet/WIZnet_Configuration_Tool. If the problem persists, feel free to reach out for further assistance."
3446,6305,"Hi there,
I keep testing the module, and detected that the network instructions state that they are being saved, without calling the MPROF=S at instruction.
Y tested multiple time and noted that if i set up the network configuration, and reset the module without calling the MPROF=S instruction, that configuration get lost. Hey there,
thanks for the follow, those commands that i was talking about, were precisaly wset, wnet and wsec, they are not being stored, when i called them. I checked this by set them up, and then resetting the module, it will always start with the default configurations.
So, what i think is that every configuration must be stored by using MPROF=S, the datasheet is wrong about the commands that states ""autosaving"" thanks, I will check about that","Q) So, what i think is that every configuration must be stored by using MPROF=S, the datasheet is wrong about the commands that states ""autosaving"" thanks, I will check about that
A) The MPROF=S instruction is necessary to store the network configuration. It seems like the datasheet is incorrect about the ""autosaving"" feature. Thank you for bringing this to my attention."
3447,6306,"Hey there, as part of the continuous testing of this module that i'm running, i found the func pin, that triggers some ""events"", i would like to know if there is anyway to execute the AP mode ran by this pin, through at commands.
Actually it has a cool feature, that is the name of network being used, that contains the MAC of the device, i want to trigger that configuration, through at commands.
Can you please point me out how to do this?

Thanks I understood that you'd like to execute the AP mode with MAC address using AT commands
Right?

there is no software trigger to set configuration with just one command.
but you can see the MAC address using AT+MMAC=?
then you should make SSID using MAC address


the FUNC pin is defined 2 functions.
if it triggered once, the module will start AP mode as you know. and run TCP Server using 5000 port.
if it triggered 3 times, the module will set initial(factory default) configurations. Yes i wanted to run the func pin AP mode with one command, the default ssid should contain the MAC address, because as it's now, every module has the same default SSID, that it's not useful, that's why i wanted to run or trigger the AP mode of the func pin in one go.
So many design issues with this module yes, I agree your opinion.
and now the WizFi310 doesn't provide that function.
why don't you try to set the AP mode with several commands like +MMAC to get the MAC address. Yes, is actually what i did, even though, that way cost me memory and processing time, that in bare metal embedded systems mean wasted of resources.
That also means to detour the current developed work flow of the wifi layer, to make this is required to develop an ""internal"" state machine for this module, so it can handle multiple instructions in the ""background"", to simulate one (actually slower) instruction for the general wifi layer state machine.
Anyways, it is as it is, thanks for your support","Q) I found the func pin that triggers some ""events,"" and I would like to know if there is any way to execute the AP mode using AT commands. Can you please point me out how to do this?
A) I understood that you'd like to execute the AP mode with MAC address using AT commands. There is no software trigger to set configuration with just one command. But you can see the MAC address using AT+MMAC=? and then you should make SSID using MAC address.

Q) Yes, I wanted to run the func pin AP mode with one command. The default SSID should contain the MAC address, because as it is now, every module has the same default SSID, which is not useful. That's why I wanted to run or trigger the AP mode of the func pin in one go.
A) The FUNC pin is defined 2 functions. If it triggered once, the module will start AP mode and run TCP Server using 5000 port. If it triggered 3 times, the module will set initial (factory default) configurations. But the WizFi310 doesn't provide that function. Why don't you try to set the AP mode with several commands like +MMAC to get the MAC address?

Q) Even though, that way cost me memory and processing time, that in bare metal embedded systems mean a waste of resources. That also means to detour the current developed workflow of the wifi layer, to make this is required to develop an ""internal"" state machine for this module, so it can handle multiple instructions in the ""background,"" to simulate one (actually slower) instruction for the general wifi layer state machine.
A) So many design issues with this module, yes, I agree with your opinion. It is as it is, thanks for your support."
3448,6308,"hello.

We have confirmed that the 1.2V part of the hardware development is the resistance value.

Please check if there is a resistance value.

In addition, please contact KEIL compilation.

thank you The question was solved by a visit.

Resolution
 -Keil has no separate parts, so I informed you of conversion through stcubemx,
 -WIZ610IO The part that does not operate was changed by using the Arudino Ethernet Library.
 -The hardware part decided to review the documents by e -mail. ","Q) Please check if there is a resistance value. In addition, please contact KEIL compilation.
A) The resistance value for the 1.2V part of the hardware development has been confirmed. As for the KEIL compilation, it has been informed that there are no separate parts, so the conversion has been done through stcubemx."
3449,631,"SW1 Do you power off and connect to ground and power back up and then search?
SW1 Do just connect to ground while the power is on?
J1 1-5 are any of those jumped at the same time or are they required to reset to factory.
Nothing I have tried works for me.
Everything just remains the same. Hello safe1234,

the method I am using is the following: If I notice I have to reset a module and it's running I connect to the serial port. Then I just shorten both pins of JP1 (with a scissor or a screwdriver or something you can firmly press on both holes of JP1) and power cycle the module. Then I can see on the serial console that the module has been reset to factory default. I release the screwdriver/scissor/tool and power cycle the module again. it is then booting with the factory defaults. What did you use to shorten the pins of JP1?

Best regards,
Felix","Q) What did you use to shorten the pins of JP1?
A) If I notice I have to reset a module and it's running I connect to the serial port. Then I just shorten both pins of JP1 (with a scissor or a screwdriver or something you can firmly press on both holes of JP1) and power cycle the module. Then I can see on the serial console that the module has been reset to factory default. I release the screwdriver/scissor/tool and power cycle the module again. it is then booting with the factory defaults. 
"
3450,6310,"I hope that there is a developer manual for linking with the WizNet App See below, reflect APP development.
https://forum.wiznet.io/t/topic/6414?u=bong ","Q) Is there a developer manual for linking with the WizNet App? 
A) You can find the developer manual for linking with the WizNet App at the following link: https://forum.wiznet.io/t/topic/6414"
3451,6312,"Multicast Receive?????ÂÃ«ÂÂ??SendÃªÂ°? ?ÂÃ«ÂÂ??Ã«Â¬Â¸Ã¬ÂÂ ?ÂÃ«Â¦Â½?ÂÃ«ÂÂ¤.

-------------------------------------------------------------

   // Multicast init
    setSn_DHAR(3, wizInfo.mac);
    setSn_DIPR(3, MultiAddress);
    setSn_DPORT(3, 53256);
    socket(3, Sn_MR_UDP, 5325, Sn_MR_MULTI);

   sendto(0x03, multicastSendBuf, length, MultiAddress, 53256);

------------------------------------------------------------------------------------------

1. Wireshark?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ¸ ?Â´Ã«Â³Â´?ÂÃ¬ÂÂ ??IGMP JOIN?ÂÃ«ÂÂ ?Â¨Ã­ÂÂ·????Ã«Â³Â´Ã¬ÂÂ´?ÂÃ«ÂÂ° join???ÂÃ«ÂÂ ÃªÂ±Â´Ãª???
2. Send?????Â¹Ã¬ÂÂ Ã¬Â¶ÂÃª? ?Â´Ã¬ÂÂ¼???Â´Ã¬ÂÂ©???ÂÃ¬ÂÂÃªÂ¹ÂÃ¬ÂÂ? 1. MEMBERSHIP REPOUP XXX.XXX.XXX.XXX (iPaddress)
Can't you see the message above?
If you see, you can see the packet as a Join packet.
2. There is no need to be added. Mac address setting was wrong.

Thank you for your help.","Q) Wireshark?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ¸ ?Â´Ã«Â³Â´?ÂÃ¬ÂÂ ??IGMP JOIN?ÂÃ«ÂÂ ?Â¨Ã­ÂÂ·????Ã«Â³Â´Ã¬ÂÂ´?ÂÃ«ÂÂ° join???ÂÃ«ÂÂ ÃªÂ±Â´Ãª?? 
Can't you see the message above? If you see, you can see the packet as a Join packet.

A) 1. MEMBERSHIP REPOUP XXX.XXX.XXX.XXX (iPaddress)
2. There is no need to be added. Mac address setting was wrong."
3452,6314,"Hello;

I have both w5500 and w5200 chipset. I'm transferring data over the UDP protocol. Receive buffers were normally defined as 2048 bytes in the library. How can I reduce the buffer because I want to work in real time. Could you help? See Section 3.3 of the manual, on page 32 for detailed information about setting Tx and Rx buffer sizes for each socket. But you don't need to adjust buffer sizes to process data in real time; you can detect the presence of data in a socket's Rx buffer and read anything from a single byte to the entire buffer contents regardless of buffer size. If you are using WIZnet's ioLibrary, the buffer size is initialized through ctlwizchip().

    uint8_t memsize[2][8] = { { 2, 2, 2, 2, 2, 2, 2, 2 }, { 2, 2, 2, 2, 2, 2, 2, 2 } };

    	if (ctlwizchip(CW_INIT_WIZCHIP, (void*) memsize) == -1) {
    		printf(""WIZCHIP Initialized fail.\r\n"");
    		while (1);
    	} (post withdrawn by author, will be automatically deleted in 24 hours unless flagged) Thanks for your answer. 

I am listening to messages in a certain period. When the connection level gets worse during wireless communication, the buffer becomes full when I cannot read. So it can't work in real time. I think that if I reduce the rx buffer size of the card I will overcome the problem. [quote=""unknown, post:4, topic:6314, full:true""]
I am using the arduino library. I try to reduce buffer sharing by increasing the number of sockets, but the card does not receive data. The definition of buffer in the library is as follows.

//
#define TX_RX_MAX_BUF_SIZE 2048
#define TX_BUF 0x1100
#define RX_BUF (TX_BUF + TX_RX_MAX_BUF_SIZE)

#define TXBUF_BASE 0x8000
#define RXBUF_BASE 0xC000

writeMR(1<<RST);

for (int i=0; i<MAX_SOCK_NUM; i++) {
write((0x4000 + i * 0x100 + 0x001F), 2);
write((0x4000 + i * 0x100 + 0x001E), 2);
}
for (int i=0; i<MAX_SOCK_NUM; i++) {
SBASE[i] = TXBUF_BASE + SSIZE * i;
RBASE[i] = RXBUF_BASE + RSIZE * i;
}
}
//

//
private:
static const uint8_t RST = 7; // Reset BIT
static const int SOCKETS = 8;
static const uint16_t SMASK = 0x07FF; // Tx buffer MASK
static const uint16_t RMASK = 0x07FF; // Rx buffer MASK
public:
static const uint16_t SSIZE = 2048; // Max Tx buffer size
private:
static const uint16_t RSIZE = 2048; // Max Rx buffer size
uint16_t SBASE[SOCKETS]; // Tx buffer base address
uint16_t RBASE[SOCKETS]; // Rx buffer base address
//
[/quote]

I am using the arduino library. I try to reduce buffer sharing by increasing the number of sockets, but the card does not receive data. The definition of buffer in the library is as follows.

//
#define TX_RX_MAX_BUF_SIZE 2048
#define TX_BUF 0x1100
#define RX_BUF (TX_BUF + TX_RX_MAX_BUF_SIZE)

#define TXBUF_BASE 0x8000
#define RXBUF_BASE 0xC000

writeMR(1<<RST);

for (int i=0; i<MAX_SOCK_NUM; i++) {
write((0x4000 + i * 0x100 + 0x001F), 2);
write((0x4000 + i * 0x100 + 0x001E), 2);
}
for (int i=0; i<MAX_SOCK_NUM; i++) {
SBASE[i] = TXBUF_BASE + SSIZE * i;
RBASE[i] = RXBUF_BASE + RSIZE * i;
}
}
//

//
private:
static const uint8_t RST = 7; // Reset BIT
static const int SOCKETS = 8;
static const uint16_t SMASK = 0x07FF; // Tx buffer MASK
static const uint16_t RMASK = 0x07FF; // Rx buffer MASK
public:
static const uint16_t SSIZE = 2048; // Max Tx buffer size
private:
static const uint16_t RSIZE = 2048; // Max Rx buffer size
uint16_t SBASE[SOCKETS]; // Tx buffer base address
uint16_t RBASE[SOCKETS]; // Rx buffer base address
// If your system is receiving data from some source that's producing it faster than you can process it, making your receive buffer smaller will make your problem worse rather than better. You can think of the receive buffer as a handy place to keep data until your software gets around to reading it into memory and processing it. Making the receive buffer smaller will back up the sender and delay making data available to your code. It won't slow down the rate at which data is created.

If you describe the application you're implementing in more detail, including how data is generated and delivered to your system I may be able to help more.  I don't understand your comment about wireless data, since both W5500 and W5200 support wired Ethernet.","Q) How can I reduce the buffer size for real-time data transfer over UDP using the W5500 and W5200 chipsets?
A) You don't need to adjust buffer sizes to process data in real time; you can detect the presence of data in a socket's Rx buffer and read anything from a single byte to the entire buffer contents regardless of buffer size. If using WIZnet's ioLibrary, the buffer size is initialized through ctlwizchip(). However, making the receive buffer smaller will back up the sender and delay making data available to your code. It won't slow down the rate at which data is created. If you describe the application you're implementing in more detail, including how data is generated and delivered to your system, I may be able to help more. 

Q) How can I overcome the problem of the buffer becoming full during wireless communication, making it impossible to read and work in real-time?
A) If your system is receiving data from some source that's producing it faster than you can process it, making your receive buffer smaller will make your problem worse rather than better. 

Q) Is wireless communication supported by the W5500 and W5200 chipsets?
A) I don't understand your comment about wireless data, since both W5500 and W5200 support wired Ethernet."
3453,632,"Wizfi210 module is used as a server.

After communication with the client and TCP socket,

The serial connection sends the following AT commands:

--------------------------------
+++
WAIT (1.2);

AT & F
WAIT (0.01);

ATE1
WAIT (0.01);

At+wd
WAIT (0.01);

At+Wauto = 0, koca
WAIT (0.01);

At+wauth = 0
WAIT (0.01);

At+wwpa = koca1111
WAIT (0.01);

At+ndhcp = 0
WAIT (0.01);

AT+NSET = 192.168.0.51,255.255.255.0,192.168.0.1
 WAIT (0.01);

At+nauto = 1,1,, 4231
WAIT (0.01);

At+xdum = 10
WAIT (0.01);

At+xar = 10
WAIT (0.01);

ATA
WAIT (0.1);
---------------------------------------------
==> Response

[DISCONNECT 1]
AT & F

[OK]
    IP SUBNET GATEWAY
 192.168.0.51: 255.255.255.0: 192.168.0.1
[OK]
-----------------------------------------------
Initially, the [OK] response to all AT commands was returned, but after the socket communication,

If you blow the AT command again,

As described above, there are no response [OK].

Which part is there? hello

Among the commands you used, the parameter of the AT+XDUM command seems to have used a parameter that is not defined.Please confirm this.

The detailed description of AT+XDUM is as follows.

[Quote]
At+xdum = n = 1 (disable) = 0 (enable)

If 1, UART MESSAGE is Disabled. (When Auto Connection Mode)
[/Quote] Please delete the AT+XAR command from the above command.

Depending on the environment, if the AT+XAR value is too small, the operation of AT command may not be normal.","Q) Which part is there? hello
Q)  Please confirm this. 
A) Initially, the [OK] response to all AT commands was returned, but after the socket communication, If you blow the AT command again, As described above, there are no response [OK]. Among the commands you used, the parameter of the AT+XDUM command seems to have used a parameter that is not defined.


A) The detailed description of AT+XDUM is as follows: At+xdum = n = 1 (disable) = 0 (enable). If 1, UART MESSAGE is Disabled. (When Auto Connection Mode). Depending on the environment, if the AT+XAR value is too small, the operation of AT command may not be normal."
3454,6323,"I would like to contact you because there is a problem that cannot be solved in the Ethernet ping test.

The phenomenon is as follows.

<Ethernet communication interlocation test>

1. Configuration
 * Ethernet network composition through herbs
 1) Controller-1 (PPC/VXWORKS, MVME2502) <-> Controller-2 (DSP, W5500)
 2) Controller-1 (PPC/VXWORKS, MVME2502) <-> W5500 Ethernet Shield (Atmega, W5500)
 3) Controller-2 (DSP, W5500) <-> W5500 Ethernet Shield (Atmega, W5500)
 4) Controller-1 (PPC/VXWORKS, MVME2502) <-> PC (Windows10)
 5) Controller-2 (DSP, W5500) <-> PC (Windows10)

2. phenomenon
  -Ping test by changing speed (10m/100m/auto) and duplex (full/half)
  -1) Ping test failure when configuration / 2), 3), 4), 5) Ping test success

When you send a pc and controller 1 or PC and a controller 2, the response comes properly, and when you send it to the controller 2 in the controller 1, the response does not come properly.

We have confirmed that the IP and Mac between the members are different. We also checked the contents you sent by e -mail

If the board you made with the W5500 is called A, Ethernet Shield.
 -A is communication with your PC, and it is not communication with MVMe2502 (VXWORKS).
 -B is well communicated with PC, MVMe2502 (VXWORKS).

That is not the problem of the Software in the W5500.
In addition, if you connect to MVMe2502 (VXWORKS), you should also check whether LINK is connected to A.

In the case of A, the board was made using the W5500, so the hardware engineer requested the artwork and the Schematic review.

Afterwards, the hardware engineer will answer.
@Scott The MAC address is set to multicast, so the phenomenon has been solved by modifying it to Unicast.

One question is that when communicating with a PC, it responds regardless of multicast/ unicast, while VME only responds only in Unicast.

Thank you for your help. In the case of a PC, I know that it will be accepted unless you set up Multicast/ Unicast.
I haven't used VME, but in the case of VME, these settings may be the default (option to prevent multicast).

It is fortunate that it has been solved.
If you are at any time, please leave a post. ","Q) What is the phenomenon you are experiencing with the Ethernet ping test? 
A) When sending a PC to Controller 1 or PC to Controller 2, the response comes properly, but when sending it to Controller 2 in Controller 1, the response does not come properly. We have confirmed that the IP and Mac between the members are different.

Q) What have you confirmed about the boards made with the W5500? 
A) The board made with the W5500, called A, is in communication with the PC, but not in communication with MVMe2502 (VXWORKS). Another board, B, is well-communicated with PC and MVMe2502 (VXWORKS). It was confirmed that the MAC address is set to multicast, and the phenomenon was solved by modifying it to Unicast. 

Q) What is the question regarding the communication with a PC and VME? 
A) One question is that when communicating with a PC, it responds regardless of multicast/unicast, while VME only responds only in Unicast. It is noted that in the case of VME, these settings may be the default (option to prevent multicast).

Q) What is the response to the issue? 
A) The MAC address set to multicast caused the issue, and it was resolved by modifying it to Unicast. It is fortunate that it has been solved."
3455,6326,"Hello, I am under development using the wiz145sr model.

I am trying to change various settings to Serial Port by entering Serial Command mode.

No matter what the command is sent, there is no response, so I leave this article.

1. I changed the hw trigger SW.

2. Baud, Data, Parity, Flow, and then opened the Cyrus Port.

3. We called the simplest command R_IP.
    ex) <r_ip> -> 3C525F49503E
I called all the viral hexa, but there was no response.

I was wondering if I had missed something or a serial communication in a different way

Leave a post. ","Q) I was trying to change various settings to the Serial Port by entering Serial Command mode, but no matter what command I sent, there was no response. Have I missed something or is there a different way to do serial communication?
A) In serial command mode, make sure you have set the correct baud rate, data bits, parity, and flow control. Additionally, ensure that the hardware trigger switch is properly configured. Double-check the command syntax and verify the serial communication settings."
3456,6328,"Hello, I am developing as a wiz145sr model.

I want to change the settings to the cereal command mode, but there is no response even if I send a command

Leave a post.

On the hardware trigger mode

To suit the serial command format

I sent <r_ip> and there is no response.If you send it to the hexa value of 3C525F49503E,

I have no response on the device, so I would like to ask if I was missing or other ways. If you use the 145sr configuration tool, isn't the setting right?

The latest firmware version has been up to 1.6.8.
Which firmware is currently being used?

Please refer to the Page link with 145sr related tools, firmware and manuals.
https://www.wiznet.io/product-item/wiz145sr/ Can I test serial commands on 145sr configuration tool?

The firmware version is also 1.6.8.

1.HW Trigger SW changed.


2. BAUD, Data, Parity, Flow, and then opened the Cyrus Port.


3. We called the simplest command R_IP.
ex) <r_ip> -> 3C525F49503E
I called all the viral hexa, but there was no response.
 
Is there any way to check if you entered the Command mode?

I was wondering if I had missed something or a serial communication in a different way

Leave a post. thank you
I've been wandering since last Friday
Thanks to this, it was solved well.","Q) Can I test serial commands on 145sr configuration tool?
A) Yes, you can test serial commands on the 145sr configuration tool. 

Q) Which firmware is currently being used?
A) The firmware version currently being used is 1.6.8. 

Q) Is there any way to check if you entered the Command mode?
A) To check if you entered the Command mode, you can use the 145sr configuration tool, and ensure that the settings are correct to suit the serial command format. 

Q) I want to change the settings to the cereal command mode, but there is no response even if I send a command. Is there any way to check if you entered the Command mode?
A) It seems like there might be an issue with the settings or the method of sending the command. Make sure to follow the proper steps and settings to enter the cereal command mode. If you are still experiencing issues, referring to the 145sr related tools, firmware, and manuals provided on the Wiznet website could be helpful in resolving the issue."
3457,633,"Halo,
I'm trying to setup a simple webservice server on your wiz550io board and faced some strange behavior. Please explain what a I doing wrong and how to fix it. Heres what I do:

first I reset w5500 and wait for its RDY signal:
[code]gpio_set_pin_high(LAN_RST);
delay_ms(500);
gpio_set_pin_low(LAN_RST);
delay_ms(500);
gpio_set_pin_high(LAN_RST); 
while ( gpio_pin_is_low( LAN_RDY ) );	
// follow below[/code]

then I initiate w5500 with default buffers size:
[code]reg_wizchip_cs_cbfunc(wizchip_select, wizchip_deselect);
reg_wizchip_spi_cbfunc(wizchip_read, wizchip_write);	 
wizchip_init( null,null );
// follow below[/code]

next I initiate interrupt:
[code]cpu_irq_disable();     
ext_int_set_interrupt_callback( LAN_INT, lan_int_callback );
ext_int_init( LAN_INT, IOPORT_SENSE_FALLING );
wizchip_setinterruptmask( IK_SOCK_3 );
ctlsocket( 3, CS_SET_INTMASK, SIK_ALL );
cpu_irq_enable();		 
// follow below[/code]

open socket, put it on listen and wait:
[code]socket(3,Sn_MR_TCP,80,SF_TCP_NODELAY);	 
listen(3);
while(1);
// follow below[/code]

my irq callback looks as follows:
[code]static void lan_int_callback(void)
{		
	ctlsocket(3, CS_GET_INTERRUPT, &i );	
 	switch( getSn_SR(3) )
	{
		case SOCK_ESTABLISHED:
			if( getSn_IR(3) & Sn_IR_CON )
			{
				WIZCHIP_WRITE( getSn_IR(3), Sn_IR_CON );
			}
			if( getSn_IR(3) & Sn_IR_RECV )
			{
				int8_t  len = recv( 3, &buf, 20 );
				send( 3, &buf, len );
				disconnect(3);
				lan_int_callback(); // <- no SIK_DISCONNECTED
			}
			break;			
		case SOCK_CLOSE_WAIT:
			disconnect(3);
			break;
		case SOCK_CLOSED:
			close(3);
			socket(3,Sn_MR_TCP,80,SF_TCP_NODELAY);
		case SOCK_INIT:
			listen(3);
			break;			
	}
	ctlsocket(3, CS_CLR_INTERRUPT, &i );	
}[/code]

Heres what the problems are:

1. once I run it, and point my browser onto [192.168.1.2/test.html](http://192.168.1.2/test.html) I recieve something ( not necessary whats expected i.e. /test.html ) after refersh I recieve something else and so on - basically it looks like the chip is sending back quite random portion of socket buffer ( sometimes it sends back expected /test.html but only from time to time )

2. I never recieve interrupts other than SIK_CONNECTED and SIK_RECEIVED so I need to reinvoke irq callback manually after disconnecting client in line marked with // <- no SIK_DISCONNECTED

3. after quick repeating tries to connect from client ( I keep F5 in my browser pushed for a couple of seconds ) the whole thing simply hangs and mu browser shows ""the connection has been reset"" forever

Thanks a lot in advance :slight_smile: Hi,

Below is my recommendation for your debugging.
-. Disable the interrupt and use polling because normally polling is easy to debug.
-. Use the wireshark([url]wireshark.org[/url]) to capture the packet. This tool is required to see how packet is sent and received.
-. Check your board can receive / send the data correctly before you test the webserver function.

What kind of MCU do you use?
We already port our driver to some general MCU and if you use same one, I think you don't need to develop it from the scratch.  :smiley: 

JB Hi JB,
thanks for your advice, I'll try it today and inform back :slight_smile:
I'm using atmega ( atmega256rfr2 to be precise ) w/o arduino and objective cpp - just c as you do in your driver.
Slaw","Q) I'm trying to setup a simple webservice server on your wiz550io board and faced some strange behavior. Please explain what a I doing wrong and how to fix it. 
Q) What kind of MCU do you use? 
Q) Hi JB, thanks for your advice, I'll try it today and inform back :slight_smile: I'm using atmega ( atmega256rfr2 to be precise ) w/o arduino and objective cpp - just c as you do in your driver.  

A) Below is my recommendation for your debugging.
-. Disable the interrupt and use polling because normally polling is easy to debug.
-. Use the wireshark([url]wireshark.org[/url]) to capture the packet. This tool is required to see how packet is sent and received.
-. Check your board can receive / send the data correctly before you test the webserver function.
A) We already port our driver to some general MCU and if you use same one, I think you don't need to develop it from the scratch.  :smiley:"
3458,6330,"Hello, Sorry for late response.
I told hardware engineer about your question.
He will response about it.

@Scott Dear p.wagner.

Is the pad you're talking about in the middle of the QFN?

if so,

We recommend connecting the pad to GND. And recommended to add via. But not must.

Normally connect GND and add vias.

Thank you","Q) Is the pad you're talking about in the middle of the QFN? 
A) We recommend connecting the pad to GND and recommended to add via, but it's not a must. Normally, connect GND and add vias. Thank you."
3459,6331,"[quote=""Caspar, post:1, topic:6331""]
while(getPHYCFGR() & PHYCFGR_LNK_ON); // PHYCFGR_LNK_ON (1<<0)
[/quote]
I think you have to fix it such as below:
while(!(getPHYCFGR() & PHYCFGR_LNK_ON)); Hi Becky, 

Yes you are right, that's a mistake in my code. Thank you for noticing, i changed it in my code. Unfortunately this is not the solution to my problem. The module still fails to connect with the server without that 3-4 second delay. So i'm curious if there is another factor which plays a part in the initialization of the module.

Caspar When I checked the first one you captured, It is so weird cause there is no destination ip address in ARP packet.
I seems w5500 socket does not ready to send arp packet.

Could you check the socket status before do connect command?
Socket status(getSn_SR(sn)) must be SOCK_INIT(0x13) before connect() function. The wiznet module does not take much time to initialize.
I've never seen module initialization take longer than the phy link takes.
In the packet you sent, the wiznet chip sent arp, but belkin did not give a response. I think we should find out why not. First check that the arp packets sent by the wiznet module are the same in the first and second packets. In the first packet, the W5500 sent an arp request. But belkin did not give an arp response. If the w5500 does not receive an arp response, it retransmits every 200ms. However, no retransmission is seen in the first packet.
I think there are two cases.
The first is that there was more arp transmission before, but it was not visible because it was sent before  link up.
The second is that the phy link is unstable.

It is recommended to check the phy twice by modifying as follows to ensure the stability of phy
    while (1) {
      check1 = getPHYCFGR () & PHYCFGR_LNK_ON
      check2 = getPHYCFGR () & PHYCFGR_LNK_ON
      if (check == 0x01 && check2 == 0x01) break;
    } The suggestion of polling the phy link twice worked. Thank you","Q) When I checked the first one you captured, It is so weird cause there is no destination ip address in ARP packet.
I seems w5500 socket does not ready to send ARP packet. Could you check the socket status before do connect command? Socket status(getSn_SR(sn)) must be SOCK_INIT(0x13) before connect() function.
The Wiznet module does not take much time to initialize. I've never seen module initialization take longer than the PHY link takes. In the packet you sent, the W5500 sent an ARP request. But Belkin did not give an ARP response. I think we should find out why not. First, check that the ARP packets sent by the Wiznet module are the same in the first and second packets. In the first packet, the W5500 sent an ARP request. But Belkin did not give an ARP response. If the W5500 does not receive an ARP response, it retransmits every 200ms. However, no retransmission is seen in the first packet. I think there are two cases. The first is that there was more ARP transmission before, but it was not visible because it was sent before the link up. The second is that the PHY link is unstable. It is recommended to check the PHY twice by modifying as follows to ensure the stability of PHY
while (1) {
  check1 = getPHYCFGR() & PHYCFGR_LNK_ON
  check2 = getPHYCFGR() & PHYCFGR_LNK_ON
  if (check1 == 0x01 && check2 == 0x01) break;
}
A) The suggestion of polling the PHY link twice worked. Thank you."
3460,634,"I just noticed that this:

[code]uint16_t ptr;
socket(3,Sn_MR_TCP,80,SF_TCP_NODELAY);
setSn_TX_WR(3,100);
ptr = getSn_TX_WR(3);[/code]

just after wizchip_init or even this:

[code]setSn_TX_WR(sn,0);[/code]

in wiz_send_data does literally nothing... ptr remains unchanged if thats any clue? [quote=""Think01""]in wiz_send_data does literally nothing... ptr remains unchanged if thats any clue?[/quote]

That at least seems normal. In my experience, after being written to TX_WR is going to be returned as modified only after the SEND command is executed.

Kind regards, Sebastian so if I run below code at any monemt tmp will allways remain 0 right?

[code]ptr_w = getSn_TX_WR(sn);
ptr_r = getSn_TX_RD(sn);
tmp = ptr_w - ptr_r;[/code]

anyways by modifying my loopback_tcps function as follows:

[code]int32_t loopback_tcps(uint8_t sn)
{
	uint8_t i;	
	int32_t ret = recv(sn,socket_buffer,DATA_BUF_SIZE);	
	if(ret < 0)								// <- I can allways see properly received data in buf[] here
	{
		gpio_set_pin_low(LED0_GPIO);
		close(sn);
		return ret;
	}
	uint16_t j = 0;
	for(j = 0; j < DATA_BUF_SIZE; j++, 1)	socket_buffer2[j] = 42;
	for(j = 0; j < 10; j++, 1)	socket_buffer2[j] = 48+j;
	ret = send(sn,&socket_buffer2[0],DATA_BUF_SIZE);			
	if(ret < 0)
	{
		gpio_set_pin_low(LED0_GPIO);
		close(sn);
	}
	return ret;
}[/code]

and doing multiple http requests on that socket I get responses like:

[code]****************************************************************************************************************************************************************************************************************************************************************0123456789******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************[/code]

[code]0123456789**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************[/code]

[code]********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************0123456789**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************[/code]

etc. which ( because data transmitted over SPI is allways starting with 0123456789******* ) means that something is wrong with Sn_TX_WR or Sn_TX_RD, the question is what for gods sake... 

help wiznet guys, help! :slight_smile:

BTW Sn_TX_WR seems to increment properly for example 0x239F after first connect and before send, 0x23BF after sending 32 bytes, then 0xD3DF after second connect and 0xD3FF after sending another 32 bytes and so on. The only strange thing is why Sn_TX_WR is not 0x0000 after first conntect following hw reset but this might be normal also... ok, I think I found your bug... its in w5500.c in function wiz_send_data ( and propably wiz_recv_data too )

you declare:
[code]uint16_t ptr = 0;[/code]
which looks fine as getSn_TX_WR is 16-bit value but later on you do:
[code]addrsel = (ptr << 8) + (WIZCHIP_TXBUF_BLOCK(sn) << 3);[/code]
so with (ptr << 8) you basically shift a word by 8-bits left resulting 0x1234 << 8 = 0x3400 so by this you loose a most significabt byte!

in order to fix that you just need to declare
[code]uint32_t ptr = 0;[/code]
and thats it...

I wonder if there are more fruits like this in your code :/ Hi,
W5500 references codes are based on 32bit MCU as ARM.
The smaller bits MCU user often did mistake to porting the codes into user system.

We will update the code with explict type declaration & casting in near future.

Thank you. Well, if your official driver is for a specific mcu you should propably state this literally in your manual... I lost a bunch of time thrusting the code I believed is well tested, bug free and platform independent ansi c code....

Also the bug I pointed out is not target mcu issu but an ansi c bug. According to language specification if you put an expression into cupbounds its being evaluated first using an allocation unit specific for cupbounded expression. So even so it may work for 32 bit arm its not proper syntax and c campiler can but does not have to evaluate this expression using 32bit lgics ( because your code ALLOWS compiler to optimise to 16 bit value ). Thank for your serious advices.
If you have some idea, suggestions and special modification part, feel free tell to me.

Thank so much again. Thank you Think01!!!  I had experienced the same problem using an Atmel XMEGA part (XMEGA-A1 Xplained evaluation board).  After confirming my data was being sent to the W5500 correctly, I started searching this forum and ran across your post.  Your fix quickly resolved my problem and saved me a significant amount of development time.  Thanks again!

WIZnet, I'm using the latest version (v1.0.2) of the Ethernet libraries.  It appears as though it's a simple fix for you to 1.) update the library, or 2.) put a note on your wiki stating that there is a known problem with this function.  Issues like this costs us a significant amount of development time.  Bugs exists -- that's understandable; however, it's difficult to understand why we have to rediscover known issues. Hi, Think01 and bobh.

We are fixed the problem and update the driver on [url]http://www.wizwiki.net/wiki/doku.php?id=products:w5500:driver[/url].

Thank again for your serious advice & interest.","Q) so if I run below code at any monemt tmp will allways remain 0 right?
A) ptr_w = getSn_TX_WR(sn);
   ptr_r = getSn_TX_RD(sn);
   tmp = ptr_w - ptr_r;

Q) The only strange thing is why Sn_TX_WR is not 0x0000 after first conntect following hw reset but this might be normal also...
A) W5500 references codes are based on 32bit MCU as ARM.
   The smaller bits MCU user often did mistake to porting the codes into user system.

Q) ok, I think I found your bug... its in w5500.c in function wiz_send_data ( and propably wiz_recv_data too )
A) We will update the code with explict type declaration & casting in near future.

Q) Well, if your official driver is for a specific mcu you should propably state this literally in your manual... I lost a bunch of time thrusting the code I believed is well tested, bug free and platform independent ansi c code....
A) Thank for your serious advices.
   If you have some idea, suggestions and special modification part, feel free tell to me.
   Thank so much again.

Q) WIZnet, I'm using the latest version (v1.0.2) of the Ethernet libraries.  It appears as though it's a simple fix for you to 1.) update the library, or 2.) put a note on your wiki stating that there is a known problem with this function.  Issues like this costs us a significant amount of development time.  Bugs exists -- that's understandable; however, it's difficult to understand why we have to rediscover known issues.
A) We are fixed the problem and update the driver on [url]http://www.wizwiki.net/wiki/doku.php?id=products:w5500:driver[/url].
   Thank again for your serious advice & interest."
3461,635,"1. If I do not need the data in the receive buffer in UDP mode, can I just set Sn_CR to RECV without reading from RX_FIFOR? Is it necessary to copy data even if I do not need the data? Currently we are reading the data from RX_FIFOR -  since there was some suggestion from some site that this is necessary to clear the buffer to make way for new data -  and then setting RECV, but it is not required to read the data, is it not? When we set RECV, next data will simply overwrite the previous data, right?

2. If a  wiznet UDP socket port is being bombarded with continuous data (may be junk / broadcast ), how does this affect the chip? Will it cause speed issues with other sockets? Can it cause the chip to reply to pings only once, or not reply at all? Can it cause the chip not to reply to arps? 

3. What is the best way to deal with unwanted data sent to wiznet udp port? Can we check the source  port and then simply set RECV  and exit? Hi,
[quote]1. If I do not need the data in the receive buffer in UDP mode, can I just set Sn_CR to RECV without reading from RX_FIFOR? Is it necessary to copy data even if I do not need the data? Currently we are reading the data from RX_FIFOR - since there was some suggestion from some site that this is necessary to clear the buffer to make way for new data - and then setting RECV, but it is not required to read the data, is it not? When we set RECV, next data will simply overwrite the previous data, right?
[/quote]
Unfortunately, W5300 FIFO register can not be flushed. So, You should read the data even if you don't want it.
If there is only unwanted data  in socket buffer, you can flush the buffer using close and reopen the socket.
But, If there is both  unwanted data and wanted data in socket buffer, you should read FIFOR for ingnoring the unwanted data.

[quote]2. If a wiznet UDP socket port is being bombarded with continuous data (may be junk / broadcast ), how does this affect the chip? Will it cause speed issues with other sockets? Can it cause the chip to reply to pings only once, or not reply at all? Can it cause the chip not to reply to arps? 
[/quote]
When being bombarded with junk, W5300 just receives the data as many as socket buffer size and the rest bombarded data is discarded until the socket buffer is free. 
It maybe cause speed issues with other sockets because the continous bombarded data should be also read for determining it to need. 
W5300 have the hardwired ping-reply logic. When W5300 have received the ping-request despite the network traffic, W5300 can ping-reply about the request. But, the ping-reply is likely to loss by network traffic. Therefore, ping-loss caused by network traffice, not W5300.

[quote]3. What is the best way to deal with unwanted data sent to wiznet udp port? Can we check the source port and then simply set RECV and exit?
[/quote]
For determining the data to need, you can read the packet information of data. Although if it don't need, you should be read FIFOR. 

Thank you. Just a stupid question.  A confusing piece of code. Data length appears after 14 bytes (6 times read of  *S5_RX_FIFOR0, and 1. Wiznet is directly memory mapped. Definitions are shown at the top of the code.

uint8 xdata *S5_IR1  = (uint8 xdata  *)0x2347;
uint8 xdata *S5_SSR1 = (uint8 xdata  *)0x2349;
uint8 xdata *S5_RX_RSR3 = (uint8 xdata *)0x236B;
uint8 xdata *S5_RX_FIFOR0 = (uint8 xdata *)0x2370;
uint8 xdata *S5_RX_FIFOR1 = (uint8 xdata *)0x2371;

uint8 head0;
uint8 head1;
uint8 udpsizelsb;

if(*S5_SSR1 == 0X22)                             // check if the socket is in udp mode
	{
                    /// get the length of the recv packet, LSB will indicate a minimum length. assuming it won't be zero.
		 udpsizelsb =  *S5_RX_RSR3;
	      if(*S5_IR1 & 0X04  || udpsizelsb > 0x08)             // if minimum 8 bytes are recvd or if interrupt is set
		  {
				 *S5_IR1 = 0X04;                        // clear the recv interrupt bit of socket
				
				 head0   = *S5_RX_FIFOR0;                                     // read 2 bytes from wiznet recv memory and throw it. Need only data size.
			        head1  = *S5_RX_FIFOR1; 

                                head0   = *S5_RX_FIFOR0;                                     // read 2 more bytes from wiznet recv memory
			        head1  = *S5_RX_FIFOR1; 

                                head0   = *S5_RX_FIFOR0;                                     // read 2 more bytes from wiznet recv memory
			        head1  = *S5_RX_FIFOR1; 


                  //completed - totally 6 bytes - next 2 bytes must be data size !!

	
                                head0   = *S5_RX_FIFOR0;                                     // read 2 more bytes from wiznet recv memory
			        head1  = *S5_RX_FIFOR1; 

//totally 8 bytes

                                head0   = *S5_RX_FIFOR0;                                     // read 2 more bytes from wiznet recv memory
			        head1  = *S5_RX_FIFOR1; 

                                head0   = *S5_RX_FIFOR0;                  // read 2 more bytes from wiznet recv memory - 13/14 bytes
			        head1  = *S5_RX_FIFOR1; 

//totally 14 bytes

// now, next 2 bytes indicate datalength. Actually, it should have been the last 2 bytes of the header (7 and 8), and not 15 and 16. But some how, 15/16 matches datalength. From 17nth onwards, it is data.

				 datalength = *S5_RX_FIFOR0;                                     // read the datasize now, from 15/16 bytes
			     datalength =(maclength << 8);
				 datalength = datalength + *S5_RX_FIFOR1;


for(index = 0 ; index < datalength; index++)    // copy the data contents of recv memory of he socket to user memory. variables are defined elsewhere.
			     {
			         mydata[index] = *S5_RX_FIFOR0;
					 index++;
					 mydata[index] =  *S5_RX_FIFOR1;
			     }

Now, mydata has UDP data. Actually, I am reading from 17, 18 .... of  the buffer, instead of 9,10.... So my data has to be incorrect, but it seems to be correct. Is this some datatype conversion issue?

Please comment. Code seems to be right, but something is wrong. (In the actual code, we are using a header array as per the sample code.). Code gives correct receive size o 15/16 reads. Some stupid interpretation, but if you can comment on this, we would appreciate it. Hi,
Did you check the first 4 bytes to valid ip address and next 2 byte check to valid port number?

If the  ip & port number is invalid, it seems to be likely to access incorrect Sn_RX_FIFOR.

Let me know the result of test the first 4 & next 2 bytes.

Thank you.","Q) If I do not need the data in the receive buffer in UDP mode, can I just set Sn_CR to RECV without reading from RX_FIFOR? Is it necessary to copy data even if I do not need the data? Currently we are reading the data from RX_FIFOR -  since there was some suggestion from some site that this is necessary to clear the buffer to make way for new data -  and then setting RECV, but it is not required to read the data, is it not? When we set RECV, next data will simply overwrite the previous data, right?
A) Unfortunately, W5300 FIFO register can not be flushed. So, You should read the data even if you don't want it. If there is only unwanted data  in socket buffer, you can flush the buffer using close and reopen the socket. But, If there is both  unwanted data and wanted data in socket buffer, you should read FIFOR for ignoring the unwanted data.

Q) If a wiznet UDP socket port is being bombarded with continuous data (may be junk / broadcast ), how does this affect the chip? Will it cause speed issues with other sockets? Can it cause the chip to reply to pings only once, or not reply at all? Can it cause the chip not to reply to arps?
A) When being bombarded with junk, W5300 just receives the data as many as socket buffer size and the rest bombarded data is discarded until the socket buffer is free. It may cause speed issues with other sockets because the continuous bombarded data should be also read for determining if it is needed. W5300 have the hardwired ping-reply logic. When W5300 have received the ping-request despite the network traffic, W5300 can ping-reply about the request. But, the ping-reply is likely to be lost by network traffic. Therefore, ping-loss caused by network traffic, not W5300.

Q) What is the best way to deal with unwanted data sent to wiznet UDP port? Can we check the source port and then simply set RECV and exit?
A) For determining the data to need, you can read the packet information of data. Although if it don't need, you should be read FIFOR. Thank you.

Q) Did you check the first 4 bytes to valid ip address and next 2 byte check to valid port number? If the  ip & port number is invalid, it seems to be likely to access incorrect Sn_RX_FIFOR. Let me know the result of test the first 4 & next 2 bytes.
A) Thank you."
3462,6359," [WIZ550S2E] wiz550se2-232???Â°ÃªÂ²Â°Ã«Â°Â©Ã«Â²Â
   1. PC??TCP/IP jackÃªÂ³?WIZ module??TCP/IP Jack??Ã«Â°ÂÃ«Â¡Â ?Â°ÃªÂ²Â°?? ( Cable?? 1:1 ?Â¸ÃªÂ²ÂÃªÂ°ÂÃ¬ÂÂ)
   2. PC??TCP/IP jack ?? ÃªÂ³ÂµÃ¬ÂÂ ÃªÂ¸Â°Ã¬ÂÂ ??LAN Port???Â°ÃªÂ²Â°?ÂÃ¬ÂÂ´?ÂÃªÂ³Â (ÃªÂ¸Â°Ã¬Â¡Â´?ÂÃ­ÂÂ),  WIZ module??
       ?Â¤Ã«Â¥Â¸ LAN Port?? ?Â°ÃªÂ²Â°??

 ?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?Â°ÃªÂ²Â°?Â´Ã¬ÂÂ wizconfig_V1.0?ÂÃ¬ÂÂ Device search??Search results ÃªÂ°? 0Ã«Â¡??ÂÃ­???
  ?Â´Ã«ÂÂ»ÃªÂ²??ÂÃ¬Â Â, ?ÂÃ¬ÂÂ¤???ÂÃ«ÂÂ?? One of the test was Desktop, but even if the TCP/IP JACK of the laptop and the TCP/IP Jack of the Wiz Module are connected, the Results is 0. It is more likely that certain ports of UDP packets transmitted from tools to modules are blocked by firewalls.
Turn off the firewall from the PC or laptop environment and check it through Ethernet connection. All of the firewalls are not solved. As you can explain WINCONFIG, I worked on V1.3 and found Module.

What procedure do you need to communicate with your PC now?

thank you","Q) What procedure do you need to communicate with your PC now?
A) To communicate with your PC, you will need to turn off the firewall from the PC or laptop environment and check the Ethernet connection. It seems that certain ports of UDP packets transmitted from tools to modules are blocked by firewalls. So, by turning off the firewall, you can establish the communication."
3463,636,"This category is for last design contest, ""Connect the Magic"" Held on March 3, 2014. Hi there,
Silly question, Whats the closing date for the competition ?

My project uses the module on a pic32 system and talks to a pc for results and control.
I assume i would need to provide source for both halves and circuits photoes etc ? The challenge launched at 12:00 PM EST on March 3, 2014. The Entry submission deadline is 12:00 PM EST August 3, 2014. 

For more information, refer to official site: [url]http://circuitcellar.com/wiznet2014/[/url]
How to enter: [url]http://circuitcellar.com/wiznet2014/enter/[/url]
Before you enter it, you should get the registration number. [url]http://circuitcellar.com/wiznet2014/registration/[/url]","Q) Silly question, What's the closing date for the competition?
A) The challenge launched at 12:00 PM EST on March 3, 2014. The entry submission deadline is 12:00 PM EST August 3, 2014.

You can find more information and instructions on how to enter at the official site: [url]http://circuitcellar.com/wiznet2014/[/url]. Before entering, make sure to obtain the registration number from [url]http://circuitcellar.com/wiznet2014/registration/[/url]."
3464,6369,"hello.I am using the WizNet W5500 and I was in an infinite loop inside the Close function while testing DNS.

The code below can be found in the 225th line of https://github.com/wiznet/iolibrary_driver/blob/master/Ethernet/socket.c.

    setsn_cr (Sn, SN_CR_CLOSE);
       / * Wait to Process The Command ... */
    while (getsn_cr (Sn));
As a result of the trace, I keep turning around in this while statement.

The return value of Getsn_cr (SN) is continuously appearing.What is a problem? In addition, it worked well before and suddenly started to do it, and in other products, it is in normal operation. If the chip is operating normally, the above problem does not occur.
System Clock seems unstable or has a hardware problem.
Check that the System Clock is entering the W5500 normally. The same problem did not occur when I assigned the setting values of Mac and IP, checked the normal state, and then did DNS.But is this situation not related to Socket Close ()? setSn_CR(sn,Sn_CR_CLOSE);
   /* wait to process the command... */
while( getSn_CR(sn) );

?ÂÃ¬?ÃªÂ°ÂÃ¬? commandÃ«Â¥??Â¤Ã¬Â Â?ÂÃªÂ³Â  clearÃ«Â¥?ÃªÂ¸Â°Ã«ÂÂ¤Ã«Â¦Â¬Ã«ÂÂ ÃªÂ²ÂÃ¬?
IP?Â¤Ã¬Â Â ?Â±ÃªÂ³Â¼ ÃªÂ´?ÃªÂ³ÂÃ¬ÂÂ??system clock ???Â°Ã«ÂÂ¼ Ã«Â°ÂÃ«Â¡Â clear ?Â©Ã«ÂÂ?? [Quote = ""Mngz, Post: 1, Topic: 6369""]
As a result of the trace, I keep turning around in this while statement.

The return value of Getsn_cr (SN) is continuously appearing.What is a problem?
[/Quote]

If the chip is in a normal state, after writing the value in SN_CR, after normal operation, SN_CR is returned 0x00.
If the operation occurs, you should send a ping packet or read the Version Register to make sure you read the value properly.","Q) What is the problem with the Close function while testing DNS on the WizNet W5500?
A) As a result of the trace, the while statement inside the Close function seems to be causing the issue. The return value of Getsn_cr (SN) is continuously appearing, indicating a problem. If the chip is in a normal state, after writing the value in SN_CR, after normal operation, SN_CR is returned as 0x00. If the operation occurs, you should send a ping packet or read the Version Register to ensure that the value is being read properly."
3465,637,"Hi, 
I want to make a simulink model which uses  TCP/IP Send and TCP/IP Recieve  modules of  Instrument Control Toolbox and send/recieve data to/from FPGA i.e. establishing an ethernet communication between MATLAB and FPGA 
 
can anyone suggest to me a chip that can make good interface between MATLAB and FPGA with very high data rate (greater than or equal 100 Mbps) ?
 
Thank you ! Our product support Fast Ethernet and it means the physical layer is 10/100 Mbps network.
Normally the network throughput is much less than 100Mbps so it's impossible to support 100Mbps or greater than this.
I think you'r better consider the Gigabit Ethernet solution.

Thanks. Can you tell me more about Gigabit ethernet solution you said and which products i have to use ?
Sorry i'm new in that field Gigabit Ethernet support 1Gbps and there are some vendors providing chipset. For example, Broadcom, AXIS and Marvell.
Unfortunately Wiznet only provide the fast Ethernet(10, 100Mbps) solution.
If your'e using Altera, refer to this. [url]http://www.altera.com/technology/high_speed/protocols/gb_ethernet/pro-gb_ethernet.html[/url]

Thanks","Q) Hi, can anyone suggest to me a chip that can make good interface between MATLAB and FPGA with very high data rate (greater than or equal 100 Mbps) ?
A) Our product support Fast Ethernet and it means the physical layer is 10/100 Mbps network. Normally the network throughput is much less than 100Mbps so it's impossible to support 100Mbps or greater than this. I think you'd better consider the Gigabit Ethernet solution.

Q) Can you tell me more about Gigabit ethernet solution you said and which products i have to use ?
A) Gigabit Ethernet support 1Gbps and there are some vendors providing chipset. For example, Broadcom, AXIS and Marvell. Unfortunately Wiznet only provide the fast Ethernet(10, 100Mbps) solution. If you're using Altera, refer to this. [url]http://www.altera.com/technology/high_speed/protocols/gb_ethernet/pro-gb_ethernet.html[/url]"
3466,6372,"Hi everyone!

I'm hardware developer and I'm working with a new design using WizFi310. Now I'm designing de PCB module so I would like to know if there is some footfrint recomendation. 

I looked for in datasheet but I only found the pin description and the dimensions, however I didn't find the footprint.

Can someone help me?

Thank you

Josep hi,

you can find the wizfi310 footprint from datasheet. (check the page before the last)

here is the link

https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310ds:start","Q) Now I'm designing the PCB module so I would like to know if there is some footprint recommendation. Can someone help me? Thank you.
A) You can find the WizFi310 footprint from the datasheet (check the page before the last). Here is the link: https://wizwiki.net/wiki/doku.php?id=products:wizfi310:wizfi310ds:start"
3467,638,"Hi,

i am working a project on w5100 to implement ntp clock using wiz810mj module.

while i'm trying to open a udp socket, it is not working. before trying to attempt the socket opening i have test ping test its work fine. and also i have initialised all registers provided in the datasheet.

below im placing the code which i have written,i'm hard to find where i'm doing wrong.

Could any one please help me to open the socket

here the code how i'm trying to attempt.
uint8 socket(
  SOCKET s, uint8 protocol,   uint16 port  )
{
  uint8 ret;
 
	if (protocol == Sn_MR_UDP)
	{
		close(s);
	    SPI_Write(Sn_MR(s),protocol);
		if (port != 0) 
		{

			SPI_Write(Sn_PORT0(s),(uint8)((port & 0xff00) >> 8));
			SPI_Write((Sn_PORT0(s) + 1),(uint8)(port & 0x00ff));
		}
		else
		{
			local_port++; // if don't set the source port, set local_port number.
			SPI_Write(Sn_PORT0(s),(uint8)((local_port & 0xff00) >> 8));
			SPI_Write((Sn_PORT0(s) + 1),(uint8)(local_port & 0x00ff));
		}
		SPI_Write(Sn_CR(s),Sn_CR_OPEN); // run sockinit Sn_CR
		while(spi_read(Sn_CR(s)));		   
		ret =1;	
		
			
	}
	else
	{
		ret = 0;
	}

	
  return ret;
}


void close(SOCKET s)
{

  SPI_Write(Sn_CR(s),Sn_CR_CLOSE);
  while( SPI_Read(Sn_CR(s)) );


 
}




Thank You Hi,

[code]SPI_Write(Sn_CR(s),Sn_CR_OPEN); // run sockinit Sn_CR
while(spi_read(Sn_CR(s))); 
//
//check sn_sr
//
while(spi_read(Sn_SR(s) != SOCK_UDP);
[/code]

After checking the command clear, Check Sn_SR to change from SOCK_INIT to SOCK_UDP. [quote=""midnightcow""]Hi,

[code]SPI_Write(Sn_CR(s),Sn_CR_OPEN); // run sockinit Sn_CR
while(spi_read(Sn_CR(s))); 
//
//check sn_sr
//
while(spi_read(Sn_SR(s) != SOCK_UDP);
[/code]

After checking the command clear, Check Sn_SR to change from SOCK_INIT to SOCK_UDP.[/quote]


Thank You for the reply

after this (SPI_Write(Sn_CR(s),Sn_CR_OPEN); ) instruction program being in infinite loop only(i.e., While(Spi_read(Sn_CR(s)))) it is not at all comming out from that instruction. I Have waited for more than an hour but there is no responce in it. I have checked it in all the sockets(0-3). Could you please help me in any otherway to open the socket. Hi,
I think spi_read function doesn't work fine.
Did you verify the spi_read function?

Write the SIPR or GAR regsiter and Read it, then check the same values between the written value and the read value.

Thank you. [quote=""midnightcow""]Hi,
I think spi_read function doesn't work fine.
Did you verify the spi_read function?

Write the SIPR or GAR regsiter and Read it, then check the same values between the written value and the read value.

Thank you.[/quote]


Yeah SPI is working fine.
I have checked every thing and also ping test working fine. I have initialized all registers provided in datasheet of w5100 chip.
But the problem facing in ""CR"" only,I think it is not working properly. :frowning:

Thank You Hi, 

I think CR register address is wrong maybe because Sn_CR always change 0 after performing command.

But your chip and code fall into infinite loop, so there is some problem.

Please check Sn_CR register address.

Best regards. [quote=""hjjeon0608""]Hi, 

I think CR register address is wrong maybe because Sn_CR always change 0 after performing command.

But your chip and code fall into infinite loop, so there is some problem.

Please check Sn_CR register address.

Best regards.[/quote]


 Thank You for reply,
[code][/code]

#ifndef SOCKET_H_
#define SOCKET_H_


#define	MAX_SOCK_NUM		4	/**< Maxmium number of socket  */

#define __DEF_IINCHIP_SPI_MODE__ 3

#define __DEF_IINCHIP_MAP_BASE__ 0x8000

#define COMMON_BASE 0x0000

//typedef uint8 SOCKET;

#define TX_RX_MAX_BUF_SIZE	2048
#define TX_BUF	0x1100
#define RX_BUF	(TX_BUF+TX_RX_MAX_BUF_SIZE)


/*-----------------------------------------------------------------------------------------------*/
/*									 WIZNET WRITE/READ											 */
/*-----------------------------------------------------------------------------------------------*/

#define WIZNET_WRITE_OPCODE			0xF0
#define WIZNET_READ_OPCODE			0x0F

/*-----------------------------------------------------------------------------------------------*/
/*								 WIZNET COMMON REGISTERS										 */
/*-----------------------------------------------------------------------------------------------*/

#define MR							0x0000		//MODE REGISTER
/**
 @brief Gateway IP Register address
 */
#define GAR0						(COMMON_BASE + 0x0001)
/**
 @brief Subnet mask Register address
 */
#define SUBR0						(COMMON_BASE + 0x0005)
/**
 @brief Source MAC Register address
 */
#define SHAR0						(COMMON_BASE + 0x0009)
/**
 @brief Source IP Register address
 */
#define SIPR0						(COMMON_BASE + 0x000F)
/**
 @brief Interrupt Register
 */
#define IR							(COMMON_BASE + 0x0015)
/**
 @brief Interrupt mask register
 */
#define IMR							(COMMON_BASE + 0x0016)
/**
 @brief Timeout register address( 1 is 100us )
 */
#define RTR0						(COMMON_BASE + 0x0017)
/**
 @brief Retry count reigster
 */
#define RCR							(COMMON_BASE + 0x0019)
/**
 @brief Receive memory size reigster
 */
#define RMSR						(COMMON_BASE + 0x001A)
/**
 @brief Transmit memory size reigster
 */
#define TMSR						(COMMON_BASE + 0x001B)


/**
 @brief Unreachable IP register address in UDP mode
 */
#define UIPR0						(COMMON_BASE + 0x002A)
/**
 @brief Unreachable Port register address in UDP mode
 */
#define UPORT0						(COMMON_BASE + 0x002E)

/*-------------------------------------------------------------------------------------------*/
/*								WIZNET SOCKET REGISTERS										 */
/*-------------------------------------------------------------------------------------------*/


/**
 @brief socket register
*/
#define CH_BASE						(COMMON_BASE + 0x0400)
/**
 @brief	size of each channel register map
 */
#define CH_SIZE						0x0100
/**
 @brief socket Mode register
 */
#define Sn_MR(ch)					(CH_BASE + ch * CH_SIZE + 0x0000)
/**
 @brief channel Sn_CR register
 */
#define Sn_CR(ch)					(CH_BASE + ch * CH_SIZE + 0x0001)
/**
 @brief channel interrupt register
 */
#define Sn_IR(ch)					(CH_BASE + ch * CH_SIZE + 0x0002)
/**
 @brief channel status register
 */
#define Sn_SR(ch)					(CH_BASE + ch * CH_SIZE + 0x0003)
/**
 @brief source port register
 */
#define Sn_PORT0(ch)				(CH_BASE + ch * CH_SIZE + 0x0004)
/**
 @brief Peer MAC register address
 */
#define Sn_DHAR0(ch)				(CH_BASE + ch * CH_SIZE + 0x0006)
/**
 @brief Peer IP register address
 */
#define Sn_DIPR0(ch)				(CH_BASE + ch * CH_SIZE + 0x000C)
/**
 @brief Peer port register address
 */
#define Sn_DPORT0(ch)				(CH_BASE + ch * CH_SIZE + 0x0010)
/**
 @brief Maximum Segment Size(Sn_MSSR0) register address
 */
#define Sn_MSSR0(ch)				(CH_BASE + ch * CH_SIZE + 0x0012)
/**
 @brief Protocol of IP Header field register in IP raw mode
 */
#define Sn_PROTO(ch)				(CH_BASE + ch * CH_SIZE + 0x0014)
/** 
 @brief IP Type of Service(TOS) Register 
 */
#define Sn_TOS(ch)					(CH_BASE + ch * CH_SIZE + 0x0015)
/**
 @brief IP Time to live(TTL) Register 
 */
#define Sn_TTL(ch)					(CH_BASE + ch * CH_SIZE + 0x0016)
/**
 @brief Transmit free memory size register
 */
#define Sn_TX_FSR0(ch)				(CH_BASE + ch * CH_SIZE + 0x0020)
/**
 @brief Transmit memory read pointer register address
 */
#define Sn_TX_RD0(ch)				(CH_BASE + ch * CH_SIZE + 0x0022)
/**
 @brief Transmit memory write pointer register address
 */
#define Sn_TX_WR0(ch)				(CH_BASE + ch * CH_SIZE + 0x0024)
/**
 @brief Received data size register
 */
#define Sn_RX_RSR0(ch)				(CH_BASE + ch * CH_SIZE + 0x0026)
/**
 @brief Read point of Receive memory
 */
#define Sn_RX_RD0(ch)				(CH_BASE + ch * CH_SIZE + 0x0028)
/**
 @brief Write point of Receive memory
 */
#define Sn_RX_WR0(ch)				(CH_BASE + ch * CH_SIZE + 0x002A)

/*===========================================================================================*/
/*								MEMORY BUFFER ADDRESS										 */
/*===========================================================================================*/

//#define TX_BUF_ADDR					0x4000		//W5100 TX MEMORY BASE ADDRESS
//#define RX_BUF_ADDR					0x6000		//W5100 RX MEMORY BASE ADDRESS

/*=====================================================================================================*/
/*										MODE register values										   */
/*=====================================================================================================*/
#define MR_RST			0x80 /**< reset */
#define MR_PB			0x10 /**< ping block */
#define MR_PPPOE		0x08 /**< enable pppoe */
#define MR_LB  			0x04 /**< little or big endian selector in indirect mode */
#define MR_AI			0x02 /**< auto-increment in indirect mode */
#define MR_IND			0x01 /**< enable indirect mode */


/*====================================================================================================*/
/*										 Sn_MR MODE REGISTERS										  */
/*====================================================================================================*/

#define Sn_MR_CLOSE		0x00		/**< unused socket */
#define Sn_MR_TCP		0x01		/**< TCP */
#define Sn_MR_UDP		0x02		/**< UDP */
#define Sn_MR_IPRAW		0x03		/**< IP LAYER RAW SOCK */
#define Sn_MR_MACRAW	0x04		/**< MAC LAYER RAW SOCK */
#define Sn_MR_PPPOE		0x05		/**< PPPoE */
#define Sn_MR_ND		0x20		/**< No Delayed Ack(TCP) flag */
#define Sn_MR_MULTI		0x80		/**< support multicating */

/*====================================================================================================*/
/*										Sn_CR COMMAND REGISTERS										  */
/*====================================================================================================*/


#define Sn_CR_OPEN		0x01		/**< initialize or open socket */
#define Sn_CR_LISTEN	0x02		/**< wait connection request in tcp mode(Server mode) */
#define Sn_CR_CONNECT	0x04		/**< send connection request in tcp mode(Client mode) */
#define Sn_CR_DISCON	0x08		/**< send closing reqeuset in tcp mode */
#define Sn_CR_CLOSE		0x10		/**< close socket */
#define Sn_CR_SEND		0x20		/**< updata txbuf pointer, send data */
#define Sn_CR_SEND_MAC	0x21		/**< send data with MAC address, so without ARP process */
#define Sn_CR_SEND_KEEP	0x22		/**<  send keep alive message */
#define Sn_CR_RECV		0x40		/**< update rxbuf pointer, recv data */

/*===================================================================================================*/
/*							 Sn_SR SOCKET n STATUS REGISTER										     */
/*===================================================================================================*/


#define SOCK_CLOSED					0x00		//STATUS REGISTER FOR SOCK CLOSED
#define SOCK_INIT					0x13		//STATUS REGISTER FOR SOCKET INITIALISATION
#define SOCK_LISTEN					0x14		//STATUS REGISTER FOR SOCKET LISTEN
#define SOCK_ESTABLISHED			0x17		//STATUS REGISTER FOR SOCKET ESTABLISHMENT
#define SOCK_CLOSE_WAIT				0x1C		//STATUS REGISTER FOR CLOSE WAITING
#define SOCK_UDP					0x22		//STATUS REGISTER FOR UDP
#define SOCK_IPRAW					0x32		//STATUS REGISTER FOR IPRAW
#define SOCK_MACRAW					0x42		//STATUS REGISTER FOR MACRAW
#define SOCK_PPPOE					0x5F		//STATUS REGISTER FOR PPPOE
#define SOCK_SYNSENT				0x15		//STATUS REGISTER FOR SYNSENT
#define SOCK_SYNRECV				0x16		//STATUS REGISTER FOR SYNRECV
#define SOCK_FIN_WAIT				0x18		//STATUS REGISTER FOR FINISH WAIT
#define SOCK_CLOSING				0x1A		//STATUS REGISTER FOR CLOSING
#define SOCK_TIME_WAIT				0x1B		//STATUS FOR TIME WAIT
#define SOCK_LAST_ACK				0x1D		//STATUS REGISTER FOR LAST ACKNOWLEDGEMWNT
#define SOCK_ARP					0x01		//STATUS REGISTER FOR ARP

/*------------------------------------------------------------------------------------------------------*/
/*											 IP PROTOCOL												*/
/*------------------------------------------------------------------------------------------------------*/
#define IPPROTO_IP              0           /**< Dummy for IP */
#define IPPROTO_ICMP            1           /**< Control message protocol */
#define IPPROTO_IGMP            2           /**< Internet group management protocol */
#define IPPROTO_GGP             3           /**< Gateway^2 (deprecated) */
#define IPPROTO_TCP             6           /**< TCP */
#define IPPROTO_PUP             12          /**< PUP */
#define IPPROTO_UDP             17          /**< UDP */
#define IPPROTO_IDP             22          /**< XNS idp */
#define IPPROTO_ND              77          /**< UNOFFICIAL net disk protocol */
#define IPPROTO_RAW             255         /**< Raw IP packet */


/*-------------------------------------------------------------------------------------------*/
/*								Sn_IR INTERRUPT REGISTER									 */	
/*-------------------------------------------------------------------------------------------*/


#define IR_CON						0x01		//INTERRUPT REGISTER FOR CONNECTION
#define IR_DISCON					0x02		//INTERRUPT REGISTER FOR DISCONNECT
#define IR_RECV						0x04		//INTERRUPT REGISTER FOR RECIEVE
#define IR_TIMEOUT					0x08		//INTERRUPT REGISTER FOR TIMEOUT
#define IR_SEND_OK					0x10		//INTERRUPT REGISTER FOR SEND_OK



[code][/code]

The above code shows that how i defined all the registers of w5100.
Plaese check it if any wrong i have done and make it correct.

Thank you Your addresses are correct.

I think your SPI access is wrong.

Check SPI read/write one more.

Best regards. [quote]
Yeah SPI is working fine.
I have checked every thing and also ping test working fine
[/quote]

You means that SIPR or GAR's  Write and Read operation is OK ? Is correct the read value of SIPR?
If correct, spi_read() works fine. 
If spi_read() and ping-test are ok, Sn_CR_OPEN bit in Sn_CR should be cleared as zero.

If you make sure to interface with W5100, W5100 is bad. 
If you have another chip, try to test it.

Thank you. [quote=""midnightcow""][quote]
Yeah SPI is working fine.
I have checked every thing and also ping test working fine
[/quote]

You means that SIPR or GAR's  Write and Read operation is OK ? Is correct the read value of SIPR?
If correct, spi_read() works fine. 
If spi_read() and ping-test are ok, Sn_CR_OPEN bit in Sn_CR should be cleared as zero.

If you make sure to interface with W5100, W5100 is bad. 
If you have another chip, try to test it.

Thank you.[/quote]

Thank You for the reply,

There is no problem with SPI,it is working fine i can write and read the SIPR, SHAR and GAR Registers. I think chip has only the problem. one more thing chip has getting more heat, while i'm in waiting state to open the socket.whether is it problem with the chip?
although ping test is also working gud. but i'm not understanding where i'm doing wrong. [quote=""hjjeon0608""]Your addresses are correct.

I think your SPI access is wrong.

Check SPI read/write one more.

Best regards.[/quote]

Thank You for the reply,

SPI is working fine.i can write and read the registers of SHAR,SIPR, and GAR and also the ping test also working fine.the main problem occuring only in the opening of a socket, it falls into the While(Sn_CR(s)); condition and it is not coming out from that instruction.could you have any idea of my problem. Please suggest me any other way to open socket.
Thank you W5100 have some heat as you feel hot. It is normal.
As PHY (the analogue part) is embedded in W5100, it generates somewhat higher heat. However, it does not make any problem in performance. 
For more detail, seach more at [url]http://www.wiznet.co.kr/sub_modules/en/technical/q_a.asp[/url] with ""w5100 heat"".

Can you check the read sequence in datasheet 69page with oscillo-scope?
W5100 sequentially output  0x00, 0x01, 0x02 thru MISO in each phase. [quote=""midnightcow""]W5100 have some heat as you feel hot. It is normal.
As PHY (the analogue part) is embedded in W5100, it generates somewhat higher heat. However, it does not make any problem in performance. 
For more detail, seach more at [url]http://www.wiznet.co.kr/sub_modules/en/technical/q_a.asp[/url] with ""w5100 heat"".

Can you check the read sequence in datasheet 69page with oscillo-scope?
W5100 sequentially output  0x00, 0x01, 0x02 thru MISO in each phase.[/quote]


Thank You for the reply

As you suggested,i checked with Oscilloscope.In all phases it read the data properly,while in the command register phase only it is being in the continuous loop,oscillocope showing only 0x00,0x01,0x02, 0x10(close command).here only iam getting problem. In the command register the bit must be cleared to 0x00 but it is not clearing.

What else should i do for proper working.

Thank You. Sn_CR should be cleared when 25MHz clock exactly feeded into w5100. I don't know why Sn_CR can't be cleared as zero.

Recheck again Sn_CR address presented on MOSI.
Sn_CR address is as followings.
S0_CR 0x0401, S1_CR 0x0501, S2_C2 0x0601, Sn_CR 0x0701.

If possible, post the capture of SPI singal about writing&reading Sn_CR.

Thank you. Hi,
I can't not analyze these wave without SCLK signal.

Please re-capture the signals MOSI & SCLK and MISO & SCLK.

If possible, capture the all signal together MOSI, MISO and SCLK.

Thank you. Thank You Very Much i find out my mistake.I have done a mistake in writing the addresses in SPI but i didnt touch that protocol,continuously i'm checking in the socket program only( i.e., in status and command register )and now i understand by observing the wave forms and i identified that where i have done major mistake.

once again thank you for your encouragement :slight_smile:

Your stuff is very helpful to me and i have learned so many things from you.

Thank you. :smiley: :smiley:  :slight_smile:

Now i'l continue my project of NTP. I'm glad to solve your problem. too.

If you need a help, feel free post it on wizwiki forum.

Thank you. hi
after successful opening of UDP socket now I'm facing trouble in DIPR register.
Here is my problem.

While Writing Destination IP through SPI into DIPR and also DPORT register its fine,but  after SPI reading it is showing all zeroes in both.
I have checked all the register addresses of DIPR & DPORT registers are correct(In socket '0' DIPR location 0x040C).

May i Know is there any other register bits to set/reset to get DIPR & DPORT working.

Al though all other registers like SIPR,SUBR are reading fine.Only in DIPR & DPORT registers are not working properly through SPI.

Could you please help me....

Thank You. Hi,

DIPR and DPORT register value is changed after TCP connection successfully.

So, try again after connection established. [quote=""hjjeon0608""]Hi,

DIPR and DPORT register value is changed after TCP connection successfully.

So, try again after connection established.[/quote]


Thank You very much for your reply....
My problem was solved... Digital products play a dispensable role in our daily life in such a technology developed dramatically world. More and more people want to own a high configuration electronics with a fast operation speed. With development of high technology, it is common to see that there are various kinds of high tech products nowadays,  
wanna try  [b][url=http://www.chinazrh.com/wholesale-digital-photo-frames-c-77.html]Digital Photo Frames[/url][/b]Ã¯Â¼ÂHere are best quality for men selling and all of them are of good quality and low price.","Q) I am working on a project to implement an NTP clock using the W5100 chip. I am having trouble opening a UDP socket, even after testing the ping and initializing all the registers provided in the datasheet. Can anyone help me open the socket?
A) Your addresses are correct. I think your SPI access is wrong. Check the SPI read/write one more.

Q) I have a problem in opening a socket. The program is getting stuck in an infinite loop after the instruction (SPI_Write(Sn_CR(s),Sn_CR_OPEN); ) and it doesn't come out of that instruction. I have waited for more than an hour, but there is no response. Could you please help me in any other way to open the socket?
A) I think your SPI access is wrong. Check SPI read/write again.

Q) I have an issue in opening a socket, where the command register falls into an infinite loop. The program seems to be getting stuck due to the Sn_CR register. Could you have any idea of my problem? Please suggest another way to open the socket.
A) Your addresses are correct. I think your SPI access is wrong. Check SPI read/write one more.

Q) I am having trouble writing the destination IP and port into the DIPR and DPORT registers through SPI. After writing, and reading back through SPI, it is showing all zeroes. I have checked all the register addresses, but only the DIPR & DPORT registers are not working properly. Could you please help me?
A) DIPR and DPORT register values change after the TCP connection is successfully established. Try again after the connection is established.

Non-response: 
- ""Thank You for the reply""
- ""Please suggest me any other way to open socket. Thank you""
- ""I have learned so many things from you. Thank you""
- ""My problem was solved""
- ""The program is getting stuck due to the Sn_CR register. Could you have any idea of my problem? Please suggest me any other way to open the socket. Thank You""
- ""Thank You very much for your reply. My problem was solved""
- ""Your stuff is very helpful to me and I have learned so many things from you. Thank you""
- ""I'm glad to solve your problem. If you need help, feel free to post on the wizwiki forum. Thank you""
- ""My problem was solved. Thank you""

Potential personal information: 
- There is no personal information present in the responses."
3468,6383,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸?? 

?Â°Ã¬ÂÂ  ????WIZ850io Ã«ÂªÂ¨Ã«ÂÂ??ÃªÂµÂ¬Ã¬ÂÂ?ÂÃ¬?ÃªÂ³?STM32L496 Ã¬Â¹Â©Ã¬ÂÂ ?Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬,

?Â´Ã«ÂÂ???ÂµÃ¬ÂÂ ???ÂÃ«Â Â¤ÃªÂ³??Â©Ã«ÂÂ??

?Â°Ã¬ÂÂ  Ping??Ã¬Â£Â¼ÃªÂ³Â  Ã«Â°ÂÃ«ÂÂÃªÂ²?ÃªÂ¹ÂÃ¬????Â±ÃªÂ³Âµ?ÂÃ¬??ÂµÃ«ÂÂ??

ÃªÂ·??Â´Ã­ÂÂ  ?ÂÃ¬Â¼Â??ÃªÂ³ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ±?ÂÃ¬Â§Â ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

hercules ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ???ÂÃ«ÂÂ???? TCP connection error :10061  ?ÂÃ«ÂÂ¬ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ«Â©Â°

?ÂÃ«Â²ÂÃªÂ¹ÂÃ¬ÂÂ ?Â´Ã«Â³Â¸ ÃªÂ²Â°ÃªÂ³Â¼ SOCKERR_SOCKINIT ?ÂÃ«ÂÂ¬ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸?ÂÃ¬??ÂµÃ«ÂÂ??

  while (1)
  {
    ret = loopback_tcps(1, gDATABUF, 6000);
    
    if(ret <0)
    {
      
    }
  }

ret ??ÃªÂ°ÂÃ¬ÂÂ´ ÃªÂ³ÂÃ¬ÂÂ -3?Â¼Ã«Â¡Â ?Â¤Ã¬ÂÂ´?Â¤Ã«ÂÂ ?ÂÃ¬ÂÂ??Ã«Â°ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

int32_t loopback_tcps(uint8_t sn, uint8_t* buf, uint16_t port)
{
   int32_t ret;
   uint16_t size = 0, sentsize=0;

   switch(getSn_SR(sn))
   {
      case SOCK_ESTABLISHED :
        
         if(getSn_IR(sn) & Sn_IR_CON)
         {
	   setSn_IR(sn,Sn_IR_CON);
         }
         
         if((size = getSn_RX_RSR(sn)) > 0) 
         {
              if(size > DATA_BUF_SIZE) size = DATA_BUF_SIZE;
              ret = recv(sn, buf, size);

              if(ret <= 0) return ret;      // check SOCKERR_BUSY & SOCKERR_XXX. For showing the occurrence of SOCKERR_BUSY.
              size = (uint16_t) ret;
              sentsize = 0;

              while(size != sentsize)
              {
                      ret = send(sn, buf+sentsize, size-sentsize);
                      if(ret < 0)
                      {
                              close(sn);
                              return ret;
                      }
                      sentsize += ret; // Don't care SOCKERR_BUSY, because it is zero.
              }
         }
         break;
         
      case SOCK_CLOSE_WAIT :

         if((ret = disconnect(sn)) != SOCK_OK) 
         {
           return ret;
         }

         break;
      case SOCK_INIT :
        
         if( (ret = listen(sn)) != SOCK_OK) 
         {
           return ret;
         }
         break;
         
      case SOCK_CLOSED:
        
        if((ret = socket(sn, Sn_MR_TCP, port, 0x00)) != sn) 
        {
          return ret;
        }
         break;
         
      default:
         break;
   }
   return 1;
}

Ã«Â£Â¨Ã­ÂÂÃ«Â°??Â¨Ã¬ÂÂ???ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

//#include <stdio.h>
#include ""w5500.h""

#define _W5500_SPI_VDM_OP_          0x00
#define _W5500_SPI_FDM_OP_LEN1_     0x01
#define _W5500_SPI_FDM_OP_LEN2_     0x02
#define _W5500_SPI_FDM_OP_LEN4_     0x03

#if   (_WIZCHIP_ == 5500)
////////////////////////////////////////////////////

uint8_t  WIZCHIP_READ(uint32_t AddrSel)
{
   uint8_t ret;
   uint8_t spi_data[3];

   WIZCHIP_CRITICAL_ENTER();
   WIZCHIP.CS._select();

   AddrSel |= (_W5500_SPI_READ_ | _W5500_SPI_VDM_OP_);

   if(!WIZCHIP.IF.SPI._read_burst || !WIZCHIP.IF.SPI._write_burst) 	// byte operation
   {
	   WIZCHIP.IF.SPI._write_byte((AddrSel & 0x00FF0000) >> 16);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x0000FF00) >>  8);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x000000FF) >>  0);
   }
   else																// burst operation
   {
		spi_data[0] = (AddrSel & 0x00FF0000) >> 16;
		spi_data[1] = (AddrSel & 0x0000FF00) >> 8;
		spi_data[2] = (AddrSel & 0x000000FF) >> 0;
		WIZCHIP.IF.SPI._write_burst(spi_data, 3);
   }
   ret = WIZCHIP.IF.SPI._read_byte();

   WIZCHIP.CS._deselect();
   WIZCHIP_CRITICAL_EXIT();
   return ret;
}

void     WIZCHIP_WRITE(uint32_t AddrSel, uint8_t wb )
{
   uint8_t spi_data[4];

   WIZCHIP_CRITICAL_ENTER();
   WIZCHIP.CS._select();

   AddrSel |= (_W5500_SPI_WRITE_ | _W5500_SPI_VDM_OP_);

   //if(!WIZCHIP.IF.SPI._read_burst || !WIZCHIP.IF.SPI._write_burst) 	// byte operation
   if(!WIZCHIP.IF.SPI._write_burst) 	// byte operation
   {
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x00FF0000) >> 16);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x0000FF00) >>  8);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x000000FF) >>  0);
		WIZCHIP.IF.SPI._write_byte(wb);
   }
   else									// burst operation
   {
		spi_data[0] = (AddrSel & 0x00FF0000) >> 16;
		spi_data[1] = (AddrSel & 0x0000FF00) >> 8;
		spi_data[2] = (AddrSel & 0x000000FF) >> 0;
		spi_data[3] = wb;
		WIZCHIP.IF.SPI._write_burst(spi_data, 4);
   }

   WIZCHIP.CS._deselect();
   WIZCHIP_CRITICAL_EXIT();
}
         
void     WIZCHIP_READ_BUF (uint32_t AddrSel, uint8_t* pBuf, uint16_t len)
{
   uint8_t spi_data[3];
   uint16_t i;

   WIZCHIP_CRITICAL_ENTER();
   WIZCHIP.CS._select();

   AddrSel |= (_W5500_SPI_READ_ | _W5500_SPI_VDM_OP_);

   if(!WIZCHIP.IF.SPI._read_burst || !WIZCHIP.IF.SPI._write_burst) 	// byte operation
   {
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x00FF0000) >> 16);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x0000FF00) >>  8);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x000000FF) >>  0);
		for(i = 0; i < len; i++)
		   pBuf[i] = WIZCHIP.IF.SPI._read_byte();
   }
   else																// burst operation
   {
		spi_data[0] = (AddrSel & 0x00FF0000) >> 16;
		spi_data[1] = (AddrSel & 0x0000FF00) >> 8;
		spi_data[2] = (AddrSel & 0x000000FF) >> 0;
		WIZCHIP.IF.SPI._write_burst(spi_data, 3);
		WIZCHIP.IF.SPI._read_burst(pBuf, len);
   }

   WIZCHIP.CS._deselect();
   WIZCHIP_CRITICAL_EXIT();
}

void     WIZCHIP_WRITE_BUF(uint32_t AddrSel, uint8_t* pBuf, uint16_t len)
{
   uint8_t spi_data[3];
   uint16_t i;

   WIZCHIP_CRITICAL_ENTER();
   WIZCHIP.CS._select();

   AddrSel |= (_W5500_SPI_WRITE_ | _W5500_SPI_VDM_OP_);

   if(!WIZCHIP.IF.SPI._write_burst) 	// byte operation
   {
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x00FF0000) >> 16);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x0000FF00) >>  8);
		WIZCHIP.IF.SPI._write_byte((AddrSel & 0x000000FF) >>  0);
		for(i = 0; i < len; i++)
			WIZCHIP.IF.SPI._write_byte(pBuf[i]);
   }
   else									// burst operation
   {
		spi_data[0] = (AddrSel & 0x00FF0000) >> 16;
		spi_data[1] = (AddrSel & 0x0000FF00) >> 8;
		spi_data[2] = (AddrSel & 0x000000FF) >> 0;
		WIZCHIP.IF.SPI._write_burst(spi_data, 3);
		WIZCHIP.IF.SPI._write_burst(pBuf, len);
   }

   WIZCHIP.CS._deselect();
   WIZCHIP_CRITICAL_EXIT();
}


uint16_t getSn_TX_FSR(uint8_t sn)
{
   uint16_t val=0,val1=0;

   do
   {
      val1 = WIZCHIP_READ(Sn_TX_FSR(sn));
      val1 = (val1 << 8) + WIZCHIP_READ(WIZCHIP_OFFSET_INC(Sn_TX_FSR(sn),1));
      if (val1 != 0)
      {
        val = WIZCHIP_READ(Sn_TX_FSR(sn));
        val = (val << 8) + WIZCHIP_READ(WIZCHIP_OFFSET_INC(Sn_TX_FSR(sn),1));
      }
   }while (val != val1);
   return val;
}


uint16_t getSn_RX_RSR(uint8_t sn)
{
   uint16_t val=0,val1=0;

   do
   {
      val1 = WIZCHIP_READ(Sn_RX_RSR(sn));
      val1 = (val1 << 8) + WIZCHIP_READ(WIZCHIP_OFFSET_INC(Sn_RX_RSR(sn),1));
      if (val1 != 0)
      {
        val = WIZCHIP_READ(Sn_RX_RSR(sn));
        val = (val << 8) + WIZCHIP_READ(WIZCHIP_OFFSET_INC(Sn_RX_RSR(sn),1));
      }
   }while (val != val1);
   return val;
}

void wiz_send_data(uint8_t sn, uint8_t *wizdata, uint16_t len)
{
   uint16_t ptr = 0;
   uint32_t addrsel = 0;

   if(len == 0)  return;
   ptr = getSn_TX_WR(sn);
   //M20140501 : implict type casting -> explict type casting
   //addrsel = (ptr << 8) + (WIZCHIP_TXBUF_BLOCK(sn) << 3);
   addrsel = ((uint32_t)ptr << 8) + (WIZCHIP_TXBUF_BLOCK(sn) << 3);
   //
   WIZCHIP_WRITE_BUF(addrsel,wizdata, len);
   
   ptr += len;
   setSn_TX_WR(sn,ptr);
}

void wiz_recv_data(uint8_t sn, uint8_t *wizdata, uint16_t len)
{
   uint16_t ptr = 0;
   uint32_t addrsel = 0;
   
   if(len == 0) return;
   ptr = getSn_RX_RD(sn);
   //M20140501 : implict type casting -> explict type casting
   //addrsel = ((ptr << 8) + (WIZCHIP_RXBUF_BLOCK(sn) << 3);
   addrsel = ((uint32_t)ptr << 8) + (WIZCHIP_RXBUF_BLOCK(sn) << 3);
   //
   WIZCHIP_READ_BUF(addrsel, wizdata, len);
   ptr += len;
   
   setSn_RX_RD(sn,ptr);
}


void wiz_recv_ignore(uint8_t sn, uint16_t len)
{
   uint16_t ptr = 0;

   ptr = getSn_RX_RD(sn);
   ptr += len;
   setSn_RX_RD(sn,ptr);
}

#endif

w5500.c ???ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.


#define SOCK_ANY_PORT_NUM  0xC000

static uint16_t sock_any_port = SOCK_ANY_PORT_NUM;
static uint16_t sock_io_mode = 0;
static uint16_t sock_is_sending = 0;

static uint16_t sock_remained_size[_WIZCHIP_SOCK_NUM_] = {0,0,};

//M20150601 : For extern decleation
//static uint8_t  sock_pack_info[_WIZCHIP_SOCK_NUM_] = {0,};
uint8_t  sock_pack_info[_WIZCHIP_SOCK_NUM_] = {0,};
//

#if _WIZCHIP_ == 5200
   static uint16_t sock_next_rd[_WIZCHIP_SOCK_NUM_] ={0,};
#endif

//A20150601 : For integrating with W5300
#if _WIZCHIP_ == 5300
   uint8_t sock_remained_byte[_WIZCHIP_SOCK_NUM_] = {0,}; // set by wiz_recv_data()
#endif


#define CHECK_SOCKNUM()   \
   do{                    \
      if(sn > _WIZCHIP_SOCK_NUM_) return SOCKERR_SOCKNUM;   \
   }while(0);             \

#define CHECK_SOCKMODE(mode)  \
   do{                     \
      if((getSn_MR(sn) & 0x0F) != mode) return SOCKERR_SOCKMODE;  \
   }while(0);              \

#define CHECK_SOCKINIT()   \
   do{                     \
      if((getSn_SR(sn) != SOCK_INIT)) return SOCKERR_SOCKINIT; \
   }while(0);              \

#define CHECK_SOCKDATA()   \
   do{                     \
      if(len == 0) return SOCKERR_DATALEN;   \
   }while(0);              \



int8_t socket(uint8_t sn, uint8_t protocol, uint16_t port, uint8_t flag)
{
	CHECK_SOCKNUM();
	switch(protocol)
	{
      case Sn_MR_TCP :
         {
            //M20150601 : Fixed the warning - taddr will never be NULL
		    /*
            uint8_t taddr[4];
            getSIPR(taddr);
            */
            uint32_t taddr;
            getSIPR((uint8_t*)&taddr);
            if(taddr == 0) return SOCKERR_SOCKINIT;
         }

      break;

      case Sn_MR_UDP :
      case Sn_MR_MACRAW :
         break;
   #if ( _WIZCHIP_ < 5200 )
      case Sn_MR_IPRAW :
      case Sn_MR_PPPoE :
         break;
   #endif
      default :
         return SOCKERR_SOCKMODE;
	}
	//M20150601 : For SF_TCP_ALIGN & W5300
	//if((flag & 0x06) != 0) return SOCKERR_SOCKFLAG;
	if((flag & 0x04) != 0) return SOCKERR_SOCKFLAG;
#if _WIZCHIP_ == 5200
   if(flag & 0x10) return SOCKERR_SOCKFLAG;
#endif
	   
	if(flag != 0)
	{
   	switch(protocol)
   	{
   	   case Sn_MR_TCP:
   		  //M20150601 :  For SF_TCP_ALIGN & W5300
          #if _WIZCHIP_ == 5300
   		     if((flag & (SF_TCP_NODELAY|SF_IO_NONBLOCK|SF_TCP_ALIGN))==0) return SOCKERR_SOCKFLAG;
          #else
   		     if((flag & (SF_TCP_NODELAY|SF_IO_NONBLOCK))==0) return SOCKERR_SOCKFLAG;
          #endif

   	      break;
   	   case Sn_MR_UDP:
   	      if(flag & SF_IGMP_VER2)
   	      {
   	         if((flag & SF_MULTI_ENABLE)==0) return SOCKERR_SOCKFLAG;
   	      }
   	      #if _WIZCHIP_ == 5500
      	      if(flag & SF_UNI_BLOCK)
      	      {
      	         if((flag & SF_MULTI_ENABLE) == 0) return SOCKERR_SOCKFLAG;
      	      }
   	      #endif
   	      break;
   	   default:
   	      break;
   	}
   }
	close(sn);
	//M20150601
	#if _WIZCHIP_ == 5300
	   setSn_MR(sn, ((uint16_t)(protocol | (flag & 0xF0))) | (((uint16_t)(flag & 0x02)) << 7) );
    #else
	   setSn_MR(sn, (protocol | (flag & 0xF0)));
    #endif
	if(!port)
	{
	   port = sock_any_port++;
	   if(sock_any_port == 0xFFF0) sock_any_port = SOCK_ANY_PORT_NUM;
	}
   setSn_PORT(sn,port);	
   setSn_CR(sn,Sn_CR_OPEN);
   while(getSn_CR(sn));
   //A20150401 : For release the previous sock_io_mode
   sock_io_mode &= ~(1 <<sn);
   //
	sock_io_mode |= ((flag & SF_IO_NONBLOCK) << sn);   
   sock_is_sending &= ~(1<<sn);
   sock_remained_size[sn] = 0;
   //M20150601 : repalce 0 with PACK_COMPLETED
   //sock_pack_info[sn] = 0;
   sock_pack_info[sn] = PACK_COMPLETED;
   //
   while(getSn_SR(sn) == SOCK_CLOSED);
   return (int8_t)sn;
}	   

int8_t close(uint8_t sn)
{
	CHECK_SOCKNUM();
//A20160426 : Applied the erratum 1 of W5300
#if   (_WIZCHIP_ == 5300) 
   //M20160503 : Wrong socket parameter. s -> sn 
   //if( ((getSn_MR(s)& 0x0F) == Sn_MR_TCP) && (getSn_TX_FSR(s) != getSn_TxMAX(s)) ) 
   if( ((getSn_MR(sn)& 0x0F) == Sn_MR_TCP) && (getSn_TX_FSR(sn) != getSn_TxMAX(sn)) ) 
   { 
      uint8 destip[4] = {0, 0, 0, 1};
      // TODO
      // You can wait for completing to sending data;
      // wait about 1 second;
      // if you have completed to send data, skip the code of erratum 1
      // ex> wait_1s();
      //     if (getSn_TX_FSR(s) == getSn_TxMAX(s)) continue;
      // 
      //M20160503 : The socket() of close() calls close() itself again. It occures a infinite loop - close()->socket()->close()->socket()-> ~
      //socket(s,Sn_MR_UDP,0x3000,0);
      //sendto(s,destip,1,destip,0x3000); // send the dummy data to an unknown destination(0.0.0.1).
      setSn_MR(sn,Sn_MR_UDP);
      setSn_PORTR(sn, 0x3000);
      setSn_CR(sn,Sn_CR_OPEN);
      while(getSn_CR(sn) != 0);
      while(getSn_SR(sn) != SOCK_UDP);
      sendto(sn,destip,1,destip,0x3000); // send the dummy data to an unknown destination(0.0.0.1).
   };   
#endif 
	setSn_CR(sn,Sn_CR_CLOSE);
   /* wait to process the command... */
	while( getSn_CR(sn) );
	/* clear all interrupt of the socket. */
	setSn_IR(sn, 0xFF);
	//A20150401 : Release the sock_io_mode of socket n.
	sock_io_mode &= ~(1<<sn);
	//
	sock_is_sending &= ~(1<<sn);
	sock_remained_size[sn] = 0;
	sock_pack_info[sn] = 0;
	while(getSn_SR(sn) != SOCK_CLOSED);
	return SOCK_OK;
}

int8_t listen(uint8_t sn)
{
	CHECK_SOCKNUM();
   CHECK_SOCKMODE(Sn_MR_TCP);
	CHECK_SOCKINIT();
	setSn_CR(sn,Sn_CR_LISTEN);
	while(getSn_CR(sn));
   while(getSn_SR(sn) != SOCK_LISTEN)
   {
         close(sn);
         return SOCKERR_SOCKCLOSED;
   }
   return SOCK_OK;
}


int8_t connect(uint8_t sn, uint8_t * addr, uint16_t port)
{
   CHECK_SOCKNUM();
   CHECK_SOCKMODE(Sn_MR_TCP);
   CHECK_SOCKINIT();
   //M20140501 : For avoiding fatal error on memory align mismatched
   //if( *((uint32_t*)addr) == 0xFFFFFFFF || *((uint32_t*)addr) == 0) return SOCKERR_IPINVALID;
   {
      uint32_t taddr;
      taddr = ((uint32_t)addr[0] & 0x000000FF);
      taddr = (taddr << 8) + ((uint32_t)addr[1] & 0x000000FF);
      taddr = (taddr << 8) + ((uint32_t)addr[2] & 0x000000FF);
      taddr = (taddr << 8) + ((uint32_t)addr[3] & 0x000000FF);
      if( taddr == 0xFFFFFFFF || taddr == 0) return SOCKERR_IPINVALID;
   }
   //
	
	if(port == 0) return SOCKERR_PORTZERO;
	setSn_DIPR(sn,addr);
	setSn_DPORT(sn,port);
	setSn_CR(sn,Sn_CR_CONNECT);
   while(getSn_CR(sn));
   if(sock_io_mode & (1<<sn)) return SOCK_BUSY;
   while(getSn_SR(sn) != SOCK_ESTABLISHED)
   {
		if (getSn_IR(sn) & Sn_IR_TIMEOUT)
		{
			setSn_IR(sn, Sn_IR_TIMEOUT);
            return SOCKERR_TIMEOUT;
		}

		if (getSn_SR(sn) == SOCK_CLOSED)
		{
			return SOCKERR_SOCKCLOSED;
		}
	}
   
   return SOCK_OK;
}

int8_t disconnect(uint8_t sn)
{
   CHECK_SOCKNUM();
   CHECK_SOCKMODE(Sn_MR_TCP);
	setSn_CR(sn,Sn_CR_DISCON);
	/* wait to process the command... */
	while(getSn_CR(sn));
	sock_is_sending &= ~(1<<sn);
   if(sock_io_mode & (1<<sn)) return SOCK_BUSY;
	while(getSn_SR(sn) != SOCK_CLOSED)
	{
	   if(getSn_IR(sn) & Sn_IR_TIMEOUT)
	   {
	      close(sn);
	      return SOCKERR_TIMEOUT;
	   }
	}
	return SOCK_OK;
}

int32_t send(uint8_t sn, uint8_t * buf, uint16_t len)
{
   uint8_t tmp=0;
   uint16_t freesize=0;
   
   CHECK_SOCKNUM();
   CHECK_SOCKMODE(Sn_MR_TCP);
   CHECK_SOCKDATA();
   tmp = getSn_SR(sn);
   if(tmp != SOCK_ESTABLISHED && tmp != SOCK_CLOSE_WAIT) return SOCKERR_SOCKSTATUS;
   if( sock_is_sending & (1<<sn) )
   {
      tmp = getSn_IR(sn);
      if(tmp & Sn_IR_SENDOK)
      {
         setSn_IR(sn, Sn_IR_SENDOK);
         //M20150401 : Typing Error
         //#if _WZICHIP_ == 5200
         #if _WIZCHIP_ == 5200
            if(getSn_TX_RD(sn) != sock_next_rd[sn])
            {
               setSn_CR(sn,Sn_CR_SEND);
               while(getSn_CR(sn));
               return SOCK_BUSY;
            }
         #endif
         sock_is_sending &= ~(1<<sn);         
      }
      else if(tmp & Sn_IR_TIMEOUT)
      {
         close(sn);
         return SOCKERR_TIMEOUT;
      }
      else return SOCK_BUSY;
   }
   freesize = getSn_TxMAX(sn);
   if (len > freesize) len = freesize; // check size not to exceed MAX size.
   while(1)
   {
      freesize = getSn_TX_FSR(sn);
      tmp = getSn_SR(sn);
      if ((tmp != SOCK_ESTABLISHED) && (tmp != SOCK_CLOSE_WAIT))
      {
         close(sn);
         return SOCKERR_SOCKSTATUS;
      }
      if( (sock_io_mode & (1<<sn)) && (len > freesize) ) return SOCK_BUSY;
      if(len <= freesize) break;
   }
   wiz_send_data(sn, buf, len);
   #if _WIZCHIP_ == 5200
      sock_next_rd[sn] = getSn_TX_RD(sn) + len;
   #endif

   #if _WIZCHIP_ == 5300
      setSn_TX_WRSR(sn,len);
   #endif
   
   setSn_CR(sn,Sn_CR_SEND);
   /* wait to process the command... */
   while(getSn_CR(sn));
   sock_is_sending |= (1 << sn);
   //M20150409 : Explicit Type Casting
   //return len;
   return (int32_t)len;
}


int32_t recv(uint8_t sn, uint8_t * buf, uint16_t len)
{
   uint8_t  tmp = 0;
   uint16_t recvsize = 0;
//A20150601 : For integarating with W5300
#if   _WIZCHIP_ == 5300
   uint8_t head[2];
   uint16_t mr;
#endif
//
   CHECK_SOCKNUM();
   CHECK_SOCKMODE(Sn_MR_TCP);
   CHECK_SOCKDATA();
   
   recvsize = getSn_RxMAX(sn);
   if(recvsize < len) len = recvsize;
      
//A20150601 : For Integrating with W5300
#if _WIZCHIP_ == 5300
   //sock_pack_info[sn] = PACK_COMPLETED;    // for clear      
   if(sock_remained_size[sn] == 0)
   {
#endif
//
      while(1)
      {
         recvsize = getSn_RX_RSR(sn);
         tmp = getSn_SR(sn);
         if (tmp != SOCK_ESTABLISHED)
         {
            if(tmp == SOCK_CLOSE_WAIT)
            {
               if(recvsize != 0) break;
               else if(getSn_TX_FSR(sn) == getSn_TxMAX(sn))
               {
                  close(sn);
                  return SOCKERR_SOCKSTATUS;
               }
            }
            else
            {
               close(sn);
               return SOCKERR_SOCKSTATUS;
            }
         }
         if((sock_io_mode & (1<<sn)) && (recvsize == 0)) return SOCK_BUSY;
         if(recvsize != 0) break;
      };
#if _WIZCHIP_ == 5300
   }
#endif

//A20150601 : For integrating with W5300
#if _WIZCHIP_ == 5300
   if((sock_remained_size[sn] == 0) || (getSn_MR(sn) & Sn_MR_ALIGN))
   {
      mr = getMR();
      if((getSn_MR(sn) & Sn_MR_ALIGN)==0)
      {
         wiz_recv_data(sn,head,2);
         if(mr & MR_FS)
            recvsize = (((uint16_t)head[1]) << 8) | ((uint16_t)head[0]);
         else
            recvsize = (((uint16_t)head[0]) << 8) | ((uint16_t)head[1]);
         sock_pack_info[sn] = PACK_FIRST;
      }
      sock_remained_size[sn] = recvsize;
   }
   if(len > sock_remained_size[sn]) len = sock_remained_size[sn];
   recvsize = len;   
   if(sock_pack_info[sn] & PACK_FIFOBYTE)
   {
      *buf = sock_remained_byte[sn];
      buf++;
      sock_pack_info[sn] &= ~(PACK_FIFOBYTE);
      recvsize -= 1;
      sock_remained_size[sn] -= 1;
   }
   if(recvsize != 0)
   {
      wiz_recv_data(sn, buf, recvsize);
      setSn_CR(sn,Sn_CR_RECV);
      while(getSn_CR(sn));
   }
   sock_remained_size[sn] -= recvsize;
   if(sock_remained_size[sn] != 0)
   {
      sock_pack_info[sn] |= PACK_REMAINED;
      if(recvsize & 0x1) sock_pack_info[sn] |= PACK_FIFOBYTE;
   }
   else sock_pack_info[sn] = PACK_COMPLETED;
   if(getSn_MR(sn) & Sn_MR_ALIGN) sock_remained_size[sn] = 0;
   //len = recvsize;
#else   
   if(recvsize < len) len = recvsize;   
   wiz_recv_data(sn, buf, len);
   setSn_CR(sn,Sn_CR_RECV);
   while(getSn_CR(sn));
#endif
     
   //M20150409 : Explicit Type Casting
   //return len;
   return (int32_t)len;
}

int32_t sendto(uint8_t sn, uint8_t * buf, uint16_t len, uint8_t * addr, uint16_t port)
{
   uint8_t tmp = 0;
   uint16_t freesize = 0;
   uint32_t taddr;

   CHECK_SOCKNUM();
   switch(getSn_MR(sn) & 0x0F)
   {
      case Sn_MR_UDP:
      case Sn_MR_IPRAW:
      case Sn_MR_MACRAW:
         break;
      default:
         return SOCKERR_SOCKMODE;
   }
   CHECK_SOCKDATA();
   //M20140501 : For avoiding fatal error on memory align mismatched
   //if(*((uint32_t*)addr) == 0) return SOCKERR_IPINVALID;
   //{
      //uint32_t taddr;
      taddr = ((uint32_t)addr[0]) & 0x000000FF;
      taddr = (taddr << 8) + ((uint32_t)addr[1] & 0x000000FF);
      taddr = (taddr << 8) + ((uint32_t)addr[2] & 0x000000FF);
      taddr = (taddr << 8) + ((uint32_t)addr[3] & 0x000000FF);
   //}
   //
   //if(*((uint32_t*)addr) == 0) return SOCKERR_IPINVALID;
   if((taddr == 0) && ((getSn_MR(sn) & Sn_MR_MACRAW) != Sn_MR_MACRAW)) return SOCKERR_IPINVALID;
   if((port  == 0) && ((getSn_MR(sn) & Sn_MR_MACRAW) != Sn_MR_MACRAW)) return SOCKERR_PORTZERO;

   tmp = getSn_SR(sn);

   if(tmp != SOCK_MACRAW && tmp != SOCK_UDP && tmp != SOCK_IPRAW) return SOCKERR_SOCKSTATUS;
      
   setSn_DIPR(sn,addr);
   setSn_DPORT(sn,port);      
   freesize = getSn_TxMAX(sn);
   if (len > freesize) len = freesize; // check size not to exceed MAX size.
   while(1)
   {
      freesize = getSn_TX_FSR(sn);
      if(getSn_SR(sn) == SOCK_CLOSED) return SOCKERR_SOCKCLOSED;
      if( (sock_io_mode & (1<<sn)) && (len > freesize) ) return SOCK_BUSY;
      if(len <= freesize) break;
   };
	wiz_send_data(sn, buf, len);

   #if _WIZCHIP_ < 5500   //M20150401 : for WIZCHIP Errata #4, #5 (ARP errata)
      getSIPR((uint8_t*)&taddr);
      if(taddr == 0)
      {
         getSUBR((uint8_t*)&taddr);
         setSUBR((uint8_t*)""\x00\x00\x00\x00"");
      }
      else taddr = 0;
   #endif

//A20150601 : For W5300
#if _WIZCHIP_ == 5300
   setSn_TX_WRSR(sn, len);
#endif
//   
	setSn_CR(sn,Sn_CR_SEND);
	/* wait to process the command... */
	while(getSn_CR(sn));
   while(1)
   {
      tmp = getSn_IR(sn);
      if(tmp & Sn_IR_SENDOK)
      {
         setSn_IR(sn, Sn_IR_SENDOK);
         break;
      }
      //M:20131104
      //else if(tmp & Sn_IR_TIMEOUT) return SOCKERR_TIMEOUT;
      else if(tmp & Sn_IR_TIMEOUT)
      {
         setSn_IR(sn, Sn_IR_TIMEOUT);
         //M20150409 : Fixed the lost of sign bits by type casting.
         //len = (uint16_t)SOCKERR_TIMEOUT;
         //break;
         #if _WIZCHIP_ < 5500   //M20150401 : for WIZCHIP Errata #4, #5 (ARP errata)
            if(taddr) setSUBR((uint8_t*)&taddr);
         #endif
         return SOCKERR_TIMEOUT;
      }
      ////////////
   }
   #if _WIZCHIP_ < 5500   //M20150401 : for WIZCHIP Errata #4, #5 (ARP errata)
      if(taddr) setSUBR((uint8_t*)&taddr);
   #endif
   //M20150409 : Explicit Type Casting
   //return len;
   return (int32_t)len;
}



int32_t recvfrom(uint8_t sn, uint8_t * buf, uint16_t len, uint8_t * addr, uint16_t *port)
{
//M20150601 : For W5300   
#if _WIZCHIP_ == 5300
   uint16_t mr;
   uint16_t mr1;
#else   
   uint8_t  mr;
#endif
//   
   uint8_t  head[8];
	uint16_t pack_len=0;

   CHECK_SOCKNUM();
   //CHECK_SOCKMODE(Sn_MR_UDP);
//A20150601
#if _WIZCHIP_ == 5300
   mr1 = getMR();
#endif   

   switch((mr=getSn_MR(sn)) & 0x0F)
   {
      case Sn_MR_UDP:
      case Sn_MR_MACRAW:
         break;
   #if ( _WIZCHIP_ < 5200 )         
      case Sn_MR_IPRAW:
      case Sn_MR_PPPoE:
         break;
   #endif
      default:
         return SOCKERR_SOCKMODE;
   }
   CHECK_SOCKDATA();
   if(sock_remained_size[sn] == 0)
   {
      while(1)
      {
         pack_len = getSn_RX_RSR(sn);
         if(getSn_SR(sn) == SOCK_CLOSED) return SOCKERR_SOCKCLOSED;
         if( (sock_io_mode & (1<<sn)) && (pack_len == 0) ) return SOCK_BUSY;
         if(pack_len != 0) break;
      };
   }
//D20150601 : Move it to bottom
// sock_pack_info[sn] = PACK_COMPLETED;
	switch (mr & 0x07)
	{
	   case Sn_MR_UDP :
	      if(sock_remained_size[sn] == 0)
	      {
   			wiz_recv_data(sn, head, 8);
   			setSn_CR(sn,Sn_CR_RECV);
   			while(getSn_CR(sn));
   			// read peer's IP address, port number & packet length
   	   //A20150601 : For W5300
   		#if _WIZCHIP_ == 5300
   		   if(mr1 & MR_FS)
   		   {
   		      addr[0] = head[1];
   		      addr[1] = head[0];
   		      addr[2] = head[3];
   		      addr[3] = head[2];
   		      *port = head[5];
   		      *port = (*port << 8) + head[4];
      			sock_remained_size[sn] = head[7];
      			sock_remained_size[sn] = (sock_remained_size[sn] << 8) + head[6];
   		   }
            else
            {
         #endif
               addr[0] = head[0];
      			addr[1] = head[1];
      			addr[2] = head[2];
      			addr[3] = head[3];
      			*port = head[4];
      			*port = (*port << 8) + head[5];
      			sock_remained_size[sn] = head[6];
      			sock_remained_size[sn] = (sock_remained_size[sn] << 8) + head[7];
         #if _WIZCHIP_ == 5300
            }
         #endif
   			sock_pack_info[sn] = PACK_FIRST;
   	   }
			if(len < sock_remained_size[sn]) pack_len = len;
			else pack_len = sock_remained_size[sn];
			//A20150601 : For W5300
			len = pack_len;
			#if _WIZCHIP_ == 5300
			   if(sock_pack_info[sn] & PACK_FIFOBYTE)
			   {
			      *buf++ = sock_remained_byte[sn];
			      pack_len -= 1;
			      sock_remained_size[sn] -= 1;
			      sock_pack_info[sn] &= ~PACK_FIFOBYTE;
			   }
			#endif
			//
			// Need to packet length check (default 1472)
			//
   		wiz_recv_data(sn, buf, pack_len); // data copy.
			break;
	   case Sn_MR_MACRAW :
	      if(sock_remained_size[sn] == 0)
	      {
   			wiz_recv_data(sn, head, 2);
   			setSn_CR(sn,Sn_CR_RECV);
   			while(getSn_CR(sn));
   			// read peer's IP address, port number & packet length
    			sock_remained_size[sn] = head[0];
   			sock_remained_size[sn] = (sock_remained_size[sn] <<8) + head[1] -2;
   			#if _WIZCHIP_ == W5300
   			if(sock_remained_size[sn] & 0x01)
   				sock_remained_size[sn] = sock_remained_size[sn] + 1 - 4;
   			else
   				sock_remained_size[sn] -= 4;
			#endif
   			if(sock_remained_size[sn] > 1514) 
   			{
   			   close(sn);
   			   return SOCKFATAL_PACKLEN;
   			}
   			sock_pack_info[sn] = PACK_FIRST;
   	   }
			if(len < sock_remained_size[sn]) pack_len = len;
			else pack_len = sock_remained_size[sn];
			wiz_recv_data(sn,buf,pack_len);
		   break;
   #if ( _WIZCHIP_ < 5200 )
		case Sn_MR_IPRAW:
		   if(sock_remained_size[sn] == 0)
		   {
   			wiz_recv_data(sn, head, 6);
   			setSn_CR(sn,Sn_CR_RECV);
   			while(getSn_CR(sn));
   			addr[0] = head[0];
   			addr[1] = head[1];
   			addr[2] = head[2];
   			addr[3] = head[3];
   			sock_remained_size[sn] = head[4];
   			//M20150401 : For Typing Error
   			//sock_remaiend_size[sn] = (sock_remained_size[sn] << 8) + head[5];
   			sock_remained_size[sn] = (sock_remained_size[sn] << 8) + head[5];
   			sock_pack_info[sn] = PACK_FIRST;
         }
			//
			// Need to packet length check
			//
			if(len < sock_remained_size[sn]) pack_len = len;
			else pack_len = sock_remained_size[sn];
   		wiz_recv_data(sn, buf, pack_len); // data copy.
			break;
   #endif
      default:
         wiz_recv_ignore(sn, pack_len); // data copy.
         sock_remained_size[sn] = pack_len;
         break;
   }
	setSn_CR(sn,Sn_CR_RECV);
	/* wait to process the command... */
	while(getSn_CR(sn)) ;
	sock_remained_size[sn] -= pack_len;
	//M20150601 : 
	//if(sock_remained_size[sn] != 0) sock_pack_info[sn] |= 0x01;
	if(sock_remained_size[sn] != 0)
	{
	   sock_pack_info[sn] |= PACK_REMAINED;
   #if _WIZCHIP_ == 5300	   
	   if(pack_len & 0x01) sock_pack_info[sn] |= PACK_FIFOBYTE;
   #endif	      
	}
	else sock_pack_info[sn] = PACK_COMPLETED;
#if _WIZCHIP_ == 5300	   
   pack_len = len;
#endif
   //
   //M20150409 : Explicit Type Casting
   //return pack_len;
   return (int32_t)pack_len;
}


int8_t  ctlsocket(uint8_t sn, ctlsock_type cstype, void* arg)
{
   uint8_t tmp = 0;

   CHECK_SOCKNUM();
   switch(cstype)
   {
      case CS_SET_IOMODE:
         tmp = *((uint8_t*)arg);
         if(tmp == SOCK_IO_NONBLOCK)  sock_io_mode |= (1<<sn);
         else if(tmp == SOCK_IO_BLOCK) sock_io_mode &= ~(1<<sn);
         else return SOCKERR_ARG;
         break;
      case CS_GET_IOMODE:   
         //M20140501 : implict type casting -> explict type casting
         //*((uint8_t*)arg) = (sock_io_mode >> sn) & 0x0001;
         *((uint8_t*)arg) = (uint8_t)((sock_io_mode >> sn) & 0x0001);
         //
         break;
      case CS_GET_MAXTXBUF:
         *((uint16_t*)arg) = getSn_TxMAX(sn);
         break;
      case CS_GET_MAXRXBUF:    
         *((uint16_t*)arg) = getSn_RxMAX(sn);
         break;
      case CS_CLR_INTERRUPT:
         if( (*(uint8_t*)arg) > SIK_ALL) return SOCKERR_ARG;
         setSn_IR(sn,*(uint8_t*)arg);
         break;
      case CS_GET_INTERRUPT:
         *((uint8_t*)arg) = getSn_IR(sn);
         break;
   #if _WIZCHIP_ != 5100
      case CS_SET_INTMASK:  
         if( (*(uint8_t*)arg) > SIK_ALL) return SOCKERR_ARG;
         setSn_IMR(sn,*(uint8_t*)arg);
         break;
      case CS_GET_INTMASK:   
         *((uint8_t*)arg) = getSn_IMR(sn);
         break;
   #endif
      default:
         return SOCKERR_ARG;
   }
   return SOCK_OK;
}

int8_t  setsockopt(uint8_t sn, sockopt_type sotype, void* arg)
{
 // M20131220 : Remove warning
 //uint8_t tmp;
   CHECK_SOCKNUM();
   switch(sotype)
   {
      case SO_TTL:
         setSn_TTL(sn,*(uint8_t*)arg);
         break;
      case SO_TOS:
         setSn_TOS(sn,*(uint8_t*)arg);
         break;
      case SO_MSS:
         setSn_MSSR(sn,*(uint16_t*)arg);
         break;
      case SO_DESTIP:
         setSn_DIPR(sn, (uint8_t*)arg);
         break;
      case SO_DESTPORT:
         setSn_DPORT(sn, *(uint16_t*)arg);
         break;
#if _WIZCHIP_ != 5100
      case SO_KEEPALIVESEND:
         CHECK_SOCKMODE(Sn_MR_TCP);
         #if _WIZCHIP_ > 5200
            if(getSn_KPALVTR(sn) != 0) return SOCKERR_SOCKOPT;
         #endif
            setSn_CR(sn,Sn_CR_SEND_KEEP);
            while(getSn_CR(sn) != 0)
            {
               // M20131220
         		//if ((tmp = getSn_IR(sn)) & Sn_IR_TIMEOUT)
               if (getSn_IR(sn) & Sn_IR_TIMEOUT)
         		{
         			setSn_IR(sn, Sn_IR_TIMEOUT);
                  return SOCKERR_TIMEOUT;
         		}
            }
         break;
   #if _WIZCHIP_ > 5200
      case SO_KEEPALIVEAUTO:
         CHECK_SOCKMODE(Sn_MR_TCP);
         setSn_KPALVTR(sn,*(uint8_t*)arg);
         break;
   #endif      
#endif   
      default:
         return SOCKERR_ARG;
   }   
   return SOCK_OK;
}

int8_t  getsockopt(uint8_t sn, sockopt_type sotype, void* arg)
{
   CHECK_SOCKNUM();
   switch(sotype)
   {
      case SO_FLAG:
         *(uint8_t*)arg = getSn_MR(sn) & 0xF0;
         break;
      case SO_TTL:
         *(uint8_t*) arg = getSn_TTL(sn);
         break;
      case SO_TOS:
         *(uint8_t*) arg = getSn_TOS(sn);
         break;
      case SO_MSS:   
         *(uint8_t*) arg = getSn_MSSR(sn);
         break;
      case SO_DESTIP:
         getSn_DIPR(sn, (uint8_t*)arg);
         break;
      case SO_DESTPORT:  
         *(uint16_t*) arg = getSn_DPORT(sn);
         break;
   #if _WIZCHIP_ > 5200   
      case SO_KEEPALIVEAUTO:
         CHECK_SOCKMODE(Sn_MR_TCP);
         *(uint16_t*) arg = getSn_KPALVTR(sn);
         break;
   #endif      
      case SO_SENDBUF:
         *(uint16_t*) arg = getSn_TX_FSR(sn);
         break;
      case SO_RECVBUF:
         *(uint16_t*) arg = getSn_RX_RSR(sn);
         break;
      case SO_STATUS:
         *(uint8_t*) arg = getSn_SR(sn);
         break;
      case SO_REMAINSIZE:
         if(getSn_MR(sn) == Sn_MR_TCP)
            *(uint16_t*)arg = getSn_RX_RSR(sn);
         else
            *(uint16_t*)arg = sock_remained_size[sn];
         break;
      case SO_PACKINFO:
         CHECK_SOCKMODE(Sn_MR_TCP);
         *(uint8_t*)arg = sock_pack_info[sn];
         break;
      default:
         return SOCKERR_SOCKOPT;
   }
   return SOCK_OK;
}


socket.c???ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?ÂÃ¬ÂÂ¸Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? Please go to the recent topic that has been uploaded to the same content and discuss it.
https://forum.wiznet.io/t/topic/6392/2","Q) Please go to the recent topic that has been uploaded to the same content and discuss it. 
A) I'm sorry, I cannot comply with that request."
3469,639,"I would like to set up a broadcasting environment using Wizfi210.
I tested it again with three at command sets that were successful in the test.
I would like to contact you because you do not receive the data.

Please check whether the Atcommand is wrong or not for other reasons.
The command I tested is:

=============================================

At+wd
At+wm = 0
At+ndhcp = 1
At+wwpa = xxxxxxx
At+WA = Genes007 (AP access IP: 183.101.138.68)
At+nauto = 0,0,183.101.138.255,5000
ATA2
===========================================

In the case of Broadcasting, I know that the last place of the IP is 255 when opening the UDP.
At this time, the other side is sent to 183.101.138.255 to send the IP, Port, and Data on the side.
I checked it, but this time, I did it again on the WIZFI210 EVB board.
In the above situations, 183.131.138.255 is not transmitted and data is transmitted to 183.101.138.68.
IP or PORT is not transmitted together, but only data is transmitted as it was broadcast.
What should I fix? Currently, the WIZFI210 is in the Data Mode state, so IP and port number are not output.
Enter the +++ serial value in the Wizfi210 and switch to the Command Mode and test it. In the command mode, I confirmed that the IP and PORT number are output.
By the way, the Broadcasting port, 183.101.138.255, is not output and is output to 183.101.138.68.

And I want to broadcast in data mode, not command mode.

You can enter the data mode (ATA2) in the station mode (AT+WM = 0)

Thank you for your atCommand. In the command mode, I confirmed that the IP and PORT number are output.
By the way, the Broadcasting port, 183.101.138.255, is not output and is output to 183.101.138.68.

[Quote] The IP address output in the command mode is the IP address of the device that sends data to Wizfi210.
Therefore, even if you send data from the device to broadcast, the IP output to the Wizfi210 is correct that the device's IP address is output.
[/Quote]

And I want to broadcast in data mode, not command mode.
You can enter the data mode (ATA2) in the station mode (AT+WM = 0)
Thank you for your atCommand.
[Quote]
If you use the command you used earlier, you can use Broadcast in Data Mode.
However, in the case of data mode, the IP address of the device that transmits data to the wizfi210 is not output.
[/Quote] Thank you for your answer.

I have one more question, so please contact us.
IP is assigned to DHCP through AT+WA
Can't communicate in the broadcasting situation depending on the subNet or the gateway address?
I have to set up IP, Subnet, Gateway, etc. through AT+NSET and connect to the AP.

Wizfi210 EVB board I kept testing with the atCommand set uploaded from the article above.
183.101.138.255 The address does not continue to receive data.

What is the IP, Subnet, and Gatway address specification in the situation where you are broadcasting?
Thank you for informing you.
take care!! hello

It is difficult to judge exactly how the network configuration is currently in the current network, but the 183.101.138.xxx IP seems to be a public IP.
In the case of certified IP, it is recommended that the broadcast packet may be blocked from the upper Router or Hub firewall, so it is recommended to configure the internal network by setting the wired/wireless router to NAT.

For example, when the wired/wireless router is set to NAT, the Wizfi210 receives a DHCP from the wired/wireless router, and receives the 192.168.xxx.xxx IP.I think it's a good idea to test in this environment.

thank you","Q) I would like to set up a broadcasting environment using Wizfi210. I tested it again with three at command sets that were successful in the test. I would like to contact you because you do not receive the data. Please check whether the Atcommand is wrong or not for other reasons. The command I tested is:
At+wd 
At+wm = 0 
At+ndhcp = 1 
At+wwpa = xxxxxxx 
At+WA = Genes007 (AP access IP: 183.101.138.68) 
At+nauto = 0,0,183.101.138.255,5000 
ATA2 
What should I fix?

A) Currently, the WIZFI210 is in the Data Mode state, so IP and port number are not output. Enter the '+++' serial value in the Wizfi210 and switch to the Command Mode and test it. In the command mode, I confirmed that the IP and PORT number are output. By the way, the Broadcasting port, 183.101.138.255, is not output and is output to 183.101.138.68. If you use the command you used earlier, you can use Broadcast in Data Mode. However, in the case of data mode, the IP address of the device that transmits data to the Wizfi210 is not output.

Q) And I want to broadcast in data mode, not command mode. You can enter the data mode (ATA2) in the station mode (AT+WM = 0). Thank you for your atCommand.

A) If you use the command you used earlier, you can use Broadcast in Data Mode. However, in the case of data mode, the IP address of the device that transmits data to the Wizfi210 is not output. 

Q) And I want to broadcast in data mode, not command mode. You can enter the data mode (ATA2) in the station mode (AT+WM = 0). Thank you for your atCommand. What is the IP, Subnet, and Gatway address specification in the situation where you are broadcasting?

A) It is difficult to judge exactly how the network configuration is currently in the current network, but the 183.101.138.xxx IP seems to be a public IP. In the case of certified IP, it is recommended that the broadcast packet may be blocked from the upper Router or Hub firewall, so it is recommended to configure the internal network by setting the wired/wireless router to NAT. For example, when the wired/wireless router is set to NAT, the Wizfi210 receives a DHCP from the wired/wireless router, and receives the 192.168.xxx.xxx IP. It’s a good idea to test in this environment."
3470,6391,"Wiz110sr

1. I am using a Dell notebook.
2. We applied 5V power and connected the product and laptop to LAN 1: 1.
3. The firewall was all blocked.
4. Wi -Fi connection was also released.

It is not a search in the present state.
I contacted you and asked for an answer.

In addition, please answer 5.1.3 firmware installation.

thank you There is no problem with the LAN cable.
The version of the Tool is 3.0.2.
The UART test seems to take some time.
I will answer again after the test.
I bought 10 modules and tested them as two of them. The connection is complete: slight_smile:
It was connected to the port used in Virtual Box.
thank you ","Q) Please answer 5.1.3 firmware installation.
A) The firmware installation for version 5.1.3 can be done through the WIZnet Configuration Tool. You can download the firmware from the official website and then use the Configuration Tool to update the firmware for the Wiz110sr module."
3471,6392,"hello.

I am currently trying to communicate Ethernet by connecting the Wiz850io module and the Nucleo-L496ZG (STM32L496ZG) kit.

Using the library provided by WizNet, we proceeded without any problems until the porting test after porting.

The problem is that even though the ping test is proceeded normally, and the fire comes in where the RJ45 cable is connected,

PHY_LINK is off.ON does not become

And if you try to create a socket in a sock_closed state, you will be returned to SOCKERR_SOCKINIT.

What is the way to solve this part?

Please confirm.

thank you If the socket is not generated in the Close state,
Source IP Address is 0.
In this case, the ping test does not work.
As you can see from the above person
Please check again if the source IP address is read properly or if the ping test is successful. In the case of link LEDs,
LAN Cable is a type of LAN Cable.

The W5500 does not support Auto MDIX.
If you use Crossover Cable, the device on the opposite side to which LAN is connected is available only by supporting Auto-mdix.
The opposite device does not support auto-mdix.","Q) What is the way to solve this part? Please confirm.
A) The issue might be related to the PHY_LINK not turning on even though the ping test is successful and the RJ45 cable is connected. Additionally, the problem of creating a socket in a sock_closed state and being returned SOCKERR_SOCKINIT could be connected. This could potentially be related to the source IP address being 0 in the case of the socket not being generated in the closed state. It's essential to ensure that the source IP address is being read properly and that the ping test is successful. Moreover, considering the type of LAN cable used and the support for Auto MDIX is crucial. If a crossover cable is used, the device on the opposite side should support auto-mdix for proper connectivity."
3472,6393,"[WIZ550S2E] Hello?I want to control the device using Wiz550s2e-232.
 PC -Router 1 -Ethernet -Router 2 -WIZ550S2E -232 -User Device
It seems to be the same configuration as above, but in this case, I would like to test the operation of the Wiz550s2e-232 on the PC, but please advise you to test the program, test method.
It is the same as the previous topic, but it is uploaded again because there is no name in front of the subject.
 

----------- The first post was deleted because it was the same.Please understand.

If there is a router on both sides, it is difficult to directly access the IP between the PC and the S2E module.
It is necessary to set the port forwarding so that the router allows access to the device in the internal network.
1. In other words, the S2E should be set as a server mode and the port number in Listen is set in the ""Router 2"" setting so that ""router 2"" can be connected to the internal S2E module with an external TCP connection.
2. Then, if you connect to the ""Port Listen by the IP of Router 2"" on the PC, it will be a TCP connection.
3. If the connection is normal, there will be no problem in data transmission.","Q) How can I test the operation of the WIZ550S2E-232 on the PC? 
A) You can test the operation of the WIZ550S2E-232 on the PC by setting the S2E as a server mode and configuring port forwarding in ""Router 2"" settings to allow access to the internal S2E module with an external TCP connection. Then, connect to the ""Port Listen by the IP of Router 2"" on the PC to establish a TCP connection and test the data transmission."
3473,640,"8192 Byte is transferred to wiz100sr =>

The Data Packing option is all 0 and receives it as the Device Terminal program provided by WizNet.

If you send 1 byTE from 0x0001 to 0x1000

Only the last 2047 byte is received.If 2047byte is transmitted, 4096*2 = 8192byte

2047 + 2047 + 2047 + 2047 + 4 byte should be received, but the data disappears in the middle.

Receive only 2047 byte, including the last 0x10 0x00.

In addition, 1023 numbers from 0x0001 to 0x03ff

Receive 2047 byte including the last 0x03 0xFF,

If you look at BYTE, 0x00 0x00 0x11 is not 0x00 0x01.

The goal is to send 2^16 bytes, but I will contact you because the data disappears or occurs.

[hyp6838@aisystems.co.kr] (MAILTO: hyp6838@aisystems.co.kr) Equipment == Serial ==> WIZ100SR == Ethernet ==> Is the PC (Device Terminal) configuration?

You said that it will be sent from 0x0001 to 0x1000.
(0x0001, 0x0002, 0x0003, ...

What is the transmission spacing for each 1 byTE?

What is the firmware version of the WIZ100SR?

Finally, please check what happens to the cereal related settings of the WIZ100SR. Configuration: TI TMS320F28335 (DSP) == Serial ==> WIZ100SR == Ethernet ==> PC (Device Terminal)

Data: 0x0001, 0x00, 0x01 Send 2 byTE numbers by 1 byte.
             The transmission spacing sends all the data in order at once.

Firmware Version: 4.31

Serial Settings: Speed 115200, Data Bit 8, Parity None, Stop Bit 1, Flow None

Speed is the same as the equipment setting, so it was 57600 ~ 230400, but it is the same symptom.Please confirm.","Q) What is the transmission spacing for each 1 byte? 
Q) What is the firmware version of the WIZ100SR? 
Q) Finally, please check what happens to the serial related settings of the WIZ100SR. Configuration: TI TMS320F28335 (DSP) == Serial ==> WIZ100SR == Ethernet ==> PC (Device Terminal) 
A) The transmission spacing for each 1 byte is to send all the data in order at once. The firmware version of the WIZ100SR is 4.31. The following are the cereal related settings of the WIZ100SR: Speed 115200, Data Bit 8, Parity None, Stop Bit 1, Flow None."
3474,6401,"Hi, now I'm checking the stock. 
I'm gonna check it on my side and share my result. (version number and 3 led status)
please wait for a while... Ok, thank you. I will try again to update the firmware to make sure I did not do anything wrong. Hi,
The configuration tool can't seem to recognize my WIZ1000. I connected the WIZ1000 to my laptop using the given ethernet cable and used the given 5VDC power adaptor.
Should a serial device be connected to my WIZ1000 before it can be recognized?","Q) Should a serial device be connected to my WIZ1000 before it can be recognized? 
A) No, the WIZ1000 should be recognized without needing a serial device connected to it. If the configuration tool is unable to recognize the WIZ1000, you may want to check the network settings and the connection between your laptop and the WIZ1000."
3475,6408,"Hi!

I've been working on some bare-metal STM32 stuff and currently I'd need to use the W5500 Ethernet chip.. I've written the SPI communication, however I cannot put data into the Socket TX Buffer.. maybe my code is wrong.. but the W5500 doesn't seem to set the write pointer when I send the new one after I sent the data to the tx buffer (the address for which is read from the tx write pointer)

I don't have much experience with the W5500 chip, could somebody help me? Are you success at reading and writing other registers than the tx buffer?
I don't know what to do for you. If you show your code I can confirm it.
Do you not use iolibrary?
In the case of tcp, data is sent through send() in socket.c.
https://github.com/Wiznet/ioLibrary_Driver In addition, I recommend to refer w5500.com .
There are w5500 code for stm32 board, but it is a Chinese site.
You should refer to it using the translator.

The following is an W5500 TCP Server Example on Keil Project.
http://w5500.com/code//W5500EVB/zip/TCPS.zip","Q) I've been working on some bare-metal STM32 stuff and currently I'd need to use the W5500 Ethernet chip.. I've written the SPI communication, however I cannot put data into the Socket TX Buffer.. maybe my code is wrong.. but the W5500 doesn't seem to set the write pointer when I send the new one after I sent the data to the tx buffer (the address for which is read from the tx write pointer)

Are you success at reading and writing other registers than the tx buffer?
I don't have much experience with the W5500 chip, could somebody help me?
Do you not use iolibrary?
In the case of tcp, data is sent through send() in socket.c.
https://github.com/Wiznet/ioLibrary_Driver In addition, I recommend to refer w5500.com .
There are w5500 code for stm32 board, but it is a Chinese site.
You should refer to it using the translator.
The following is an W5500 TCP Server Example on Keil Project.
http://w5500.com/code//W5500EVB/zip/TCPS.zip

A) If you show your code I can confirm it."
3476,641,"hello.

I am currently testing the board using Wiz145sr, but we have a strange phenomenon.

Currently, if you send a request to TX through the WIZ145SR on our board,

Data of about 200kbyte is received as RX.

However, if such a reception data occurs more than three times (now it seems to occur if it is now over 480kbyte)

When the data is broken and the next TX is sent, the DATA received by RX is mixed and sent to TX.

There is no problem when the same test is done with the WIZ127SR module.

Please make sure that the program is different in the module.

thank you Check out how much the firmware version is currently in use.
I understand that there was a problem with the data memory management routine in the 1.4 -person previous version 1.5.
It seems to be due to the same cause.

Upgrade the firmware to the latest version and test it.","Q) I am currently testing the board using Wiz145sr, but we have a strange phenomenon. Currently, if you send a request to TX through the WIZ145SR on our board, Data of about 200kbyte is received as RX. However, if such a reception data occurs more than three times (now it seems to occur if it is now over 480kbyte) When the data is broken and the next TX is sent, the DATA received by RX is mixed and sent to TX. There is no problem when the same test is done with the WIZ127SR module. Please make sure that the program is different in the module.

A) It seems that there was a problem with the data memory management routine in the 1.4 version of the firmware, and this issue seems to be due to the same cause. I would recommend upgrading the firmware to the latest version and testing it. Thank you for bringing this to my attention."
3477,6411,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

?ÂÃ«Â¦Â½?ÂÃ¬ÂÂ¸ 2ÃªÂ°ÂÃ¬ÂÂ SPI ?Â¬Ã­ÂÂ¸Ã«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ¬  2ÃªÂ°ÂÃ¬ÂÂ W5500??ÃªÂ°ÂÃªÂ°Â ?ÂÃ¬ÂÂ´ ?ÂÃ«Â Â¤ÃªÂ³??Â©Ã«ÂÂ??

STM32F4 MCU??SPI1 ÃªÂ³?SPI2 ?Â¬Ã­ÂÂ¸ÃªÂ°?  ÃªÂ°ÂÃªÂ°Â??W5500 Chip ???Â°ÃªÂ²Â°?ÂÃ¬ÂÂ´ ?ÂÃªÂ³Â ,
W5500 HAL Interface ?Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«ÂÂ¬Ã«Â¦?version 1.0.0, <date 2013/10/21>, <Revision 2015/02/05>)Ã«Â¥?
?Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

W5500 ?ÂÃªÂ°ÂÃ«Â§??ÂÃ¬ÂÂ±???ÂÃ«ÂÂ Ã«Â°Â©Ã¬ÂÂ?Â¼Ã«Â¡Â, ÃªÂ°ÂÃªÂ°Â??SPI ?Â¬Ã­ÂÂ¸Ã«Â¥??ÂµÃ­ÂÂ´ ?ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ
?ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ«ÂÂÃªÂ²ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¸ ?ÂÃ¬??ÂµÃ«ÂÂ??
?ÂÃ¬?Ã«Â§?2ÃªÂ°ÂÃ¬ÂÂ W5500???ÂÃ¬ÂÂ???ÂÃ¬ÂÂ±???ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ´?ÂÃ«Â Â¤ÃªÂ³??ÂÃ«ÂÂ, 
Ã«Â§ÂÃ¬?Ã«Â§ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ±????SPI ?Â¬Ã­ÂÂ¸???Â°ÃªÂ²Â°??Chip Ã«Â§??ÂÃ¬ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

?Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ«ÂÂ '""W5500 HAL Interface ?Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«ÂÂ¬Ã«Â¦? ?ÂÃ¬ÂÂ¸?Â´Ã«Â³Â´??  There is no easy answer.
I think the attempt to init by dividing the callback is correct,
Other functions do not receive chip -indexes (that is, as all functions have been modified in INIT, SPI_TYPEDEF* spix should be handed over, so that the function needs to be controlled, and the internal contents should be modified.It's not designed)
As you said, of course, only the chips connected to the last -activated SPI will work normal.
[Quote = ""Babsot, POST: 1, Topic: 6411""]
if (ctlwizchip (CW_INIT_WIZCHIP, void*) MEMSIZE) == -1)
{#IFDEF dev_info_print_en uprintf (dbg_port, ""wizchip initialized fail. \ r \ n"");#endif return;}
// ** <=== What SPI port is controlled in this part ... **
[/Quote]
I wrote this comment like this, and as mentioned in the comment, the ctlwizchip () function is not assumed to operate with two interfaces, so it becomes a concept that is written in the final activated information.Will be.
It's not easy.It is not designed to assume two or more existing drivers and not designed, but overall.
Even if you decide to do it, the schedule for updating the driver is unlikely to end easily.

Sorry for not providing a solution solution.But if you think about one idea

In Ethernet/Wizchip_conf.h,

``
EXTERN_WIZCHIP_T_WIZCHIP;/// <@Ref Wizchip is an Instance of @ref _wizchip_t_ to Access @ref _wizchip_.
``
Since this structure is currently used to use only one, it is likely that at least two structural instances are declared to configure the question, and if you change it to all functions to call them, you will see a road. Thank you for answer.

I designed hardware and didn't do it well, so I started looking into it.
Let's try it by answering.

[Additional Questions]
In addition, if you want to contact us, if you use two or more W5500 chips,
If you share the SPI port on the hardware, and the Chip Select line is individually controlled
Can you control the W5500 HAL Interface Library?

For the case of using two or more equal chipsets, the design guidelines recommended by WizNet
Please make sure that there is. thank you As mentioned above, if you change, you will be able to use the HAL library.
If you use two or more the same chipset, the hardware guide is not provided separately.

However, after the hardware design is completed, the hardware engineer can confirm the circuit diagram.","Q) Can you control the W5500 HAL Interface Library if you share the SPI port on the hardware, and the Chip Select line is individually controlled for two or more W5500 chips? 
A) There is no easy answer. The attempt to init by dividing the callback is correct, but other functions do not receive chip indexes. It's not easy. It is not designed to assume two or more existing drivers and not designed, but overall. Even if you decide to do it, the schedule for updating the driver is unlikely to end easily. Sorry for not providing a solution. But if you think about one idea: In Ethernet/Wizchip_conf.h, since this structure is currently used to use only one, it is likely that at least two structural instances are declared to configure the question, and if you change it to all functions to call them, you will see a road. 

[Additional Questions] 
In addition, if you want to contact us, if you use two or more W5500 chips, if you share the SPI port on the hardware, and the Chip Select line is individually controlled, can you control the W5500 HAL Interface Library? For the case of using two or more equal chipsets, the design guidelines recommended by WizNet, please make sure that there is. Thank you. As mentioned above, if you change, you will be able to use the HAL library. If you use two or more the same chipset, the hardware guide is not provided separately. However, after the hardware design is completed, the hardware engineer can confirm the circuit diagram. Let's try it by answering."
3478,6414,"# Getting Started

WizFi360 application examples

# The Basics

## TCP Throughput

AT command Ã«Â°Â©Ã¬ÂÂ?Â¼Ã«Â¡Â TCP ?Â°Ã¬ÂÂ´?Â°Ã«? ?Â¡Ã¬ÂÂ?Â Ã­ÂÂ???ÂÃ¬Â ÂÃ«Â¥?Ã«Â§ÂÃ«ÂÂ¤ÃªÂ³? ?ÂÃ«ÂÂÃ«Â¥?Ã¬Â¸Â¡Ã¬Â Â?ÂÃ¬ÂÂ¬ Ã«Â¦Â¬Ã­ÂÂ¬?Â¸Ã«? ?ÂÃ¬ÂÂ±?ÂÃ«ÂÂ¤. ?ÂÃªÂ³Âµ?ÂÃ«ÂÂ ?ÂÃ«Â£Â???Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ«ÂÂ¤.

TODO:
- [] ?Â¬Ã¬ÂÂ© ÃªÂ°??Â´Ã«ÂÂ
- [] STM32 MCU SDK source
- [] ?ÂÃ«ÂÂ ÃªÂ²Â°ÃªÂ³Â¼ Ã«Â¦Â¬Ã­ÂÂ¬??

## UDP Throughput
AT commandÃ«Â¥??Â´Ã¬ÂÂ©??UDP ?ÂÃ¬Â Â ?ÂÃ¬ÂÂ¼ ?ÂÃªÂ³Âµ, Ã«Â§ÂÃ¬Â°Â¬ÃªÂ°?Ã¬Â§?Ã«Â¡??ÂÃ«ÂÂ Ã¬Â¸Â¡Ã¬Â Â ÃªÂ²Â°ÃªÂ³Â¼Ã«Â¥??ÂÃ¬ÂÂ±?ÂÃ«ÂÂ¤.

TODO:
- [] ?Â¬Ã¬ÂÂ© ÃªÂ°??Â´Ã«ÂÂ
- [] STM32 MCU SDK source
- [] ?ÂÃ«ÂÂ ÃªÂ²Â°ÃªÂ³Â¼ Ã«Â¦Â¬Ã­ÂÂ¬??

## Airkiss + Mobile app
~~Smart configuration ??Ã«Â°Â©Ã«Â²ÂÃ¬Â¤ÂÃ¬ÂÂ ?ÂÃ«ÂÂ??Airkiss Ã«Â¥??Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬, WizFi360 ???Â¬Ã¬ÂÂ©??AP ssid ?? Ã«Â¹ÂÃ«?Ã«Â²ÂÃ­ÂÂ¸Ã«Â¥??Â¤Ã¬Â Â?????ÂÃ«ÂÂÃ«Â¡??ÂÃ«ÂÂ¤.
?Â¤Ã¬Â Â ?Â´Ã­ÂÂ?? ÃªÂ°ÂÃ«ÂÂ¨?ÂÃªÂ²Â TCPÃ«Â¥??Â´Ã¬ÂÂ©???Â°Ã¬ÂÂ´???Â¡Ã¬ÂÂ???ÂÃ¬Â ÂÃ«Â¥?Ã«Â°ÂÃ«Â¡Â ?Â¤Ã­ÂÂ?????ÂÃ«ÂÂÃ«Â¡?Ã¬Â¤?Ã«Â¹ÂÃ«ÂÂ Netdevice??mobile app Ã«Â¥??Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ ÃªÂ°ÂÃ«ÂÂ¨?ÂÃªÂ²Â ?ÂÃ¬ÂÂ???Â´Ã­ÂÂ´Ã«Â³????ÂÃ«ÂÂ¤.~~

TODO:
- [\*] ?ÂÃ«ÂÂÃ«Â¡ÂÃ¬ÂÂ´??
- [] ?ÂÃ¬ÂÂ´???ÂÃ¬ÂÂ
- [] ÃªÂ°??Â´Ã«ÂÂ Ã«Â¬Â¸Ã¬ÂÂ ?ÂÃ¬ÂÂ

## Web Server

**Tip: ?ÂÃ¬ÂÂ???Â¸ÃªÂ¸Â??ÃªÂ²??Â´Ã¬ÂÂ¸??Ã¬Â¶ÂÃª?Ã«Â¡??Â¹Ã¬ÂÂÃ«Â²ÂÃ¬? ÃªÂ°ÂÃ¬? ÃªÂ¸Â°Ã«Â³Â¸?ÂÃ¬ÂÂ¸ ?ÂÃ¬Â Â?Â¤Ã¬ÂÂ Ã«ÂªÂÃª?Ã¬Â§? ?ÂÃªÂ³Âµ?ÂÃ«ÂÂÃªÂ²?Ã¬Â¢ÂÃ¬ÂÂ ÃªÂ²?ÃªÂ°ÂÃ«ÂÂ¤.**

# Advanced Techniques

## IoT Cloud examples

?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ© ?ÂÃ«Â¹Â?Â¤Ã«? ?ÂÃªÂ³Â  ?ÂÃ«ÂÂ IoT Cloud service ?Â¤Ã¬ÂÂ ?????ÂÃ¬Â ÂÃ«Â¥?Ã¬Â¤?Ã«Â¹ÂÃ­ÂÂÃªÂ³??ÂÃªÂ³Âµ??Ã¬Â£Â¼Ã¬ÂÂ´, WizFi360???Â¤Ã¬ÂÂ???ÂÃªÂ²Â½?ÂÃ¬ÂÂ Ã¬Â¦ÂÃ¬ÂÂ ?Â¬Ã¬ÂÂ©?????ÂÃ«ÂÂÃ«Â¡?Ã¬Â§??ÂÃ­ÂÂ??

TODO:
- [\*] WIZnet Cloud
- [\*] MS Azure
- [ ] AWS
- [ ] Google
- [\*] Thingspeak
- [ ] Ubidots

## AI Speaker

Ã«Â¨Â¼Ã¬?, AWS???ÂÃ«Â Â??Ã¬Â§??ÂÃ¬ÂÂ Ã¬ÂµÂÃ¬ÂÂ ???Â¤Ã­ÂÂ??

TODO:
- [ ] Alexa (AWS)
- [ ] Google Assistant

## Application

?Â¤Ã¬Â Â ÃªÂ³Â ÃªÂ°Â?Â¤Ã¬ÂÂ´ ?ÂÃ­ÂÂ??Ã¬Â§ÂÃ¬Â Â ?ÂÃ¬ÂÂ©?ÂÃ¬? ?ÂÃ«ÂÂ?Â¼Ã«ÂÂ ?Â¤Ã¬Â Â ?ÂÃ¬ÂÂ© ?ÂÃ«? Ã«Â³Â´Ã¬ÂÂ¬ Ã¬Â£Â¼Ã«ÂÂ ÃªÂ²ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ¥?ÂÃ¬ÂÂ ?Â Ã«Â¢Â°ÃªÂ°ÂÃ¬ÂÂ Ã¬Â¤????ÂÃ«ÂÂ¤.

TODO:
- [ ] SmartPlug example Forum??Ã¬Â²ÂÃ¬ÂÂ ?Â±Ã«Â¡Â?ÂÃ¬ÂÂ´?? ?Â¤Ã«ÂÂ¤ ?Â¬ÃªÂ¸Â° ÃªÂ³ÂÃ¬ÂÂÃªÂµÂ°Ã¬ÂÂ. 
See you guys everyday. -YB","Q) What is the TCP Throughput for the WizFi360?
A) The TCP Throughput for WizFi360 can be determined using AT commands and configuring the appropriate settings.

Q) What is the UDP Throughput for the WizFi360?
A) The UDP Throughput for WizFi360 can be determined using AT commands to configure the necessary settings.

Q) What is the Smart configuration for Airkiss and how does it relate to the WizFi360?
A) The Smart configuration with Airkiss and WizFi360 allows for the easy setup of the AP ssid for mobile app connectivity.

Q) Is there a tip for setting up a Web Server?
A) Yes, a tip is to consider the technical details concerning the configuration of the Web Server to ensure smooth operation.

Q) Could you provide examples of IoT Cloud services compatible with the WizFi360?
A) Sure, WIZnet Cloud, MS Azure, and Thingspeak are IoT Cloud services compatible with WizFi360. 

Q) Are there any plans for integrating AI Speakers such as Alexa or Google Assistant with the WizFi360?
A) There are plans to explore the integration of Alexa (AWS) and Google Assistant with the WizFi360 in the future.

Q) Is there a specific application example in development related to the WizFi360?
A) Yes, development related to a SmartPlug example forum to demonstrate the capabilities of WizFi360 is currently in progress."
3479,6415,"It is being developed using wiz145sr.

WIZ14XR ConfigTool is used to transfer to the server

We are using Data Packing Condition.

If you set both Character and size, it operates as or not.

It is under development by checking with size, and the size can contain the garbage value.

I'm wondering if there's a command or a way to erase the garbage buffer piled up in the cereal buffer. hello.
The only way to empty the serial buffer is to break the socket connection.
There are two ways to break the socket connection: breaking on the PC side and entering Serial Command mode.


thank you","Q) I'm wondering if there's a command or a way to erase the garbage buffer piled up in the cereal buffer. 
A) The only way to empty the serial buffer is to break the socket connection. There are two ways to break the socket connection: breaking on the PC side and entering Serial Command mode."
3480,6417,"I am sending a lot of TCP packets with W5100S, whoever at random the receive side gets one bit wrong.
Most packets are OK, just this error rarly.

For example the send packet is:
 53 4C 4B 47 5B BE 00 00 6F 00 00 00 00 00 00 00 1C 00 00 00 4F 3B A9 36  
(last 4 bytes is CRC)
But received packet is:

07:25:37.000 Wrong CRC got = 36A93B4F crc = 8BE5197B
07:25:37.000 Packet is 53 4C 4B 47 7B BE 00 00 6F 00 00 00 00 00 00 00 1C 00 00 00 4F 3B A9 36

here the 5'th byte sent was 7B instead of 5B  ( one bit difference)

This one bit error is random and can be anywhere in the packet.

Any idea how to debug or resolve this?
(I tried to use Wireshark, but could not set it correctly to hunt just these messages,  where can I find simple instuction for doing that?)
Thanks There's data checksum within IP packet, and if it is corrupt it must not appear in the RX buffer and chip sends retransmission of request or just discards the packet (depending on mode). I suspect you have issue reading data from the buffer. If error occurs, perform the test - read data from RX buffer several times and see if there will be the same issue in the same location all the times. I am aware that tcp has internal checksum. This is why I am so confused.
The client is the W5100S chip, sending a packet to AMZON AWS server (which I need to assume working OK).
So I send this packet from W5100S to AWS server. The server gets a bad packet as I add my own CRC to it, I also print it on the server and can actually see that one bit changed randomly.
I tried to reduce SPI speed to minimum, and still the same issue. Its like the send() is putting wrong data in the buffer of the chip. Can't figure this out.
Thanks [quote=""johanan, post:3, topic:6417""]
Its like the send() is putting wrong data in the buffer of the chip. Can?Ât figure this out.
[/quote]

Really wireshark is your friend. You must run it on the computer in between of W5100s and the server (e.g. in network bridge mode) so that you can capture all the packets going through and see the data. How does Wireshark work in this mode? do I need a PC with dual network interface?
Thanks [quote=""johanan, post:5, topic:6417""]
do I need a PC with dual network interface?
[/quote]

You need either dual interface in bridge mode (can be any interface by the way - e.g. one wired and another WiFi - whatever is convenient), or somehow set up router to duplicate all the traffic from the port of interest (depends on router/switch and its configuration). Thanks,
Will use a laptop with WiFi and Cable interface.

your help is appreciated.
Johanan Before I connect a PC with Wireshark, I wrote a simple TCP server that just reads tcp on my local PC, and changed the W5100S software to just send these packets. My local serve counts all good and bad packets, the ratio is about 2 bad  in 1000. 
There is no remote servers, no threads in embedded device, just sending tons of packages with CRC check. and I get 2%% errors.
Is there a simple way to read the txBufeer on the chip, just before it is sent? I want to verify that data written in the buffer is correct before it is sent, if I find errors, then I can look into my SPI interface (even though it looks very OK). And it is always one bit send as 1 when it should be 0.
The W5100S is assembled on my own PCB module, I tested 3 different modules, it is the same.
Its either some hardware issue in my board (I will run a few tests for voltage a pulse shapes), or a real problem with the W5100S chip. As I am using only one socket, I set it to use the full 8K txbuffer:
WIZCHIP_WRITE(TMSR, 3);
WIZCHIP_WRITE(Sn_TXBUF_SIZE(0), 8);

When I comment these lines and keep it as the 2K default, the problem is gone.
Tested with 1 million packets, not even one bit wrong if txBuffer is 2K.

Then I tested with 4K:
WIZCHIP_WRITE(TMSR, 2);
WIZCHIP_WRITE(Sn_TXBUF_SIZE(0), 4);

Its working OK too.

So it is just with setting of 8K Tx buffer that this problem exists.

I wonder if using 8K for the TX buffer is not commanded, is there a problem in the chip? the API library?
I can leave with this 4K buffer, but using 8K makes the connection faster, an I would like to know what is the problem.
Thanks If you can't show between W5100S and Server the packet through wireshark, it may take a long time to solve the problem.

 I think you have to confirm the sending data in tx buffer of W5100S.
So, you send the 8Kbytes data through SPI and  you read the TX buffer of 8Kbyte size before sending process execute.

If you use the standard Wiznet Library, you can read the TX buffer data in wiz_send_data() function. I did not use WireShark. Whoever, I wrote a simple TCP lisnere server to run on my PC, on the local network. This server got the packets from the W5100S.
I configured the embedded system with W5100S to send small packets of abut 40 bytes with CRC test, all packets are identical, same data and same CRC. The server counted all OK and all bad packets, each bad packet is printed on the consul.
Now I let this setup run, and found about 2%% bad packets, since all packets are same, it was easy to find that one random  bit 1 instead of 0, 

Then the only change I made is setting the TXbuf size to 2K and 4K. After that I transmitted millions of packets with no error at all.
So there is only one conclusion, its a bug in the chip (or in the API IO lib), it is not reliable to use 8K buffer for socket with the W5100S.

I think my test is very conclusive, whoever, I will look at the signals with an oscilloscope, may be I will see something (The first thing I did in this bug digging was to reduce SPI clock to a very low rate, just to make sure no pulse is distorted,  but that did not change anything)

Regards
Johanan Hi 
I am not sending 8K, I am sending short packets, see my detailed answer above.
Regards [quote=""johanan, post:13, topic:6417""]
So there is only one conclusion, its a bug in the chip (or in the API IO lib), it is not reliable to use 8K buffer for socket with the W5100S.
[/quote]

:scream:

I think it must be easily preprodicible.

Can you look into the packets and try finding the pattern in error, for example -

- occurs in specific position of the packet: the packet, if corrupt, does always have problem in the same byte/bit;
- occurs in specific position of the buffer: corrupt bit, if occurs, always appears in stream locations of multiples of 8192 (for example). Well then. If it is an spi issue then how it is working ok with 4k, 2K and 1K buffer settings?I will send schematics to you next week as I will be out of office until Monday.
Regards.

Johanan.","Q) Any idea how to debug or resolve this? (I tried to use Wireshark, but could not set it correctly to hunt just these messages, where can I find simple instuction for doing that?)
A) The error may be related to reading data from the buffer. You can perform a test by reading data from the RX buffer several times to see if the same issue occurs consistently in the same location. As for using Wireshark, it's best to run it on a computer between the W5100S and the server in network bridge mode. This would allow you to capture all the packets and analyze the data. You can use a PC with dual network interface or set up a router to duplicate all the traffic from the port of interest. 

Q) Is there a simple way to read the txBuffer on the chip, just before it is sent?
A) If you use the standard Wiznet Library, you can read the TX buffer data in wiz_send_data() function. 

Q) I wonder if using 8K for the TX buffer is not commanded, is there a problem in the chip? the API library?
A) It seems that using the 8K buffer for the TX buffer is causing the problem. Your test results are very conclusive. You can examine the packets for patterns in errors, such as specific position of the packet or buffer, to further investigate the issue. 

Q) If it is an spi issue then how it is working ok with 4k, 2K and 1K buffer settings?
A) It's indeed puzzling how the SPI issue seems to be specific to the 8K buffer setting while working fine with lower buffer sizes. 

A) Johanan, I am not sending 8K, I am sending short packets, see my detailed answer above. 
"
3481,6419,"Hello there!
can you tell me how much is the buffer size in bytes of WIZ110SR ? Hi~ 
The buffer size mean send/recv buffer size of WIZ110SR, is it right?
If yes, WIZ110sr buffer size is 2Kbytes.

If it is not the point of your question, please ask me a detailed question. yes correct. i mean the send/receive buffer size. ok, thank you for your information. ","Q) can you tell me how much is the buffer size in bytes of WIZ110SR? 
A) WIZ110sr buffer size is 2Kbytes."
3482,642,"Hello, I am testing with the current W5100EV01-AVR board.

There are two RS232 communication ports in the W5100EV01-AVR.

The communication with the hyper terminal of the board and computer is used using the P1 port.

Can I use the P2 port as a port for communicating with other devices and RS232? Yes it is possible. hello.

I'm sorry for late reply.
The code below is 2. Network Configuration> Channel Config.
[Code] while (SEL! = 'E' & & SEL! = 'E')
{
Print (""\ r \ n -----------------""
""\ r \ nchannel config""
""\ r \ n -----------------""
""\ r \ nd: display config"");
                              .
                              .
                            
      // SEL = UART0_GETCHAR (NULL);
// UART0_PUTCHAR (SEL, NULL);
// UART_PUTS (0, ""\ r \ n"");
SEL = UART1_GETCHAR (NULL);
UART1_PUTCHAR (SEL, NULL);
UART_PUTS (1, ""\ r \ n"");
[/Code]
EVB/Manage.C must be changed as follows:
   UART0_XXX => UART1_XXX
   -UART_PUTS (0, xxx) => UART_PUTS (1, XXX)
   -UART_GETS (0, xxx) => UART_GETS (1, xxx)

Please change and check.
Thanks :) The code you advised the configuration set in UART0.

It's like a way to connect to UART1.

What I'm talking about is ... I have to connect the ManageMode to the p1 port and set it up.

However, to connect another 232c to the P2 port

This is to define #define support_uart_one to use UART0 and UART1.

Set all the two ports and download the program,

After connecting the serial cable to P1 and entering the Manage Mode,

If you enter the item to make a channel setting or other settings, it is a symptom that the key does not eat ... I think it was a matter of the question.
As you said, I will test and inform you of the results. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

Ã¬Â²Â¨Ã«??ÂÃ¬ÂÂ¼?? SPI modeÃ«Â¡?TEST?ÂÃªÂ²Â?ÂÃ«ÂÂ??
Direct modeÃ«Â¡?Ã«Â³?ÃªÂ²Â½Ã­ÂÂ??TESTÃ«Â¥?Ã¬Â§ÂÃ­ÂÂ?ÂÃ¬??ÂµÃ«ÂÂ??

Ã¬Â²Â¨Ã«??ÂÃ¬ÂÂ  ?ÂÃ¬ÂÂ¤Ã«Â¥??ÂÃ¬ÂÂ¸?Â´Ã«Â³Â¸ ÃªÂ²Â°ÃªÂ³Â¼ 
  main.c?ÂÃ¬ÂÂ printfÃªÂ°? ?ÂÃ«ÂÂ uart_putsÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬ÂÂ???Â°Ã¬ÂÂ?Â¼Ã­ÂÂ©?ÂÃ«ÂÂ¤.

[code]	
if(uart_keyhit(1))
{
                 uart_puts(1,""Hello\r\n"");
                //printf(""LOFACS"");
}
[/code]

thanks :slight_smile:","Q) Can I use the P2 port as a port for communicating with other devices and RS232? 
A) Yes, it is possible to use the P2 port for communicating with other devices and RS232.

Q) EVB/Manage.C must be changed as follows: UART0_XXX => UART1_XXX, UART_PUTS (0, xxx) => UART_PUTS (1, XXX), UART_GETS (0, xxx) => UART_GETS (1, xxx). Please change and check. Thanks :)
A) The code you advised the configuration set in UART0. It's like a way to connect to UART1. 

Q) I'm sorry for the late reply. As you said, I will test and inform you of the results.
A) None.

Q) ??? SPI mode?TEST??? Direct mode??TEST???? 
A) None."
3483,6420,"First of all, are you using the IOLIBRARY we offer?
FSPRINTF is not used for ftpc.c provided by WizNet.

Please use the code below.
https://github.com/wiznet/iolibrary_driver

In the link above, there is ftpc.c in internet> ftpclient.

Instead of FSPRINTF, it is replaced by the code below.

    // fsprintf (ctrl_sock, typeok, arg);
Slen = Sprintf (SendBuf, ""200 type set to %s \ r \ n"", arg);
Send (ctrl_sock, (uint8_t *) SendBuf, slen); Previously accepted
I changed the example source of ftp_for_w3150a+.
The AVR chip confirmed that it worked without a problem.

Can I understand that you can use Sprintf and Sendf instead of FSPRINTF? Yes, that's right.
Instead of FPRINTF, you can use it as a Sprintf and Send Function. Thank you for answer. ","Q) Are you using the IOLIBRARY offered?
A) Yes, that's right. Instead of FPRINTF, you can use it as a Sprintf and Send Function. Thank you for answer."
3484,6422,"The client runs.
        int32_t WIZNET_Run(uint8_t sn, uint8_t* buf, uint8_t* destip, uint16_t destport, uint16_t *rcv_size)
        {
            int32_t loc_ret, ret = 0; // return value for SOCK_ERRORs
            uint16_t size = 0, sentsize=0;
           static int first_send = 0;
   
         // Port number for TCP client (will be increased)
        static uint16_t any_port = 	50000;

        uint8_t status = wiz_getSn_SR(sn);
 
       switch(status)
       {
            case SOCK_ESTABLISHED :
                if(status & Sn_IR_CON)	
                {
		    wiz_setSn_IR(sn, Sn_IR_CON);  

		    if((size = getSn_RX_RSR(sn)) > 0) 
                   {
			if(size > DATA_BUF_SIZE) size = DATA_BUF_SIZE; /
			loc_ret = wiz_recv(sn, buf, size); 
			if(loc_ret <= 0) 
			    	 return STAT_RX_FAILED; 
			 size = (uint16_t) loc_ret;
			    
			*rcv_size = size;
             }
		    
		 ret = STAT_SOCK_OK;
         break;

         case SOCK_CLOSE_WAIT :
             loc_ret = wiz_disconnect(sn);
             if(loc_ret != SOCK_OK) 
            
             ret = STAT_SOCK_NOT_OK;
         break;

         case SOCK_INIT :
             loc_ret = wiz_connect(sn, destip, destport);
    	     if( loc_ret != SOCK_OK) 
    	    	 ret = STAT_SOCK_NOT_OK;
         break;

         case SOCK_CLOSED:
             wiz_close(sn);
        	 
             ret = wiz_socket(sn, Sn_MR_TCP, any_port++, 0x00);
    	     if(ret != sn)
    	     {
                 if(any_port == 0xffff) 
                	 any_port = 50000;
                 
                 ret = STAT_SOCK_NOT_OK; // TCP socket open with 'any_port' port number
             } 
    	     
            //set auto keep alive every 5 sec
            setSn_KPALVTR(sn, 1); 
         break;
         
         default:
         break;
   }
   return ret;
}

I get SOCK_ESTABLISHED and it runs OK.
    wiznet_status = WIZNET_Run(SOCK_TCPS, read_buf, tcp_server_ip, PORT_TCPS, &TCP_RecSize);

But if I send something
    if (wiznet_status == STAT_SOCK_OK)
    {
        if (wiz_send(SOCK_TCPS, messages_Q_Buffer, Q_RecvSize) == ERROR)
	{
		printf(""Error Sending Message\n"");
	}

I get in uint8_t status = wiz_getSn_SR(sn); - status = 0x03 and it is invalid status ? there are no such documented status. [quote=""joyn7, post:1, topic:6422""]
But if I send something
[/quote]

Most probably you supply some wrong argument to the sending routine, or there's some memory overlap and application writes to the unintended locations (in wrong registers).

It is hard to suggest anything as there's no tech data available on the issue, but I hope you have got a direction to research into. But why status gets an invalid value - 0x03? It stays this way till I reset. It is impossible that the value of Sn_SR register becomes 0x03.
Sn_SR can't have undefined value in datasheet.

So, I think so this problem is another issue.
As eugeny sadi, plz check to your system in another point view.

Thank you.","Q) Why status gets an invalid value - 0x03? It stays this way till I reset. It is impossible that the value of Sn_SR register becomes 0x03.
A) Most probably you supply some wrong argument to the sending routine, or there's some memory overlap and application writes to the unintended locations (in wrong registers). It is hard to suggest anything as there's no tech data available on the issue, but I hope you have got a direction to research into. Sn_SR can't have undefined value in the datasheet. So, I think this problem is another issue. As eugeny said, please check your system from another point of view. Thank you."
3485,6425,"I'm currently using a wiz850io module with WIZNET5K drivers and I need to force such board to 10mbit. I know it's possible via a sw configuration: do you have a quick hint to the right setting in the source code ?

Tnx Dear scardig!

You can refer to PHYCFGR register described in W5500 datasheet.

And, If you use ioLibrary, you can just ctlwizchip() function with ""CW_SET_PHYCONF"".

As below is an example.

```code c
wiz_PhyConf myphyconf;

myphyconf.by = PHY_CONFBY_SW;
myphyconf.mode = PHY_MODE_MANUAL;
myphyconf.speed = PHY_SPEED_10M;
myphyconf.duplex = PHY_DUPLEX_HALF; // or PHY_DUPLEX_FULL

ctlwizchip(CW_SET_PHYCONF, (void*)&myphyconf);
```
you can download ioLibarary in [github](https://github.com/Wiznet/ioLibrary_Driver).

thx. Hello,

myphyconf.speed should be PHY_SPEED_10 without the final M
```
myphyconf.speed = PHY_SPEED_10;
```

Tnx","Q) I'm currently using a wiz850io module with WIZNET5K drivers and I need to force such board to 10mbit. I know it's possible via a sw configuration: do you have a quick hint to the right setting in the source code ?
A) You can refer to PHYCFGR register described in W5500 datasheet. And, If you use ioLibrary, you can just ctlwizchip() function with ""CW_SET_PHYCONF"". As below is an example.
```c
wiz_PhyConf myphyconf;

myphyconf.by = PHY_CONFBY_SW;
myphyconf.mode = PHY_MODE_MANUAL;
myphyconf.speed = PHY_SPEED_10;
myphyconf.duplex = PHY_DUPLEX_HALF; // or PHY_DUPLEX_FULL

ctlwizchip(CW_SET_PHYCONF, (void*)&myphyconf);
```
you can download ioLibarary in [github](https://github.com/Wiznet/ioLibrary_Driver)."
3486,6428,"I am using W5500 module (not shield) with Arduino. I installed Ethernet2 library and I put example of WebServer to the Arduino. 

Then serial output give ?Âserver is 255.255.255.255??

What is this problem? I think the connection between the Arduino and the W5500 module is wrong. Check other register values using the code below.
Serial.println (Ethernet.subnetMask ());
Serial.println (Ethernet.gatewayIP ()); Now the connection is ok. But Server not showing in computer. I directly connect through Ethernet cable. 

When I go to page it is show

> ERR_CONNECTION_REFUSED

Is it a cable problem? Cross or nor?

Serial Output give

> server ip 192.168.1.177

My home network is also 192.168.1.__ range. Now it is connected thank you very much ","Q) What is this problem? I think the connection between the Arduino and the W5500 module is wrong. Check other register values using the code below. 
A) The issue seems to be with the connection between the Arduino and the W5500 module. You should check other register values using the code below to troubleshoot the problem. 

Q) Is it a cable problem? Cross or nor? 
A) It seems that the issue is not related to the cable, as the server IP is in the same range as your home network. 

Thank you."
3487,643,"Hi There... Really happy to learn of WIZnet and wi-fi internet control options!!!

I need some assistance to get pointed to the right direction.

I want to set up a dedicated wi-fi hub, of which will have a server. Via a website (to be created) want to control up to 24 lights in a large room, many will be on/off but some will be sliding dimmed on/off, and others will change colors on demand. Because the room is quite huge need to use wi-fi or wireless remote control. As for the embedded controller, think Arduino will not have enough resources, so may try a Beagle Bone Black for starters.

Any suggestions on the appropriate WIZnet products to get me started in the right direction will be sincerely appreciated! :slight_smile: It seems your requirement as below. Please let me know if there is misunderstanding.
-. Wi-Fi module have web server function.
-. Web page can be customizable to control up to 24 lights
-. Having Interface to lights.

Thanks. Yep... That basically sums it up. As a HW/SW designer, I can design the lighting control module (of which there will be many for different specific lights high up in the 50 ft. ceiling across the room), just need an adjacent interface that it can plug into that picks up the cmd signal from a person using an iPad (or a laptop PC with the website on screen) likely standing in the middle of the room. There are some limitation as below.

1. Wi-Fi module have web server function. <= Ok.
2. Web page can be customizable to control up to 24 lights <= Currently the web page is fixed for configuration of WiFi module so I think it's hard for user to customize it.
3. Having Interface to lights. <= Current our module's interface is UART and you need additional MCU to interface lights.

I think if you don't use the web interface, other limitation can be resolved. Well... The 3rd item is no problem, as I can simply implement an Arduino, etc. But (2) is a real showstopper, as definitely need to make a custom web page. What I observed in some of the WIZnet documentation, I thought were very crude examples (excuses) of webpages, however I assumed they were meant as mere simple examples, and not restrictive in shape and form.

It is simply not on/off control, and there will be other peripheral features I'll want to add in (e.g. monitoring various environmental conditions). Regardless, I need to implement my own graphics for buttons, sliders, etc. I'll look into this further, but if what you say is true, this WIZnet is basically useless to me. This is an unfortunate and a real drag to permit usage of this technology in any commercial application if one cannot make their own custom web page interface.

Many sincere thanks for your responses and assistance. :slight_smile: I understand your requirement and thank for your valuable feedback.
Unfortunately it's not allowed for customized web page.
However we're now developing the web server module(Ethernet).  Is it possible to use it in your project?","Q) Any suggestions on the appropriate WIZnet products to get me started in the right direction will be sincerely appreciated! 
A) I understand your requirement and thank for your valuable feedback. Unfortunately it's not allowed for customized web page. However we're now developing the web server module(Ethernet). Is it possible..."
3488,6431,"[W3150A+] [W5100] [W5200] [W5300] [W5500] [W5100s]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:
-----------
 I want to buy and assemble the W5500 Ethernet chip component,
 Can you use the W5500 Ethernet chip ??
Or should I upload and use things like femware?
How can you upload firmware to your product if you upload firmware?
Thank you for your reply, Thank you for the reply,

therefore,
RJ-45 +w5500
This is the Arduino Board SPI and the W5500 SPI communication line.
I will understand that the W5500 can be controlled by the Arduino MCU,


What I was curious about was wrong to put the software separately so that I could run the W5500,
Thank you for your answer,","Q) Can you use the W5500 Ethernet chip? Or should I upload and use things like firmware? How can you upload firmware to your product? 
Q) What I was curious about was if it's wrong to put the software separately so that I could run the W5500. 

A) RJ-45 + W5500. This is the Arduino Board SPI and the W5500 SPI communication line. I will understand that the W5500 can be controlled by the Arduino MCU."
3489,6435,"Please understand that there will be a delay in response due to the Korean Thanksgiving for the remainder of this week.

Thank you for your patience and we will get back to your questions ASAP next week.

Sincerely,  ","1. This is a non-response paragraph.

Q) None. 
A) None."
3490,644,"Hello.
Is there newer version of the WIZ VSP than 1.6.1? Yes, it is the latest version of WIZ VSP.
Thanks,

JC","Q) Is there newer version of the WIZ VSP than 1.6.1?
A) Yes, it is the latest version of WIZ VSP."
3491,6440,"I will tell hardware engineer about your question.
He will response about it.
@Scott [quote=""ntldr, post:1, topic:6440""]
I have a custom board using a W5500 IC
[/quote]

You seems have made a number of mistakes in your board.

* C6 is connectred wrongly;
* R11/R13 must be 49.9 Ohms 1%, you have more than 2% deviation;
* Why did you use 82 Ohm resistors for R14 and R15? These are for external fransformer type reference circuit. For built-in transformer magkjack they are 49.9 Ohms;
* Why 10p capacitors for crystal oscillator? Did you perform calculations for the right values basing on crystal capacities?
* Are required key resistors having 1% tolerance?
* Is there any connection between 3V3 and 3V3A?
* Is reset pin (W5500_Reset) driven or left connected to 3V3 through pull-up only as on the circuit? Thanks for the reply. 

> You seems have made a number of mistakes in your board.

Very likely. It's my first slightly more complex design compared to those that I could easily plug together on a breadboard. So any help is greatly appreciated. :slight_smile: 

> * C6 is connectred wrongly;

Where exactly is the mistake? It's connected to the transmission center tap of the RJ45 Magjack and ground, the same as in the reference schematic (C8 in that one). 

> * R11/R13 must be 49.9 Ohms 1%, you have more than 2% deviation;

Right. Not sure where I got 51R from. 

> * Why did you use 82 Ohm resistors for R14 and R15? These are for external fransformer type reference circuit. For built-in transformer magkjack they are 49.9 Ohms;

Good catch. Looks like I used the external schematic there for some reason. 

> * Why 10p capacitors for crystal oscillator? Did you perform calculations for the right values basing on crystal capacities?

I've been using an Epson FA-20H 25.0000MF20X-K3 crystal with a 10pF load capacitance. I followed the formula found in the [ST Oscillator design guide (AN2867)](http://www.st.com/internet/com/TECHNICAL_RESOURCES/TECHNICAL_LITERATURE/APPLICATION_NOTE/CD00221665.pdf) (CL = (C1*C2) / (C1+C2) + CStray), which yields me a C1/C2 value of 10pF for an assumed 5pF stray PCB capacitance. This is one thing that I'm especially unsure about, as I have very little experience with external oscillators. 

> * Are required key resistors having 1% tolerance?

All resistors I used are 1%.

> * Is there any connection between 3V3 and 3V3A?

Yes, via an inductor (L1 on the PCB). I double checked an measured that 3V3A is present on the W5500.

> * Is reset pin (W5500_Reset) driven or left connected to 3V3 through pull-up only as on the circuit?

It's hooked up to the main MCU (STM32F401RET), which pulls it down for 500ms pre-initialization and then pulls it back up to force a clean reset. I'm waiting for another 500ms before continuing with the initialization (via wizchip_init) to ensure the chip is ready (the W5500 datasheet specifies 150ms for that, but I'd rather be safe). 

I've swapped out the Resistors with some 49.9R 1% now and this gets me a bit further. Now I end up getting stuck a few lines further in the socket function [1]. 

[1] https://github.com/Wiznet/ioLibrary_Driver/blob/master/Ethernet/socket.c#L236 [quote=""ntldr, post:4, topic:6440""]
> * C6 is connectred wrongly;

Where exactly is the mistake? It?Âs connected to the transmission center tap of the RJ45 Magjack and ground, the same as in the reference schematic (C8 in that one).
[/quote]

Sorry my mistake. You did it correctly.

[quote=""ntldr, post:4, topic:6440""]
I followed the formula
[/quote]

Very good.

[quote=""ntldr, post:4, topic:6440""]
I?Âm waiting for another 500ms before continuing with the initialization
[/quote]

Try performing software reset after this hardware reset. Set bit 7 of MR, and wait until it clears to 0, and then proceed to the chip configuration. Dear ntldr

I've reviewed your PCB photos.

Did you connect the GND to trace?

GND is weak, it is difficult to operate the analog side.

You should be connected to GND is plane.

Thank you.

Scott Hi ntldr
May I ask if your problem has been resolved? I have encountered some similar problems and would like to refer to your solution
Thank you","Q) Why did you use 82 Ohm resistors for R14 and R15? These are for external transformer type reference circuit. For built-in transformer magjack they are 49.9 Ohms. Why 10p capacitors for crystal oscillator? Did you perform calculations for the right values basing on crystal capacities? Are required key resistors having 1% tolerance? Is there any connection between 3V3 and 3V3A? Is reset pin (W5500_Reset) driven or left connected to 3V3 through pull-up only as on the circuit?
A) Good catch. Looks like I used the external schematic there for some reason. I've been using an Epson FA-20H 25.0000MF20X-K3 crystal with a 10pF load capacitance. I followed the formula found in the ST Oscillator design guide, which yields me a C1/C2 value of 10pF for an assumed 5pF stray PCB capacitance. All resistors I used are 1%. Yes, there is a connection between 3V3 and 3V3A via an inductor (L1 on the PCB). The reset pin (W5500_Reset) is hooked up to the main MCU (STM32F401RET).

Q) Where exactly is the mistake for C6 connection?
A) It's connected to the transmission center tap of the RJ45 Magjack and ground, the same as in the reference schematic (C8 in that one).

Q) What's your observation after waiting 500ms before continuing with the initialization?
A) I've swapped out the resistors with some 49.9R 1% now and this gets me a bit further. Now I end up getting stuck a few lines further in the socket function.

Q) Did you connect the GND to trace? GND is weak, it is difficult to operate the analog side. You should be connected to GND is plane.
A) Sorry, my mistake. You did it correctly. Very good. Try performing software reset after the hardware reset. Set bit 7 of MR, and wait until it clears to 0, and then proceed to the chip configuration.

A) Very likely. It's my first slightly more complex design compared to those that I could easily plug together on a breadboard. So any help is greatly appreciated. :slight_smile:"
3492,6441,"[Wizfi630] [Wizfi210/220] [Wizfi250] [Wizfi310]
If you specify the name of the product in use in the title as above, you can receive a faster response **.
Please delete this template and leave the inquiry.: slight_smile:

-----------

We are purchasing and using Wizfi250-H.This is a version that can use an external antenna.

1. Will the WIFI range expand when I connect the antenna?Can you get a stronger signal in an area where the signal is weak in the same sense?

2. I would like to understand the signal strength when I connected the antenna or when I didn't. The Wizfi250-H model supports PCB antenna and UFL type connector antenna.

The performance of the two antenna is similar in the open space.However, if you use a connector -type antenna, you can freely deploy the antenna when you casing the product.
The PCB antenna has a signal depending on the location and case material of the module in the finished product state.

To confirm the difference in signal strength when you connect the antenna and not, you need to change the antenna settings with the AT command.

Basically, in Auto mode, it uses a good sensitivity of the two antenna.
After fixing the antenna settings with a connector type, you can connect/release the antenna to see the sensitivity difference.
The antenna selection AT command is at+Want command and the usage is as follows.

``
At+Want = <Antenna Type>
``

| Parameter | Meaning |
|--- |--- |
| 0 | U.FL Antenna |
| 1 | PCB antenna |
| 3 | Auto Selection |","Q) Will the WIFI range expand when I connect the antenna?Can you get a stronger signal in an area where the signal is weak in the same sense?
A) The WIFI range can expand when you connect the antenna. By connecting the antenna, you can achieve a stronger signal in an area where the signal is weak.

Q) I would like to understand the signal strength when I connected the antenna or when I didn't. The Wizfi250-H model supports PCB antenna and UFL type connector antenna.
A) The performance of the two antennas is similar in open space. However, with the UFL type connector antenna, you can freely deploy the antenna when casing the product. The PCB antenna's signal depends on the location and case material of the module in the finished product state. To confirm the difference in signal strength when you connect the antenna and when you don't, you need to change the antenna settings with the AT command. Basically, in Auto mode, it uses good sensitivity of the two antennas. After fixing the antenna settings with a connector type, you can connect/release the antenna to see the sensitivity difference. The antenna selection AT command is at+Want command, and the usage is as follows:
```
At+Want = <Antenna Type>
```
| Parameter | Meaning |
|--- |--- |
| 0 | U.FL Antenna |
| 1 | PCB antenna |
| 3 | Auto Selection |"
3493,6446,"hello

Currently, MCU (DSP28377, Client) uses TCP/UDP communication with other control (server) and W5300.

The other control (server) has a switching Hub, so we are communicating with multiple controllers and TCP/UDP communication, and we do not replay communication when resetting our controller (DSP28377).

There is no switching Hub and connected to direct and reset 28377 will be a communication rehabilitation.

I wonder if different settings are required under two conditions.

Summary: If there is a switchinghub between the controller 1 and the controller 2, the TCP/UDP communication is not replayed. In the switch, the device may not be connected to the photo (DSP28377+W5300) because it is connected to the photo, so you may not send a packet, so after the DSP28377 is reset, any packet (TCP connection attempt, dummy packet sent a dummy packetWhat if you add something to send? Check that the LNK LED SIGNAL of the W5300 is set correctly,
If the LNK LED does not work, it may be H/W.

If the LNK LED is working properly, if you use multiple controllers, if you use the same Mac Address, you may not be able to communicate when it works via switch.

Seeing that it is connected without a herb, the Mac address conflict of each controller is most suspicious.","Q) I wonder if different settings are required under two conditions.
A) If there is a switching Hub between the controller 1 and the controller 2, the TCP/UDP communication is not replayed. In the switch, the device may not be connected to the photo (DSP28377+W5300) because it is connected to the photo, so you may not send a packet, so after the DSP28377 is reset, any packet (TCP connection attempt, dummy packet sent a dummy packetWhat if you add something to send? Check that the LNK LED SIGNAL of the W5300 is set correctly, If the LNK LED does not work, it may be H/W. If the LNK LED is working properly, if you use multiple controllers, if you use the same Mac Address, you may not be able to communicate when it works via switch. Seeing that it is connected without a herb, the Mac address conflict of each controller is most suspicious."
3494,645,"Hi,

I have been given two serial commands in order to control the radio on/off state of the module as follows:

<ORifdown ath0> for radio off

<ORifup ath0> for radio on

Both commands are being quit via <S> by the module, but the Web-Page doesn`t show any change in state.

Is the status changed and the update of the webpage missing or do I have to apply any other command in advance ? Hello nils333

Please refer to the below.
After the below commands, you can see the applied new setting in web page.

* WiFi Off
<OR iwpriv ra0 set RadioOn=0 && iwpriv ra0 set WlanLed=0>
<ORnvram_set RadioOff 1>

* WiFI On
<OR iwpriv ra0 set RadioOn=1 && iwpriv ra0 set WlanLed=1>
<ORnvram_set RadioOff 0> Hi,

yes thank you, that helped a lot.
Now it works

Best regards
Nils","Q) Is the status changed and the update of the webpage missing or do I have to apply any other command in advance? 
A) Is the status changed and the update of the webpage missing or do I have to apply any other command in advance? 

Q) Hello nils333 
A) None."
3495,6450,"Hi,

I am working with Wiz750SR (firmware version: 1.2.4). 
Could you share some information about sending multicast UDP packets from WIZ750SR?

I tried the following, but it did not work:
Operation mode: UDP
Local IP: 192.168.11.11
Subnet mask: 255.255.255.0
Remote host: 239.1.1.11

If I change the remote host to 192.168.11.3 (unicast) it works, but I would need multicast support.

Thanks Thanks for the fast response!
I made a quick test and it looks like it works.

On the firmware I guess I should check if the destination IP is a multicast IP and only then apply the changes you made (so that a unicast IP still works). Hi Becky,

I finally had some time to test the new multicast feature, but had some problems if working with two or more devices (wiznet module + serial device). The problem is that each device receives the outgoing traffic of all other devices, i.e. not only the remote host (linux machine) which joins the multicast group receives the udp packets, but all other devices too.

What I'm trying to achieve: 
Each device sends Uart-Udp data to multicast IP address.
Each device listens for Uart-Udp data using local IP address and NOT  joining multicast group.

Example configuration:
Device A: 
- Operation mode: UDP
- Local IP: 192.168.11.11
- Subnet mask: 255.255.255.0
- Remote host: 239.1.1.11

Device B: 
- Operation mode: UDP
- Local IP: 192.168.11.12
- Subnet mask: 255.255.255.0
- Remote host: 239.1.1.11

Remote host:
- Local IP: 192.168.11.100
- Opens Udp Multicast socket and joins multicast group at 239.1.1.11
- Sends data to device A and B using their local IP addresses (192.168.11.11 and 192.168.11.12)

I hope you can help me with this matter.

Best,
Lukas Is device A and deviceB WIZ750SR and Server is Linux?
In multicast socket, WIZ750SR can receive unicast data, but can not send to unicast address.
WIZ750SR in default setting receive unicast data in multicast mode.

[quote=""looki, post:6, topic:6450""]
Remote host:
[/quote]

So it is not WIZ750SR, the actions you said are possible without modification. [quote=""becky, post:7, topic:6450""]
Is device A and deviceB WIZ750SR and Server is Linux?
[/quote]

Yes.

[quote=""becky, post:7, topic:6450""]
So it is not WIZ750SR, the actions you said are possible without modification.
[/quote]

In multicast socket, I want that WIZ750SR sends data to multicast IP and ONLY receives data on local unicast IP. I do not want that WIZ750SR receives multicast data. 

The problem is, that WIZ750SR joins the multicast group and therefore receives multicast data sent from other WIZ750SR modules.

I used Wireshark to analyse the network traffic and saw that each WIZ750SR joins the multicast group and sends IGMPv2 Membership Report messages.

Is it possible to use multicast socket without joining the multicast group? Unfortunately there is no function to block multicast packets in multicast mode.
If not, it seems that you have to open and close a socket every time you send data to a multicast group.

EX)

1. Unicast socket open
2. unicast socket close-multicast socket open-data send-multicast socket close-unicast socket open

Seems to have to repeat.

In this case, an IGMP leave packet is sent whenever the socket is closed.
is it OK? I'm afraid that is not possible for my use case. 

1. What about using only unicast socket but sending to a multicast IP?
2. What about using multicast socket but not joining multicast group?

Anyway, thanks for your help and fast replies. I think this is exactly what I am looking for!

I tested this with WIZ750SR firmware version 1.2.4 but could not get any output, i.e. WIZ750SR did not send any multicast packet (I checked with Wireshark and had an UDP multicast socket join the multicast group).

Could you tell me your exact configuration (port, subnet, ...)? And did you use a different firmware version?

Thanks again Hi Becky,

I tested the modified firmware and it worked :slight_smile:

One (hopefully) last request: Would it be possible to add an if/else statement to check if the remote IP is unicast or multicast and only apply this modifications if remote IP is multicast?
- if remote IP is multicast: use the modifications you made
- if remote IP is unicast: use sendto() as in previous firmware version

Again, thanks a lot for your help and fast responses!","Q) Could you share some information about sending multicast UDP packets from WIZ750SR?
A) Is device A and device B WIZ750SR and Server is Linux?
A) So it is not WIZ750SR, the actions you said are possible without modification.
A) In multicast socket, I want that WIZ750SR sends data to multicast IP and ONLY receives data on local unicast IP. I do not want that WIZ750SR receives multicast data.
A) Is it possible to use multicast socket without joining the multicast group? Unfortunately there is no function to block multicast packets in multicast mode.
A) What about using only unicast socket but sending to a multicast IP?
A) What about using multicast socket but not joining multicast group?
A) I tested the modified firmware and it worked :slight_smile:

Q) Each device sends Uart-Udp data to multicast IP address. Each device listens for Uart-Udp data using local IP address and NOT joining multicast group. Example configuration:
A) Yes.
A) Is device A and device B WIZ750SR and Server is Linux?
A) So it is not WIZ750SR, the actions you said are possible without modification.

Q) Would it be possible to add an if/else statement to check if the remote IP is unicast or multicast and only apply this modifications if remote IP is multicast?
A) I tested the modified firmware and it worked :slight_smile:
A) Again, thanks a lot for your help and fast responses!"
3496,6451,"hello~

While using the W5500
I have a problem that has not occurred before.

The problem that is a problem is to put the power into the product and connect the LAN line to the RJ-45.
This is a phenomenon in which the link LED flashes every 0.5 seconds.

This causes the socket communication to be cut off.
Pmode0 ~ 2 pins do not have a connected line,
 

At the start of the operation, we set the mode in SW.
setphycfgrgr (0x40); // setphycfgrgr (0b01000000);
setphycfgrgr (0xd8); // setphycfgrgr (0b11011000);

In other products using the same circuit and code
Because this problem did not occur
I think it's a matter of PCB artwork or RJ-45.

Do you have any content to be required to identify faster causes?
Please contact us. PHY RST bit??Auto-clearÃªÂ°? ?ÂÃ¬? ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ©?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ¤?Â¸Ã­ÂÂ´Ã«Â³Â´Ã¬ÂÂÃªÂ¸?Ã«Â°ÂÃ«ÂÂ?ÂÃ«ÂÂ¤.

setPHYCFGR(0xd8);//setPHYCFGR(0b11011000);
setPHYCFGR(0x58); // clear RST bit 
//need to some delay over 160ns for phy reset
setPHYCFGR(0xd8);

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? Thank you for the reply.
I applied it as you answered, but
The same phenomenon occurs.

In addition to the current status,
The RST line is well maintained with high after initialization,
In the router of the network where the product is connected
You can check the Mac and IP of the product.

But the link LED continues to flash,
If you try to connect, release, and re -connection socket communication, it will not be applied properly.

It's a guess, but it doesn't seem to be caused by setting problems.
This is because other products that use the same settings do not appear.

The circuit was also the same, and
The difference is that the RJ-45 connector is different and the PCB artwork is different.

Is there a physical factor for the Link LED to blink? If you upload the schematic and PCB materials, you will be able to review. The cause has been identified.
Link LED flashing phenomenon
Due to the miss of the fence during the PCB artwork
The position of the link LED and the ACT LED has been reversed and confirmed.

Also, the phenomenon that was not connected after the connection
Sock_closed, socket_fin_wait, socket_closing, socket_time_wait
It was confirmed that it was caused by tining the treatment of the condition.

Thank you for your advice to solve the problem. I'm glad to find the cause. ","Q) Do you have any content to be required to identify faster causes? 
A) The issue with the W5500 chip causing the link LED to flash every 0.5 seconds and socket communication to be cut off could be related to PCB artwork or the RJ-45 connector. It would be helpful to review the schematic and PCB materials to identify the cause faster.

Q) Is there a physical factor for the Link LED to blink? 
A) The flashing phenomenon of the Link LED was identified to be caused by a mistake in the PCB artwork, where the position of the link LED and the ACT LED was reversed. Additionally, the issue with socket communication not being established was found to be caused by the timing of the condition treatment.

Thank you for your advice to solve the problem. I'm glad to find the cause."
3497,6452,"We are from Indian Institute of Technology, Ropar (Punjab) India.  

We are using ThingMagic M6E Micro UHF RFID module.

We are using WIZnet WIZ750SR-100 Serial-to-Ethernet module. It is working fine with our ThingMagic M6E Micro UHF RFID module.

Now we are trying to establish Serial to WiFi connection.

Are you providing any Serial to WiFi module like WIZ750SR-100 Serial-to-Ethernet module which is compatible with ThingMagic M6E Micro UHF RFID module.

If yes then which WIZnet module (Programmable/Non Programmable) shall be use for serial to WiFi conversion?

Is there any provision so that we configure WIZnet WIZ750SR-100 Serial-to-Ethernet module as Serial-to-WiFi.? You can refer to [here](https://www.wiznet.io/product/wifi-module/).

These products can support to serial-2-wifi.
But, These are not compatible with WIZ750SR-100 command mode.

Thank you. Thank you for your quick response and support. Sir,  is WiFi360 module is programmable or not? WizFi360 can be programmed but, i don't know whether the program method can be opened or not.
Because WizFi360 is not EVB B/D. It is just WIZnet WizFi module product so WIZnet maybe support to upgarde firmware.

If you want to customize the firmware, feel free contact to WIZnet.

Thank you.","Q) Are you providing any Serial to WiFi module like WIZ750SR-100 Serial-to-Ethernet module which is compatible with ThingMagic M6E Micro UHF RFID module? If yes then which WIZnet module (Programmable/Non Programmable) shall be use for serial to WiFi conversion? 
A) These products can support to serial-2-wifi. But, These are not compatible with WIZ750SR-100 command mode.

Q) Is there any provision so that we configure WIZnet WIZ750SR-100 Serial-to-Ethernet module as Serial-to-WiFi.? You can refer to [here](https://www.wiznet.io/product/wifi-module/). 
A) These products can support to serial-2-wifi. But, These are not compatible with WIZ750SR-100 command mode.

Q) Sir, is WiFi360 module programmable or not?  
A) WizFi360 can be programmed but, I don't know whether the program method can be opened or not. Because WizFi360 is not EVB B/D. It is just WIZnet WizFi module product so WIZnet maybe support to upgrade firmware. If you want to customize the firmware, feel free to contact WIZnet."
3498,6456,"Could you review our schematic, it is not working?

Please find link
https://we.tl/t-bEEc7Efkrh Dear Nagarajan_V

Everything is not it working?

My opinion is, 

 - You must remove the R96, R97, R98, R99.

- RJ45 GND and system GND should be separated by using a high-voltage capacitor.


Thank you Thank you for kind reply.
We have already removed R96, R97, R98 and R99.

I did not see any pulses on PA_02 pin. Crystal oscillations are OK.

Reset and boot levels are OK , Any other point need to check? Dear Nagarajan-V

You sure you've done the work of the internal MCU?

EX) firmware download....

In my opinion, if the crystal is work, it seems normal.

However, if the network does not work, the PCB design should be considered.

You have to tell me specifically what the problem.

Thank you. Dear Scott

Thanks for your reply. 
We use preprogrammed W7500P with S2E firmware.
Green LED is on and Activity Indicator is Blinking on RJ45 connector but search through Config Tool, device is not listed.
No response for commands from RS232 side.
No debug message is also outputted. Dear Nagarajan_V

If so, I think your W7500P seems to be working properly hardware.

Debug messages are output to UART2. Did you check it?

<Review of additional circuits>

* Remove R138
* Either R82 or R83 must be soldering
  * To use RS232 soldering R83 
  * To use RS485 soldering R82
* 28 Pin Pull-Up

Except for this, your schematic is fine.

Scott Dear Scott

Thanks your verification of our circuit
Debug message is not output. 
What else can be tested.

V.Nagarajan Dear Scott

Can you share gerber of wiz750sr-RS232 module.
What is reset time required for the module.


V.Nagarajan","Q) Could you review our schematic, it is not working? Please find link https://we.tl/t-bEEc7Efkrh Dear Nagarajan_V
Q) Everything is not it working? My opinion is, - You must remove the R96, R97, R98, R99. RJ45 GND and system GND should be separated by using a high-voltage capacitor.
Q) My opinion is, - You must remove the R96, R97, R98, R99. RJ45 GND and system GND should be separated by using a high-voltage capacitor. Thank you Thank you for kind reply. We have already removed R96, R97, R98, and R99.
A) I did not see any pulses on PA_02 pin. Crystal oscillations are OK. Reset and boot levels are OK, Any other point need to check? Dear Nagarajan-V
A) You sure you've done the work of the internal MCU? EX) firmware download.... In my opinion, if the crystal is work, it seems normal. However, if the network does not work, the PCB design should be considered. You have to tell me specifically what the problem. Thank you. Dear Scott
A) Thanks for your reply. We use preprogrammed W7500P with S2E firmware. Green LED is on and Activity Indicator is Blinking on RJ45 connector but search through Config Tool, device is not listed. No response for commands from RS232 side. No debug message is also outputted. Dear Nagarajan_V
Q) If so, I think your W7500P seems to be working properly hardware. Debug messages are output to UART2. Did you check it? <Review of additional circuits> * Remove R138 * Either R82 or R83 must be soldering * To use RS232 soldering R83 * To use RS485 soldering R82 * 28 Pin Pull-Up Except for this, your schematic is fine. Scott
A) Thanks your verification of our circuit Debug message is not output. What else can be tested. V.Nagarajan
Q) Can you share gerber of wiz750sr-RS232 module. What is reset time required for the module. V.Nagarajan
A) None."
3499,646,"Hi,

your engineers have passed some information about how to set the country code via serial interface like follows:

First command:

<ORnvram_set CountryCode KR && nvram_set CountryRegion 0 && nvram_set CountryRegionABand 0>

as an example for setting KOREA country code

Second command:

<WR>

The command obviously executes, as the web-page does show the change in country code, but:
- from then the module doesn't react anymore to any serial command and
- the new setting is not stored in flash, as the setting is reset after next power up

If the module needs to have another hardware reset after setting...no problem
but the setting needs to be stored on a permanent base. Hello nils333

<WR> : Set System Restart 
<WL> : This command saves configured data to flash. After this command is processed, configured data is kept even if rebooting. 

You need to issue the below commands. 
<ORnvram_set CountryCode KR && nvram_set CountryRegion 0 && nvram_set CountryRegionABand 0>
<WL>
<WR>

BTW, there was a mistake in previous my email.

Thanks. Hi,

unfortunately you advice does not help to save the Country code permanentely.

I have checked the following:

first action: set the country code as advised, followed by <WL> and <WR> commands

Result: The setting takes effect during run time, but is reset after power up

second action: set the country code as advised via serial command, followed by save action in web browser

Result: The setting takes effect even during a new power up.

It seems, that the country code command blocks any further commands issued via the serial interface, as the serial channel doesn't react anymore after this command.

Have you got a workaroud for this problem ? Hello Nils333

You had better issue the commands step by step.
Please issue the commands as below.

<ORnvram_set CountryCode KR>
<ORnvram_set CountryRegion 0>
<ORnvram_set CountryRegionABand 0>
<ORnvram_write write>

Now, maybe you can see the changed country-code in web-page.

Even after rebooting, you can see the changed country-code in web-page.

Regards, Steve Hello Steve,

now everything works fine,

Thank you.
 :smiley:","Q) Have you got a workaroud for this problem ? 
A) You had better issue the commands step by step.
<ORnvram_set CountryCode KR>
<ORnvram_set CountryRegion 0>
<ORnvram_set CountryRegionABand 0>
<ORnvram_write write>
Now, maybe you can see the changed country-code in web-page.
Even after rebooting, you can see the changed country-code in web-page.

Q) BTW, there was a mistake in previous my email. 
A) Thanks. 

Q) unfortunately you advice does not help to save the Country code permanentely.
I have checked the following:
Action 1: set the country code as advised, followed by <WL> and <WR> commands
Result: The setting takes effect during run time, but is reset after power up
Action 2: set the country code as advised via serial command, followed by save action in web browser
Result: The setting takes effect even during a new power up.
It seems, that the country code command blocks any further commands issued via the serial interface, as the serial channel doesn't react anymore after this command. 
Do you have a workaround for this problem?
A) Hello Nils333

Q) Hello nils333
A) <WR> : Set System Restart 
<WL> : This command saves configured data to flash. After this command is processed, configured data is kept even if rebooting. 
You need to issue the below commands. 
<ORnvram_set CountryCode KR && nvram_set CountryRegion 0 && nvram_set CountryRegionABand 0>
<WL>
<WR>

Q) Hi,
your engineers have passed some information about how to set the country code via serial interface like follows:
First command:
<ORnvram_set CountryCode KR && nvram_set CountryRegion 0 && nvram_set CountryRegionABand 0>
as an example for setting KOREA country code
Second command:
<WR>
The command obviously executes, as the web-page does show the change in country code, but:
- from then the module doesn't react anymore to any serial command and
- the new setting is not stored in flash, as the setting is reset after next power up
If the module needs to have another hardware reset after setting...no problem but the setting needs to be stored on a permanent base.
A) None"
3500,6462,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ­?ÂÃªÂ¹Â?

????DSP28335?? WIZ811MJ ?Â´Ã«ÂÂ??Ã«ÂªÂ¨Ã«ÂÂ???Â´Ã¬ÂÂ©?ÂÃ¬ÂÂ¬ TCP ?ÂµÃ¬ÂÂ ??ÃªÂµÂ¬Ã­ÂÂ?ÂÃªÂ³Â  ?ÂÃ«ÂÂ ?Â¬Ã«ÂÂ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?Â¤Ã¬ÂÂÃªÂ°??ÂÃ¬ÂÂ¡?Â´Ã«ÂÂ¼???Â´Ã«Â Â¤??Ã«Â¬Â¸Ã¬Â ÂÃ«Â¥????Â¤ÃªÂ³Â  ?ÂÃ«ÂÂ??Ã«Â¬Â¸Ã¬Â ÂÃªÂ°? ?ÂÃªÂ²Â¨ ÃªÂ¸????Â¬Ã«Â¦Â½?ÂÃ«ÂÂ¤.

DSP28335 : ?ÂÃ«Â²Â
PC              : ?Â´Ã«ÂÂ¼?Â´Ã¬ÂÂ¸??

SPI ?ÂµÃ¬ÂÂ  Ã«Â°Â©Ã¬ÂÂ

?Â¼Ã«Â¡Â ?ÂµÃ¬ÂÂ ???ÂÃ«ÂÂ???ÂÃ¬Â¼Â0 ?? 2k ?Â°Ã¬ÂÂ´?Â°Ã«? ?ÂÃ«Â²Â?ÂÃ¬ÂÂ ?Â´Ã«ÂÂ¼?Â´Ã¬ÂÂ¸?Â¸Ã«Â¡Â ?Â°Ã¬ÂÂ´?Â°Ã«? Ã«Â³Â´Ã«ÂÂ´???ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨???ÂÃ¬ÂÂ±?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

ÃªÂ·Â¼Ã«ÂÂ°,  2K ?Â°Ã¬ÂÂ´?Â°Ã«? 3msec ?ÂÃ«ÂÂ??Ã¬Â£Â¼ÃªÂ¸Â°Ã«Â¡?WIZ811MJ ???Â°Ã¬ÂÂ´?Â°Ã«? send ?ÂÃ«ÂÂ??

Ã«Â¶ÂÃªÂ·ÂÃ¬Â¹ÂÃ¬Â Â?Â¼Ã«Â¡Â ?ÂÃ¬Â¼Â???Â«Ã­ÂÂ???ÂÃ¬ÂÂ??Ã«Â°ÂÃ¬ÂÂ?Â©Ã«ÂÂ?? 2K ?Â°Ã¬ÂÂ´???ÂÃ¬ÂÂ 4K ?Â°Ã¬ÂÂ´?Â°Ã«Â¡Â ?ÂÃ¬ÂÂ´Ã«Â©??ÂÃ¬Â¼Â??Ã«Â°ÂÃ«Â¡Â ?Â«Ã­?Ã«Â²ÂÃ«Â¦Â¬?Â¤Ã¬ÂÂ.

1K ?Â°Ã¬ÂÂ´?Â°Ã«Â¡Â Ã«Â³Â´Ã«ÂÂ´Ã«Â©?1Ã«Â¶??ÂÃ«ÂÂ Ã«Â³Â´Ã«ÂÂ´?Â¤Ãª? ?ÂÃ¬Â¼Â???Â«Ã­ÂÂÃªÂ³Â Ã¬ÂÂ  ????

?Â¬Ã«ÂÂ¼?ÂÃ¬ÂÂ Ã¬Â°Â¾Ã¬ÂÂÃ«Â³Â´Ã«ÂÂ W5100?ÂÃ«ÂÂ ?ÂÃ¬Â¼Â??4ÃªÂ°??ÂÃªÂ³Â , ÃªÂ°ÂÃªÂ°Â ÃªÂ¸Â°Ã«Â³Â¸?ÂÃ¬ÂÂ¼Ã«Â¡?2K Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦Â¬Ãª? ?Â Ã«ÂÂ¹?ÂÃ¬ÂÂ´ ?ÂÃ«ÂÂ¤ÃªÂ³?ÃªÂ·Â¸Ã«ÂÂ?? ÃªÂ¸Â°Ã«Â³Â¸ Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦Â¬Ã«? ?ÂÃ¬ÂÂ¥?ÂÃ«Â©Â´ ?ÂÃ«ÂÂ¤ÃªÂ³??ÂÃ¬ÂÂ¸?ÂÃ¬??ÂµÃ«ÂÂ??

?Â¬ÃªÂ¸Â°??Ã¬Â§ÂÃ«Â¬Â¸???ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

?????ÂÃ¬Â¼Â 0 Ã«Â§??Â¬Ã¬ÂÂ©???ÂÃªÂ³Â  ?Â¤Ã«Â¥Â¸ Ã¬Â±ÂÃ«ÂÂ?? ?Â¬Ã¬ÂÂ©???ÂÃ­ÂÂÃªÂ³Â Ã¬ÂÂ ?Â©Ã«ÂÂ??

Ã¬Â§ÂÃ«Â¬Â¸ 1 : ?ÂÃ¬Â¼Â0??TX Ã¬ÂµÂÃ«? Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦Â¬Ã¬ÂÂ¸ 8K Ã«Â°ÂÃ¬ÂÂ´?Â¸Ã«? ?Â Ã«ÂÂ¹?????ÂÃ«ÂÂÃ¬Â§???
Ã¬Â§ÂÃ«Â¬Â¸ 2 : ?ÂÃ¬Â¼Â0??8K Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦Â¬Ã«? ?Â Ã«ÂÂ¹????ÃªÂ·Â¸Ã¬ÂÂ¸ ?ÂÃ¬Â¼Â ?Â¤Ã¬Â Â???Â°Ã«Â¡Â ?Â´Ã¬ÂÂ¼ ?ÂÃ«ÂÂÃ¬Â§???  ?ÂÃ¬Â¼Â diable ?Â´Ã«ÂÂ¼?Â Ã¬? , ?ÂÃ¬Â¼Â 2,3,4 0K Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦??Â Ã«ÂÂ¹ ?Â¤Ã¬Â Â?Â´Ã«ÂÂ¼?Â Ã¬?
Ã¬Â§ÂÃ«Â¬Â¸ 3 :  ?Â´Ã«ÂÂ???ÂµÃ¬ÂÂ ??RX ???Â°Ã¬? ?ÂÃªÂ³Â  TXÃ«Â§??Â´Ã«ÂÂ¤Ã«Â©?RX Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦Â¬Ã«ÂÂ ?ÂÃ¬ÂÂ©??ÃªÂ°??Â¥Ã­ÂÂÃ¬Â§???

5usec ADC ?ÂÃ­ÂÂÃ«Â§??Â°Ã¬ÂÂ´?Â°Ã«? 3msec?ÂÃ¬ÂÂ 2K ?Â°Ã¬ÂÂ´?Â°Ã«? Ã«Â³Â´Ã«ÂÂ´???ÂÃªÂ±Â°?Â Ã¬ÂÂ ????
?ÂÃ¬ÂÂ¸???Â´Ã«Â³Â´??2K Ã«Â¥?Ã«Â³Â´Ã«ÂÂ´??1KÃ«Â¥?Ã«Â³Â´Ã«ÂÂ´???ÂÃªÂ°Â??ÃªÂ±Â°Ã¬ÂÂ ?ÂÃ¬ÂÂ¼?Â´Ã¬ÂÂ ?ÂÃ«Â²Â Ã«Â³Â´Ã«ÂÂ¼ ??Ã¬ÂµÂÃ«???Ã«Â§ÂÃ¬ÂÂ´ Ã«Â³Â´Ã«ÂÂ¼?Â¤ÃªÂ³Â  ?Â©Ã«ÂÂ??

ÃªÂ²????ÂÃªÂ²Â¬ Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ??

?ÂÃ¬ÂÂ?ÂÃ«ÂÂ ÃªÂ¸????Â½Ã¬ÂÂ´ Ã¬Â£Â¼Ã¬ÂÂ??ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? ^^ hello.

Before answering the question, you said that the socket was Close during the transmission, but first of all, the cause analysis of the socket should be a priority.Please tell us that it has nothing to do with the Socket Close problem and the size of the Socket TX buffer.

Answer 1: SOCKET maximum tx buffer size can be used 8K.
Answer 2: Tx Memory Setting Register TMSR value must be set to 0x03.
              Unused SOCKETs must maintain the close.
Answer 3: Socket's TX and RX Memory are physically separated,
             The RX Memory area cannot be assigned to the socket RX buffer.

For reference, the transmission bandwidth is calculated at about 5.5Mbps.
Using the DSP chip, it is possible to be able to be 5.5 Mbps enough with 2KB SOCKET TX buffer.

thank you ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? 

?ÂÃª? DSP28335 ??SPI ?Â´Ã«ÂÂ­??10MHZ ?Â´Ã¬ÂÂ?Â¼Ã«Â¡Â ?Â´Ã¬ÂÂ W5100ÃªÂ³?IP Ã¬Â£Â¼Ã¬ÂÂÃ«Â¥??Â°ÃªÂ³Â  ?Â¤Ã¬ÂÂ ?Â½Ã¬ÂÂ¼???Â°Ã«Â ÂÃªÂ¸?ÃªÂ°ÂÃ¬ÂÂ´ ?Â¤Ã¬ÂÂ´?Â¤Ã«ÂÂ?Â¼ÃªÂµÂ¬??

SPI ?Â´Ã«ÂÂ­??10MHZ ?Â´Ã¬ÂÂ ?Â¬Ã«Â¦Â¬Ã¬Â§?Ã«Â¥?Ã«ÂªÂ»Ã­ÂÂÃªÂ²Â Ã«ÂÂ¤??

10MHz ?Â´Ã«ÂÂ­?Â¼Ã«Â¡Â ?ÂÃ¬ÂÂ¡ ???Â´Ã«ÂÂ???ÂµÃ¬ÂÂ ?ÂÃ«ÂÂÃªÂ°? 1.5MbpsÃªÂ°? ?ÂÃ¬ÂÂ¤?ÂÃ«ÂÂ°??

?ÂÃ¬ÂÂ¡?ÂÃ«ÂÂÃ«Â¥??Â¬Ã«Â¦Â¬???Â¤Ã­ÂÂ¬???ÂÃ«ÂÂÃ¬Â§???

????wiznet git???ÂÃ«ÂÂ W5100_ATMega_WEBSERV-master ?ÂÃ¬ÂÂ¤Ã«Â¥??ÂÃ¬Â Â?ÂÃ¬ÂÂ¬ ?Â¬Ã¬ÂÂ©?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

send ?Â¨Ã¬ÂÂÃ«Â¥??ÂÃ¬Â Â?ÂÃ¬ÂÂ¬ ?Â¤Ã¬ÂÂÃªÂ³?ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬Â Â?ÂÃ¬??ÂµÃ«ÂÂ?? 

DSP 28335??Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦??Â¹Ã¬ÂÂ±??16bit Ã«Â©ÂÃ«ÂªÂ¨Ã«Â¦Â¬Ã«Â¡Â ÃªÂ³Â Ã¬Â Â???ÂÃ¬ÂÂ´ ÃªÂ¸Â°Ã¬Â¡Â´??send()?Â¨Ã¬ÂÂÃ«Â¥??Â¬Ã¬ÂÂ©?ÂÃ¬? Ã«ÂªÂ»Ã­ÂÂÃªÂ³??ÂÃ¬Â Â?ÂÃ¬??ÂµÃ«ÂÂ??

Uint8 Send16(Uint8  sock, const Uint16  *buf, Uint16  buflen)
{
    Uint16  ptr;
    Uint16  offaddr;
    Uint16  realaddr;
    Uint16  txsize;
    Uint16  timeout;
    Uint16  sockaddr;
//    Uint16  DMASendFlagState;

    if (buflen == 0 || sock >= W5100_NUM_SOCKETS)  return  W5100_FAIL;      // ignore illegal requests
    sockaddr = W5100_SKT_BASE(sock);                                        // calc base addr for this socket
    // Make sure the TX Free Size Register is available
    txsize = W51_read(sockaddr+W5100_TX_FSR_OFFSET);                        // make sure the TX free-size reg is available
    txsize = (((txsize & 0x00FF) << 8 ) + W51_read(sockaddr+W5100_TX_FSR_OFFSET + 1));

    timeout = 0;
    while (txsize < buflen)
    {
//        DELAY_US(10);
        txsize = W51_read(sockaddr+W5100_TX_FSR_OFFSET);        // make sure the TX free-size reg is available
        txsize = (((txsize & 0x00FF) << 8 ) + W51_read(sockaddr+W5100_TX_FSR_OFFSET + 1));
        if (timeout++ > 1000)                       // if max delay has passed...
        {
            DisconnectSocket(sock);                 // can't connect, close it down
            return  W5100_FAIL;                     // show failure
        }
    }
   // Read the Tx Write Pointer
    ptr = W51_read(sockaddr+W5100_TX_WR_OFFSET);
    offaddr = (((ptr & 0x00FF) << 8 ) + W51_read(sockaddr+W5100_TX_WR_OFFSET + 1));
    while (buflen)
    {
        buflen--;
        realaddr = W5100_TXBUFADDR + (offaddr & W5100_TX_BUF_MASK);     // calc W5100 physical buffer addr for this socket

        static Uint8 tmp;
        tmp = *buf & 0x00ff;
        W51_write(realaddr, tmp);                  // send a upper byte of application data to TX buffer
        offaddr++;                                  // next TX buffer addr
        tmp = (*buf) >> 8;
        W51_write(realaddr+1, tmp);                  // send a lower byte of application data to TX buffer
        offaddr++;                                  // next TX buffer addr
        buf++;                                      // next input buffer addr
        if(DMASendFlag)
        {
//            return DMA_OVERFLOW;
        }
    }

    W51_write(sockaddr+W5100_TX_WR_OFFSET, (offaddr & 0xFF00) >> 8);    // send MSB of new write-pointer addr
    W51_write(sockaddr+W5100_TX_WR_OFFSET + 1, (offaddr & 0x00FF));     // send LSB

    W51_write(sockaddr+W5100_CR_OFFSET, W5100_SKT_CR_SEND); // start the send on its way
    while (W51_read(sockaddr+W5100_CR_OFFSET))  ;   // loop until socket starts the send (blocks!!)

    return  W5100_OK;
}


?ÂÃ¬? ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬Â Â?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ¡?ÂÃ«Â©Â´ ?ÂÃ¬ÂÂ¡?ÂÃ«ÂÂÃªÂ°? 1.5MbpsÃªÂ°? Ã¬ÂµÂÃªÂ³Â ?Â´Ã«ÂÂ?Â¼ÃªÂµÂ¬??  ????

?ÂÃ¬ÂÂ¡ ?ÂÃ«ÂÂÃ«Â¥??Â¬Ã«Â¦Â´ ???ÂÃ«ÂÂ Ã«Â°Â©Ã«Â²Â???ÂÃ«ÂÂÃ¬Â§??? hello.
SPIs of the W5100 may not be speed.
Logic is designed to sampling and process SPI clocks, so there is a limit to speed improvement.

It is recommended to use Bus I/F or change to W5500 or W6100.

Even if it's 16bit mode, I know that it can be used as 8bit bus.

It is expected that the DSP is expected to use the 16bit Address Space, so you can doubles the W5100's Register Map and define it and process the 8bit as if it is 16bit.

For example)
If the existing 8bit definition is as follows

#define IR 0x0008
#define IMR 0x0009

Change this to 16bit definition and access it.
#define IR (0x0008 << 2)
#define IMR (0x0009 << 2)

thank you","Q) Can you explain the maximum tx buffer size for the SOCKET?
A) SOCKET maximum tx buffer size can be used 8K.

Q) What value must be set for the Tx Memory Setting Register (TMSR)?
A) Tx Memory Setting Register TMSR value must be set to 0x03. Unused SOCKETs must maintain the close.

Q) Are the Socket's TX and RX Memory physically separated?
A) Socket's TX and RX Memory are physically separated. The RX Memory area cannot be assigned to the socket RX buffer.

Q) What is the maximum transmission bandwidth for the DSP chip?
A) Using the DSP chip, it is possible to achieve a transmission bandwidth calculation of about 5.5Mbps.

Q) What is the SPI clock speed of the DSP28335 and W5100?
A) The SPI clock speed of the DSP28335 is 10MHz. The logic is designed to sample and process SPI clocks, limiting the speed improvement. It is recommended to use Bus I/F or change to W5500 or W6100.

Q) How can the W5100's Register Map be doubled and defined to process 8 bits as if it is 16bits?
A) It is expected that the DSP is likely to use the 16bit Address Space, so you can double the W5100's Register Map and define it and process the 8bit as if it is 16bit. For example, the 8-bit definitions can be changed to 16-bit definitions for accessing.

Thank you."
3501,6465,"Does Wiznet have any STC Approval? Hi

We don't provide STC approval now.
if you give us any information about how to get that approval.
we can discuss whether to get it or not.

thanks.","Q) Does Wiznet have any STC Approval? 
A) We don't provide STC approval now. If you give us any information about how to get that approval, we can discuss whether to get it or not. Thank you."
3502,6468,"I've always assumed it means that a physical network connection is present, but searching the manual today made me realize that I don't really know that for sure. Does anyone know for certain under what conditions this bit is set and reset? [quote=""Mxyxixptlick, post:1, topic:6468""]
but searching the manual today made me realize that I don?Ât really know that for sure
[/quote]

What exactly have you made thinking this way? In my opinion it must get set when carrier signal is detected. I was going to answer a question about a W5x00 Ethernet library that was posted at https://github.com/arduino-libraries/Ethernet/issues/111 but realized I didn't have a definitive answer. 

Your answer makes sense, but I'm hoping someone from Wiznet can confirm that's how it works. Hi~
LNK bit of PHYCFGR operates same the link pin of W5500.
It is driven low whenever the PHY detects a valid link. We don't  know about valid link or any carrier signal because it operates internal to the PHY.","Q) Does anyone know for certain under what conditions this bit is set and reset? 
A) LNK bit of PHYCFGR operates same the link pin of W5500. It is driven low whenever the PHY detects a valid link. We don't know about valid link or any carrier signal because it operates internal to the PHY."
3503,647,"Hi,

I try to set the security mode via serial interface using the GU command. There are some modes using a radius server for management of the security.

The Radius Server also uses a password which is refered to as follows in the serial command:

e.g. <S4_2_0_0_0_0_Password_RadiusIp_RadiusPort>

When setting the Password, the command is accepted, but the password doesn't show up on the web page.
In the Radius settings the only indication for the password is the so-called ""shared secret"". Is this identical to the password, set in the serial command and if yes, why does it not show up on the web page.

This isue is very important for us, as we are about to release our product in the near future.
Thank you for your cooperation. Hi

This problem will be fixed in next firmware version. But we can't provide new firmware to you immediately.
Because we need some time for fixing this issue. 

Thanks","Q) When setting the Password, the command is accepted, but the password doesn't show up on the web page. In the Radius settings the only indication for the password is the so-called ""shared secret"". Is this identical to the password, set in the serial command and if yes, why does it not show up on the web page?
A) The issue with the password not showing up on the web page when using the GU command to set the security mode via the serial interface will be addressed in the next firmware version. The password, referred to as ""shared secret"" in the Radius settings, is indeed the same as the password set in the serial command. However, there is a problem with it not displaying on the web page. This will be fixed in the upcoming firmware update. Thank you for your cooperation."
3504,6472,"Some time back I bought a few Wiz610io modules that contain W6100 chip. The datasheet of W6100 does not clearly define a current consumption and only states greater than 100mA. However, when I connect the module to 3.3V voltage, it draws a current of a round 1.85A. Why is the current so high? IS there something wrong with the module or it is normal? I remember W5500 could be powered from USB. [quote=""MHT2020, post:1, topic:6472""]
it draws a current of a round 1.85A
[/quote]

Does it still function properly? Does it heat? Actually the current is so high that exceeds my circuit regulator current limit. So I can not test it in circuit. I connected the module to my 10A bench supply and realised that it draws 1.85A. The chip does not get very hot. I need to know what is the normal standby and operation current of the module. 1.85A must be too much. Table 23 shows 265 mA maximum. Dear MHT2020.

I'm sorry. If there is a problem with your WIZ610io due to our incorrect document, we will replace it for free.

Thank you.

Scott Thanks, Actually this time the problem is fixable by cutting a pin. But please be careful in later documents","Q) Why is the current consumption of the Wiz610io module with W6100 chip so high when connected to 3.3V? Is there something wrong with the module?
A) If the module draws a current of around 1.85A when connected to 3.3V, it may indicate a problem. The W6100 datasheet states a current consumption greater than 100mA, but drawing 1.85A seems abnormal. It's advisable to check if the module still functions properly and if it heats up during operation. The excessive current draw may exceed the circuit regulator's current limit, making it challenging to test in the circuit. The normal standby and operating current of the module should be around 265mA, as shown in the datasheet. If the current consumption significantly exceeds this value, there could be an issue with the module.

A) I'm sorry. If there is a problem with your WIZ610io due to our incorrect document, we will replace it for free. Thank you.

A) The problem is fixable by cutting a pin. But please be careful in later documents."
3505,6479,"2019??9??3??ÃªÂµÂ¬Ã¬ÂÂ WIZ550S2E Ã«ÂªÂ¨Ã«ÂÂ¸?ÂÃ«ÂÂ??
WIZ550S2E???ÂÃ¬ÂÂÃ«Â§??Â°ÃªÂ²Â°???ÂÃ­ÂÂ?ÂÃ¬ÂÂ ÃªÂ³ÂµÃ¬ÂÂ ÃªÂ¸?192.168.11.1)?? ?Â°ÃªÂ²Â°?ÂÃ¬ÂÂ¬ ""WIZnet Configuration Tool""Ã«Â¡?""Search"" ?ÂÃ¬ÂÂ ????PC?ÂÃ¬ÂÂ ?ÂÃ­??ÂÃ«ÂÂ Ã¬Â¤ÂÃ¬ÂÂ?ÂÃ«ÂÂ??


PC1 : WIZnet Configuration Tool ?ÂÃ«Â©Â´??ÃªÂ²??ÂÃ«ÂÂ??Ã«ÂªÂ¨Ã«ÂÂ???ÂÃ¬ÂÂ¼Ã«Â©? ""Ping"" Ã«ÂªÂÃ«Â Â¹?ÂÃ«ÂÂ Ã«Â°ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

PC2 : WIZnet Configuration Tool ?ÂÃ«Â©Â´??ModuleÃªÂ³?MAC Address??ÃªÂ²??ÂÃ«ÂÂÃ¬Â§?Ã«Â§?IP??ÃªÂ¸Â°Ã­? ?ÂÃ«Â³Â´???Â½Ã¬ÂÂ´?Â¤Ã¬? Ã«ÂªÂ»Ã­ÂÂ©?ÂÃ«ÂÂ¤. ??ÂÂ ""Ping""?ÂÃ«ÂÂ Ã«Â°ÂÃ¬ÂÂ?Â©Ã«ÂÂ??

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ?? I solved it.
I can't use the version in Wizwiki.
I accept Ver 1.3.1 and read it well.
Please update the version of Wizwiki. First of all, I'm sorry for the inconvenience.
There was a phrase that the wizwiki page was no longer updated,
I think this part was not visible.
I will modify the part you said.","Q) 2019??9??3??ÃªÂµÂ¬Ã¬ÂÂ WIZ550S2E Ã«ÂªÂ¨Ã«ÂÂ¸?ÂÃ«ÂÂ??
A) It looks like a technical question about the WIZ550S2E module configuration. 
Q) PC1 : WIZnet Configuration Tool ?ÂÃ«Â©Â´??ÃªÂ²??ÂÃ«ÂÂ??Ã«ÂªÂ¨Ã«ÂÂ???ÂÃ¬ÂÂ¼Ã«Â©? ""Ping"" Ã«ÂªÂÃ«Â Â¹?ÂÃ«ÂÂ Ã«Â°ÂÃ¬ÂÂ?Â©Ã«ÂÂ??
A) This seems to be a question about using the WIZnet Configuration Tool to ping the device. 
Q) PC2 : WIZnet Configuration Tool ?ÂÃ«Â©Â´??ModuleÃªÂ³?MAC Address??ÃªÂ²??ÂÃ«ÂÂÃ¬Â§?Ã«Â§?IP??ÃªÂ¸Â°Ã­? ?ÂÃ«Â³Â´???Â½Ã¬ÂÂ´?Â¤Ã¬? Ã«ÂªÂ»Ã­ÂÂ©?ÂÃ«ÂÂ¤. ??ÂÂ ""Ping""?ÂÃ«ÂÂ Ã«Â°ÂÃ¬ÂÂ?Â©Ã«Â"
3506,648,"It is no different, please contact the Ethernet W5300.



Even though the current FLCC ETHERNET -related terminal is open

The value (SN_TX_FIFO, SN_RX_FIFIFOR) value that accesses the RX TX memory of the W5300 continues to change in real time.

(Symptoms of the same UDP SOCKET are open or close)

I would like to ask you if you know the cause.



thank you Is FLCC stand for Flight Control Computer?
I don't know what FLCC Ethernet is.
Is it used by converting with FLCC to Ethernet?

Sn_tx_fifor/SN_RX_FIFIFIFIFIFIFOR value continues to change means that the chip does not work properly.
I should try the cause analysis, but
Do you use an external pie? Thank you for answer.
1. I found the cause of the problem.The Debug tool continued to dump SN_TX_FIFOR, SN_RX_FIFOR memory.

2. UDP Build in Test is being implemented.I would like to apply Loopback test as an internal.I would like to ask if there is a way to do Loopback test internally.If you UDP Send with your own IP or 127.0.0.1, there is no Sendok.
(Currently, external and UDP communications work normally. RXTX memory test is applied)

FLCC is Flight Control Computer.
Please help.thank you The existing chips supplied by WizNet do not support their own loop bags.
Addresses like 127.0.0.1 used in the OS are not available.
It may be cumbersome, but please do a test PC or Loopback test.
WizNet provides AX1 Program, and there is also a freeWare Hercles Program [URL] http://www.hw-group.com/products/hercules/index_en.html [/URL].","Q) Is FLCC stand for Flight Control Computer? I don't know what FLCC Ethernet is. Is it used by converting with FLCC to Ethernet?
Q) Sn_tx_fifor/SN_RX_FIFIFIFIFIFIFOR value continues to change means that the chip does not work properly. I should try the cause analysis, but
Do you use an external pie?
A) FLCC stands for Flight Control Computer. The existing chips supplied by WizNet do not support their own loop bags. Addresses like 127.0.0.1 used in the OS are not available. It may be cumbersome, but please do a test PC or Loopback test.

Q) I found the cause of the problem. The Debug tool continued to dump SN_TX_FIFOR, SN_RX_FIFOR memory. UDP Build in Test is being implemented. I would like to apply Loopback test as an internal. I would like to ask if there is a way to do a Loopback test internally. If you UDP Send with your own IP or 127.0.0.1, there is no Sendok. (Currently, external and UDP communications work normally. RXTX memory test is applied)
A) The value (SN_TX_FIFO, SN_RX_FIFIFOR) value that accesses the RX TX memory of the W5300 continues to change in real-time. Symptoms of the same UDP SOCKET are open or close. WizNet provides the AX1 Program, and there is also a freeWare Hercules Program [URL] http://www.hw-group.com/products/hercules/index_en.html [/URL].

Thank you for answer."
3507,6480,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??
ÃªÂ¸Â°Ã¬Â¡Â´?? W5100 Driver V1.9???Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ Ã«Â³Â´Ã«ÂÂÃ«Â¥?ioLibrary_Driver-masterÃ«Â¡??ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´??ÃªÂ·Â¸Ã«?Ã«Â¡ÂÃ¬ÂÂ´ÃªÂ³?f/wÃ«Â§?Ã«Â³?ÃªÂ²Â½Ã­ÂÂ???ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨ Ã¬Â§ÂÃ­ÂÂÃ¬Â¤ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤. ?ÂÃ«ÂÂ¬?Â´Ã­ÂÂµ?Â Ã¬ÂÂ ?Â¬Ã¬ÂÂ©?Â©Ã«ÂÂ??
?ÂÃ­ÂÂ?Â°ÃªÂ²Â°?? ?ÂÃ«ÂÂ?ÂÃ«ÂÂ° rx ?Â°Ã¬ÂÂ´?Â°Ãª? pc?ÂÃ¬ÂÂ Ã«Â³Â´Ã«ÂÂ¸ÃªÂ²ÂÃªÂ³Â¼ ?Â¤Ã«Â¥Â¸ ÃªÂ°ÂÃ¬ÂÂ´ Ã«Â²ÂÃ­ÂÂ¼?????Â¥Ã¬ÂÂ´ ?Â©Ã«ÂÂ?? tx ?Â°Ã¬ÂÂ´?Â°Ã«ÂÂ Ã«Â²ÂÃ­ÂÂ¼?????Â¥Ã«ÂÂ ÃªÂ²ÂÃªÂ³Â¼ ?Â¤Ã«Â¥Â¸ ÃªÂ²ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ¡???ÂÃ«ÂÂ ?ÂÃ­ÂÂ?ÂÃ«ÂÂ??
?Â¤Ã¬Â Â??Ã«Â¶?Ã«Â¶ÂÃ¬? ?ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

reg_wizchip_bus_cbfunc(wizchip_read, wizchip_write);	
void  wizchip_write(unsigned int addr, iodata_t wb)
{
  *((volatile unsigned char*)(addr)) = wb;
}

iodata_twizchip_read(uint32_t addr)
{
  iodata_t data;
	data = *((volatile unsigned char*)(addr)); 
	return data;
}
====================wizchip_conf.h ========================================
#ifndef _WIZCHIP_
#define _WIZCHIP_                      W5100   // W5100, W5100S, W5200, W5300, W5500
#endif

#if   (_WIZCHIP_ == W5100)
   #define _WIZCHIP_ID_                ""W5100\0""
 	#define _WIZCHIP_IO_MODE_           _WIZCHIP_IO_MODE_BUS_DIR_

#if _WIZCHIP_IO_MODE_ & _WIZCHIP_IO_MODE_BUS_
	#define _WIZCHIP_IO_BASE_				((unsigned int)0xc0000000)	// for 5100S IND
		
?Â´Ã«ÂÂ Ã«Â¶?Ã«Â¶ÂÃ¬ÂÂ ÃªÂ²??Â Ã­ÂÂ´???ÂÃ«ÂÂÃ¬Â§? ÃªÂ¶ÂÃªÂ¸Â?Â©Ã«ÂÂ??
Ã«Â²ÂÃ­ÂÂ¼??0Ã«Â²??ÂÃ¬Â¼ÂÃ«Â§??Â¬Ã¬ÂÂ©?ÂÃ«Â Â¤ ?ÂÃ«ÂÂ???ÂÃ«ÂÂÃ¬Â²ÂÃ«ÂÂ¼ ?ÂÃ«Â©Â´ ?ÂÃ«ÂÂÃ¬Â§???
void network_WizchipBufInit(void)
{
	uint8_t memsize[2][4] = {{8,0,0,0},{8,0,0,0}}; 
	ctlwizchip(CW_RESET_WIZCHIP,(void*)memsize) ;
	if(ctlwizchip(CW_INIT_WIZCHIP,(void*)memsize) == -1)
    {
       while(1);
    }
} Are you currently using Direct Bus Mode?
First of all, please check if the IO base is set properly.

You can do the socket buffer size settings. [quote=""becky, post:2, topic:6480""]
?ÂÃ¬ÂÂ¬ Direct bus mode?Â¬Ã¬ÂÂ©Ã¬Â¤ÂÃ¬ÂÂ´?Â Ãª???
[/quote]

ÃªÂ°ÂÃ¬ÂÂ¬?Â©Ã«ÂÂ??
?? Direct bus mode ?Â¬Ã¬ÂÂ©Ã¬Â¤ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤. 
IO BASE ?Â¤Ã¬Â Â?Â´Ã«ÂÂ¼?ÂÃ¬ÂÂÃ«Â©?#define WIZCHIP_IO_BASE??Ã«Â§ÂÃ¬??ÂÃ¬ÂÂ??ÃªÂ²ÂÃ¬ÂÂ¸ÃªÂ°???
0xc0000000??W5100 Driver V1.9?ÂÃ¬ÂÂ???Â¬Ã¬ÂÂ©?ÂÃ«ÂÂ Ã¬Â£Â¼Ã¬ÂÂ?ÂÃ«ÂÂ?? I read the article again
The fact that the product is good is good, but is there a problem only in TCP/UDP communication?
If not, what does the product connect well? 1. Use TCP communication.Connect on your PC and read the getsn_sr () to represent 0x17 well.
2. When you read it with getsn_rx_rsr (0), the number of data from the PC is exactly expressed.
  -> After that, if you read the data with recv (), if you read the data, the number of buffers is the same, but the value is different.
3. The number of data is correct even if you send data using Send (), but the data value is different from the buffer. If the W5100 registers are ready, you do not need to check the interface part.
Only the TCP data part cannot be wrong.You can see it as normal.


I want to know the CODE of the send () RECV () function, the data sent from the PC, and the data read from the PC.I think there is a problem in the parameter delivery or the data read.When using the RECV () function, the data type of the BUF is as follows.Please check for the same.

    uint8_t* buf;// OR UINT8_T BUF [50];
    RECV (SN, BUF, SIZE);
    For (int i = 0; I <size; I ++) {
       printf (""%C"", buf [i]);
    } Ã¬Â½ÂÃ«ÂÂ???ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
Ã«Â²ÂÃ­ÂÂ¼?????Â¥Ã«ÂÂ???Â´Ã¬ÂÂ©?? UART ?????ÂÃ«Â²ÂÃªÂ±Â°Ã«Â¡Â ?ÂÃ¬ÂÂ¸?ÂÃªÂ³Â  ?ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
PC?ÂÃ¬ÂÂ 0x00??Ã«Â°ÂÃ«Â³Âµ?Â´Ã¬ÂÂ ?ÂÃ¬ÂÂ¡?Â´Ã«ÂÂ mcuÃ«Â²ÂÃ­ÂÂ¼?????Â¥Ã«ÂÂ??ÃªÂ°ÂÃ¬? ?ÂÃ«ÂÂ¤?ÂÃªÂ²Â ?Â©Ã«ÂÂ??
pc   -> mcu(buffer)
0x00 -> 0xc9 
0x00-> 0x85
0x00 -> 0x62
0x00 -> 0x48

typedef struct RxProtocol
{
	unsigned char buffer[128];
} rxProtocolStruct;	

=================================================	
case 0x17:		//socket established??
			length = getSn_RX_RSR(0);
			if( length > 0)
			{
				recv(0, eth_rx.buffer, length);		
				send(0,eth_rx.buffer, length);					
			}
			break; Instead of ETH_RX.BUFFER
Is it the same result even if you declare another buffer? yes.It's the same symptoms even if you use another buffer.
Other boards that use the W5100 also change the driver, so the same symptoms appear. [quote=""ldj1123, post:7, topic:6480""]
if( length > 0)
{
recv(0, eth_rx.buffer, length);
send(0,eth_rx.buffer, length);
}
break;
[/quote]
recv??returnÃªÂ°ÂÃ¬ÂÂ´ ?Â¤Ã¬Â ÂÃ«Â¡?Ã«Â°ÂÃ¬? ?Â°Ã¬ÂÂ´?Â°Ã¬ÂÂ ÃªÂ¸Â¸Ã¬ÂÂ´ÃªÂ±Â°Ã«ÂÂ Error Ã«Â©ÂÃ¬ÂÂÃ¬Â§??ÂÃ«ÂÂ??
send??return ÃªÂ°ÂÃ¬? ?Â¤Ã¬Â Â Ã«Â³Â´Ã«ÂÂ¸?Â°Ã¬ÂÂ´?Â°Ã¬ÂÂ ÃªÂ¸Â¸Ã¬ÂÂ´ÃªÂ±Â°Ã«ÂÂ Error Ã«Â©ÂÃ¬ÂÂ¸Ã¬Â§? ÃªÂ°ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.
???ÂÃªÂ°Â??ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ«?Ã«Â¡??ÂÃ¬ÂÂ¤?ÂÃ¬? ?ÂÃ¬ÂÂ¸?ÂÃ¬ÂÂÃªÂ³?W5100?ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ ??Ã«Â²ÂÃ­ÂÂ¼??ÃªÂ°ÂÃ¬ÂÂ ?ÂÃ«Â²ÂÃªÂ·Â¸Ã«Â§ÂÃªÂ³?UARTÃ«Â¡??ÂÃ¬ÂÂ¸ Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? if (LENGTH> 0)
{
ret = recv (0, buffer33, length);
UART_SENDDATA (buffer33, length);
Delay (1000);
UART_SENDDATA (& RET, 1);
Send (0, buffer33, length);
}
I confirmed the UART as above.Buffer33 outputs different values, and RETs are the same value as length. If you modify the library variable type, it will be well received.
void wiz_send_data (uint8_t Sn, uint8_t *wizdata, uint16_t len)
{
uint32_t dst_ptr;
}
void wiz_recv_data (uint8_t Sn, uint8_t *wizdata, uint16_t len)
{
 uint32_t src_ptr;
}
Can't you change this in ""wizchip_conf.h""? uint16_t dst_ptr;(uint16_t src_ptr;)
uint32_t dst_ptr;Do you mean it's good to change to (uint32_t src_ptr;)? yes.If you change it, it will be good.
The library used in the past is TypeDef Unsigned int Uint16, so it was actually used as 4 bytes.
It's like 2 bytes because it's a compiler now.
The MCU's FSMC address starts from 0xC0000000, so if you use 16 -bit address, your address seems to be cut off.","A) Are you currently using Direct Bus Mode? First of all, please check if the IO base is set properly.
You can do the socket buffer size settings. [quote=""becky, post:2, topic:6480""] ? Direct bus mode?[/quote] Are you reading the article again? The fact that the product is good is good, but is there a problem only in TCP/UDP communication? If not, what does the product connect well? 1. Use TCP communication. Connect on your PC and read the getsn_sr () to represent 0x17 well. 2. When you read it with getsn_rx_rsr (0), the number of data from the PC is exactly expressed. -> After that, if you read the data with recv (), if you read the data, the number of buffers is the same, but the value is different. 3. The number of data is correct even if you send data using Send (), but the data value is different from the buffer. If the W5100 registers are ready, you do not need to check the interface part. Only the TCP data part cannot be wrong. You can see it as normal.

I want to know the CODE of the send () RECV () function, the data sent from the PC, and the data read from the PC. I think there is a problem in the parameter delivery or the data read. When using the RECV () function, the data type of the BUF is as follows. Please check for the same.

    uint8_t* buf;// OR UINT8_T BUF [50];
    RECV (SN, BUF, SIZE);
    For (int i = 0; I <size; I ++) {
       printf (""%C"", buf [i]);
    }
?
?
Case 0x17: The socket is established. Length = getsn_rx_rsr(0); If( length > 0){recv(0, eth_rx.buffer, length);send(0,eth_rx.buffer, length);}break; Instead of ETH_RX.BUFFER Is it the same result even if you declare another buffer? yes? It's the same symptoms even if you use another buffer. Other boards that use the W5100 also change the driver, so the same symptoms appear. [quote=""ldj1123, post:7, topic:6480""] if( length > 0) {recv(0, eth_rx.buffer, length); send(0,eth_rx.buffer, length);}break; [/quote] recv? Return? Length? Sends? Error? I confirmed the UART as above.Buffer33 outputs different values, and RETs are the same value as length. If you modify the library variable type, it will be well received. Can't you change this in ""wizchip_conf.h""? uint16_t dst_ptr; (uint16_t src_ptr;) uint32_t dst_ptr; Do you mean it's good to change to (uint32_t src_ptr;)? yes. If you change it, it will be good. The library used in the past is TypeDef Unsigned int Uint16, so it was actually used as 4 bytes. It's like 2 bytes because it's a compiler now. The MCU's FSMC address starts from 0xC0000000, so if you use 16 -bit address, your address seems to be cut off."
3508,6484,"Hello

Is there a reference design for available for the W7500 with PoE?

thanks in advance Dear Plyer

We don't have a PoE reference.

PoE is not related to W7500. PoE is a separate function.

You have to design yourself.

Thank you. Thank you Scott

Every 7500 connected device normally would need some kind of power. It would have been great to have PoE as an add-on capability Thank you for your good advice.

Scott For readers of this thread: I agree - it would be great to have a compact and integrated IP/MAC/PHY & PoE solution. However, PoE is a rather involved subject, with thermal, safety, EMC and other concerns that require a non-trivial amount of expertise to appreciate and implement as part of a project or product - even with the hypothesized part. The standard is also asymmetric, in that PSE and PD are handled completely differently. For these reasons, it's probably not practical to build such a chip. At best, it would probably be prohibitively expensive.

There are numerous players, but TI has some well-integrated solutions, good docs and useful Dev boards. Consider checking their materials out as a starting point.","Q) Is there a reference design available for the W7500 with PoE?
A) We don't have a PoE reference. PoE is not related to W7500. PoE is a separate function. You have to design yourself.

Q) Every 7500 connected device normally would need some kind of power. It would have been great to have PoE as an add-on capability.
A) For readers of this thread: I agree - it would be great to have a compact and integrated IP/MAC/PHY & PoE solution. However, PoE is a rather involved subject, with thermal, safety, EMC and other concerns that require a non-trivial amount of expertise to appreciate and implement as part of a project or product - even with the hypothesized part. The standard is also asymmetric, in that PSE and PD are handled completely differently. For these reasons, it's probably not practical to build such a chip. At best, it would probably be prohibitively expensive.

A) There are numerous players, but TI has some well-integrated solutions, good docs and useful Dev boards. Consider checking their materials out as a starting point."
3509,6485,"Is WIZnet planning on Single Pair Ethernet anytime soon..?

An SPE version of W7500  (even better with IP v6) would be fantastic! We don't have that plan yet.
Thank you for your attention.","Q) Is WIZnet planning on Single Pair Ethernet anytime soon..? 
A) We don't have that plan yet. Thank you for your attention."
3510,6489,"hello
The FTP Client is being tested using the W5500, but it is often not connected.

1. When you connect to the internal IP of the FTP server, it will always be good.
2. If you connect to the external IP of the FTP server, it can be done well, but if it is not connected, it should not continue.
3. In the case of 2, it is good to use internal IP.
4. In the case of 2, it will be good when you connect to a regular PC.

For the program, I refer to ftpc.c (https://github.com/wiznet/iolibrary_driver/blob/master/internet/ftpclient/ftpc.c).
Is there a step that needs to be added when accessing an external IP?
please answer me. There is no need to add external IP on the FTP application.
How is IP allocation at the W5500?
It would be better to make sure that there is no conflict in the IP or Mac address.

If you can capture Wireshark,
If you can't connect in Wireshark, you can see the packet more clearly.
For packets, you should check on the FTP server device.","Q) Is there a step that needs to be added when accessing an external IP?
Q) How is IP allocation at the W5500?

A) The FTP Client's connection issue when accessing the external IP could be due to the need for additional steps in the program. However, adding the external IP on the FTP application is not necessary. As for the IP allocation at the W5500, it is essential to ensure there is no conflict in the IP or MAC address assigned.

If you can capture Wireshark, you can check for clearer packet information if the connection fails. It is also recommended to verify the packets on the FTP server device for further analysis."
3511,649,"hello.
thank you

                I heard that there is a limit to the number of AP WiFi.

                What is the maximum number of Internet available at the same time?

                What can be allowed to download at the same time?


               I'm so curious.

                have a good day. In general, it's hard to tell you exactly how many devices you can stick to AP.

It depends on the operating environment or the WiFi Option, and it is also related to the amount of Traffic of the connected devices.

Even if there are many devices, if you have a lot of traffice, you may have a hard time using the Internet, and on the contrary, more than dozens of devices without traffic can be available.

In this environment, wireless breaks and speeds will occur frequently.","Q) What is the maximum number of Internet available at the same time? What can be allowed to download at the same time?
A) It's hard to tell you exactly how many devices you can stick to AP. It depends on the operating environment or the WiFi Option, and it is also related to the amount of Traffic of the connected devices. Even if there are many devices, if you have a lot of traffic, you may have a hard time using the Internet, and on the contrary, more than dozens of devices without traffic can be available. In this environment, wireless breaks and speeds will occur frequently."
3512,6496,"?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

DSP28335 ?? WIZ811MJ Ã«ÂªÂ¨Ã«ÂÂ??ÃªÂ°?Ã¬Â§?ÃªÂ³?ÃªÂ°ÂÃ«Â°Â?ÂÃ«ÂÂ ÃªÂ°ÂÃ«Â°Â?ÂÃ¬ÂÂ?ÂÃ«ÂÂ¤.

?ÂÃ¬Â¼Â 0 Ã«Â¥??ÂµÃ­ÂÂ´ 2048byteÃ«Â¥?dSP28335 ?ÂÃ¬ÂÂ PCÃ«Â¡??Â°Ã¬ÂÂ´?Â°Ã«? ?Â¡Ã¬ÂÂ ?ÂÃ«ÂÂ ?ÂÃ¬ÂÂ¨?Â´Ã«? ÃªÂµÂ¬Ã¬ÂÂ±?ÂÃ¬??ÂµÃ«ÂÂ??

Ã«Â³Â´Ã«ÂÂ´ÃªÂ³Â Ã¬ÂÂ ?ÂÃ«ÂÂ ?Â°Ã¬ÂÂ´?Â°Ãª? 16bit ?Â°Ã¬ÂÂ´?Â°Ã«? ?Â¡Ã¬ÂÂ ?ÂÃ«ÂÂ??ÃªÂ°ÂÃ­ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??Â°Ã¬ÂÂ´?Â°Ãª? ?Â¡Ã¬ÂÂ ???ÂÃ«ÂÂ??ÃªÂ²Â½Ã¬ÂÂ°ÃªÂ°? Ã«Â°ÂÃ¬ÂÂ???Â©Ã«ÂÂ??

?Â°Ã¬ÂÂ´???Â¨Ã­ÂÂ·    ?ÂÃ¬ÂÂ 8bit ?ÂÃ¬ÂÂ 8bit  ?Â´Ã«Â ÂÃªÂ²??Â¡Ã¬ÂÂ ???Â©Ã«ÂÂ??

?ÂÃ«? ?Â¤Ã«Â©Â´ 

DSP ?Â¡Ã¬ÂÂ  :

**0x01 0xAB**  **0x01 0xAB** **0x01 0xAB** **0x01 0xAB** **0x01 0xAB** **0x01 0xAB** **0x01 0xAB**   : 2048 Ã«Â°ÂÃ¬ÂÂ´??

PC ?ÂÃ¬ÂÂ  : 

**0x01 0xAB**  **0x01 0xAB** **0x01 0xAB** **0x01 0xAB** *0xAB 0xAB* **0x01 0xAB** **0x01 0xAB**   : 2048 Ã«Â°ÂÃ¬ÂÂ´??

PC Ã¬Â¸??ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ  0x01 0xAB   ÃªÂ°ÂÃ¬ÂÂ´ ?ÂÃ¬ÂÂ ???ÂÃ«ÂÂ¤ÃªÂ°?  0xAB 0XAB ?Â´ÃªÂ°Â???ÂÃ¬ÂÂ ???Â©Ã«ÂÂ??

Ã«Â§Â¤Ã«Â²Â ?ÂÃªÂ¸Â°??Ã¬Â¦ÂÃ¬ÂÂ?? ?ÂÃ«ÂÂÃªÂ³? ÃªÂ°ÂÃ­ÂÂ?ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃªÂ¸Â°ÃªÂ³? ?ÂÃ«Â²Â ?ÂÃªÂ¸Â°ÃªÂ¸??ÂÃ¬ÂÂ?ÂÃ«Â©Â´ 2048 Ã¬Â¤ÂÃ¬ÂÂ???Â¹Ã¬Â Â???ÂÃ¬Â¹Â?ÂÃ¬ÂÂ ?ÂÃ¬ÂÂ¼?ÂÃªÂ²Â Ã«Â°ÂÃ¬ÂÂ ?Â©Ã«ÂÂ??   

PC ?ÂÃ¬ÂÂ Ã¬Â¸Â¡Ã¬? ?ÂÃ¬ÂÂ±???ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?Â¼Ã«Â¡Â Ã«Â°ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¼??Ã¬Â¦ÂÃ¬ÂÂ?Â´ÃªÂ³Â ,  wire shark ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨?Â¼Ã«Â¡Â Ã«Â°ÂÃ¬ÂÂ???ÂÃ¬ÂÂ¼??Ã¬Â¦ÂÃ¬ÂÂ?ÂÃ«ÂÂ??

?ÂÃª? ÃªÂµÂ¬Ã­ÂÂ???ÂÃ¬ÂÂ¤??W5100_ATMega_WEBSERV-master ?ÂÃ«Â¡ÂÃªÂ·Â¸Ã«ÂÂ¨???ÂÃ¬Â Â?ÂÃ¬??ÂµÃ«ÂÂ??

?ÂÃ«ÂÂ?Â¨Ã¬ÂÂ´ ?ÂÃªÂ²Â½?? SPI ?Â´Ã«ÂÂ­ 10Mhz ?ÂÃ«ÂÂ??

TCP sever ?Â¨Ã¬ÂÂ???ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

    void W5100_TCP_SOCKET_Flow(void)
    {
        mysocketstate = W51_read(sockaddr+W5100_SR_OFFSET);
        switch  (mysocketstate)        // based on current status of socket...
        {
        case  W5100_SKT_SR_CLOSED:                      // if socket is closed...
            if (OpenSocket(mysocket, W5100_SKT_MR_TCP, HTTP_PORT) == mysocket)      // if successful opening a socket...
            {
                socketreconnectcounter++;
                Listen(mysocket);
                DELAY_US(1000);
            }
        break;
        case  W5100_SKT_SR_ESTABLISHED:                 // if socket connection is established...
            if(RECT.DMADataSendFlag)
            {
                if(DMAFlagCount > 4)
                {
                    DMAFlagCountdisplay = DMAFlagCount;
                    DMAFlagCount = 0;
                    switch(DMASendFlag)
                    {
                    case SENDPING:

                        DMASendFlag = SENDSTOP;
                        datasendstate = Send16(mysocket, ADC_RESULT, sizeof(ADC_RESULT));

                        break;
                    case SENDPONG:
                        DMASendFlag = SENDSTOP;
                        datasendstate = Send16(mysocket, ADC_RESULT_BUFF, sizeof(ADC_RESULT_BUFF));
                        break;
                    case SENDSTOP:
                        break;
                    default :
                        break;
                    }
                }

            }
            else
            {
                DMASendFlag = SENDSTOP;
            }
        break;
        case  W5100_SKT_SR_FIN_WAIT:
        case  W5100_SKT_SR_CLOSING:
        case  W5100_SKT_SR_TIME_WAIT:
        case  W5100_SKT_SR_CLOSE_WAIT:
        case  W5100_SKT_SR_LAST_ACK:
            DisconnectSocket(mysocket);
            CloseSocket(mysocket);
        break;
        }
    }

send ÃªÂµÂ¬Ã­ÂÂ ?Â¨Ã¬ÂÂ???ÂÃ«ÂÂ?? ÃªÂ°ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.

    Uint8 Send16(Uint8  sock, const Uint16  *buf, Uint16  buflen)
    {
        Uint16  ptr;
        Uint16  offaddr;
        Uint16  realaddr;
        Uint16  txsize;
        Uint16  timeout;
        Uint16  sockaddr;
    //    GPIO0_ON;
    //    Uint16  DMASendFlagState;
        // ----------------------(1)   1msec -------------------------------------------------------------------
        if (buflen == 0 || sock >= W5100_NUM_SOCKETS)  return  W5100_FAIL;      // ignore illegal requests
        sockaddr = W5100_SKT_BASE(sock);                                        // calc base addr for this socket
        // Make sure the TX Free Size Register is available
        txsize = W51_read(sockaddr+W5100_TX_FSR_OFFSET);                        // make sure the TX free-size reg is available
        txsize = (((txsize & 0x00FF) << 8 ) + W51_read(sockaddr+W5100_TX_FSR_OFFSET + 1));

        timeout = 0;
        while (txsize < buflen)
        {
    //        DELAY_US(10);
            txsize = W51_read(sockaddr+W5100_TX_FSR_OFFSET);        // make sure the TX free-size reg is available
            txsize = (((txsize & 0x00FF) << 8 ) + W51_read(sockaddr+W5100_TX_FSR_OFFSET + 1));
            if (timeout++ > 1000)                       // if max delay has passed...
            {
                DisconnectSocket(sock);                 // can't connect, close it down
                return  W5100_FAIL;                     // show failure
            }
        }
       // Read the Tx Write Pointer
        ptr = W51_read(sockaddr+W5100_TX_WR_OFFSET);
        offaddr = (((ptr & 0x00FF) << 8 ) + W51_read(sockaddr+W5100_TX_WR_OFFSET + 1));
        //------------------(1) 1msec end ------------------------------------------------------------------------
        while (buflen)
        {
            buflen--;
            realaddr = W5100_TXBUFADDR + (offaddr & W5100_TX_BUF_MASK);     // calc W5100 physical buffer addr for this socket

            static Uint8 tmp;
            tmp = *buf & 0x00FF;
            W51_write(realaddr, tmp);                  // send a upper byte of application data to TX buffer
            offaddr++;                                  // next TX buffer addr
            tmp = ((*buf) >> 8)&0x00FF;
            W51_write(realaddr+1, tmp);                  // send a lower byte of application data to TX buffer
            offaddr++;                                  // next TX buffer addr
            buf++;                                      // next input buffer addr
            if(DMASendFlag)
            {
    //            return DMA_OVERFLOW;
            }
        }

        W51_write(sockaddr+W5100_TX_WR_OFFSET, (offaddr & 0xFF00) >> 8);    // send MSB of new write-pointer addr
        W51_write(sockaddr+W5100_TX_WR_OFFSET + 1, (offaddr & 0x00FF));     // send LSB

        W51_write(sockaddr+W5100_CR_OFFSET, W5100_SKT_CR_SEND); // start the send on its way
        while (W51_read(sockaddr+W5100_CR_OFFSET))  ;   // loop until socket starts the send (blocks!!)
    //    GPIO0_OFF;
        return  W5100_OK;
    }


ÃªÂ²????ÂÃªÂ²Â¬ Ã«Â¶??ÂÃ«ÂÂÃ«Â¦Â½Ã«ÂÂ?? Even if you use other data, it is not to send completely different data, but send the previous data.

That is, 0x01 0x34 If you send it like this, you will receive 0x34 0x34 intermittently. [quote = ""sang_mun_lee, post: 2, topic: 6496, full: true""]
That is, 0x01 0x34 If you send it like this, you will receive 0x34 0x34 intermittently.
[/Quote]

It seems that the data given in the DSP28335 is stored in ADC_RESULT's BUF and sent to Wiz811MJ when operating Send.

It is necessary to make sure that the proper value is stored in the ADC_RESULT, or if the Send16 is sent, the exact value and the exact value are sent.

If the contents of ADC_RESULT are normal, I think the TX BUFFER AddR value was not weird when using Send16.

Please check it out and let me know.","Q) It is necessary to make sure that the proper value is stored in the ADC_RESULT, or if the Send16 is sent, the exact value and the exact value are sent.
A) The data given in the DSP28335 is stored in ADC_RESULT's BUF and sent to Wiz811MJ when operating Send. It is necessary to make sure that the proper value is stored in the ADC_RESULT, or if the Send16 is sent, the exact value and the exact value are sent. If the contents of ADC_RESULT are normal, I think the TX BUFFER AddR value was not weird when using Send16. Please check it out and let me know."
3513,6498,"Today is the winner's announce day. But why does the winners not shown on the page??
I'm always waiting for it....:cold_sweat::cold_sweat::cold_sweat: Hello, @dmswl6310.

First of all, please note that the winner announcement has been postponed to October 10th.

We currently evaluating contest posts internally.
It takes longer than scheduled to analyze and evaluate the submitted work by the end date.

Thank you for your interest and we apologize for not letting you know about the schedule.
Please check the October 10 announcement.
The new schedule will be announced today in maker.wiznet.io.

Thank you.","Q) Today is the winner's announce day. But why does the winners not shown on the page?? I'm always waiting for it.... 
A) First of all, please note that the winner announcement has been postponed to October 10th. We currently evaluating contest posts internally. It takes longer than scheduled to analyze and evaluate the submitted work by the end date. Thank you for your interest and we apologize for not letting you know about the schedule. Please check the October 10 announcement. The new schedule will be announced today in maker.wiznet.io. Thank you."
3514,6499,"We are using the W5300 to communicate with TCP/IP.
I want to communicate using an external IP, so I think I need a DNS address.

The example source I refer to (1. W5300_DRV_AVR_VR_V1.2.2.2.2.BASIC) is required to set only IP, Gateway, Subnet, and Mac. How can DNS be set?

In the W5100 source
Netconf.dns = *((u_long *) Get_dns_ip);
I think there is a part that is set up,
Is there a function or reference code that can be set immediately, as in the W5300 example source, such as SETGAR and SETSIPR?

If you don't have a simple example, please .. ?ÂÃ«ÂÂ?ÂÃ¬ÂÂ¸??

DNS??ÃªÂ²Â½Ã¬ÂÂ° gateway, ip ?? ?Â¬Ã«Â¦Â¬ dns Ã¬Â£Â¼Ã¬ÂÂ ?Â¤Ã¬Â Â Ã«Â§ÂÃ¬ÂÂ¼Ã«Â¡??ÂÃ¬ÂÂ?ÂÃ¬??ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
DNS??UDP ÃªÂ¸Â°Ã«Â°Â???ÂÃ«Â¡Â?Â Ã¬Â½ÂÃ«Â¡?DNS ?ÂÃ«Â²ÂÃ«Â¡??Â°Ã¬ÂÂ´?Â°Ã«? ?ÂÃ¬Â²Â­?ÂÃ¬ÂÂ¬ ?ÂÃ¬ÂÂ ?ÂÃ«ÂÂ Ã«Â°Â©Ã¬ÂÂ?ÂÃ«ÂÂ??
?ÂÃ«ÂÂ???Â¼Ã¬ÂÂ´Ã«Â¸ÂÃ«ÂÂ¬Ã«Â¦Â¬Ã«? ?Â¬Ã­ÂÂ?ÂÃ¬ÂÂ??DNS_init(), DNS_run()?Â¨Ã¬ÂÂÃ«Â¥??ÂµÃ­ÂÂ´ DNSÃ«Â¥??Â´Ã¬ÂÂ©?????ÂÃ¬ÂÂµ?ÂÃ«ÂÂ¤.
domain_addr??domain addressÃ«Â¥??ÂÃ¬ÂÂ´Ã¬Â£Â¼Ã¬ÂÂÃ«Â©??Â´Ã«ÂÂ¹?ÂÃ«ÂÂ ip addressÃªÂ°? ip_addr?????Â¥Ã«ÂÂ©?ÂÃ«ÂÂ¤.
  
    DNS_init( socket, buf);
    DNS_run( dns_server_ip, domain_addr, ip_addr); 

https://github.com/Wiznet/ioLibrary_Driver/tree/master/Internet/DNS Thank you for answer.I'll ask for some additional advice.

Windows Program (TCP/IP Server) -W5300 Board (TCP/IP Client)
It is currently configured in this way, but in the internal network, it is well connected.
But through the external network, it can't be connected strangely .. ;;
Of course, I did a port forward on the server firewall.

Mac Address is also put into the address purchased from IEEE before.Can I just put it in the purchased address?

I didn't have the DNS setting, so I asked yesterday.
Windows Program (TCP/IP Server) -In Windows Program (TCP/IP Client-> DNS), it is connected through an external network.

If it doesn't matter, how should I apply the library and functions?
W5300_DRV_AVR_V1.2.2 Use the example source.

U08 ServerIP [4] = {112,216,161,174};
U08 ClientiP [4] = {192,168,159};
U08 gateway [4] = {192,168,1,1};
U08 subNet [4] = {255,255,255,0};
U08 mac [6] = {0x70,0xb3,0xd5,0xF7,0x2e, 0xee};

int main (void)
{
.........................
     setshar (Mac);
     setgar (Gateway);
     setsubr (subnet);
     setsipr (clientip);
...........
     while (1) {
          loopback_tcpc (socketno1, serverip, port_no, bufferrxpacket, 0);
     }
............
}


The reason is that the external network is not connected .... ?ÂÃ£ÂÂ
It's urgent, but I'm frustrated. Please help me.","Q) How can DNS be set for W5300 when using an external IP? Is there a function or reference code that can be set immediately for DNS, as in the W5300 example source, such as SETGAR and SETSIPR?
A) To set DNS for W5300 when using an external IP, you can use the `DNS_init()` and `DNS_run()` functions. You can refer to the example source W5300_DRV_AVR_VR_V1.2.2.2.2.BASIC for the implementation. Additionally, ensure that the DNS server IP, domain address, and IP address are initialized properly before calling the `DNS_run()` function.

Q) Can I just put the Mac Address purchased from IEEE directly into the W5300 Board? 
A) Yes, you can put the Mac Address purchased from IEEE directly into the W5300 Board. Ensure that the Mac Address is set using the `setshar()` function in your code.

Q) How should I apply the library and functions to ensure connectivity through the external network for the Windows Program (TCP/IP Server) - W5300 Board (TCP/IP Client) setup? 
A) To ensure connectivity through the external network for the Windows Program (TCP/IP Server) - W5300 Board (TCP/IP Client) setup, you need to check the port forwarding settings on the server firewall. Additionally, verify that the DNS settings are correctly configured for both the server and client.

Q) What could be the reason for the external network not connecting in the setup? 
A) The external network may not be connecting due to incorrect DNS settings or firewall configurations. It's essential to verify the DNS settings and ensure that the port forwarding is correctly set up on the server firewall to allow external connections.

Q) What could be the possible solution for the issue of not being able to connect through the external network? 
A) To address the issue of not being able to connect through the external network, double-check the DNS settings and ensure that the library functions such as `setshar()`, `setgar()`, `setsubr()`, and `setsipr()` are being applied correctly in your code. Additionally, ensure that the port forwarding is properly configured on the server firewall. If further assistance is needed, please provide more details about the specific error or issue encountered."
3515,650,"Hi,
I've developed a prototype board using the W5100 device and all seems to work right.
Now I'm little confused in the choice of the RJ45 connectors with the magnetic module inside.
The document with the specification is here:
[dl.dropboxusercontent.com/u/464 ... 7-xxxx.pdf](https://dl.dropboxusercontent.com/u/46446242/RJ47-xxxx.pdf)

If you see into page 3 there are a lot of module connection schematics.
Can you suggest me the best connection that I have to use with the W5100 device?

Thank you for your attention
Regards
Beppe Hi,

RJ45 schematic needs to be same with our reference macjack.

If not we couldn't guarantee.

Best regards. HI~~

RJ45 is on sale now through our site. Please refer to URL as below.
[url]http://www.shopwiznet.com/accessories[/url]
The model  name of RJ45 is RB1-125BAG1A.

thanks, :slight_smile: Thank you to all for your attention.

Only for my information: in the datasheets that you two suggest me, the magnetic transformer is indicated as 1:1.
With my little knowledge about the magnetic module for data network, this is wrong because the transformer has the central tap, so I think that the right indication is 1CT:1CT.

Am I wrong?
If yes, what is the right interpretation about 1:1 and 1CT:1CT indication?

Thank you
Regards
Beppe The difference of 1:1 and 1CT:1CT, but the difference between the center tap. 

RDA-125BAG1A are represented by 1:1, it can be seen in 1CT:1CT. 

You, please use the 1CT:1CT.","Q) Can you suggest me the best connection that I have to use with the W5100 device?
Q) Am I wrong? If yes, what is the right interpretation about 1:1 and 1CT:1CT indication?
A) The difference of 1:1 and 1CT:1CT, but the difference between the center tap. RDA-125BAG1A are represented by 1:1, it can be seen in 1CT:1CT. You, please use the 1CT:1CT."
3516,6502,"I moved the category to the Korean Forum. The switch was a problem!, Thank you.It has been solved! ","Q) Is there an issue with the category switch to the Korean Forum? 
A) Thank you. It has been solved!"
3517,6508,"Hi, can someone link me videos or usefull data for programing w6100 evb over usb? Or i should program it over some other metods? Im new in arm mcu's hi, Mario_Runje

you can use this example project. This has tcp & udp loopback examples.

https://wizwiki.net/wiki/doku.php/products:w6100:driver:start

&

https://github.com/Wiznet/W6100_EVB

thank you Loopback doesnt work, i got this in build console, and i found out that it stucks at W6100Initialze();

Its too long for post so i got it on this link : https://pastebin.com/Mig9K1Um There are two examples for gcc and truestudio.

could you check it agian with evb gcc project link ?

https://github.com/Wiznet/W6100-EVB-gcc-eclipse Here is loopback project guide.
https://maker.wiznet.io/2019/04/30/wiznetw6100evb-loopback-2/

If you want to know more application about W6100, you click this link and go to 3th page on ENTRY part.
https://maker.wiznet.io/contests/contest-in-progress/201905-iot-ioffload-contest/ Hello Mario_Runje,

Here is W6100 Loopback full code.

https://github.com/WIZnet-ioLibrary/W6100EVB-Loopback

thank you
taylor Hello!  I am bumping this because I have tried for several attempts to get the ST Flash loader Demonstrator to connect to my W6100-EVB.
My fully up to date Windows 10 (Non domain) PC has an entry in the Device manager showing a COM3 set to 115200 8,n,1  the ST Loader is set to COM3, 115200, 8,N, Listen Mode (or Echo)  10s timeout.
Listen mode says: The failure says ""no response from the target, the Boot loader can not be started.  Please verify the boot mode configuration and the flash protection status, Reset device then try again...""
Echo mode and disabled mode says : ""Cannot get available commands, Please, Try to change Echo selection, Reset your device then try again...""

I'm probably not doing something silly, this is my first programming with an ST device
Any help would be appreciated.  
Thank You
Ray","Q) Hi, can someone link me videos or usefull data for programing w6100 evb over usb? Or i should program it over some other metods? Im new in arm mcu's hi, Mario_Runje
A) You can use this example project. This has tcp & udp loopback examples.
https://wizwiki.net/wiki/doku.php/products:w6100:driver:start
&
https://github.com/Wiznet/W6100_EVB

Q) Loopback doesnt work, i got this in build console, and i found out that it stucks at W6100Initialze();
Its too long for post so i got it on this link : https://pastebin.com/Mig9K1Um There are two examples for gcc and truestudio.
could you check it agian with evb gcc project link ?
A) Here is loopback project guide.
https://maker.wiznet.io/2019/04/30/wiznetw6100evb-loopback-2/
If you want to know more application about W6100, you can click this link and go to 3th page on ENTRY part.
https://maker.wiznet.io/contests/contest-in-progress/201905-iot-ioffload-contest/

Q) Hello Mario_Runje, Here is W6100 Loopback full code.
https://github.com/WIZnet-ioLibrary/W6100EVB-Loopback
A) Thank you.

Q) Hello! I am bumping this because I have tried for several attempts to get the ST Flash loader Demonstrator to connect to my W6100-EVB. My fully up to date Windows 10 (Non domain) PC has an entry in the Device manager showing a COM3 set to 115200 8,n,1 the ST Loader is set to COM3, 115200, 8,N, Listen Mode (or Echo) 10s timeout. Listen mode says: The failure says ""no response from the target, the Boot loader can not be started. Please verify the boot mode configuration and the flash protection status, Reset device then try again..."" Echo mode and disabled mode says : ""Cannot get available commands, Please, Try to change Echo selection, Reset your device then try again..."" I'm probably not doing something silly, this is my first programming with an ST device 
Any help would be appreciated. Thank You
A) None."
3518,651,"I'm using the W3100A
Occasionally, in about 50 of the 1000 equipment,
Only one connected herb port dies (communication).
When you turn off the hub and turn it on, the died herb port will survive.
Once you connect your laptop to the dead port, you can't communicate.
)
There are no abnormalities in the equipment of other companies in the herb
It doesn't seem to be a herb problem.
Other company equipment has no problem, so send a strange packet on our board
I have no choice but to kill the switching hub port
It is in a very difficult situation.
I wonder if there were some similar symptoms in other companies using the W3100.
Or please give me some ideas that can be tested even a minor hint. Thank you for your accurate NewTwork configuration and application.

Also, if you have a logging function on the HUB device, please check.
It is very difficult to grasp the problem that does not work for a long time.Therefore, I wonder if there is a way to stress to get this problem faster.","Q) I wonder if there were some similar symptoms in other companies using the W3100. Or please give me some ideas that can be tested even a minor hint. Thank you for your accurate NewTwork configuration and application.

A) It seems like you are experiencing intermittent connectivity issues with the W3100A. One possible troubleshooting step is to check if there are any firmware updates available for the W3100A that address connectivity issues. Additionally, it would be helpful to analyze the network traffic using a packet analyzer to identify any unusual behavior that may be causing the herb port to die. As for stressing the problem to get a faster resolution, enabling logging on the HUB device and analyzing the logs during the occurrence of the issue could provide valuable insights."
3519,6515,"Hi!

I purchased a WIZNET110SR S2E module recently and trying to get data from our medical laboratory analyzer using the WIZNET s2e module's LAN interface. The serial device(med Analyzer) transfers and receives data from external system(LIS) through its serial RS 232 interface. I tested the module's s2e feature successfully with terminal utility hercules. But when I am connecting the serial device to the WIZNET gateway module and trying to get data from the LAN interface of the module, I don't receive any data. The procedure I am following for this testing is as follows:
1. Connecting the serial device to Wiznet's serial int with serial cable.
2. Connecting the LAN int with LAN cable from the local network
3. Creating a virtual COM port with option 2 (client)  and adding the IP/port of Wiznet module 
4. Opening the Virtual COM port with hercules serial window to listening serial data
5. Press data send button in Serial device
Result: Nothing is showing in console window.
Now, would you please tell me the exact steps to have the data in Wiznet's LAN interface.
Please give me a solution how I activate the features/functions of the module in such real world scenarios Hi, Prom001

could you explain your system? is it like this?

> device --< serial cable >-- wiznet110sr --< lan cable >-- local pc

If you do, you have to open TCP or UDP port on hercules to receive the data from wiznet110sr.
But do I understanding well?
Anyway I am waiting your reply. :slight_smile: 

Thank you","Q) could you explain your system? is it like this?
A) device --< serial cable >-- wiznet110sr --< lan cable >-- local pc
"
3520,6517,"Everything was fine until he mistakenly entered.
AT+USET=384000,N,8,1,N
Power off and reset do not help.
Now I don?Ât know how to connect to the module?
Tell me how to return to factory settings?
:frowning:

I'm at a loss :worried:
It turns out that AT + USET can be set to any speed with saving in Flash, and these parameters are used the next time the module is turned on.
And, if in the process of communicating with the Microcontroller with the module such a sequence is accidentally transmitted AT + USET = ?????? ... ???? {0x0D}, then the module becomes useless?
Where is the logic and common sense?:rage:
I liked your module and I planned its mass commercial use, but now I don?Ât know what to do ...:disappointed_relieved: Hi

you have to press a ""Function pin"" three times to make the module to default setting.(baud:115200)
if you have any problem. feel free to let me know.

Thanks  push three times Function pin from GND or VCC? ?ÂFunction pin??to ?ÂVCC??-> turn off -> turn on -> returned to factory settings:slightly_smiling_face:
Thanks wizdaniel","Q) Tell me how to return to factory settings?
A) you have to press a ""Function pin"" three times to make the module to default setting.(baud:115200) If you have any problem, feel free to let me know. Thanks."
3521,6519,"In the W6100 Data Sheet (Hangul version), click on the link to refer to the crystal selection.

The guide is not linked.

Is the W5100S and the W6100 Crystal oscillate calculation?

In the case of the W5100s, the gain margin is 6.9897. It has been confirmed that the link is incorrectly set, and the W6100 Datasheet has been updated.
As you said, the Crystal oscillator calculation of the W5100s and W6100 is the same.
thank you","Q) Is the W5100S and the W6100 Crystal oscillate calculation?
A) As you said, the Crystal oscillator calculation of the W5100s and W6100 is the same."
3522,652,"Hi,

I try to poll the module with the serial command <QP> in order to get information about the connection status.
My module is not connected to any wireless network and responses with error number 4.

Is the command not suitable for this condition(altough it should be because it has a detail about connected or not) or do you have an alternative ? Hello Nils333

Return Code 4 : Not supported command in current running 

Please be sure that the operation mode is <Client mode>.
In another mode, it will return 4.

Steve Hi,

our currently prefered mode is AP client with setting of Multi Bridge Mode.

Where do I have to keep the setting to Client Mode else ? Hi

you can use <QP> command in AP-Client mode. Please refer this command list.
It is serial command list for using AP-Client mode. Red color is command and black color is response message.

[color=#FF0000][b]<GO6>[/b][/color]
<S>
[b][color=#FF0000]<DI>[/color][/b]
<S_xxxx>
[b][color=#FF0000]<PU5_2_6_1_123456789>[/color][/b]
<S>
[b][color=#FF0000]<PIWiznetKaizen_123456789>[/color][/b]
<4>  <-- If you show this response, Don't care.
[b][color=#FF0000]<WL>[/color][/b]
<S>
[b][color=#FF0000]<WR>[/color][/b]
[b][color=#FF0000]<QP>[/color][/b]
<S1_WiznetKaizen_0026667B9DB0_1_150_44> Hi,

sorry I tried your settings, but it doesn't work, the result is still <4>.

By the way, what is the difference in function of the command pairs AU/PU and DU/GU ?
In my understanding the AU/PU is used in order to set the security of the modules client function relative to the AP ?

How is the modules AP function used ?
Does the module share the SSID of the upper AP for its own AP function ?

Is the DU/GU used for operation modes other than AP Client Multibridge Mode ? Hi,

the <S6> after <DO> command is confirmed.
My module has got the serial number <Sv1.1.24>

I also tried with a module, having the <Sv1.1.25> with the same result.

What is the general reaction of the <QP> command ? Does it work in correct manner, if the module has got an establshed connection or what can affect the commands always response with message <4> ? Hi nils

I did identify the problem about this issue.
In 1.1.24 and 1.1.25, WizFi630 always output message <4> after enter <QP> command.
But in 1.1.29, We fixed this problem. So I will send this firmware to you via your mail.

I hope this solution is of help.

Thank you. Hello,

yes thank you very much, the new firmware works fine. Hi again,

this morning I tested the firmware and first I got a <S0> for no connection and after that, connection and the correct response.

This afternoon I performed some more tests and the connection is good and stable, web server tells me connection, but status telegram <QP> always tells me <S0>.

What may have happen ?","Q) Is the command not suitable for this condition(altough it should be because it has a detail about connected or not) or do you have an alternative ?
A) Return Code 4 : Not supported command in current running 
Please be sure that the operation mode is <Client mode>.
In another mode, it will return 4.

Q) Where do I have to keep the setting to Client Mode else ?
A) you can use <QP> command in AP-Client mode. Please refer this command list.
It is serial command list for using AP-Client mode. Red color is command and black color is response message.

Q) By the way, what is the difference in function of the command pairs AU/PU and DU/GU ? In my understanding the AU/PU is used in order to set the security of the modules client function relative to the AP ?
A) Hi, the <S6> after <DO> command is confirmed.
My module has got the serial number <Sv1.1.24>
I also tried with a module, having the <Sv1.1.25> with the same result.
What is the general reaction of the <QP> command ? Does it work in correct manner, if the module has got an establshed connection or what can affect the commands always response with message <4> ?

Q) What is the general reaction of the <QP> command ? Does it work in correct manner, if the module has got an establshed connection or what can affect the commands always response with message <4> ?
A) I did identify the problem about this issue.
In 1.1.24 and 1.1.25, WizFi630 always output message <4> after enter <QP> command.
But in 1.1.29, We fixed this problem. So I will send this firmware to you via your mail.
I hope this solution is of help."
3523,6520,"Please check other at command default values. Thank you for your opinion
I checked it.
AT+RESTORE command is run well.
But Default Value of AT+CWMODE_CUR is 2. It is not 1.
So I will fix it to AT instruction set document.","Q) Please check other at command default values. 
A) I checked it. The AT+RESTORE command is run well. But the Default Value of AT+CWMODE_CUR is 2. It is not 1. So I will fix it to AT instruction set document."
3524,6528,"The client port value is 61858 among the values of AT+CIPSTAUS.
The captured file is only up to 61857.

Isn't it a normal connection since?
I'll test it once @becky It wasn't normal.
Once the wizfi360 is terminated, it is connected to the cipstatus.
Once the scenario is special, please tell me if it is difficult to reproduce. The situation was reproduced.
I'm the same except that I can't see the RST packet.
TEDDY Master said you checked the SDK.
In the case of the PORT number, it increases periodically while transmitting the SYN Packet, and the last sent number of SYN Packet seems to be raised. I can't do it properly by the situation alone
Or ACK for SYN is not confirmed and seems to be going directly to the connection state.
Port number is also an issue The PORT number increases by 1 from the Port number set by the user.

If you think it's an issue, can you capture and share it with ESP? Is it normal for users to transmit data through Transparent Transmission Mode and get out of the mode automatically?

Or is it a disconnect if the server has disconnect like the scenario I shared and the wizfi360 exits the mode? Hello, this is Park Byung -taek.

When the server is connected, the transmission does not lead to disconnect.

But if the server is blocked during the Trans mode, you will continue to pack the server.

Later, when you get out of the Trans mode, you will be disconnect if there is no server response.

thank you

Park Byung -taek Dream.","Q) If you think it's an issue, can you capture and share it with ESP? Is it normal for users to transmit data through Transparent Transmission Mode and get out of the mode automatically?
A) It's possible that the issue lies in the communication process. Capturing and sharing the data with ESP can provide more insight into the problem. Regarding the mode transition, it's not normal for the device to automatically exit the Transparent Transmission Mode without a clear trigger or command. 

Q) Or is it a disconnect if the server has disconnect like the scenario I shared and the wizfi360 exits the mode? 
A) It seems that the scenario you shared indicates a potential disconnect when the server is inaccessible, and the wizfi360 then exits the mode. This behavior may lead to unexpected disconnections. 

Q) When the server is connected, the transmission does not lead to disconnect. But if the server is blocked during the Trans mode, you will continue to pack the server. Later, when you get out of the Trans mode, you will be disconnect if there is no server response.
A) The behavior described indicates that when the server is connected, the transmission remains stable. However, if the server is blocked during the Transparent Transmission Mode, the device tries to continue packing the server. Subsequently, when exiting the Trans mode without a server response, it leads to disconnection. This sequence can be problematic and may require further analysis."
